<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

\section[RnSource]{Main pass of renamer}
-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">RnTypes</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- Type related stuff</span><span>
</span><a name="line-12"></a><span>        </span><a href="RnTypes.html#rnHsType"><span class="hs-identifier hs-var">rnHsType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsTypes"><span class="hs-identifier hs-var">rnLHsTypes</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnContext"><span class="hs-identifier hs-var">rnContext</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="RnTypes.html#rnHsKind"><span class="hs-identifier hs-var">rnHsKind</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnHsWcType"><span class="hs-identifier hs-var">rnHsWcType</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="RnTypes.html#rnHsSigWcType"><span class="hs-identifier hs-var">rnHsSigWcType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnHsSigWcTypeScoped"><span class="hs-identifier hs-var">rnHsSigWcTypeScoped</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="RnTypes.html#rnLHsInstType"><span class="hs-identifier hs-var">rnLHsInstType</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier hs-var">rnConDeclFields</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="RnTypes.html#rnLTyVar"><span class="hs-identifier hs-var">rnLTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>        </span><span class="hs-comment">-- Precence related stuff</span><span>
</span><a name="line-22"></a><span>        </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkNegAppRn"><span class="hs-identifier hs-var">mkNegAppRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier hs-var">mkOpFormRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier hs-var">mkConOpPatRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="RnTypes.html#checkPrecMatch"><span class="hs-identifier hs-var">checkPrecMatch</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#checkSectionPrec"><span class="hs-identifier hs-var">checkSectionPrec</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">-- Binding related stuff</span><span>
</span><a name="line-26"></a><span>        </span><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier hs-var">bindLHsTyVarBndr</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="RnTypes.html#bindSigTyVarsFV"><span class="hs-identifier hs-var">bindSigTyVarsFV</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#bindHsQTyVars"><span class="hs-identifier hs-var">bindHsQTyVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#bindLRdrNames"><span class="hs-identifier hs-var">bindLRdrNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractHsTysRdrTyVars"><span class="hs-identifier hs-var">extractHsTysRdrTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>        </span><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTysRdrTyVarsDups</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="RnTypes.html#extractRdrKindSigVars"><span class="hs-identifier hs-var">extractRdrKindSigVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractDataDefnKindVars"><span class="hs-identifier hs-var">extractDataDefnKindVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier hs-var">freeKiTyVarsAllVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#freeKiTyVarsTypeVars"><span class="hs-identifier hs-var">freeKiTyVarsTypeVars</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="RnSplice.html"><span class="hs-identifier">RnSplice</span></a><span class="hs-special">(</span><span> </span><a href="RnSplice.html#rnSpliceType"><span class="hs-identifier hs-var">rnSpliceType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="RnHsDoc.html"><span class="hs-identifier">RnHsDoc</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="RnHsDoc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a><span class="hs-special">,</span><span> </span><a href="RnHsDoc.html#rnMbLHsDoc"><span class="hs-identifier hs-var">rnMbLHsDoc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="RnEnv.html"><span class="hs-identifier">RnEnv</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>                          </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#FixityDirection"><span class="hs-identifier hs-type">FixityDirection</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#LexicalFixity"><span class="hs-identifier hs-type">LexicalFixity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">{-
These type renamers are in a separate module, rather than in (say) RnSource,
to break several loop.

*********************************************************
*                                                       *
           HsSigWcType (i.e with wildcards)
*                                                       *
*********************************************************
-}</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-identifier">rnHsSigWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-76"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><a name="rnHsSigWcType"><a href="RnTypes.html#rnHsSigWcType"><span class="hs-identifier">rnHsSigWcType</span></a></a><span> </span><a name="local-6989586621679803363"><a href="#local-6989586621679803363"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803364"><a href="#local-6989586621679803364"><span class="hs-identifier">sig_ty</span></a></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier hs-var">rn_hs_sig_wc_type</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679803363"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803364"><span class="hs-identifier hs-var">sig_ty</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679803365"><a href="#local-6989586621679803365"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-79"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803365"><span class="hs-identifier hs-var">sig_ty'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">rnHsSigWcTypeScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-82"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803362"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- Used for</span><span>
</span><a name="line-85"></a><span class="hs-comment">--   - Signatures on binders in a RULE</span><span>
</span><a name="line-86"></a><span class="hs-comment">--   - Pattern type signatures</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- Wildcards are allowed</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- type signatures on binders only allowed with ScopedTypeVariables</span><span>
</span><a name="line-89"></a><a name="rnHsSigWcTypeScoped"><a href="RnTypes.html#rnHsSigWcTypeScoped"><span class="hs-identifier">rnHsSigWcTypeScoped</span></a></a><span> </span><a name="local-6989586621679803366"><a href="#local-6989586621679803366"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679803367"><a href="#local-6989586621679803367"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621679803368"><a href="#local-6989586621679803368"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803369"><a href="#local-6989586621679803369"><span class="hs-identifier">ty_sig_okay</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#ScopedTypeVariables"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ScopedTypeVariables</span></a><span>
</span><a name="line-91"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#checkErr"><span class="hs-identifier hs-var">checkErr</span></a><span> </span><a href="#local-6989586621679803369"><span class="hs-identifier hs-var">ty_sig_okay</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#unexpectedTypeSigErr"><span class="hs-identifier hs-var">unexpectedTypeSigErr</span></a><span> </span><a href="#local-6989586621679803367"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier hs-var">rn_hs_sig_wc_type</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679803366"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679803367"><span class="hs-identifier hs-var">sig_ty</span></a><span> </span><a href="#local-6989586621679803368"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-93"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-comment">-- False: for pattern type sigs and rules we /do/ want</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-comment">--        to bring those type variables into scope</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-comment">-- e.g  \ (x :: forall a. a-&gt; b) -&gt; e</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-comment">-- Here we do bring 'b' into scope</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">rn_hs_sig_wc_type</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>   </span><span class="hs-comment">-- see rnImplicitBndrs</span><span>
</span><a name="line-100"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-101"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-102"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- rn_hs_sig_wc_type is used for source-language type signatures</span><span>
</span><a name="line-105"></a><a name="rn_hs_sig_wc_type"><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier">rn_hs_sig_wc_type</span></a></a><span> </span><a name="local-6989586621679803370"><a href="#local-6989586621679803370"><span class="hs-identifier">no_implicit_if_forall</span></a></a><span> </span><a name="local-6989586621679803371"><a href="#local-6989586621679803371"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-106"></a><span>                  </span><span class="hs-special">(</span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803372"><a href="#local-6989586621679803372"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>                  </span><a name="local-6989586621679803373"><a href="#local-6989586621679803373"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803374"><a href="#local-6989586621679803374"><span class="hs-identifier">free_vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span> </span><a href="#local-6989586621679803372"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-109"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803375"><a href="#local-6989586621679803375"><span class="hs-identifier">tv_rdrs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803376"><a href="#local-6989586621679803376"><span class="hs-identifier">nwc_rdrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier hs-var">partition_nwcs</span></a><span> </span><a href="#local-6989586621679803374"><span class="hs-identifier hs-var">free_vars</span></a><span>
</span><a name="line-110"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier hs-var">rnImplicitBndrs</span></a><span> </span><a href="#local-6989586621679803370"><span class="hs-identifier hs-var">no_implicit_if_forall</span></a><span> </span><a href="#local-6989586621679803375"><span class="hs-identifier hs-var">tv_rdrs</span></a><span> </span><a href="#local-6989586621679803372"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803377"><a href="#local-6989586621679803377"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803378"><a href="#local-6989586621679803378"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803379"><a href="#local-6989586621679803379"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803380"><a href="#local-6989586621679803380"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnWcBody"><span class="hs-identifier hs-var">rnWcBody</span></a><span> </span><a href="#local-6989586621679803371"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679803376"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span> </span><a href="#local-6989586621679803372"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-112"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803381"><a href="#local-6989586621679803381"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_wcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803378"><span class="hs-identifier hs-var">wcs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803382"><span class="hs-identifier hs-var">ib_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-113"></a><span>             </span><a name="local-6989586621679803382"><a href="#local-6989586621679803382"><span class="hs-identifier">ib_ty'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier hs-var">mk_implicit_bndrs</span></a><span> </span><a href="#local-6989586621679803377"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679803379"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><a href="#local-6989586621679803380"><span class="hs-identifier hs-var">fvs1</span></a><span>
</span><a name="line-114"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803383"><a href="#local-6989586621679803383"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803384"><a href="#local-6989586621679803384"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803373"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803381"><span class="hs-identifier hs-var">sig_ty'</span></a><span>
</span><a name="line-115"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803383"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803380"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803384"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-identifier">rnHsWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="rnHsWcType"><a href="RnTypes.html#rnHsWcType"><span class="hs-identifier">rnHsWcType</span></a></a><span> </span><a name="local-6989586621679803385"><a href="#local-6989586621679803385"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803386"><a href="#local-6989586621679803386"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803387"><a href="#local-6989586621679803387"><span class="hs-identifier">free_vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span> </span><a href="#local-6989586621679803386"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-120"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679803388"><a href="#local-6989586621679803388"><span class="hs-identifier">nwc_rdrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier hs-var">partition_nwcs</span></a><span> </span><a href="#local-6989586621679803387"><span class="hs-identifier hs-var">free_vars</span></a><span>
</span><a name="line-121"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803389"><a href="#local-6989586621679803389"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803390"><a href="#local-6989586621679803390"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803391"><a href="#local-6989586621679803391"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnWcBody"><span class="hs-identifier hs-var">rnWcBody</span></a><span> </span><a href="#local-6989586621679803385"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679803388"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span> </span><a href="#local-6989586621679803386"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-122"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803392"><a href="#local-6989586621679803392"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_wcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803389"><span class="hs-identifier hs-var">wcs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803390"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-123"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803392"><span class="hs-identifier hs-var">sig_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803391"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">rnWcBody</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-126"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><a name="rnWcBody"><a href="RnTypes.html#rnWcBody"><span class="hs-identifier">rnWcBody</span></a></a><span> </span><a name="local-6989586621679803393"><a href="#local-6989586621679803393"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803394"><a href="#local-6989586621679803394"><span class="hs-identifier">nwc_rdrs</span></a></a><span> </span><a name="local-6989586621679803395"><a href="#local-6989586621679803395"><span class="hs-identifier">hs_ty</span></a></a><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803432"><a href="#local-6989586621679803432"><span class="hs-identifier">nwcs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><a href="#local-6989586621679803394"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span>
</span><a name="line-129"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803433"><a href="#local-6989586621679803433"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span>
</span><a name="line-130"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>
</span><a name="line-131"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><a href="#local-6989586621679803432"><span class="hs-identifier hs-var">nwcs</span></a><span>
</span><a name="line-132"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803393"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803434"><a href="#local-6989586621679803434"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803435"><a href="#local-6989586621679803435"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621679803432"><span class="hs-identifier hs-var">nwcs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-134"></a><span>                          </span><a href="#local-6989586621679803396"><span class="hs-identifier hs-var">rn_lty</span></a><span> </span><a href="#local-6989586621679803433"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803395"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-135"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803436"><a href="#local-6989586621679803436"><span class="hs-identifier">awcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span> </span><a href="#local-6989586621679803434"><span class="hs-identifier hs-var">hs_ty'</span></a><span>
</span><a name="line-136"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803432"><span class="hs-identifier hs-var">nwcs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679803436"><span class="hs-identifier hs-var">awcs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803434"><span class="hs-identifier hs-var">hs_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803435"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-138"></a><span>    </span><a name="local-6989586621679803396"><a href="#local-6989586621679803396"><span class="hs-identifier">rn_lty</span></a></a><span> </span><a name="local-6989586621679803399"><a href="#local-6989586621679803399"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803400"><a href="#local-6989586621679803400"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803401"><a href="#local-6989586621679803401"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621679803400"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-140"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803402"><a href="#local-6989586621679803402"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803403"><a href="#local-6989586621679803403"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803397"><span class="hs-identifier hs-var">rn_ty</span></a><span> </span><a href="#local-6989586621679803399"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803401"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-141"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803400"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803402"><span class="hs-identifier hs-var">hs_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803403"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-comment">-- A lot of faff just to allow the extra-constraints wildcard to appear</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-6989586621679803397"><a href="#local-6989586621679803397"><span class="hs-identifier">rn_ty</span></a></a><span> </span><a name="local-6989586621679803404"><a href="#local-6989586621679803404"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803405"><a href="#local-6989586621679803405"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803406"><a href="#local-6989586621679803406"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803407"><a href="#local-6989586621679803407"><span class="hs-identifier">hs_body</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803404"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier hs-var">inTypeDoc</span></a><span> </span><a href="#local-6989586621679803405"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>                           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679803406"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803408"><a href="#local-6989586621679803408"><span class="hs-identifier">tvs'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-148"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803409"><a href="#local-6989586621679803409"><span class="hs-identifier">hs_body'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803410"><a href="#local-6989586621679803410"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803396"><span class="hs-identifier hs-var">rn_lty</span></a><span> </span><a href="#local-6989586621679803404"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803407"><span class="hs-identifier hs-var">hs_body</span></a><span>
</span><a name="line-149"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803408"><span class="hs-identifier hs-var">tvs'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803409"><span class="hs-identifier hs-var">hs_body'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803410"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><a name="local-6989586621679803411"><a href="#local-6989586621679803411"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803412"><a href="#local-6989586621679803412"><span class="hs-identifier">cx</span></a></a><span> </span><a name="local-6989586621679803413"><a href="#local-6989586621679803413"><span class="hs-identifier">hs_ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803414"><a href="#local-6989586621679803414"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679803415"><a href="#local-6989586621679803415"><span class="hs-identifier">hs_ctxt1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803416"><a href="#local-6989586621679803416"><span class="hs-identifier">hs_ctxt_last</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-6989586621679803413"><span class="hs-identifier hs-var">hs_ctxt</span></a><span>
</span><a name="line-153"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803417"><a href="#local-6989586621679803417"><span class="hs-identifier">lx</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a name="local-6989586621679803418"><a href="#local-6989586621679803418"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#ignoreParens"><span class="hs-identifier hs-var">ignoreParens</span></a><span> </span><a href="#local-6989586621679803416"><span class="hs-identifier hs-var">hs_ctxt_last</span></a><span>
</span><a name="line-154"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803419"><a href="#local-6989586621679803419"><span class="hs-identifier">hs_ctxt1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803420"><a href="#local-6989586621679803420"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803398"><span class="hs-identifier hs-var">rn_top_constraint</span></a><span> </span><a href="#local-6989586621679803411"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803415"><span class="hs-identifier hs-var">hs_ctxt1</span></a><span>
</span><a name="line-155"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803421"><a href="#local-6989586621679803421"><span class="hs-identifier">wc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621679803417"><span class="hs-identifier hs-var">lx</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-156"></a><span>                    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkExtraConstraintWildCard"><span class="hs-identifier hs-var">checkExtraConstraintWildCard</span></a><span> </span><a href="#local-6989586621679803411"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803418"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-157"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier hs-var">rnAnonWildCard</span></a><span> </span><a href="#local-6989586621679803418"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-158"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803422"><a href="#local-6989586621679803422"><span class="hs-identifier">hs_ctxt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803419"><span class="hs-identifier hs-var">hs_ctxt1'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803417"><span class="hs-identifier hs-var">lx</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a href="#local-6989586621679803421"><span class="hs-identifier hs-var">wc'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-159"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803423"><a href="#local-6989586621679803423"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803424"><a href="#local-6989586621679803424"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803411"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803414"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-160"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803412"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621679803422"><span class="hs-identifier hs-var">hs_ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803423"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-161"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803420"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803424"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-164"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803425"><a href="#local-6989586621679803425"><span class="hs-identifier">hs_ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803426"><a href="#local-6989586621679803426"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803398"><span class="hs-identifier hs-var">rn_top_constraint</span></a><span> </span><a href="#local-6989586621679803411"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803413"><span class="hs-identifier hs-var">hs_ctxt</span></a><span>
</span><a name="line-165"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803427"><a href="#local-6989586621679803427"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803428"><a href="#local-6989586621679803428"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803411"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803414"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-166"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803412"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621679803425"><span class="hs-identifier hs-var">hs_ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803427"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-167"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803426"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803428"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><a name="local-6989586621679803429"><a href="#local-6989586621679803429"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803430"><a href="#local-6989586621679803430"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><a href="#local-6989586621679803429"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803430"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span>    </span><a name="local-6989586621679803398"><a href="#local-6989586621679803398"><span class="hs-identifier">rn_top_constraint</span></a></a><span> </span><a name="local-6989586621679803431"><a href="#local-6989586621679803431"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803431"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-identifier">checkExtraConstraintWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-175"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- Rename the extra-constraint spot in a type signature</span><span>
</span><a name="line-177"></a><span class="hs-comment">--    (blah, _) =&gt; type</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- Check that extra-constraints are allowed at all, and</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- if so that it's an anonymous wildcard</span><span>
</span><a name="line-180"></a><a name="checkExtraConstraintWildCard"><a href="RnTypes.html#checkExtraConstraintWildCard"><span class="hs-identifier">checkExtraConstraintWildCard</span></a></a><span> </span><a name="local-6989586621679803437"><a href="#local-6989586621679803437"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803438"><a href="#local-6989586621679803438"><span class="hs-identifier">wc</span></a></a><span>
</span><a name="line-181"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621679803437"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803439"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-182"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-183"></a><span>    </span><a name="local-6989586621679803439"><a href="#local-6989586621679803439"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extraConstraintWildCardsAllowed"><span class="hs-identifier hs-var">extraConstraintWildCardsAllowed</span></a><span> </span><a href="#local-6989586621679803437"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Extra-constraint wildcard&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803438"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>                   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;not allowed&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-187"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-identifier">extraConstraintWildCardsAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-190"></a><a name="extraConstraintWildCardsAllowed"><a href="RnTypes.html#extraConstraintWildCardsAllowed"><span class="hs-identifier">extraConstraintWildCardsAllowed</span></a></a><span> </span><a name="local-6989586621679803440"><a href="#local-6989586621679803440"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-191"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803440"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-192"></a><span>      </span><a href="RnEnv.html#TypeSigCtx"><span class="hs-identifier hs-var">TypeSigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-193"></a><span>      </span><a href="RnEnv.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-194"></a><span>      </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Finds free type and kind variables in a type,</span><span>
</span><a name="line-197"></a><span class="hs-comment">--     without duplicates, and</span><span>
</span><a name="line-198"></a><span class="hs-comment">--     without variables that are already in scope in LocalRdrEnv</span><span>
</span><a name="line-199"></a><span class="hs-comment">--   NB: this includes named wildcards, which look like perfectly</span><span>
</span><a name="line-200"></a><span class="hs-comment">--       ordinary type variables at this point</span><span>
</span><a name="line-201"></a><span class="hs-identifier">extractFilteredRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-202"></a><a name="extractFilteredRdrTyVars"><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier">extractFilteredRdrTyVars</span></a></a><span> </span><a name="local-6989586621679803441"><a href="#local-6989586621679803441"><span class="hs-identifier">hs_ty</span></a></a><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803442"><a href="#local-6989586621679803442"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-204"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#filterInScope"><span class="hs-identifier hs-var">filterInScope</span></a><span> </span><a href="#local-6989586621679803442"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621679803441"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- | When the NamedWildCards extension is enabled, partition_nwcs</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- removes type variables that start with an underscore from the</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- FreeKiTyVars in the argument and returns them in a separate list.</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- When the extension is disabled, the function returns the argument</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- and empty list.  See Note [Renaming named wild cards]</span><span>
</span><a name="line-211"></a><span class="hs-identifier">partition_nwcs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><a name="partition_nwcs"><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier">partition_nwcs</span></a></a><span> </span><a name="local-6989586621679803443"><a href="#local-6989586621679803443"><span class="hs-identifier">free_vars</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fktv_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803444"><a href="#local-6989586621679803444"><span class="hs-identifier">tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fktv_all</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803445"><a href="#local-6989586621679803445"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803448"><a href="#local-6989586621679803448"><span class="hs-identifier">wildcards_enabled</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#NamedWildCards"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">NamedWildCards</span></a><span class="hs-special">)</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-214"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803449"><a href="#local-6989586621679803449"><span class="hs-identifier">nwcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803450"><a href="#local-6989586621679803450"><span class="hs-identifier">no_nwcs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803448"><span class="hs-identifier hs-var">wildcards_enabled</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-6989586621679803446"><span class="hs-identifier hs-var">is_wildcard</span></a><span> </span><a href="#local-6989586621679803444"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-215"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803444"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>             </span><a name="local-6989586621679803451"><a href="#local-6989586621679803451"><span class="hs-identifier">free_vars'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803443"><span class="hs-identifier hs-var">free_vars</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fktv_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803450"><span class="hs-identifier hs-var">no_nwcs</span></a><span>
</span><a name="line-217"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fktv_all</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803445"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><a href="#local-6989586621679803449"><span class="hs-identifier hs-var">nwcs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-218"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803451"><span class="hs-identifier hs-var">free_vars'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803449"><span class="hs-identifier hs-var">nwcs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>     </span><span class="hs-identifier">is_wildcard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-221"></a><span>     </span><a name="local-6989586621679803446"><a href="#local-6989586621679803446"><span class="hs-identifier">is_wildcard</span></a></a><span> </span><a name="local-6989586621679803447"><a href="#local-6989586621679803447"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803447"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">{- Note [Renaming named wild cards]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Identifiers starting with an underscore are always parsed as type variables.
It is only here in the renamer that we give the special treatment.
See Note [The wildcard story for types] in HsTypes.

It's easy!  When we collect the implicitly bound type variables, ready
to bring them into scope, and NamedWildCards is on, we partition the
variables into the ones that start with an underscore (the named
wildcards) and the rest. Then we just add them to the hswc_wcs field
of the HsWildCardBndrs structure, and we are done.


*********************************************************
*                                                       *
           HsSigtype (i.e. no wildcards)
*                                                       *
****************************************************** -}</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-identifier">rnHsSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-243"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- Used for source-language type signatures</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- that cannot have wildcards</span><span>
</span><a name="line-246"></a><a name="rnHsSigType"><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier">rnHsSigType</span></a></a><span> </span><a name="local-6989586621679803452"><a href="#local-6989586621679803452"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803453"><a href="#local-6989586621679803453"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803454"><a href="#local-6989586621679803454"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span> </span><a href="#local-6989586621679803453"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-248"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier hs-var">rnImplicitBndrs</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679803454"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679803453"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803455"><a href="#local-6989586621679803455"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803456"><a href="#local-6989586621679803456"><span class="hs-identifier">body'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803457"><a href="#local-6989586621679803457"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span> </span><a href="#local-6989586621679803452"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679803453"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-250"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier hs-var">mk_implicit_bndrs</span></a><span> </span><a href="#local-6989586621679803455"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679803456"><span class="hs-identifier hs-var">body'</span></a><span> </span><a href="#local-6989586621679803457"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803457"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-identifier">rnImplicitBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- True &lt;=&gt; no implicit quantification</span><span>
</span><a name="line-253"></a><span>                           </span><span class="hs-comment">--          if type is headed by a forall</span><span>
</span><a name="line-254"></a><span>                           </span><span class="hs-comment">-- E.g.  f :: forall a. a-&gt;b</span><span>
</span><a name="line-255"></a><span>                           </span><span class="hs-comment">-- Do not quantify over 'b' too.</span><span>
</span><a name="line-256"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-257"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-258"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-260"></a><a name="rnImplicitBndrs"><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier">rnImplicitBndrs</span></a></a><span> </span><a name="local-6989586621679803458"><a href="#local-6989586621679803458"><span class="hs-identifier">no_implicit_if_forall</span></a></a><span> </span><a name="local-6989586621679803459"><a href="#local-6989586621679803459"><span class="hs-identifier">free_vars</span></a></a><span> </span><a name="local-6989586621679803460"><a href="#local-6989586621679803460"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803461"><a href="#local-6989586621679803461"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679803462"><a href="#local-6989586621679803462"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803463"><a href="#local-6989586621679803463"><span class="hs-identifier">real_tv_rdrs</span></a></a><span>  </span><span class="hs-comment">-- Implicit quantification only if</span><span>
</span><a name="line-262"></a><span>                           </span><span class="hs-comment">-- there is no explicit forall</span><span>
</span><a name="line-263"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803458"><span class="hs-identifier hs-var">no_implicit_if_forall</span></a><span>
</span><a name="line-264"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803460"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-265"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#freeKiTyVarsTypeVars"><span class="hs-identifier hs-var">freeKiTyVarsTypeVars</span></a><span> </span><a href="#local-6989586621679803459"><span class="hs-identifier hs-var">free_vars</span></a><span>
</span><a name="line-266"></a><span>             </span><a name="local-6989586621679803464"><a href="#local-6989586621679803464"><span class="hs-identifier">real_rdrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span> </span><a href="#local-6989586621679803459"><span class="hs-identifier hs-var">free_vars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679803463"><span class="hs-identifier hs-var">real_tv_rdrs</span></a><span>
</span><a name="line-267"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;rnSigType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803460"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803459"><span class="hs-identifier hs-var">free_vars</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-268"></a><span>                                        </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803464"><span class="hs-identifier hs-var">real_rdrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;rnSigType2&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803460"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803459"><span class="hs-identifier hs-var">free_vars</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-271"></a><span>                                        </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803464"><span class="hs-identifier hs-var">real_rdrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803465"><a href="#local-6989586621679803465"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803461"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803464"><span class="hs-identifier hs-var">real_rdrs</span></a><span>
</span><a name="line-273"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621679803465"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-274"></a><span>         </span><a href="#local-6989586621679803462"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803465"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-identifier">rnLHsInstType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- Rename the type in an instance or standalone deriving decl</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- The 'doc_str' is &quot;an instance declaration&quot; or &quot;a VECTORISE pragma&quot;</span><span>
</span><a name="line-279"></a><a name="rnLHsInstType"><a href="RnTypes.html#rnLHsInstType"><span class="hs-identifier">rnLHsInstType</span></a></a><span> </span><a name="local-6989586621679803466"><a href="#local-6989586621679803466"><span class="hs-identifier">doc_str</span></a></a><span> </span><a name="local-6989586621679803467"><a href="#local-6989586621679803467"><span class="hs-identifier">inst_ty</span></a></a><span>
</span><a name="line-280"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803468"><a href="#local-6989586621679803468"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#getLHsInstDeclClass_maybe"><span class="hs-identifier hs-var">getLHsInstDeclClass_maybe</span></a><span> </span><a href="#local-6989586621679803467"><span class="hs-identifier hs-var">inst_ty</span></a><span>
</span><a name="line-281"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803468"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>         </span><span class="hs-comment">-- The guards check that the instance type looks like</span><span>
</span><a name="line-283"></a><span>         </span><span class="hs-comment">--   blah =&gt; C ty1 .. tyn</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803469"><a href="#local-6989586621679803469"><span class="hs-identifier">full_doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803466"><span class="hs-identifier hs-var">doc_str</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803468"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#GenericCtx"><span class="hs-identifier hs-var">GenericCtx</span></a><span> </span><a href="#local-6989586621679803469"><span class="hs-identifier hs-var">full_doc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803467"><span class="hs-identifier hs-var">inst_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- The instance is malformed, but we'd still like</span><span>
</span><a name="line-288"></a><span>               </span><span class="hs-comment">-- to make progress rather than failing outright, so</span><span>
</span><a name="line-289"></a><span>               </span><span class="hs-comment">-- we report more errors.  So we rename it anyway.</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#hsSigType"><span class="hs-identifier hs-var">hsSigType</span></a><span> </span><a href="#local-6989586621679803467"><span class="hs-identifier hs-var">inst_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-291"></a><span>         </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Malformed instance:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803467"><span class="hs-identifier hs-var">inst_ty</span></a><span>
</span><a name="line-292"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#GenericCtx"><span class="hs-identifier hs-var">GenericCtx</span></a><span> </span><a href="#local-6989586621679803466"><span class="hs-identifier hs-var">doc_str</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803467"><span class="hs-identifier hs-var">inst_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-identifier">mk_implicit_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- implicitly bound</span><span>
</span><a name="line-295"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803359"><span class="hs-identifier hs-type">a</span></a><span>           </span><span class="hs-comment">-- payload</span><span>
</span><a name="line-296"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span>    </span><span class="hs-comment">-- FreeVars of payload</span><span>
</span><a name="line-297"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsImplicitBndrs"><span class="hs-identifier hs-type">HsImplicitBndrs</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679803359"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-298"></a><a name="mk_implicit_bndrs"><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier">mk_implicit_bndrs</span></a></a><span> </span><a name="local-6989586621679803470"><a href="#local-6989586621679803470"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679803471"><a href="#local-6989586621679803471"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679803472"><a href="#local-6989586621679803472"><span class="hs-identifier">fvs</span></a></a><span>
</span><a name="line-299"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803470"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-300"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803471"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-301"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_closed</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#nameSetAll"><span class="hs-identifier hs-var">nameSetAll</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#isTyVarName"><span class="hs-identifier hs-var">isTyVarName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803470"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#delFVs"><span class="hs-identifier hs-var">delFVs</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803472"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-comment">{- ******************************************************
*                                                       *
           LHsType and HsType
*                                                       *
****************************************************** -}</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">{-
rnHsType is here because we call it from loadInstDecl, and I didn't
want a gratuitous knot.

Note [Context quantification]
-----------------------------
Variables in type signatures are implicitly quantified
when (1) they are in a type signature not beginning
with &quot;forall&quot; or (2) in any qualified type T =&gt; R.
We are phasing out (2) since it leads to inconsistencies
(Trac #4426):

data A = A (a -&gt; a)           is an error
data A = A (Eq a =&gt; a -&gt; a)   binds &quot;a&quot;
data A = A (Eq a =&gt; a -&gt; b)   binds &quot;a&quot; and &quot;b&quot;
data A = A (() =&gt; a -&gt; b)     binds &quot;a&quot; and &quot;b&quot;
f :: forall a. a -&gt; b         is an error
f :: forall a. () =&gt; a -&gt; b   is an error
f :: forall a. a -&gt; (() =&gt; b) binds &quot;a&quot; and &quot;b&quot;

This situation is now considered to be an error. See rnHsTyKi for case
HsForAllTy Qualified.

Note [Dealing with *]
~~~~~~~~~~~~~~~~~~~~~
As a legacy from the days when types and kinds were different, we use
the type * to mean what we now call GHC.Types.Type. The problem is that
* should associate just like an identifier, *not* a symbol.
Running example: the user has written

  T (Int, Bool) b + c * d

At this point, we have a bunch of stretches of types

  [[T, (Int, Bool), b], [c], [d]]

these are the [[LHsType Name]] and a bunch of operators

  [GHC.TypeLits.+, GHC.Types.*]

Note that the * is GHC.Types.*. So, we want to rearrange to have

  [[T, (Int, Bool), b], [c, *, d]]

and

  [GHC.TypeLits.+]

as our lists. We can then do normal fixity resolution on these. The fixities
must come along for the ride just so that the list stays in sync with the
operators.

Note [QualTy in kinds]
~~~~~~~~~~~~~~~~~~~~~~
I was wondering whether QualTy could occur only at TypeLevel.  But no,
we can have a qualified type in a kind too. Here is an example:

  type family F a where
    F Bool = Nat
    F Nat  = Type

  type family G a where
    G Type = Type -&gt; Type
    G ()   = Nat

  data X :: forall k1 k2. (F k1 ~ G k2) =&gt; k1 -&gt; k2 -&gt; Type where
    MkX :: X 'True '()

See that k1 becomes Bool and k2 becomes (), so the equality is
satisfied. If I write MkX :: X 'True 'False, compilation fails with a
suitable message:

  MkX :: X 'True '()
    &#8226; Couldn't match kind &#8216;G Bool&#8217; with &#8216;Nat&#8217;
      Expected kind: G Bool
        Actual kind: F Bool

However: in a kind, the constraints in the QualTy must all be
equalities; or at least, any kinds with a class constraint are
uninhabited.
-}</span><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-keyword">data</span><span> </span><a name="RnTyKiEnv"><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier">RnTyKiEnv</span></a></a><span>
</span><a name="line-393"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="RTKE"><a href="RnTypes.html#RTKE"><span class="hs-identifier">RTKE</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="rtke_ctxt"><a href="RnTypes.html#rtke_ctxt"><span class="hs-identifier">rtke_ctxt</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-394"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_level"><a href="RnTypes.html#rtke_level"><span class="hs-identifier">rtke_level</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>  </span><span class="hs-comment">-- Am I renaming a type or a kind?</span><span>
</span><a name="line-395"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_what"><a href="RnTypes.html#rtke_what"><span class="hs-identifier">rtke_what</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span>  </span><span class="hs-comment">-- And within that what am I renaming?</span><span>
</span><a name="line-396"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_nwcs"><a href="RnTypes.html#rtke_nwcs"><span class="hs-identifier">rtke_nwcs</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>     </span><span class="hs-comment">-- These are the in-scope named wildcards</span><span>
</span><a name="line-397"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-keyword">data</span><span> </span><a name="RnTyKiWhat"><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier">RnTyKiWhat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RnTypeBody"><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier">RnTypeBody</span></a></a><span>
</span><a name="line-400"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="RnTopConstraint"><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier">RnTopConstraint</span></a></a><span>   </span><span class="hs-comment">-- Top-level context of HsSigWcTypes</span><span>
</span><a name="line-401"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="RnConstraint"><a href="RnTypes.html#RnConstraint"><span class="hs-identifier">RnConstraint</span></a></a><span>      </span><span class="hs-comment">-- All other constraints</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-404"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803335"><a href="#local-6989586621679803335"><span class="hs-identifier">lev</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803336"><a href="#local-6989586621679803336"><span class="hs-identifier">what</span></a></a><span>
</span><a name="line-405"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803337"><a href="#local-6989586621679803337"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803338"><a href="#local-6989586621679803338"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RTKE&quot;</span><span>
</span><a name="line-407"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803335"><span class="hs-identifier hs-var">lev</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803336"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803337"><span class="hs-identifier hs-var">wcs</span></a><span>
</span><a name="line-408"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-6989586621679803338"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-411"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnTypeBody&quot;</span><span>
</span><a name="line-412"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnTopConstraint&quot;</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnConstraint&quot;</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-identifier">mkTyKiEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-416"></a><a name="mkTyKiEnv"><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier">mkTyKiEnv</span></a></a><span> </span><a name="local-6989586621679803473"><a href="#local-6989586621679803473"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679803474"><a href="#local-6989586621679803474"><span class="hs-identifier">level</span></a></a><span> </span><a name="local-6989586621679803475"><a href="#local-6989586621679803475"><span class="hs-identifier">what</span></a></a><span>
</span><a name="line-417"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803474"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-418"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803475"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803473"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-identifier">isRnKindLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-421"></a><a name="isRnKindLevel"><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier">isRnKindLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-422"></a><span class="hs-identifier">isRnKindLevel</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-425"></a><span class="hs-identifier">rnLHsType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><a name="rnLHsType"><a href="RnTypes.html#rnLHsType"><span class="hs-identifier">rnLHsType</span></a></a><span> </span><a name="local-6989586621679803476"><a href="#local-6989586621679803476"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803477"><a href="#local-6989586621679803477"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803476"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803477"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-identifier">rnLHsTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><a name="rnLHsTypes"><a href="RnTypes.html#rnLHsTypes"><span class="hs-identifier">rnLHsTypes</span></a></a><span> </span><a name="local-6989586621679803478"><a href="#local-6989586621679803478"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803479"><a href="#local-6989586621679803479"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span> </span><a href="#local-6989586621679803478"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803479"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-identifier">rnHsType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><a name="rnHsType"><a href="RnTypes.html#rnHsType"><span class="hs-identifier">rnHsType</span></a></a><span> </span><a name="local-6989586621679803480"><a href="#local-6989586621679803480"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803481"><a href="#local-6989586621679803481"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803480"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803481"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-identifier">rnLHsKind</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><a name="rnLHsKind"><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier">rnLHsKind</span></a></a><span> </span><a name="local-6989586621679803482"><a href="#local-6989586621679803482"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803483"><a href="#local-6989586621679803483"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803482"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803483"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-identifier">rnHsKind</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsKind"><span class="hs-identifier hs-type">HsKind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsKind"><span class="hs-identifier hs-type">HsKind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-438"></a><a name="rnHsKind"><a href="RnTypes.html#rnHsKind"><span class="hs-identifier">rnHsKind</span></a></a><span> </span><a name="local-6989586621679803484"><a href="#local-6989586621679803484"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803485"><a href="#local-6989586621679803485"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span>  </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803484"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803485"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-441"></a><span class="hs-identifier">rnTyKiContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><a name="rnTyKiContext"><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier">rnTyKiContext</span></a></a><span> </span><a name="local-6989586621679803486"><a href="#local-6989586621679803486"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803487"><a href="#local-6989586621679803487"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803488"><a href="#local-6989586621679803488"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;rncontext&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803488"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-444"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803489"><a href="#local-6989586621679803489"><span class="hs-identifier">env'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803486"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-445"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803490"><a href="#local-6989586621679803490"><span class="hs-identifier">cxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803491"><a href="#local-6989586621679803491"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803489"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803488"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-446"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803487"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803490"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803491"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span class="hs-identifier">rnContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-449"></a><a name="rnContext"><a href="RnTypes.html#rnContext"><span class="hs-identifier">rnContext</span></a></a><span> </span><a name="local-6989586621679803492"><a href="#local-6989586621679803492"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803493"><a href="#local-6989586621679803493"><span class="hs-identifier">theta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier hs-var">rnTyKiContext</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803492"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803493"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-452"></a><span class="hs-identifier">rnLHsTyKi</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-453"></a><a name="rnLHsTyKi"><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier">rnLHsTyKi</span></a></a><span> </span><a name="local-6989586621679803494"><a href="#local-6989586621679803494"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803495"><a href="#local-6989586621679803495"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803496"><a href="#local-6989586621679803496"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621679803495"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-455"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803497"><a href="#local-6989586621679803497"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803498"><a href="#local-6989586621679803498"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><a href="#local-6989586621679803494"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803496"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-456"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803495"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803497"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803498"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><a name="rnHsTyKi"><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier">rnHsTyKi</span></a></a><span> </span><a name="local-6989586621679803499"><a href="#local-6989586621679803499"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803500"><a href="#local-6989586621679803500"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803501"><a href="#local-6989586621679803501"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803502"><a href="#local-6989586621679803502"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803499"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803500"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-462"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803499"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier hs-var">inTypeDoc</span></a><span> </span><a href="#local-6989586621679803500"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>                           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679803501"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803503"><a href="#local-6989586621679803503"><span class="hs-identifier">tyvars'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-464"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803504"><a href="#local-6989586621679803504"><span class="hs-identifier">tau'</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-6989586621679803505"><a href="#local-6989586621679803505"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803499"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803502"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-465"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803503"><span class="hs-identifier hs-var">tyvars'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679803504"><span class="hs-identifier hs-var">tau'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-466"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803505"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803506"><a href="#local-6989586621679803506"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803507"><a href="#local-6989586621679803507"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803508"><a href="#local-6989586621679803508"><span class="hs-identifier">lctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803509"><a href="#local-6989586621679803509"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803506"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803507"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-comment">-- See Note [QualTy in kinds]</span><span>
</span><a name="line-470"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803510"><a href="#local-6989586621679803510"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803511"><a href="#local-6989586621679803511"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier hs-var">rnTyKiContext</span></a><span> </span><a href="#local-6989586621679803506"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803508"><span class="hs-identifier hs-var">lctxt</span></a><span>
</span><a name="line-471"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803512"><a href="#local-6989586621679803512"><span class="hs-identifier">tau'</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-6989586621679803513"><a href="#local-6989586621679803513"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803506"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803509"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-472"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803510"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679803512"><span class="hs-identifier hs-var">tau'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-473"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803511"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803513"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803514"><a href="#local-6989586621679803514"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a name="local-6989586621679803515"><a href="#local-6989586621679803515"><span class="hs-identifier">ip</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803516"><a href="#local-6989586621679803516"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803517"><a href="#local-6989586621679803517"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803518"><a href="#local-6989586621679803518"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyVar"><span class="hs-identifier hs-var">rnTyVar</span></a><span> </span><a href="#local-6989586621679803514"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803517"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-477"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="#local-6989586621679803515"><span class="hs-identifier hs-var">ip</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803516"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803518"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-6989586621679803518"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803519"><a href="#local-6989586621679803519"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803520"><a href="#local-6989586621679803520"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621679803521"><a href="#local-6989586621679803521"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803522"><a href="#local-6989586621679803522"><span class="hs-identifier">l_op</span></a></a><span> </span><a name="local-6989586621679803523"><a href="#local-6989586621679803523"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679803522"><span class="hs-identifier hs-var">l_op</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-481"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803524"><a href="#local-6989586621679803524"><span class="hs-identifier">l_op'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803525"><a href="#local-6989586621679803525"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier hs-var">rnHsTyOp</span></a><span> </span><a href="#local-6989586621679803519"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803520"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679803522"><span class="hs-identifier hs-var">l_op</span></a><span>
</span><a name="line-482"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803526"><a href="#local-6989586621679803526"><span class="hs-identifier">fix</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621679803524"><span class="hs-identifier hs-var">l_op'</span></a><span>
</span><a name="line-483"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803527"><a href="#local-6989586621679803527"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803528"><a href="#local-6989586621679803528"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803519"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803521"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-484"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803529"><a href="#local-6989586621679803529"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803530"><a href="#local-6989586621679803530"><span class="hs-identifier">fvs3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803519"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803523"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-485"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803533"><a href="#local-6989586621679803533"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679803531"><a href="#local-6989586621679803531"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679803532"><a href="#local-6989586621679803532"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621679803531"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679803524"><span class="hs-identifier hs-var">l_op'</span></a><span> </span><a href="#local-6989586621679803532"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>                               </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803524"><span class="hs-identifier hs-var">l_op'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803526"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621679803527"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621679803529"><span class="hs-identifier hs-var">ty2'</span></a><span>
</span><a name="line-487"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803533"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803525"><span class="hs-identifier hs-var">fvs1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803528"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803530"><span class="hs-identifier hs-var">fvs3</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803534"><a href="#local-6989586621679803534"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621679803535"><a href="#local-6989586621679803535"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803536"><a href="#local-6989586621679803536"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803537"><a href="#local-6989586621679803537"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803534"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803535"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-491"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a href="#local-6989586621679803536"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803537"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803538"><a href="#local-6989586621679803538"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a name="local-6989586621679803539"><a href="#local-6989586621679803539"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679803540"><a href="#local-6989586621679803540"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803541"><a href="#local-6989586621679803541"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803542"><a href="#local-6989586621679803542"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803538"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803540"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-495"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a href="#local-6989586621679803539"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679803541"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803542"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803543"><a href="#local-6989586621679803543"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803544"><a href="#local-6989586621679803544"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621679803545"><a href="#local-6989586621679803545"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803548"><a href="#local-6989586621679803548"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803543"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-499"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803549"><a href="#local-6989586621679803549"><span class="hs-identifier">fls</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803546"><span class="hs-identifier hs-var">get_fields</span></a><span> </span><a href="#local-6989586621679803548"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-500"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803550"><a href="#local-6989586621679803550"><span class="hs-identifier">flds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803551"><a href="#local-6989586621679803551"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier hs-var">rnConDeclFields</span></a><span> </span><a href="#local-6989586621679803548"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679803549"><span class="hs-identifier hs-var">fls</span></a><span> </span><a href="#local-6989586621679803545"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-501"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a href="#local-6989586621679803550"><span class="hs-identifier hs-var">flds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803551"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-502"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-503"></a><span>    </span><a name="local-6989586621679803546"><a href="#local-6989586621679803546"><span class="hs-identifier">get_fields</span></a></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a><span> </span><a name="local-6989586621679803547"><a href="#local-6989586621679803547"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#lookupConstructorFields"><span class="hs-identifier hs-var">lookupConstructorFields</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803547"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-505"></a><span>    </span><span class="hs-identifier">get_fields</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-506"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Record syntax is illegal here:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-507"></a><span>                                   </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803544"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803552"><a href="#local-6989586621679803552"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621679803553"><a href="#local-6989586621679803553"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803554"><a href="#local-6989586621679803554"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803555"><a href="#local-6989586621679803555"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803556"><a href="#local-6989586621679803556"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803552"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803553"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-512"></a><span>        </span><span class="hs-comment">-- Might find a for-all as the arg of a function type</span><span>
</span><a name="line-513"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803557"><a href="#local-6989586621679803557"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803558"><a href="#local-6989586621679803558"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803552"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803554"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-514"></a><span>        </span><span class="hs-comment">-- Or as the result.  This happens when reading Prelude.hi</span><span>
</span><a name="line-515"></a><span>        </span><span class="hs-comment">-- when we find return :: forall m. Monad m -&gt; forall a. a -&gt; m a</span><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span>        </span><span class="hs-comment">-- Check for fixity rearrangements</span><span>
</span><a name="line-518"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803559"><a href="#local-6989586621679803559"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span> </span><a href="#local-6989586621679803555"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621679803557"><span class="hs-identifier hs-var">ty2'</span></a><span>
</span><a name="line-519"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803559"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803556"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803558"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803560"><a href="#local-6989586621679803560"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803561"><a href="#local-6989586621679803561"><span class="hs-identifier">listTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621679803562"><a href="#local-6989586621679803562"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-522"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803563"><a href="#local-6989586621679803563"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-523"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803563"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803560"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803560"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803561"><span class="hs-identifier hs-var">listTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803564"><a href="#local-6989586621679803564"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803565"><a href="#local-6989586621679803565"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803560"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803562"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-526"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a href="#local-6989586621679803564"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803565"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803566"><a href="#local-6989586621679803566"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803567"><a href="#local-6989586621679803567"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621679803568"><a href="#local-6989586621679803568"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679803569"><a href="#local-6989586621679803569"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803566"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803567"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-530"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803570"><a href="#local-6989586621679803570"><span class="hs-identifier">kind_sigs_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#KindSignatures"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">KindSignatures</span></a><span>
</span><a name="line-531"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803570"><span class="hs-identifier hs-var">kind_sigs_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier hs-var">badKindSigErr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803566"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803568"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803571"><a href="#local-6989586621679803571"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803572"><a href="#local-6989586621679803572"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803566"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803568"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-533"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803573"><a href="#local-6989586621679803573"><span class="hs-identifier">k'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803574"><a href="#local-6989586621679803574"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803566"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803569"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-534"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a href="#local-6989586621679803571"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679803573"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803572"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803574"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803575"><a href="#local-6989586621679803575"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803576"><a href="#local-6989586621679803576"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621679803577"><a href="#local-6989586621679803577"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#notInKinds"><span class="hs-identifier hs-var">notInKinds</span></a><span> </span><a href="#local-6989586621679803575"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803576"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-538"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803578"><a href="#local-6989586621679803578"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803579"><a href="#local-6989586621679803579"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803575"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803577"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-539"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a href="#local-6989586621679803578"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803579"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">-- Unboxed tuples are allowed to have poly-typed arguments.  These</span><span>
</span><a name="line-542"></a><span class="hs-comment">-- sometimes crop up as a result of CPR worker-wrappering dictionaries.</span><span>
</span><a name="line-543"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803580"><a href="#local-6989586621679803580"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803581"><a href="#local-6989586621679803581"><span class="hs-identifier">tupleTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><a name="local-6989586621679803582"><a href="#local-6989586621679803582"><span class="hs-identifier">tup_con</span></a></a><span> </span><a name="local-6989586621679803583"><a href="#local-6989586621679803583"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803584"><a href="#local-6989586621679803584"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-545"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803584"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803580"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-546"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803580"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803581"><span class="hs-identifier hs-var">tupleTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803585"><a href="#local-6989586621679803585"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803586"><a href="#local-6989586621679803586"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803580"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803583"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-548"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><a href="#local-6989586621679803582"><span class="hs-identifier hs-var">tup_con</span></a><span> </span><a href="#local-6989586621679803585"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803586"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-549"></a><span>
</span><a name="line-550"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803587"><a href="#local-6989586621679803587"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803588"><a href="#local-6989586621679803588"><span class="hs-identifier">sumTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621679803589"><a href="#local-6989586621679803589"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-551"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803590"><a href="#local-6989586621679803590"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-552"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803590"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803587"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803587"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803588"><span class="hs-identifier hs-var">sumTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803591"><a href="#local-6989586621679803591"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803592"><a href="#local-6989586621679803592"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803587"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803589"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-555"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a href="#local-6989586621679803591"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803592"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- Ensure that a type-level integer is nonnegative (#8306, #8412)</span><span>
</span><a name="line-558"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803593"><a href="#local-6989586621679803593"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803594"><a href="#local-6989586621679803594"><span class="hs-identifier">tyLit</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a name="local-6989586621679803595"><a href="#local-6989586621679803595"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-559"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803599"><a href="#local-6989586621679803599"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-560"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803599"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803593"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803594"><span class="hs-identifier hs-var">tyLit</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803596"><span class="hs-identifier hs-var">negLit</span></a><span> </span><a href="#local-6989586621679803595"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-6989586621679803597"><span class="hs-identifier hs-var">negLitErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803593"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803594"><span class="hs-identifier hs-var">tyLit</span></a><span>
</span><a name="line-563"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a href="#local-6989586621679803595"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-564"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-565"></a><span>    </span><a name="local-6989586621679803596"><a href="#local-6989586621679803596"><span class="hs-identifier">negLit</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsStrTy"><span class="hs-identifier hs-var">HsStrTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-566"></a><span>    </span><span class="hs-identifier">negLit</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsNumTy"><span class="hs-identifier hs-var">HsNumTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803598"><a href="#local-6989586621679803598"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803598"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-567"></a><span>    </span><a name="local-6989586621679803597"><a href="#local-6989586621679803597"><span class="hs-identifier">negLitErr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal literal in type (type literals must not be negative):&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803594"><span class="hs-identifier hs-var">tyLit</span></a><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803600"><a href="#local-6989586621679803600"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803601"><a href="#local-6989586621679803601"><span class="hs-identifier">overall_ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621679803602"><a href="#local-6989586621679803602"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Step 1: Break up the HsAppsTy into symbols and non-symbol regions</span><span>
</span><a name="line-571"></a><span>         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803636"><a href="#local-6989586621679803636"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803637"><a href="#local-6989586621679803637"><span class="hs-identifier">syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#splitHsAppsTy"><span class="hs-identifier hs-var">splitHsAppsTy</span></a><span> </span><a href="#local-6989586621679803602"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span>             </span><span class="hs-comment">-- Step 2: rename the pieces</span><span>
</span><a name="line-574"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803638"><a href="#local-6989586621679803638"><span class="hs-identifier">syms1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803639"><a href="#local-6989586621679803639"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier hs-var">rnHsTyOp</span></a><span> </span><a href="#local-6989586621679803600"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803601"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803637"><span class="hs-identifier hs-var">syms</span></a><span>
</span><a name="line-575"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803640"><a href="#local-6989586621679803640"><span class="hs-identifier">non_syms1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803641"><a href="#local-6989586621679803641"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803600"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803636"><span class="hs-identifier hs-var">non_syms</span></a><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span>             </span><span class="hs-comment">-- Step 3: deal with *. See Note [Dealing with *]</span><span>
</span><a name="line-578"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803642"><a href="#local-6989586621679803642"><span class="hs-identifier">non_syms2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803643"><a href="#local-6989586621679803643"><span class="hs-identifier">syms2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803603"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679803640"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><a href="#local-6989586621679803638"><span class="hs-identifier hs-var">syms1</span></a><span>
</span><a name="line-579"></a><span>
</span><a name="line-580"></a><span>             </span><span class="hs-comment">-- Step 4: collapse the non-symbol regions with HsAppTy</span><span>
</span><a name="line-581"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803644"><a href="#local-6989586621679803644"><span class="hs-identifier">non_syms3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679803604"><span class="hs-identifier hs-var">deal_with_non_syms</span></a><span> </span><a href="#local-6989586621679803642"><span class="hs-identifier hs-var">non_syms2</span></a><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span>             </span><span class="hs-comment">-- Step 5: assemble the pieces, using mkHsOpTyRn</span><span>
</span><a name="line-584"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803645"><a href="#local-6989586621679803645"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803605"><span class="hs-identifier hs-var">build_res_ty</span></a><span> </span><a href="#local-6989586621679803644"><span class="hs-identifier hs-var">non_syms3</span></a><span> </span><a href="#local-6989586621679803643"><span class="hs-identifier hs-var">syms2</span></a><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span>        </span><span class="hs-comment">-- all done. Phew.</span><span>
</span><a name="line-587"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803645"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803639"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803641"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-588"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-589"></a><span>    </span><span class="hs-comment">-- See Note [Dealing with *]</span><span>
</span><a name="line-590"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-591"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-592"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-593"></a><span>    </span><a name="local-6989586621679803603"><a href="#local-6989586621679803603"><span class="hs-identifier">deal_with_star</span></a></a><span> </span><a name="local-6989586621679803606"><a href="#local-6989586621679803606"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621679803607"><a href="#local-6989586621679803607"><span class="hs-identifier">acc2</span></a></a><span>
</span><a name="line-594"></a><span>                   </span><span class="hs-special">(</span><a name="local-6989586621679803608"><a href="#local-6989586621679803608"><span class="hs-identifier">non_syms1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803609"><a href="#local-6989586621679803609"><span class="hs-identifier">non_syms2</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803610"><a href="#local-6989586621679803610"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803611"><a href="#local-6989586621679803611"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803612"><a href="#local-6989586621679803612"><span class="hs-identifier">star</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803613"><a href="#local-6989586621679803613"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803612"><span class="hs-identifier hs-var">star</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#starKindTyConKey"><span class="hs-identifier hs-var">starKindTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679803612"><span class="hs-identifier hs-var">star</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#unicodeStarKindTyConKey"><span class="hs-identifier hs-var">unicodeStarKindTyConKey</span></a><span>
</span><a name="line-596"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803603"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><a href="#local-6989586621679803606"><span class="hs-identifier hs-var">acc1</span></a><span> </span><a href="#local-6989586621679803607"><span class="hs-identifier hs-var">acc2</span></a><span>
</span><a name="line-597"></a><span>                       </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679803608"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803611"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="HsTypes.html#NotPromoted"><span class="hs-identifier hs-var">NotPromoted</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803611"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803612"><span class="hs-identifier hs-var">star</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>                            </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803609"><span class="hs-identifier hs-var">non_syms2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803610"><span class="hs-identifier hs-var">non_syms</span></a><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>                       </span><a href="#local-6989586621679803613"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-600"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><a name="local-6989586621679803614"><a href="#local-6989586621679803614"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621679803615"><a href="#local-6989586621679803615"><span class="hs-identifier">acc2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679803616"><a href="#local-6989586621679803616"><span class="hs-identifier">non_syms1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803617"><a href="#local-6989586621679803617"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803618"><a href="#local-6989586621679803618"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803619"><a href="#local-6989586621679803619"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803603"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803616"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803614"><span class="hs-identifier hs-var">acc1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803618"><span class="hs-identifier hs-var">op1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803615"><span class="hs-identifier hs-var">acc2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803617"><span class="hs-identifier hs-var">non_syms</span></a><span> </span><a href="#local-6989586621679803619"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-602"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><a name="local-6989586621679803620"><a href="#local-6989586621679803620"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621679803621"><a href="#local-6989586621679803621"><span class="hs-identifier">acc2</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679803622"><a href="#local-6989586621679803622"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-603"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803622"><span class="hs-identifier hs-var">non_syms</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803620"><span class="hs-identifier hs-var">acc1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679803621"><span class="hs-identifier hs-var">acc2</span></a><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-605"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;deal_with_star&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803601"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span>    </span><span class="hs-comment">-- collapse [LHsType Name] to LHsType Name by making applications</span><span>
</span><a name="line-608"></a><span>    </span><span class="hs-comment">-- monadic only for failure</span><span>
</span><a name="line-609"></a><span>    </span><span class="hs-identifier">deal_with_non_syms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>    </span><a name="local-6989586621679803604"><a href="#local-6989586621679803604"><span class="hs-identifier">deal_with_non_syms</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679803623"><a href="#local-6989586621679803623"><span class="hs-identifier">non_sym</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803624"><a href="#local-6989586621679803624"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#mkHsAppTys"><span class="hs-identifier hs-var">mkHsAppTys</span></a><span> </span><a href="#local-6989586621679803623"><span class="hs-identifier hs-var">non_sym</span></a><span> </span><a href="#local-6989586621679803624"><span class="hs-identifier hs-var">non_syms</span></a><span>
</span><a name="line-611"></a><span>    </span><span class="hs-identifier">deal_with_non_syms</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#emptyNonSymsErr"><span class="hs-identifier hs-var">emptyNonSymsErr</span></a><span> </span><a href="#local-6989586621679803601"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span>    </span><span class="hs-comment">-- assemble a right-biased OpTy for use in mkHsOpTyRn</span><span>
</span><a name="line-614"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>    </span><a name="local-6989586621679803605"><a href="#local-6989586621679803605"><span class="hs-identifier">build_res_ty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679803625"><a href="#local-6989586621679803625"><span class="hs-identifier">arg1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803626"><a href="#local-6989586621679803626"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803627"><a href="#local-6989586621679803627"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803628"><a href="#local-6989586621679803628"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803629"><a href="#local-6989586621679803629"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803605"><span class="hs-identifier hs-var">build_res_ty</span></a><span> </span><a href="#local-6989586621679803626"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679803628"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-617"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803630"><a href="#local-6989586621679803630"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621679803627"><span class="hs-identifier hs-var">op1</span></a><span>
</span><a name="line-618"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803633"><a href="#local-6989586621679803633"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-619"></a><span>               </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679803631"><a href="#local-6989586621679803631"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679803632"><a href="#local-6989586621679803632"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621679803631"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679803627"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679803632"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803627"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803630"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621679803625"><span class="hs-identifier hs-var">arg1</span></a><span> </span><a href="#local-6989586621679803629"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-620"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803634"><a href="#local-6989586621679803634"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679803625"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679803629"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803634"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803633"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span>           </span><span class="hs-special">}</span><span>
</span><a name="line-623"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679803635"><a href="#local-6989586621679803635"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679803635"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-624"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;build_op_ty&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803601"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>
</span><a name="line-626"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803646"><a href="#local-6989586621679803646"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621679803647"><a href="#local-6989586621679803647"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803648"><a href="#local-6989586621679803648"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803649"><a href="#local-6989586621679803649"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803650"><a href="#local-6989586621679803650"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803646"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803647"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-628"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803651"><a href="#local-6989586621679803651"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803652"><a href="#local-6989586621679803652"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803646"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803648"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-629"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a href="#local-6989586621679803649"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621679803651"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803650"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803652"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803653"><a href="#local-6989586621679803653"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803654"><a href="#local-6989586621679803654"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><a name="local-6989586621679803655"><a href="#local-6989586621679803655"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679803656"><a href="#local-6989586621679803656"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#notInKinds"><span class="hs-identifier hs-var">notInKinds</span></a><span> </span><a href="#local-6989586621679803653"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803654"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-633"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803657"><a href="#local-6989586621679803657"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803658"><a href="#local-6989586621679803658"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803653"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803656"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-634"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><a href="#local-6989586621679803655"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679803657"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803658"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803659"><a href="#local-6989586621679803659"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803660"><a href="#local-6989586621679803660"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621679803661"><a href="#local-6989586621679803661"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803662"><a href="#local-6989586621679803662"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803659"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803660"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-638"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803663"><a href="#local-6989586621679803663"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803664"><a href="#local-6989586621679803664"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803659"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803661"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-639"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803665"><a href="#local-6989586621679803665"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803666"><a href="#local-6989586621679803666"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803659"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803662"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-640"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a href="#local-6989586621679803663"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621679803665"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803664"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803666"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><a name="local-6989586621679803667"><a href="#local-6989586621679803667"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621679803668"><a href="#local-6989586621679803668"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnSplice.html#rnSpliceType"><span class="hs-identifier hs-var">rnSpliceType</span></a><span> </span><a href="#local-6989586621679803667"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-6989586621679803668"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803669"><a href="#local-6989586621679803669"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621679803670"><a href="#local-6989586621679803670"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679803671"><a href="#local-6989586621679803671"><span class="hs-identifier">haddock_doc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803672"><a href="#local-6989586621679803672"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803673"><a href="#local-6989586621679803673"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803669"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803670"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-647"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803674"><a href="#local-6989586621679803674"><span class="hs-identifier">haddock_doc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnHsDoc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a><span> </span><a href="#local-6989586621679803671"><span class="hs-identifier hs-var">haddock_doc</span></a><span>
</span><a name="line-648"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a href="#local-6989586621679803672"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679803674"><span class="hs-identifier hs-var">haddock_doc'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803673"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a name="local-6989586621679803675"><a href="#local-6989586621679803675"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a href="#local-6989586621679803675"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-652"></a><span>    </span><span class="hs-comment">-- The emptyFVs probably isn't quite right</span><span>
</span><a name="line-653"></a><span>    </span><span class="hs-comment">-- but I don't think it matters</span><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803676"><a href="#local-6989586621679803676"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803677"><a href="#local-6989586621679803677"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><a name="local-6989586621679803678"><a href="#local-6989586621679803678"><span class="hs-identifier">ip</span></a></a><span> </span><a name="local-6989586621679803679"><a href="#local-6989586621679803679"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679803680"><a href="#local-6989586621679803680"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803676"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803677"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-657"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803681"><a href="#local-6989586621679803681"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-658"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803681"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803676"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803677"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803682"><a href="#local-6989586621679803682"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803683"><a href="#local-6989586621679803683"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803676"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803680"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-660"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><a href="#local-6989586621679803678"><span class="hs-identifier hs-var">ip</span></a><span> </span><a href="#local-6989586621679803679"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679803682"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803683"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803684"><a href="#local-6989586621679803684"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803685"><a href="#local-6989586621679803685"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><a name="local-6989586621679803686"><a href="#local-6989586621679803686"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621679803687"><a href="#local-6989586621679803687"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621679803684"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803685"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-664"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803688"><a href="#local-6989586621679803688"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-665"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803688"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621679803684"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803685"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803689"><a href="#local-6989586621679803689"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803690"><a href="#local-6989586621679803690"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803684"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803687"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-667"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><a href="#local-6989586621679803686"><span class="hs-identifier hs-var">kis</span></a><span> </span><a href="#local-6989586621679803689"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803690"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621679803691"><a href="#local-6989586621679803691"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a name="local-6989586621679803692"><a href="#local-6989586621679803692"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkAnonWildCard"><span class="hs-identifier hs-var">checkAnonWildCard</span></a><span> </span><a href="#local-6989586621679803691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803692"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-671"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803693"><a href="#local-6989586621679803693"><span class="hs-identifier">wc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier hs-var">rnAnonWildCard</span></a><span> </span><a href="#local-6989586621679803692"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-672"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a href="#local-6989586621679803693"><span class="hs-identifier hs-var">wc'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-673"></a><span>         </span><span class="hs-comment">-- emptyFVs: this occurrence does not refer to a</span><span>
</span><a name="line-674"></a><span>         </span><span class="hs-comment">--           user-written binding site, so don't treat</span><span>
</span><a name="line-675"></a><span>         </span><span class="hs-comment">--           it as a free variable</span><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-678"></a><span class="hs-identifier">rnTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-679"></a><a name="rnTyVar"><a href="RnTypes.html#rnTyVar"><span class="hs-identifier">rnTyVar</span></a></a><span> </span><a name="local-6989586621679803694"><a href="#local-6989586621679803694"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803695"><a href="#local-6989586621679803695"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-680"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803696"><a href="#local-6989586621679803696"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span>   </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803694"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-681"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="RnEnv.html#lookupKindOccRn"><span class="hs-identifier hs-var">lookupKindOccRn</span></a><span> </span><a href="#local-6989586621679803695"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-682"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span> </span><a href="#local-6989586621679803695"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-683"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkNamedWildCard"><span class="hs-identifier hs-var">checkNamedWildCard</span></a><span> </span><a href="#local-6989586621679803694"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803696"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-684"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679803696"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span class="hs-identifier">rnLTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span class="hs-comment">-- Called externally; does not deal with wildards</span><span>
</span><a name="line-688"></a><a name="rnLTyVar"><a href="RnTypes.html#rnLTyVar"><span class="hs-identifier">rnLTyVar</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803697"><a href="#local-6989586621679803697"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803698"><a href="#local-6989586621679803698"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803699"><a href="#local-6989586621679803699"><span class="hs-identifier">tyvar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span> </span><a href="#local-6989586621679803698"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-690"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803697"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803699"><span class="hs-identifier hs-var">tyvar</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-693"></a><span class="hs-identifier">rnHsTyOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679803358"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-694"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803358"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-695"></a><a name="rnHsTyOp"><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier">rnHsTyOp</span></a></a><span> </span><a name="local-6989586621679803700"><a href="#local-6989586621679803700"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803701"><a href="#local-6989586621679803701"><span class="hs-identifier">overall_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803702"><a href="#local-6989586621679803702"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803703"><a href="#local-6989586621679803703"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-696"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803704"><a href="#local-6989586621679803704"><span class="hs-identifier">ops_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeOperators"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeOperators</span></a><span>
</span><a name="line-697"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803705"><a href="#local-6989586621679803705"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyVar"><span class="hs-identifier hs-var">rnTyVar</span></a><span> </span><a href="#local-6989586621679803700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803703"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-698"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803704"><span class="hs-identifier hs-var">ops_ok</span></a><span>
</span><a name="line-699"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679803705"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span>
</span><a name="line-700"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679803705"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span>
</span><a name="line-701"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679803705"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqTyConKey"><span class="hs-identifier hs-var">eqTyConKey</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-702"></a><span>           </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#opTyErr"><span class="hs-identifier hs-var">opTyErr</span></a><span> </span><a href="#local-6989586621679803703"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679803701"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803706"><a href="#local-6989586621679803706"><span class="hs-identifier">l_op'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803702"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803705"><span class="hs-identifier hs-var">op'</span></a><span>
</span><a name="line-704"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803706"><span class="hs-identifier hs-var">l_op'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-6989586621679803705"><span class="hs-identifier hs-var">op'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-707"></a><span class="hs-identifier">notAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-708"></a><a name="notAllowed"><a href="RnTypes.html#notAllowed"><span class="hs-identifier">notAllowed</span></a></a><span> </span><a name="local-6989586621679803707"><a href="#local-6989586621679803707"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-709"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Wildcard&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><a href="#local-6989586621679803707"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;not allowed&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>
</span><a name="line-711"></a><span class="hs-identifier">checkWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-712"></a><a name="checkWildCard"><a href="RnTypes.html#checkWildCard"><span class="hs-identifier">checkWildCard</span></a></a><span> </span><a name="local-6989586621679803708"><a href="#local-6989586621679803708"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803709"><a href="#local-6989586621679803709"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-713"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803709"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803708"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-714"></a><span class="hs-identifier">checkWildCard</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-715"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span class="hs-identifier">checkAnonWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-718"></a><span class="hs-comment">-- Report an error if an anonymoous wildcard is illegal here</span><span>
</span><a name="line-719"></a><a name="checkAnonWildCard"><a href="RnTypes.html#checkAnonWildCard"><span class="hs-identifier">checkAnonWildCard</span></a></a><span> </span><a name="local-6989586621679803710"><a href="#local-6989586621679803710"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803711"><a href="#local-6989586621679803711"><span class="hs-identifier">wc</span></a></a><span>
</span><a name="line-720"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621679803710"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803712"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-721"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-722"></a><span>    </span><span class="hs-identifier">mb_bad</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-723"></a><span>    </span><a name="local-6989586621679803712"><a href="#local-6989586621679803712"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier hs-var">wildCardsAllowed</span></a><span> </span><a href="#local-6989586621679803710"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803711"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-726"></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><a href="#local-6989586621679803710"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-727"></a><span>               </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-728"></a><span>               </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803713"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-729"></a><span>               </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803713"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span>    </span><a name="local-6989586621679803713"><a href="#local-6989586621679803713"><span class="hs-identifier">constraint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803711"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a constraint&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-732"></a><span>                        </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679803714"><span class="hs-identifier hs-var">hint_msg</span></a><span>
</span><a name="line-733"></a><span>    </span><a name="local-6989586621679803714"><a href="#local-6989586621679803714"><span class="hs-identifier">hint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;except as the last top-level constraint of a type signature&quot;</span><span>
</span><a name="line-734"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;e.g  f :: (Eq a, _) =&gt; blah&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-735"></a><span>
</span><a name="line-736"></a><span class="hs-identifier">checkNamedWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-737"></a><span class="hs-comment">-- Report an error if a named wildcard is illegal here</span><span>
</span><a name="line-738"></a><a name="checkNamedWildCard"><a href="RnTypes.html#checkNamedWildCard"><span class="hs-identifier">checkNamedWildCard</span></a></a><span> </span><a name="local-6989586621679803715"><a href="#local-6989586621679803715"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803716"><a href="#local-6989586621679803716"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621679803715"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803717"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-740"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-741"></a><span>    </span><a name="local-6989586621679803717"><a href="#local-6989586621679803717"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803716"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><a href="#local-6989586621679803715"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-comment">-- Not a wildcard</span><span>
</span><a name="line-743"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier hs-var">wildCardsAllowed</span></a><span> </span><a href="#local-6989586621679803715"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803716"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-745"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-746"></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><a href="#local-6989586621679803715"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-747"></a><span>               </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-comment">-- Allowed</span><span>
</span><a name="line-748"></a><span>               </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-comment">-- Allowed</span><span>
</span><a name="line-749"></a><span>               </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803718"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-750"></a><span>    </span><a name="local-6989586621679803718"><a href="#local-6989586621679803718"><span class="hs-identifier">constraint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803716"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a constraint&quot;</span><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-identifier">wildCardsAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-753"></a><span class="hs-comment">-- ^ In what contexts are wildcards permitted</span><span>
</span><a name="line-754"></a><a name="wildCardsAllowed"><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier">wildCardsAllowed</span></a></a><span> </span><a name="local-6989586621679803719"><a href="#local-6989586621679803719"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-755"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621679803719"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-756"></a><span>       </span><a href="RnEnv.html#TypeSigCtx"><span class="hs-identifier hs-var">TypeSigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-757"></a><span>       </span><a href="RnEnv.html#TypBrCtx"><span class="hs-identifier hs-var">TypBrCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Template Haskell quoted type</span><span>
</span><a name="line-758"></a><span>       </span><a href="RnEnv.html#SpliceTypeCtx"><span class="hs-identifier hs-var">SpliceTypeCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Result of a Template Haskell splice</span><span>
</span><a name="line-759"></a><span>       </span><a href="RnEnv.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-760"></a><span>       </span><a href="RnEnv.html#PatCtx"><span class="hs-identifier hs-var">PatCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-761"></a><span>       </span><a href="RnEnv.html#RuleCtx"><span class="hs-identifier hs-var">RuleCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-762"></a><span>       </span><a href="RnEnv.html#FamPatCtx"><span class="hs-identifier hs-var">FamPatCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Not named wildcards though</span><span>
</span><a name="line-763"></a><span>       </span><a href="RnEnv.html#GHCiCtx"><span class="hs-identifier hs-var">GHCiCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-764"></a><span>       </span><a href="RnEnv.html#HsTypeCtx"><span class="hs-identifier hs-var">HsTypeCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-765"></a><span>       </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span class="hs-identifier">rnAnonWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><a name="rnAnonWildCard"><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier">rnAnonWildCard</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803720"><a href="#local-6989586621679803720"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span>
</span><a name="line-770"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803721"><a href="#local-6989586621679803721"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-771"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803722"><a href="#local-6989586621679803722"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-6989586621679803721"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier hs-var">mkTyVarOcc</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803720"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-772"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803720"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803722"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-775"></a><span class="hs-comment">-- | Ensures either that we're in a type or that -XTypeInType is set</span><span>
</span><a name="line-776"></a><span class="hs-identifier">checkTypeInType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679803357"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-777"></a><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-778"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803357"><span class="hs-identifier hs-type">ty</span></a><span>      </span><span class="hs-comment">-- ^ type</span><span>
</span><a name="line-779"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-780"></a><a name="checkTypeInType"><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier">checkTypeInType</span></a></a><span> </span><a name="local-6989586621679803723"><a href="#local-6989586621679803723"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803724"><a href="#local-6989586621679803724"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-781"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803723"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-782"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803725"><a href="#local-6989586621679803725"><span class="hs-identifier">type_in_type</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-783"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803725"><span class="hs-identifier hs-var">type_in_type</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-784"></a><span>         </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803724"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-785"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you mean to enable TypeInType?&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-786"></a><span class="hs-identifier">checkTypeInType</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span class="hs-identifier">notInKinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679803356"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-789"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-790"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803356"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-791"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-792"></a><a name="notInKinds"><a href="RnTypes.html#notInKinds"><span class="hs-identifier">notInKinds</span></a></a><span> </span><a name="local-6989586621679803726"><a href="#local-6989586621679803726"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679803727"><a href="#local-6989586621679803727"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-793"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679803726"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-794"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind (even with TypeInType enabled):&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803727"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-795"></a><span class="hs-identifier">notInKinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span class="hs-comment">{- *****************************************************
*                                                      *
          Binding type variables
*                                                      *
***************************************************** -}</span><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">bindSigTyVarsFV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-804"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803355"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-805"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803355"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- Used just before renaming the defn of a function</span><span>
</span><a name="line-807"></a><span class="hs-comment">-- with a separate type signature, to bring its tyvars into scope</span><span>
</span><a name="line-808"></a><span class="hs-comment">-- With no -XScopedTypeVariables, this is a no-op</span><span>
</span><a name="line-809"></a><a name="bindSigTyVarsFV"><a href="RnTypes.html#bindSigTyVarsFV"><span class="hs-identifier">bindSigTyVarsFV</span></a></a><span> </span><a name="local-6989586621679803728"><a href="#local-6989586621679803728"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679803729"><a href="#local-6989586621679803729"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-810"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803730"><a href="#local-6989586621679803730"><span class="hs-identifier">scoped_tyvars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#ScopedTypeVariables"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ScopedTypeVariables</span></a><span>
</span><a name="line-811"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803730"><span class="hs-identifier hs-var">scoped_tyvars</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-812"></a><span>                </span><a href="#local-6989586621679803729"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-813"></a><span>          </span><span class="hs-keyword">else</span><span>
</span><a name="line-814"></a><span>                </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621679803728"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679803729"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span class="hs-comment">-- | Simply bring a bunch of RdrNames into scope. No checking for</span><span>
</span><a name="line-817"></a><span class="hs-comment">-- validity, at all. The binding location is taken from the location</span><span>
</span><a name="line-818"></a><span class="hs-comment">-- on each name.</span><span>
</span><a name="line-819"></a><span class="hs-identifier">bindLRdrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-820"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-821"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-822"></a><a name="bindLRdrNames"><a href="RnTypes.html#bindLRdrNames"><span class="hs-identifier">bindLRdrNames</span></a></a><span> </span><a name="local-6989586621679803731"><a href="#local-6989586621679803731"><span class="hs-identifier">rdrs</span></a></a><span> </span><a name="local-6989586621679803732"><a href="#local-6989586621679803732"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-823"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803733"><a href="#local-6989586621679803733"><span class="hs-identifier">var_names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803731"><span class="hs-identifier hs-var">rdrs</span></a><span>
</span><a name="line-824"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621679803733"><span class="hs-identifier hs-var">var_names</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-825"></a><span>         </span><a href="#local-6989586621679803732"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803733"><span class="hs-identifier hs-var">var_names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-828"></a><span class="hs-identifier">bindHsQTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679803352"><a href="#local-6989586621679803352"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679803353"><a href="#local-6989586621679803353"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-829"></a><span>                 </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-830"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>         </span><span class="hs-comment">-- if we are to check for unused tvs,</span><span>
</span><a name="line-831"></a><span>                                    </span><span class="hs-comment">-- a phrase like &quot;in the type ...&quot;</span><span>
</span><a name="line-832"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803352"><span class="hs-identifier hs-type">a</span></a><span>                 </span><span class="hs-comment">-- Just _  =&gt; an associated type decl</span><span>
</span><a name="line-833"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- Kind variables from scope, in l-to-r</span><span>
</span><a name="line-834"></a><span>                                         </span><span class="hs-comment">-- order, but not from ...</span><span>
</span><a name="line-835"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ... these user-written tyvars</span><span>
</span><a name="line-836"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803353"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-837"></a><span>                  </span><span class="hs-comment">-- also returns all names used in kind signatures, for the</span><span>
</span><a name="line-838"></a><span>                  </span><span class="hs-comment">-- TypeInType clause of Note [Complete user-supplied kind</span><span>
</span><a name="line-839"></a><span>                  </span><span class="hs-comment">-- signatures] in HsDecls</span><span>
</span><a name="line-840"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803353"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span class="hs-comment">-- (a) Bring kind variables into scope</span><span>
</span><a name="line-842"></a><span class="hs-comment">--     both (i)  passed in (kv_bndrs)</span><span>
</span><a name="line-843"></a><span class="hs-comment">--     and  (ii) mentioned in the kinds of tv_bndrs</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- (b) Bring type variables into scope</span><span>
</span><a name="line-845"></a><a name="bindHsQTyVars"><a href="RnTypes.html#bindHsQTyVars"><span class="hs-identifier">bindHsQTyVars</span></a></a><span> </span><a name="local-6989586621679803734"><a href="#local-6989586621679803734"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803735"><a href="#local-6989586621679803735"><span class="hs-identifier">mb_in_doc</span></a></a><span> </span><a name="local-6989586621679803736"><a href="#local-6989586621679803736"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621679803737"><a href="#local-6989586621679803737"><span class="hs-identifier">kv_bndrs</span></a></a><span> </span><a name="local-6989586621679803738"><a href="#local-6989586621679803738"><span class="hs-identifier">tv_bndrs</span></a></a><span> </span><a name="local-6989586621679803739"><a href="#local-6989586621679803739"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-846"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><a href="#local-6989586621679803734"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803735"><span class="hs-identifier hs-var">mb_in_doc</span></a><span>
</span><a name="line-847"></a><span>                           </span><a href="#local-6989586621679803736"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803737"><span class="hs-identifier hs-var">kv_bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#hsQTvExplicit"><span class="hs-identifier hs-var">hsQTvExplicit</span></a><span> </span><a href="#local-6989586621679803738"><span class="hs-identifier hs-var">tv_bndrs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-848"></a><span>         </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803740"><a href="#local-6989586621679803740"><span class="hs-identifier">rn_kvs</span></a></a><span> </span><a name="local-6989586621679803741"><a href="#local-6989586621679803741"><span class="hs-identifier">rn_bndrs</span></a></a><span> </span><a name="local-6989586621679803742"><a href="#local-6989586621679803742"><span class="hs-identifier">dep_var_set</span></a></a><span> </span><a name="local-6989586621679803743"><a href="#local-6989586621679803743"><span class="hs-identifier">all_dep_vars</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-849"></a><span>         </span><a href="#local-6989586621679803739"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQTvs"><span class="hs-identifier hs-var">HsQTvs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803740"><span class="hs-identifier hs-var">rn_kvs</span></a><span>
</span><a name="line-850"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803741"><span class="hs-identifier hs-var">rn_bndrs</span></a><span>
</span><a name="line-851"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_dependent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803742"><span class="hs-identifier hs-var">dep_var_set</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803743"><span class="hs-identifier hs-var">all_dep_vars</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-identifier">bindLHsTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679803350"><a href="#local-6989586621679803350"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679803351"><a href="#local-6989586621679803351"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-854"></a><span>                     </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-855"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>         </span><span class="hs-comment">-- if we are to check for unused tvs,</span><span>
</span><a name="line-856"></a><span>                                        </span><span class="hs-comment">-- a phrase like &quot;in the type ...&quot;</span><span>
</span><a name="line-857"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803350"><span class="hs-identifier hs-type">a</span></a><span>            </span><span class="hs-comment">-- Just _  =&gt; an associated type decl</span><span>
</span><a name="line-858"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Unbound kind variables from scope,</span><span>
</span><a name="line-859"></a><span>                                        </span><span class="hs-comment">-- in l-to-r order, but not from ...</span><span>
</span><a name="line-860"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ... these user-written tyvars</span><span>
</span><a name="line-861"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span>   </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- all kv names</span><span>
</span><a name="line-862"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-863"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-comment">-- which names, from the preceding list,</span><span>
</span><a name="line-864"></a><span>                                 </span><span class="hs-comment">-- are used dependently within that list</span><span>
</span><a name="line-865"></a><span>                                 </span><span class="hs-comment">-- See Note [Dependent LHsQTyVars] in TcHsType</span><span>
</span><a name="line-866"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-comment">-- all names used in kind signatures</span><span>
</span><a name="line-867"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803351"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803351"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-869"></a><a name="bindLHsTyVarBndrs"><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier">bindLHsTyVarBndrs</span></a></a><span> </span><a name="local-6989586621679803744"><a href="#local-6989586621679803744"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803745"><a href="#local-6989586621679803745"><span class="hs-identifier">mb_in_doc</span></a></a><span> </span><a name="local-6989586621679803746"><a href="#local-6989586621679803746"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621679803747"><a href="#local-6989586621679803747"><span class="hs-identifier">kv_bndrs</span></a></a><span> </span><a name="local-6989586621679803748"><a href="#local-6989586621679803748"><span class="hs-identifier">tv_bndrs</span></a></a><span> </span><a name="local-6989586621679803749"><a href="#local-6989586621679803749"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-870"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a><span> </span><a href="#local-6989586621679803746"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a><span> </span><a href="#local-6989586621679803750"><span class="hs-identifier hs-var">tv_names_w_loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-871"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679803751"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><a href="#local-6989586621679803748"><span class="hs-identifier hs-var">tv_bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-872"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-873"></a><span>    </span><a name="local-6989586621679803750"><a href="#local-6989586621679803750"><span class="hs-identifier">tv_names_w_loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsTypes.html#hsLTyVarLocName"><span class="hs-identifier hs-var">hsLTyVarLocName</span></a><span> </span><a href="#local-6989586621679803748"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-874"></a><span>
</span><a name="line-875"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>                 </span><span class="hs-comment">-- kind-vars found (in reverse order)</span><span>
</span><a name="line-876"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- already renamed (in reverse order)</span><span>
</span><a name="line-877"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>                </span><span class="hs-comment">-- kind vars already in scope (for dup checking)</span><span>
</span><a name="line-878"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>                </span><span class="hs-comment">-- type vars already in scope (for dup checking)</span><span>
</span><a name="line-879"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>                </span><span class="hs-comment">-- (all) variables used dependently</span><span>
</span><a name="line-880"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- still to be renamed, scoped</span><span>
</span><a name="line-881"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803351"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>    </span><a name="local-6989586621679803751"><a href="#local-6989586621679803751"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679803753"><a href="#local-6989586621679803753"><span class="hs-identifier">rn_kvs</span></a></a><span> </span><a name="local-6989586621679803754"><a href="#local-6989586621679803754"><span class="hs-identifier">rn_tvs</span></a></a><span> </span><a name="local-6989586621679803755"><a href="#local-6989586621679803755"><span class="hs-identifier">kv_names</span></a></a><span> </span><a name="local-6989586621679803756"><a href="#local-6989586621679803756"><span class="hs-identifier">tv_names</span></a></a><span> </span><a name="local-6989586621679803757"><a href="#local-6989586621679803757"><span class="hs-identifier">dep_vars</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679803758"><a href="#local-6989586621679803758"><span class="hs-identifier">tv_bndr</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679803759"><a href="#local-6989586621679803759"><span class="hs-identifier">tv_bndrs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier hs-var">bindLHsTyVarBndr</span></a><span> </span><a href="#local-6989586621679803744"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803746"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803755"><span class="hs-identifier hs-var">kv_names</span></a><span> </span><a href="#local-6989586621679803756"><span class="hs-identifier hs-var">tv_names</span></a><span> </span><a href="#local-6989586621679803758"><span class="hs-identifier hs-var">tv_bndr</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-884"></a><span>        </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803760"><a href="#local-6989586621679803760"><span class="hs-identifier">kv_nms</span></a></a><span> </span><a name="local-6989586621679803761"><a href="#local-6989586621679803761"><span class="hs-identifier">used_dependently</span></a></a><span> </span><a name="local-6989586621679803762"><a href="#local-6989586621679803762"><span class="hs-identifier">tv_bndr'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-885"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803763"><a href="#local-6989586621679803763"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803764"><a href="#local-6989586621679803764"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803751"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679803760"><span class="hs-identifier hs-var">kv_nms</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679803753"><span class="hs-identifier hs-var">rn_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span>                            </span><span class="hs-special">(</span><a href="#local-6989586621679803762"><span class="hs-identifier hs-var">tv_bndr'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679803754"><span class="hs-identifier hs-var">rn_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-887"></a><span>                            </span><span class="hs-special">(</span><a href="#local-6989586621679803755"><span class="hs-identifier hs-var">kv_names</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#extendNameSetList"><span class="hs-identifier hs-var">extendNameSetList</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803760"><span class="hs-identifier hs-var">kv_nms</span></a><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span>                            </span><span class="hs-special">(</span><a href="#local-6989586621679803756"><span class="hs-identifier hs-var">tv_names</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#extendNameSet"><span class="hs-identifier hs-var">extendNameSet</span></a><span class="hs-special">`</span><span> </span><a href="HsTypes.html#hsLTyVarName"><span class="hs-identifier hs-var">hsLTyVarName</span></a><span> </span><a href="#local-6989586621679803762"><span class="hs-identifier hs-var">tv_bndr'</span></a><span class="hs-special">)</span><span>
</span><a name="line-889"></a><span>                            </span><span class="hs-special">(</span><a href="#local-6989586621679803757"><span class="hs-identifier hs-var">dep_vars</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803761"><span class="hs-identifier hs-var">used_dependently</span></a><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>                            </span><a href="#local-6989586621679803759"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-891"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679803752"><span class="hs-identifier hs-var">warn_unused</span></a><span> </span><a href="#local-6989586621679803762"><span class="hs-identifier hs-var">tv_bndr'</span></a><span> </span><a href="#local-6989586621679803764"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-892"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803763"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803764"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679803765"><a href="#local-6989586621679803765"><span class="hs-identifier">rn_kvs</span></a></a><span> </span><a name="local-6989586621679803766"><a href="#local-6989586621679803766"><span class="hs-identifier">rn_tvs</span></a></a><span> </span><a name="local-6989586621679803767"><a href="#local-6989586621679803767"><span class="hs-identifier">_kv_names</span></a></a><span> </span><a name="local-6989586621679803768"><a href="#local-6989586621679803768"><span class="hs-identifier">tv_names</span></a></a><span> </span><a name="local-6989586621679803769"><a href="#local-6989586621679803769"><span class="hs-identifier">dep_vars</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-895"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- still need to deal with the kv_bndrs passed in originally</span><span>
</span><a name="line-896"></a><span>        </span><a href="RnTypes.html#bindImplicitKvs"><span class="hs-identifier hs-var">bindImplicitKvs</span></a><span> </span><a href="#local-6989586621679803744"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803746"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803747"><span class="hs-identifier hs-var">kv_bndrs</span></a><span> </span><a href="#local-6989586621679803768"><span class="hs-identifier hs-var">tv_names</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803770"><a href="#local-6989586621679803770"><span class="hs-identifier">kv_nms</span></a></a><span> </span><a name="local-6989586621679803771"><a href="#local-6989586621679803771"><span class="hs-identifier">others</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-897"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803772"><a href="#local-6989586621679803772"><span class="hs-identifier">all_rn_kvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679803770"><span class="hs-identifier hs-var">kv_nms</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679803765"><span class="hs-identifier hs-var">rn_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>                 </span><a name="local-6989586621679803773"><a href="#local-6989586621679803773"><span class="hs-identifier">all_rn_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679803766"><span class="hs-identifier hs-var">rn_tvs</span></a><span>
</span><a name="line-899"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803774"><a href="#local-6989586621679803774"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-900"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803775"><a href="#local-6989586621679803775"><span class="hs-identifier">all_dep_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803769"><span class="hs-identifier hs-var">dep_vars</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803771"><span class="hs-identifier hs-var">others</span></a><span>
</span><a name="line-901"></a><span>                 </span><a name="local-6989586621679803776"><a href="#local-6989586621679803776"><span class="hs-identifier">exp_dep_vars</span></a></a><span> </span><span class="hs-comment">-- variables in all_rn_tvs that are in dep_vars</span><span>
</span><a name="line-902"></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679803778"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-903"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679803777"><a href="#local-6989586621679803777"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803773"><span class="hs-identifier hs-var">all_rn_tvs</span></a><span>
</span><a name="line-904"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803778"><a href="#local-6989586621679803778"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#hsLTyVarName"><span class="hs-identifier hs-var">hsLTyVarName</span></a><span> </span><a href="#local-6989586621679803777"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-905"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803778"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803775"><span class="hs-identifier hs-var">all_dep_vars</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-906"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;bindHsTyVars&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803774"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-907"></a><span>                                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803772"><span class="hs-identifier hs-var">all_rn_kvs</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-908"></a><span>                                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803773"><span class="hs-identifier hs-var">all_rn_tvs</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-909"></a><span>                                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803776"><span class="hs-identifier hs-var">exp_dep_vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-910"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679803749"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803772"><span class="hs-identifier hs-var">all_rn_kvs</span></a><span> </span><a href="#local-6989586621679803773"><span class="hs-identifier hs-var">all_rn_tvs</span></a><span> </span><a href="#local-6989586621679803776"><span class="hs-identifier hs-var">exp_dep_vars</span></a><span> </span><a href="#local-6989586621679803775"><span class="hs-identifier hs-var">all_dep_vars</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span>    </span><a name="local-6989586621679803752"><a href="#local-6989586621679803752"><span class="hs-identifier">warn_unused</span></a></a><span> </span><a name="local-6989586621679803779"><a href="#local-6989586621679803779"><span class="hs-identifier">tv_bndr</span></a></a><span> </span><a name="local-6989586621679803780"><a href="#local-6989586621679803780"><span class="hs-identifier">fvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679803745"><span class="hs-identifier hs-var">mb_in_doc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-913"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803781"><a href="#local-6989586621679803781"><span class="hs-identifier">in_doc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#warnUnusedForAll"><span class="hs-identifier hs-var">warnUnusedForAll</span></a><span> </span><a href="#local-6989586621679803781"><span class="hs-identifier hs-var">in_doc</span></a><span> </span><a href="#local-6989586621679803779"><span class="hs-identifier hs-var">tv_bndr</span></a><span> </span><a href="#local-6989586621679803780"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-914"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-915"></a><span>
</span><a name="line-916"></a><span class="hs-identifier">bindLHsTyVarBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-917"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803348"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- associated class</span><span>
</span><a name="line-918"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>   </span><span class="hs-comment">-- kind vars already in scope</span><span>
</span><a name="line-919"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>   </span><span class="hs-comment">-- type vars already in scope</span><span>
</span><a name="line-920"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-921"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803349"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>                   </span><span class="hs-comment">-- passed the newly-bound implicitly-declared kind vars,</span><span>
</span><a name="line-923"></a><span>                   </span><span class="hs-comment">-- any other names used in a kind</span><span>
</span><a name="line-924"></a><span>                   </span><span class="hs-comment">-- and the renamed LHsTyVarBndr</span><span>
</span><a name="line-925"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803349"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-926"></a><a name="bindLHsTyVarBndr"><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier">bindLHsTyVarBndr</span></a></a><span> </span><a name="local-6989586621679803782"><a href="#local-6989586621679803782"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803783"><a href="#local-6989586621679803783"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621679803784"><a href="#local-6989586621679803784"><span class="hs-identifier">kv_names</span></a></a><span> </span><a name="local-6989586621679803785"><a href="#local-6989586621679803785"><span class="hs-identifier">tv_names</span></a></a><span> </span><a name="local-6989586621679803786"><a href="#local-6989586621679803786"><span class="hs-identifier">hs_tv_bndr</span></a></a><span> </span><a name="local-6989586621679803787"><a href="#local-6989586621679803787"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-927"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679803786"><span class="hs-identifier hs-var">hs_tv_bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-928"></a><span>      </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803798"><a href="#local-6989586621679803798"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a name="local-6989586621679803799"><a href="#local-6989586621679803799"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803800"><a href="#local-6989586621679803800"><span class="hs-identifier">lv</span></a></a><span> </span><a name="local-6989586621679803801"><a href="#local-6989586621679803801"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-929"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="#local-6989586621679803788"><span class="hs-identifier hs-var">check_dup</span></a><span> </span><a href="#local-6989586621679803798"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803801"><span class="hs-identifier hs-var">rdr</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-930"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803802"><a href="#local-6989586621679803802"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621679803783"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803799"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-931"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803802"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-932"></a><span>             </span><a href="#local-6989586621679803787"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803798"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803800"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621679803802"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-933"></a><span>      </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803803"><a href="#local-6989586621679803803"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><a name="local-6989586621679803804"><a href="#local-6989586621679803804"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803805"><a href="#local-6989586621679803805"><span class="hs-identifier">lv</span></a></a><span> </span><a name="local-6989586621679803806"><a href="#local-6989586621679803806"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679803807"><a href="#local-6989586621679803807"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-934"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803808"><a href="#local-6989586621679803808"><span class="hs-identifier">free_kvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier hs-var">freeKiTyVarsAllVars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621679803807"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-935"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679803788"><span class="hs-identifier hs-var">check_dup</span></a><span> </span><a href="#local-6989586621679803805"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621679803806"><span class="hs-identifier hs-var">rdr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803808"><span class="hs-identifier hs-var">free_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>
</span><a name="line-937"></a><span>             </span><span class="hs-comment">-- check for -XKindSignatures</span><span>
</span><a name="line-938"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803809"><a href="#local-6989586621679803809"><span class="hs-identifier">sig_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#KindSignatures"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">KindSignatures</span></a><span>
</span><a name="line-939"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803809"><span class="hs-identifier hs-var">sig_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier hs-var">badKindSigErr</span></a><span> </span><a href="#local-6989586621679803782"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803807"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>
</span><a name="line-941"></a><span>             </span><span class="hs-comment">-- deal with kind vars in the user-written kind</span><span>
</span><a name="line-942"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#bindImplicitKvs"><span class="hs-identifier hs-var">bindImplicitKvs</span></a><span> </span><a href="#local-6989586621679803782"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803783"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803808"><span class="hs-identifier hs-var">free_kvs</span></a><span> </span><a href="#local-6989586621679803785"><span class="hs-identifier hs-var">tv_names</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-943"></a><span>             </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679803810"><a href="#local-6989586621679803810"><span class="hs-identifier">new_kv_nms</span></a></a><span> </span><a name="local-6989586621679803811"><a href="#local-6989586621679803811"><span class="hs-identifier">other_kv_nms</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-944"></a><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803812"><a href="#local-6989586621679803812"><span class="hs-identifier">kind'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803813"><a href="#local-6989586621679803813"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a><span> </span><a href="#local-6989586621679803782"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803807"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-945"></a><span>                </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803814"><a href="#local-6989586621679803814"><span class="hs-identifier">tv_nm</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621679803783"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621679803804"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-946"></a><span>                </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803815"><a href="#local-6989586621679803815"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803816"><a href="#local-6989586621679803816"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803814"><span class="hs-identifier hs-var">tv_nm</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-947"></a><span>                               </span><a href="#local-6989586621679803787"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803810"><span class="hs-identifier hs-var">new_kv_nms</span></a><span> </span><a href="#local-6989586621679803811"><span class="hs-identifier hs-var">other_kv_nms</span></a><span>
</span><a name="line-948"></a><span>                                 </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803803"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803805"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621679803814"><span class="hs-identifier hs-var">tv_nm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803812"><span class="hs-identifier hs-var">kind'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803815"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803813"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803816"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-950"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-951"></a><span>      </span><span class="hs-comment">-- make sure that the RdrName isn't in the sets of</span><span>
</span><a name="line-952"></a><span>      </span><span class="hs-comment">-- names. We can't just check that it's not in scope at all</span><span>
</span><a name="line-953"></a><span>      </span><span class="hs-comment">-- because we might be inside an associated class.</span><span>
</span><a name="line-954"></a><span>    </span><span class="hs-identifier">check_dup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-955"></a><span>    </span><a name="local-6989586621679803788"><a href="#local-6989586621679803788"><span class="hs-identifier">check_dup</span></a></a><span> </span><a name="local-6989586621679803791"><a href="#local-6989586621679803791"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803792"><a href="#local-6989586621679803792"><span class="hs-identifier">rdr</span></a></a><span> </span><a name="local-6989586621679803793"><a href="#local-6989586621679803793"><span class="hs-identifier">kindFreeVars</span></a></a><span>
</span><a name="line-956"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Disallow use of a type variable name in its</span><span>
</span><a name="line-957"></a><span>             </span><span class="hs-comment">-- kind signature (#11592).</span><span>
</span><a name="line-958"></a><span>             </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803792"><span class="hs-identifier hs-var">rdr</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803793"><span class="hs-identifier hs-var">kindFreeVars</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-959"></a><span>             </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-6989586621679803791"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679803790"><span class="hs-identifier hs-var">ki_ty_self_err</span></a><span> </span><a href="#local-6989586621679803792"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-960"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-6989586621679803782"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>
</span><a name="line-962"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803794"><a href="#local-6989586621679803794"><span class="hs-identifier">m_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupLocalOccRn_maybe"><span class="hs-identifier hs-var">lookupLocalOccRn_maybe</span></a><span> </span><a href="#local-6989586621679803792"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-963"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="Maybes.html#whenIsJust"><span class="hs-identifier hs-var">whenIsJust</span></a><span> </span><a href="#local-6989586621679803794"><span class="hs-identifier hs-var">m_name</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679803795"><a href="#local-6989586621679803795"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-964"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803784"><span class="hs-identifier hs-var">kv_names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-965"></a><span>             </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-6989586621679803791"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679803789"><span class="hs-identifier hs-var">ki_ty_err_msg</span></a><span> </span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-966"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-6989586621679803782"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803785"><span class="hs-identifier hs-var">tv_names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-968"></a><span>             </span><a href="RnEnv.html#dupNamesErr"><span class="hs-identifier hs-var">dupNamesErr</span></a><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803791"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803795"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-969"></a><span>
</span><a name="line-970"></a><span>    </span><a name="local-6989586621679803789"><a href="#local-6989586621679803789"><span class="hs-identifier">ki_ty_err_msg</span></a></a><span> </span><a name="local-6989586621679803796"><a href="#local-6989586621679803796"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803796"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-971"></a><span>                      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;used as a kind variable before being bound&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-972"></a><span>                      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;as a type variable. Perhaps reorder your variables?&quot;</span><span>
</span><a name="line-973"></a><span>
</span><a name="line-974"></a><span>    </span><a name="local-6989586621679803790"><a href="#local-6989586621679803790"><span class="hs-identifier">ki_ty_self_err</span></a></a><span> </span><a name="local-6989586621679803797"><a href="#local-6989586621679803797"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803797"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-975"></a><span>                       </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is used in the kind signature of its&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-976"></a><span>                       </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;declaration as a type variable.&quot;</span><span>
</span><a name="line-977"></a><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-identifier">bindImplicitKvs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-980"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803346"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-981"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ kind var *occurrences*, from which</span><span>
</span><a name="line-982"></a><span>                                      </span><span class="hs-comment">-- intent to bind is inferred</span><span>
</span><a name="line-983"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>            </span><span class="hs-comment">-- ^ *type* variables, for type/kind</span><span>
</span><a name="line-984"></a><span>                                      </span><span class="hs-comment">-- misuse check for -XNoTypeInType</span><span>
</span><a name="line-985"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803347"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>                   </span><span class="hs-comment">-- ^ passed new kv_names, and any other names used in a kind</span><span>
</span><a name="line-987"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803347"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-988"></a><a name="bindImplicitKvs"><a href="RnTypes.html#bindImplicitKvs"><span class="hs-identifier">bindImplicitKvs</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-identifier">_</span><span>        </span><a name="local-6989586621679803817"><a href="#local-6989586621679803817"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-989"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803817"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-990"></a><span class="hs-identifier">bindImplicitKvs</span><span> </span><a name="local-6989586621679803818"><a href="#local-6989586621679803818"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679803819"><a href="#local-6989586621679803819"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621679803820"><a href="#local-6989586621679803820"><span class="hs-identifier">free_kvs</span></a></a><span> </span><a name="local-6989586621679803821"><a href="#local-6989586621679803821"><span class="hs-identifier">tv_names</span></a></a><span> </span><a name="local-6989586621679803822"><a href="#local-6989586621679803822"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-991"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803827"><a href="#local-6989586621679803827"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-992"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803828"><a href="#local-6989586621679803828"><span class="hs-identifier">part_kvs</span></a></a><span> </span><a name="local-6989586621679803831"><a href="#local-6989586621679803831"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803832"><a href="#local-6989586621679803832"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803833"><a href="#local-6989586621679803833"><span class="hs-identifier">kv_rdr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-993"></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-6989586621679803827"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621679803833"><span class="hs-identifier hs-var">kv_rdr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-994"></a><span>                   </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803834"><a href="#local-6989586621679803834"><span class="hs-identifier">kv_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803832"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803834"><span class="hs-identifier hs-var">kv_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-995"></a><span>                   </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-6989586621679803831"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-996"></a><span>             </span><span class="hs-special">(</span><a name="local-6989586621679803829"><a href="#local-6989586621679803829"><span class="hs-identifier">bound_kvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803830"><a href="#local-6989586621679803830"><span class="hs-identifier">new_kvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a><span> </span><a href="#local-6989586621679803828"><span class="hs-identifier hs-var">part_kvs</span></a><span> </span><a href="#local-6989586621679803820"><span class="hs-identifier hs-var">free_kvs</span></a><span>
</span><a name="line-997"></a><span>
</span><a name="line-998"></a><span>          </span><span class="hs-comment">-- check whether we're mixing types &amp; kinds illegally</span><span>
</span><a name="line-999"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803835"><a href="#local-6989586621679803835"><span class="hs-identifier">type_in_type</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-1000"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803835"><span class="hs-identifier hs-var">type_in_type</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1001"></a><span>         </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803823"><span class="hs-identifier hs-var">check_tv_used_in_kind</span></a><span> </span><a href="#local-6989586621679803821"><span class="hs-identifier hs-var">tv_names</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803829"><span class="hs-identifier hs-var">bound_kvs</span></a><span>
</span><a name="line-1002"></a><span>
</span><a name="line-1003"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803836"><a href="#local-6989586621679803836"><span class="hs-identifier">poly_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#PolyKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">PolyKinds</span></a><span>
</span><a name="line-1004"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679803836"><span class="hs-identifier hs-var">poly_kinds</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1005"></a><span>         </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#badKindBndrs"><span class="hs-identifier hs-var">badKindBndrs</span></a><span> </span><a href="#local-6989586621679803818"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679803830"><span class="hs-identifier hs-var">new_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1006"></a><span>
</span><a name="line-1007"></a><span>          </span><span class="hs-comment">-- bind the vars and move on</span><span>
</span><a name="line-1008"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803837"><a href="#local-6989586621679803837"><span class="hs-identifier">kv_nms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621679803819"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803830"><span class="hs-identifier hs-var">new_kvs</span></a><span>
</span><a name="line-1009"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621679803837"><span class="hs-identifier hs-var">kv_nms</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1010"></a><span>         </span><a href="#local-6989586621679803822"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621679803837"><span class="hs-identifier hs-var">kv_nms</span></a><span> </span><span class="hs-special">(</span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803829"><span class="hs-identifier hs-var">bound_kvs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1011"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1012"></a><span>      </span><span class="hs-comment">-- check to see if the variables free in a kind are bound as type</span><span>
</span><a name="line-1013"></a><span>      </span><span class="hs-comment">-- variables. Assume -XNoTypeInType.</span><span>
</span><a name="line-1014"></a><span>    </span><span class="hs-identifier">check_tv_used_in_kind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>       </span><span class="hs-comment">-- ^ *type* variables</span><span>
</span><a name="line-1015"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>  </span><span class="hs-comment">-- ^ renamed var used in kind</span><span>
</span><a name="line-1016"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1017"></a><span>    </span><a name="local-6989586621679803823"><a href="#local-6989586621679803823"><span class="hs-identifier">check_tv_used_in_kind</span></a></a><span> </span><a name="local-6989586621679803824"><a href="#local-6989586621679803824"><span class="hs-identifier">tv_names</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803825"><a href="#local-6989586621679803825"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803826"><a href="#local-6989586621679803826"><span class="hs-identifier">kv_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803826"><span class="hs-identifier hs-var">kv_name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803824"><span class="hs-identifier hs-var">tv_names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1019"></a><span>        </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-6989586621679803825"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803826"><span class="hs-identifier hs-var">kv_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1020"></a><span>                             </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;used in a kind.&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1021"></a><span>                             </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you mean to use TypeInType?&quot;</span><span>
</span><a name="line-1022"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-6989586621679803818"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1023"></a><span>
</span><a name="line-1024"></a><span>
</span><a name="line-1025"></a><span class="hs-identifier">newTyVarNameRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803345"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1026"></a><a name="newTyVarNameRn"><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier">newTyVarNameRn</span></a></a><span> </span><a name="local-6989586621679803838"><a href="#local-6989586621679803838"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803839"><a href="#local-6989586621679803839"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679803840"><a href="#local-6989586621679803840"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1027"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803841"><a href="#local-6989586621679803841"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-1028"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803838"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-6989586621679803841"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621679803840"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1029"></a><span>           </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803842"><a href="#local-6989586621679803842"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679803842"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1030"></a><span>              </span><span class="hs-comment">-- Use the same Name as the parent class decl</span><span>
</span><a name="line-1031"></a><span>
</span><a name="line-1032"></a><span>           </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803839"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803840"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1033"></a><span>
</span><a name="line-1034"></a><span class="hs-comment">---------------------</span><span>
</span><a name="line-1035"></a><span class="hs-identifier">collectAnonWildCards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1036"></a><span class="hs-comment">-- | Extract all wild cards from a type.</span><span>
</span><a name="line-1037"></a><a name="collectAnonWildCards"><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier">collectAnonWildCards</span></a></a><span> </span><a name="local-6989586621679803843"><a href="#local-6989586621679803843"><span class="hs-identifier">lty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803843"><span class="hs-identifier hs-var">lty</span></a><span>
</span><a name="line-1038"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1039"></a><span>    </span><a name="local-6989586621679803844"><a href="#local-6989586621679803844"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803847"><a href="#local-6989586621679803847"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679803847"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1040"></a><span>      </span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803848"><a href="#local-6989586621679803848"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803848"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">]</span><span>
</span><a name="line-1041"></a><span>      </span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621679803849"><a href="#local-6989586621679803849"><span class="hs-identifier">tys</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803846"><span class="hs-identifier hs-var">prefix_types_only</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803849"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1042"></a><span>      </span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621679803850"><a href="#local-6989586621679803850"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803851"><a href="#local-6989586621679803851"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803850"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803851"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1043"></a><span>      </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621679803852"><a href="#local-6989586621679803852"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803853"><a href="#local-6989586621679803853"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803852"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803853"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1044"></a><span>      </span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621679803854"><a href="#local-6989586621679803854"><span class="hs-identifier">ty</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803854"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1045"></a><span>      </span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621679803855"><a href="#local-6989586621679803855"><span class="hs-identifier">ty</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803855"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1046"></a><span>      </span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803856"><a href="#local-6989586621679803856"><span class="hs-identifier">tys</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679803856"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1047"></a><span>      </span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621679803857"><a href="#local-6989586621679803857"><span class="hs-identifier">tys</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679803857"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1048"></a><span>      </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621679803858"><a href="#local-6989586621679803858"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803859"><a href="#local-6989586621679803859"><span class="hs-identifier">ty2</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803858"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803859"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1049"></a><span>      </span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621679803860"><a href="#local-6989586621679803860"><span class="hs-identifier">ty</span></a></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803860"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1050"></a><span>      </span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803861"><a href="#local-6989586621679803861"><span class="hs-identifier">ty</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803861"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1051"></a><span>      </span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621679803862"><a href="#local-6989586621679803862"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803863"><a href="#local-6989586621679803863"><span class="hs-identifier">ty2</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803862"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803863"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1052"></a><span>      </span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621679803864"><a href="#local-6989586621679803864"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679803865"><a href="#local-6989586621679803865"><span class="hs-identifier">kind</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803864"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803865"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1053"></a><span>      </span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621679803866"><a href="#local-6989586621679803866"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803866"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1054"></a><span>      </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803867"><a href="#local-6989586621679803867"><span class="hs-identifier">ty</span></a></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803867"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1055"></a><span>      </span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621679803868"><a href="#local-6989586621679803868"><span class="hs-identifier">flds</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_type</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803868"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1056"></a><span>      </span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803869"><a href="#local-6989586621679803869"><span class="hs-identifier">tys</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679803869"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1057"></a><span>      </span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803870"><a href="#local-6989586621679803870"><span class="hs-identifier">tys</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679803870"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1058"></a><span>      </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803871"><a href="#local-6989586621679803871"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1059"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803872"><a href="#local-6989586621679803872"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#collectAnonWildCardsBndrs"><span class="hs-identifier hs-var">collectAnonWildCardsBndrs</span></a><span> </span><a href="#local-6989586621679803871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1060"></a><span>                                      </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803872"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1061"></a><span>      </span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803873"><a href="#local-6989586621679803873"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-1062"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679803874"><a href="#local-6989586621679803874"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803845"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679803873"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679803874"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1063"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliced"><span class="hs-identifier hs-var">HsSpliced</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSplicedTy"><span class="hs-identifier hs-var">HsSplicedTy</span></a><span> </span><a name="local-6989586621679803875"><a href="#local-6989586621679803875"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="#local-6989586621679803875"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1064"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1065"></a><span>      </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1066"></a><span>      </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1067"></a><span>      </span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1068"></a><span>
</span><a name="line-1069"></a><span>    </span><a name="local-6989586621679803845"><a href="#local-6989586621679803845"><span class="hs-identifier">gos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679803844"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1070"></a><span>
</span><a name="line-1071"></a><span>    </span><a name="local-6989586621679803846"><a href="#local-6989586621679803846"><span class="hs-identifier">prefix_types_only</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppPrefix"><span class="hs-identifier hs-var">HsAppPrefix</span></a><span> </span><a name="local-6989586621679803876"><a href="#local-6989586621679803876"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803876"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-identifier">prefix_types_only</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppInfix"><span class="hs-identifier hs-var">HsAppInfix</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span class="hs-identifier">collectAnonWildCardsBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1075"></a><a name="collectAnonWildCardsBndrs"><a href="RnTypes.html#collectAnonWildCardsBndrs"><span class="hs-identifier">collectAnonWildCardsBndrs</span></a></a><span> </span><a name="local-6989586621679803877"><a href="#local-6989586621679803877"><span class="hs-identifier">ltvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803878"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803877"><span class="hs-identifier hs-var">ltvs</span></a><span>
</span><a name="line-1076"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1077"></a><span>    </span><a name="local-6989586621679803878"><a href="#local-6989586621679803878"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1078"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803879"><a href="#local-6989586621679803879"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span> </span><a href="#local-6989586621679803879"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1079"></a><span>
</span><a name="line-1080"></a><span class="hs-comment">{-
*********************************************************
*                                                       *
        ConDeclField
*                                                       *
*********************************************************

When renaming a ConDeclField, we have to find the FieldLabel
associated with each field.  But we already have all the FieldLabels
available (since they were brought into scope by
RnNames.getLocalNonValBinders), so we just take the list as an
argument, build a map and look them up.
-}</span><span>
</span><a name="line-1093"></a><span>
</span><a name="line-1094"></a><span class="hs-identifier">rnConDeclFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1095"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1096"></a><span class="hs-comment">-- Also called from RnSource</span><span>
</span><a name="line-1097"></a><span class="hs-comment">-- No wildcards can appear in record fields</span><span>
</span><a name="line-1098"></a><a name="rnConDeclFields"><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier">rnConDeclFields</span></a></a><span> </span><a name="local-6989586621679803880"><a href="#local-6989586621679803880"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679803881"><a href="#local-6989586621679803881"><span class="hs-identifier">fls</span></a></a><span> </span><a name="local-6989586621679803882"><a href="#local-6989586621679803882"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-1099"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnField"><span class="hs-identifier hs-var">rnField</span></a><span> </span><a href="#local-6989586621679803884"><span class="hs-identifier hs-var">fl_env</span></a><span> </span><a href="#local-6989586621679803883"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803882"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1100"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1101"></a><span>    </span><a name="local-6989586621679803883"><a href="#local-6989586621679803883"><span class="hs-identifier">env</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621679803880"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>
</span><a name="line-1102"></a><span>    </span><a name="local-6989586621679803884"><a href="#local-6989586621679803884"><span class="hs-identifier">fl_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#mkFsEnv"><span class="hs-identifier hs-var">mkFsEnv</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flLabel</span><span> </span><a href="#local-6989586621679803885"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803885"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679803885"><a href="#local-6989586621679803885"><span class="hs-identifier">fl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679803881"><span class="hs-identifier hs-var">fls</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1103"></a><span>
</span><a name="line-1104"></a><span class="hs-identifier">rnField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastStringEnv.html#FastStringEnv"><span class="hs-identifier hs-type">FastStringEnv</span></a><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1105"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1106"></a><a name="rnField"><a href="RnTypes.html#rnField"><span class="hs-identifier">rnField</span></a></a><span> </span><a name="local-6989586621679803886"><a href="#local-6989586621679803886"><span class="hs-identifier">fl_env</span></a></a><span> </span><a name="local-6989586621679803887"><a href="#local-6989586621679803887"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803888"><a href="#local-6989586621679803888"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#ConDeclField"><span class="hs-identifier hs-var">ConDeclField</span></a><span> </span><a name="local-6989586621679803889"><a href="#local-6989586621679803889"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621679803890"><a href="#local-6989586621679803890"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679803891"><a href="#local-6989586621679803891"><span class="hs-identifier">haddock_doc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1107"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679803897"><a href="#local-6989586621679803897"><span class="hs-identifier">new_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679803892"><span class="hs-identifier hs-var">lookupField</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803889"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1108"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679803898"><a href="#local-6989586621679803898"><span class="hs-identifier">new_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803899"><a href="#local-6989586621679803899"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621679803887"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679803890"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1109"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679803900"><a href="#local-6989586621679803900"><span class="hs-identifier">new_haddock_doc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnHsDoc.html#rnMbLHsDoc"><span class="hs-identifier hs-var">rnMbLHsDoc</span></a><span> </span><a href="#local-6989586621679803891"><span class="hs-identifier hs-var">haddock_doc</span></a><span>
</span><a name="line-1110"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803888"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#ConDeclField"><span class="hs-identifier hs-var">ConDeclField</span></a><span> </span><a href="#local-6989586621679803897"><span class="hs-identifier hs-var">new_names</span></a><span> </span><a href="#local-6989586621679803898"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621679803900"><span class="hs-identifier hs-var">new_haddock_doc</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803899"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1111"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1112"></a><span>    </span><span class="hs-identifier">lookupField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1113"></a><span>    </span><a name="local-6989586621679803892"><a href="#local-6989586621679803892"><span class="hs-identifier">lookupField</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803893"><a href="#local-6989586621679803893"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621679803894"><a href="#local-6989586621679803894"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803893"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-6989586621679803894"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flSelector</span><span> </span><a href="#local-6989586621679803896"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1115"></a><span>        </span><a name="local-6989586621679803895"><a href="#local-6989586621679803895"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">occNameFS</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621679803894"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1116"></a><span>        </span><a name="local-6989586621679803896"><a href="#local-6989586621679803896"><span class="hs-identifier">fl</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Maybes.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a><span> </span><span class="hs-string">&quot;rnField&quot;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="FastStringEnv.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a><span> </span><a href="#local-6989586621679803886"><span class="hs-identifier hs-var">fl_env</span></a><span> </span><a href="#local-6989586621679803895"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-1117"></a><span>
</span><a name="line-1118"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Fixities and precedence parsing
*                                                                      *
************************************************************************

@mkOpAppRn@ deals with operator fixities.  The argument expressions
are assumed to be already correctly arranged.  It needs the fixities
recorded in the OpApp nodes, because fixity info applies to the things
the programmer actually wrote, so you can't find it out from the Name.

Furthermore, the second argument is guaranteed not to be another
operator application.  Why? Because the parser parses all
operator applications left-associatively, EXCEPT negation, which
we need to handle specially.
Infix types are read in a *right-associative* way, so that
        a `op` b `op` c
is always read in as
        a `op` (b `op` c)

mkHsOpTyRn rearranges where necessary.  The two arguments
have already been renamed and rearranged.  It's made rather tiresome
by the presence of -&gt;, which is a separate syntactic construct.
-}</span><span>
</span><a name="line-1143"></a><span>
</span><a name="line-1144"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1145"></a><span class="hs-comment">-- Building (ty1 `op1` (ty21 `op2` ty22))</span><span>
</span><a name="line-1146"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1148"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1149"></a><span>
</span><a name="line-1150"></a><a name="mkHsOpTyRn"><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier">mkHsOpTyRn</span></a></a><span> </span><a name="local-6989586621679803901"><a href="#local-6989586621679803901"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621679803902"><a href="#local-6989586621679803902"><span class="hs-identifier">pp_op1</span></a></a><span> </span><a name="local-6989586621679803903"><a href="#local-6989586621679803903"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621679803904"><a href="#local-6989586621679803904"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803905"><a href="#local-6989586621679803905"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621679803906"><a href="#local-6989586621679803906"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621679803907"><a href="#local-6989586621679803907"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803908"><a href="#local-6989586621679803908"><span class="hs-identifier">ty22</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1151"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679803909"><a href="#local-6989586621679803909"><span class="hs-identifier">fix2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621679803907"><span class="hs-identifier hs-var">op2</span></a><span>
</span><a name="line-1152"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier hs-var">mk_hs_op_ty</span></a><span> </span><a href="#local-6989586621679803901"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803902"><span class="hs-identifier hs-var">pp_op1</span></a><span> </span><a href="#local-6989586621679803903"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803904"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1153"></a><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679803910"><a href="#local-6989586621679803910"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679803911"><a href="#local-6989586621679803911"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621679803910"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679803907"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803911"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1154"></a><span>                      </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803907"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803909"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803906"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621679803908"><span class="hs-identifier hs-var">ty22</span></a><span> </span><a href="#local-6989586621679803905"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><a name="local-6989586621679803912"><a href="#local-6989586621679803912"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621679803913"><a href="#local-6989586621679803913"><span class="hs-identifier">pp_op1</span></a></a><span> </span><a name="local-6989586621679803914"><a href="#local-6989586621679803914"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621679803915"><a href="#local-6989586621679803915"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803916"><a href="#local-6989586621679803916"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621679803917"><a href="#local-6989586621679803917"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621679803918"><a href="#local-6989586621679803918"><span class="hs-identifier">ty22</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1157"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier hs-var">mk_hs_op_ty</span></a><span> </span><a href="#local-6989586621679803912"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803913"><span class="hs-identifier hs-var">pp_op1</span></a><span> </span><a href="#local-6989586621679803914"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803915"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1158"></a><span>                </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span> </span><a href="#local-6989586621679803917"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621679803918"><span class="hs-identifier hs-var">ty22</span></a><span> </span><a href="#local-6989586621679803916"><span class="hs-identifier hs-var">loc2</span></a><span>
</span><a name="line-1159"></a><span>
</span><a name="line-1160"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><a name="local-6989586621679803919"><a href="#local-6989586621679803919"><span class="hs-identifier">mk1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803920"><a href="#local-6989586621679803920"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679803921"><a href="#local-6989586621679803921"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1161"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803919"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803920"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679803921"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1162"></a><span>
</span><a name="line-1163"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1164"></a><span class="hs-identifier">mk_hs_op_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1165"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1166"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1167"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-1168"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1169"></a><a name="mk_hs_op_ty"><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier">mk_hs_op_ty</span></a></a><span> </span><a name="local-6989586621679803922"><a href="#local-6989586621679803922"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621679803923"><a href="#local-6989586621679803923"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679803924"><a href="#local-6989586621679803924"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621679803925"><a href="#local-6989586621679803925"><span class="hs-identifier">ty1</span></a></a><span>
</span><a name="line-1170"></a><span>            </span><a name="local-6989586621679803926"><a href="#local-6989586621679803926"><span class="hs-identifier">mk2</span></a></a><span> </span><a name="local-6989586621679803927"><a href="#local-6989586621679803927"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803928"><a href="#local-6989586621679803928"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621679803929"><a href="#local-6989586621679803929"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621679803930"><a href="#local-6989586621679803930"><span class="hs-identifier">ty22</span></a></a><span> </span><a name="local-6989586621679803931"><a href="#local-6989586621679803931"><span class="hs-identifier">loc2</span></a></a><span>
</span><a name="line-1171"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803932"><span class="hs-identifier hs-var">nofix_error</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621679803923"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621679803924"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621679803927"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621679803928"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803922"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803925"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803931"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803926"><span class="hs-identifier hs-var">mk2</span></a><span> </span><a href="#local-6989586621679803929"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621679803930"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1173"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803933"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803922"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803925"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803931"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803926"><span class="hs-identifier hs-var">mk2</span></a><span> </span><a href="#local-6989586621679803929"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621679803930"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Rearrange to ((ty1 `op1` ty21) `op2` ty22)</span><span>
</span><a name="line-1175"></a><span>                           </span><a name="local-6989586621679803934"><a href="#local-6989586621679803934"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><a href="#local-6989586621679803922"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621679803923"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679803924"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803925"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679803929"><span class="hs-identifier hs-var">ty21</span></a><span>
</span><a name="line-1176"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803926"><span class="hs-identifier hs-var">mk2</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679803934"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803930"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1177"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1178"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679803932"><a href="#local-6989586621679803932"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803933"><a href="#local-6989586621679803933"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679803924"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803928"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1179"></a><span>
</span><a name="line-1180"></a><span>
</span><a name="line-1181"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1182"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>                       </span><span class="hs-comment">-- Left operand; already rearranged</span><span>
</span><a name="line-1183"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>             </span><span class="hs-comment">-- Operator and fixity</span><span>
</span><a name="line-1184"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>                       </span><span class="hs-comment">-- Right operand (not an OpApp, but might</span><span>
</span><a name="line-1185"></a><span>                                                </span><span class="hs-comment">-- be a NegApp)</span><span>
</span><a name="line-1186"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1187"></a><span>
</span><a name="line-1188"></a><span class="hs-comment">-- (e11 `op1` e12) `op2` e2</span><span>
</span><a name="line-1189"></a><a name="mkOpAppRn"><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier">mkOpAppRn</span></a></a><span> </span><a name="local-6989586621679803935"><a href="#local-6989586621679803935"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a name="local-6989586621679803936"><a href="#local-6989586621679803936"><span class="hs-identifier">e11</span></a></a><span> </span><a name="local-6989586621679803937"><a href="#local-6989586621679803937"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679803938"><a href="#local-6989586621679803938"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621679803939"><a href="#local-6989586621679803939"><span class="hs-identifier">e12</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679803940"><a href="#local-6989586621679803940"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803941"><a href="#local-6989586621679803941"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621679803942"><a href="#local-6989586621679803942"><span class="hs-identifier">e2</span></a></a><span>
</span><a name="line-1190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803944"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1191"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803937"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621679803938"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803940"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621679803941"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1192"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679803935"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679803940"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803941"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803942"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1193"></a><span>
</span><a name="line-1194"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803945"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1195"></a><span>    </span><a name="local-6989586621679803946"><a href="#local-6989586621679803946"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span> </span><a href="#local-6989586621679803939"><span class="hs-identifier hs-var">e12</span></a><span> </span><a href="#local-6989586621679803940"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803941"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803942"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1196"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679803936"><span class="hs-identifier hs-var">e11</span></a><span> </span><a href="#local-6989586621679803937"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679803938"><span class="hs-identifier hs-var">fix1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803943"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621679803946"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1197"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1198"></a><span>    </span><a name="local-6989586621679803943"><a href="#local-6989586621679803943"><span class="hs-identifier">loc'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621679803939"><span class="hs-identifier hs-var">e12</span></a><span> </span><a href="#local-6989586621679803942"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1199"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679803944"><a href="#local-6989586621679803944"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803945"><a href="#local-6989586621679803945"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679803938"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803941"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1200"></a><span>
</span><a name="line-1201"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1202"></a><span class="hs-comment">--      (- neg_arg) `op` e2</span><span>
</span><a name="line-1203"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621679803947"><a href="#local-6989586621679803947"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a name="local-6989586621679803948"><a href="#local-6989586621679803948"><span class="hs-identifier">neg_arg</span></a></a><span> </span><a name="local-6989586621679803949"><a href="#local-6989586621679803949"><span class="hs-identifier">neg_name</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679803950"><a href="#local-6989586621679803950"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803951"><a href="#local-6989586621679803951"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621679803952"><a href="#local-6989586621679803952"><span class="hs-identifier">e2</span></a></a><span>
</span><a name="line-1204"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803954"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1205"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span class="hs-special">,</span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803950"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621679803951"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1206"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679803947"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679803950"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803951"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803952"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>
</span><a name="line-1208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803955"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1209"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679803956"><a href="#local-6989586621679803956"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span> </span><a href="#local-6989586621679803948"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621679803950"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803951"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803952"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1210"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803953"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621679803956"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679803949"><span class="hs-identifier hs-var">neg_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1211"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1212"></a><span>    </span><a name="local-6989586621679803953"><a href="#local-6989586621679803953"><span class="hs-identifier">loc'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621679803948"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621679803952"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1213"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679803954"><a href="#local-6989586621679803954"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803955"><a href="#local-6989586621679803955"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span> </span><a href="#local-6989586621679803951"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1214"></a><span>
</span><a name="line-1215"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1216"></a><span class="hs-comment">--      e1 `op` - neg_arg</span><span>
</span><a name="line-1217"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621679803957"><a href="#local-6989586621679803957"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679803958"><a href="#local-6989586621679803958"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679803959"><a href="#local-6989586621679803959"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621679803960"><a href="#local-6989586621679803960"><span class="hs-identifier">e2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- NegApp can occur on the right</span><span>
</span><a name="line-1218"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803961"><span class="hs-identifier hs-var">associate_right</span></a><span>                 </span><span class="hs-comment">-- We *want* right association</span><span>
</span><a name="line-1219"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803958"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803959"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1220"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679803957"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679803958"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679803959"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803960"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1221"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1222"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679803961"><a href="#local-6989586621679803961"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679803959"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1225"></a><span class="hs-comment">--      Default case</span><span>
</span><a name="line-1226"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621679803962"><a href="#local-6989586621679803962"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679803963"><a href="#local-6989586621679803963"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679803964"><a href="#local-6989586621679803964"><span class="hs-identifier">fix</span></a></a><span> </span><a name="local-6989586621679803965"><a href="#local-6989586621679803965"><span class="hs-identifier">e2</span></a></a><span>                  </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1227"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#right_op_ok"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-identifier">e2</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1228"></a><span>             </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">e1</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">op</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">e2</span><span>
</span><a name="line-1229"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-1230"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679803962"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679803963"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679803964"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621679803965"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1231"></a><span>
</span><a name="line-1232"></a><span class="hs-comment">----------------------------</span><span>
</span><a name="line-1233"></a><span>
</span><a name="line-1234"></a><span class="hs-comment">-- | Name of an operator in an operator application or section</span><span>
</span><a name="line-1235"></a><span class="hs-keyword">data</span><span> </span><a name="OpName"><a href="RnTypes.html#OpName"><span class="hs-identifier">OpName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NormalOp"><a href="RnTypes.html#NormalOp"><span class="hs-identifier">NormalOp</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>         </span><span class="hs-comment">-- ^ A normal identifier</span><span>
</span><a name="line-1236"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="NegateOp"><a href="RnTypes.html#NegateOp"><span class="hs-identifier">NegateOp</span></a></a><span>              </span><span class="hs-comment">-- ^ Prefix negation</span><span>
</span><a name="line-1237"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="UnboundOp"><a href="RnTypes.html#UnboundOp"><span class="hs-identifier">UnboundOp</span></a></a><span> </span><a href="HsExpr.html#UnboundVar"><span class="hs-identifier hs-type">UnboundVar</span></a><span>  </span><span class="hs-comment">-- ^ An unbound indentifier</span><span>
</span><a name="line-1238"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="RecFldOp"><a href="RnTypes.html#RecFldOp"><span class="hs-identifier">RecFldOp</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AmbiguousFieldOcc"><span class="hs-identifier hs-type">AmbiguousFieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1239"></a><span>              </span><span class="hs-comment">-- ^ A (possibly ambiguous) record field occurrence</span><span>
</span><a name="line-1240"></a><span>
</span><a name="line-1241"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1242"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a name="local-6989586621679803332"><a href="#local-6989586621679803332"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803332"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1243"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="PrelNames.html#negateName"><span class="hs-identifier hs-var">negateName</span></a><span>
</span><a name="line-1244"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a name="local-6989586621679803333"><a href="#local-6989586621679803333"><span class="hs-identifier">uv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803333"><span class="hs-identifier hs-var">uv</span></a><span>
</span><a name="line-1245"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a name="local-6989586621679803334"><a href="#local-6989586621679803334"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803334"><span class="hs-identifier hs-var">fld</span></a><span>
</span><a name="line-1246"></a><span>
</span><a name="line-1247"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span>
</span><a name="line-1248"></a><span class="hs-comment">-- An unbound name could be either HsVar or HsUnboundVar</span><span>
</span><a name="line-1249"></a><span class="hs-comment">-- See RnExpr.rnUnboundVar</span><span>
</span><a name="line-1250"></a><a name="get_op"><a href="RnTypes.html#get_op"><span class="hs-identifier">get_op</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803966"><a href="#local-6989586621679803966"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621679803966"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1251"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a><span> </span><a name="local-6989586621679803967"><a href="#local-6989586621679803967"><span class="hs-identifier">uv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a href="#local-6989586621679803967"><span class="hs-identifier hs-var">uv</span></a><span>
</span><a name="line-1252"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a><span> </span><a name="local-6989586621679803968"><a href="#local-6989586621679803968"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a href="#local-6989586621679803968"><span class="hs-identifier hs-var">fld</span></a><span>
</span><a name="line-1253"></a><span class="hs-identifier">get_op</span><span> </span><a name="local-6989586621679803969"><a href="#local-6989586621679803969"><span class="hs-identifier">other</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;get_op&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679803969"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span class="hs-comment">-- Parser left-associates everything, but</span><span>
</span><a name="line-1256"></a><span class="hs-comment">-- derived instances may have correctly-associated things to</span><span>
</span><a name="line-1257"></a><span class="hs-comment">-- in the right operand.  So we just check that the right operand is OK</span><span>
</span><a name="line-1258"></a><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1259"></a><a name="right_op_ok"><a href="RnTypes.html#right_op_ok"><span class="hs-identifier">right_op_ok</span></a></a><span> </span><a name="local-6989586621679803970"><a href="#local-6989586621679803970"><span class="hs-identifier">fix1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803971"><a href="#local-6989586621679803971"><span class="hs-identifier">fix2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679803972"><span class="hs-identifier hs-var">error_please</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679803973"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1261"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1262"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679803972"><a href="#local-6989586621679803972"><span class="hs-identifier">error_please</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803973"><a href="#local-6989586621679803973"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679803970"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803971"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1263"></a><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1264"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1265"></a><span>
</span><a name="line-1266"></a><span class="hs-comment">-- Parser initially makes negation bind more tightly than any other operator</span><span>
</span><a name="line-1267"></a><span class="hs-comment">-- And &quot;deriving&quot; code should respect this (use HsPar if not)</span><span>
</span><a name="line-1268"></a><span class="hs-identifier">mkNegAppRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679803344"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="#local-6989586621679803344"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679803344"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1269"></a><a name="mkNegAppRn"><a href="RnTypes.html#mkNegAppRn"><span class="hs-identifier">mkNegAppRn</span></a></a><span> </span><a name="local-6989586621679803974"><a href="#local-6989586621679803974"><span class="hs-identifier">neg_arg</span></a></a><span> </span><a name="local-6989586621679803975"><a href="#local-6989586621679803975"><span class="hs-identifier">neg_name</span></a></a><span>
</span><a name="line-1270"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">neg_arg</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a href="#local-6989586621679803974"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621679803975"><span class="hs-identifier hs-var">neg_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679803343"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1274"></a><a name="not_op_app"><a href="RnTypes.html#not_op_app"><span class="hs-identifier">not_op_app</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1275"></a><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1276"></a><span>
</span><a name="line-1277"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1278"></a><span class="hs-identifier">mkOpFormRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>            </span><span class="hs-comment">-- Left operand; already rearranged</span><span>
</span><a name="line-1279"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>     </span><span class="hs-comment">-- Operator and fixity</span><span>
</span><a name="line-1280"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>             </span><span class="hs-comment">-- Right operand (not an infix)</span><span>
</span><a name="line-1281"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-comment">-- (e11 `op1` e12) `op2` e2</span><span>
</span><a name="line-1284"></a><a name="mkOpFormRn"><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier">mkOpFormRn</span></a></a><span> </span><a name="local-6989586621679803976"><a href="#local-6989586621679803976"><span class="hs-identifier">a1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803977"><a href="#local-6989586621679803977"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a name="local-6989586621679803978"><a href="#local-6989586621679803978"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679803979"><a href="#local-6989586621679803979"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679803980"><a href="#local-6989586621679803980"><span class="hs-identifier">fix1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1285"></a><span>                                     </span><span class="hs-special">[</span><a name="local-6989586621679803981"><a href="#local-6989586621679803981"><span class="hs-identifier">a11</span></a></a><span class="hs-special">,</span><a name="local-6989586621679803982"><a href="#local-6989586621679803982"><span class="hs-identifier">a12</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1286"></a><span>        </span><a name="local-6989586621679803983"><a href="#local-6989586621679803983"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803984"><a href="#local-6989586621679803984"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621679803985"><a href="#local-6989586621679803985"><span class="hs-identifier">a2</span></a></a><span>
</span><a name="line-1287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803986"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1288"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803978"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621679803980"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679803983"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621679803984"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1289"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621679803983"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803979"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803984"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803976"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803985"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1290"></a><span>
</span><a name="line-1291"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679803987"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1292"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679803988"><a href="#local-6989586621679803988"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier hs-var">mkOpFormRn</span></a><span> </span><a href="#local-6989586621679803982"><span class="hs-identifier hs-var">a12</span></a><span> </span><a href="#local-6989586621679803983"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803984"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803985"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-1293"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621679803978"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679803979"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803980"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1294"></a><span>               </span><span class="hs-special">[</span><a href="#local-6989586621679803981"><span class="hs-identifier hs-var">a11</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803977"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803977"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679803988"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span>               </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1296"></a><span>        </span><span class="hs-comment">-- TODO: locs are wrong</span><span>
</span><a name="line-1297"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1298"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679803986"><a href="#local-6989586621679803986"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679803987"><a href="#local-6989586621679803987"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679803980"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803984"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span class="hs-comment">--      Default case</span><span>
</span><a name="line-1301"></a><span class="hs-identifier">mkOpFormRn</span><span> </span><a name="local-6989586621679803989"><a href="#local-6989586621679803989"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621679803990"><a href="#local-6989586621679803990"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679803991"><a href="#local-6989586621679803991"><span class="hs-identifier">fix</span></a></a><span> </span><a name="local-6989586621679803992"><a href="#local-6989586621679803992"><span class="hs-identifier">arg2</span></a></a><span>                     </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1302"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621679803990"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679803991"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679803989"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803992"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1303"></a><span>
</span><a name="line-1304"></a><span>
</span><a name="line-1305"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-1306"></a><span class="hs-identifier">mkConOpPatRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1307"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1308"></a><span>
</span><a name="line-1309"></a><a name="mkConOpPatRn"><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier">mkConOpPatRn</span></a></a><span> </span><a name="local-6989586621679803993"><a href="#local-6989586621679803993"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679803994"><a href="#local-6989586621679803994"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621679803995"><a href="#local-6989586621679803995"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679803996"><a href="#local-6989586621679803996"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-6989586621679803997"><a href="#local-6989586621679803997"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621679803998"><a href="#local-6989586621679803998"><span class="hs-identifier">p11</span></a></a><span> </span><a name="local-6989586621679803999"><a href="#local-6989586621679803999"><span class="hs-identifier">p12</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804000"><a href="#local-6989586621679804000"><span class="hs-identifier">p2</span></a></a><span>
</span><a name="line-1310"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679804001"><a href="#local-6989586621679804001"><span class="hs-identifier">fix1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803997"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1311"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679804002"><a href="#local-6989586621679804002"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679804003"><a href="#local-6989586621679804003"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621679804001"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621679803994"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1312"></a><span>
</span><a name="line-1313"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679804002"><span class="hs-identifier hs-var">nofix_error</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1314"></a><span>                </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803997"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679804001"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1315"></a><span>                               </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679803993"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679803994"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1316"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621679803993"><span class="hs-identifier hs-var">op2</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679803995"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679804000"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1317"></a><span>
</span><a name="line-1318"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679804003"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1319"></a><span>                </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679804004"><a href="#local-6989586621679804004"><span class="hs-identifier">new_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier hs-var">mkConOpPatRn</span></a><span> </span><a href="#local-6989586621679803993"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679803994"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621679803999"><span class="hs-identifier hs-var">p12</span></a><span> </span><a href="#local-6989586621679804000"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1320"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621679803997"><span class="hs-identifier hs-var">op1</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679803998"><span class="hs-identifier hs-var">p11</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679803996"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679804004"><span class="hs-identifier hs-var">new_p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- XXX loc right?</span><span>
</span><a name="line-1321"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621679803993"><span class="hs-identifier hs-var">op2</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679803995"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679804000"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span class="hs-identifier">mkConOpPatRn</span><span> </span><a name="local-6989586621679804005"><a href="#local-6989586621679804005"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804006"><a href="#local-6989586621679804006"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679804007"><a href="#local-6989586621679804007"><span class="hs-identifier">p2</span></a></a><span>                         </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><a href="RnTypes.html#not_op_pat"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621679804005"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679804006"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679804007"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1326"></a><span>
</span><a name="line-1327"></a><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1328"></a><a name="not_op_pat"><a href="RnTypes.html#not_op_pat"><span class="hs-identifier">not_op_pat</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1329"></a><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1330"></a><span>
</span><a name="line-1331"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-1332"></a><span class="hs-identifier">checkPrecMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679803342"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1333"></a><span>  </span><span class="hs-comment">-- Check precedence of a function binding written infix</span><span>
</span><a name="line-1334"></a><span>  </span><span class="hs-comment">--   eg  a `op` b `C` c = ...</span><span>
</span><a name="line-1335"></a><span>  </span><span class="hs-comment">-- See comments with rnExpr (OpApp ...) about &quot;deriving&quot;</span><span>
</span><a name="line-1336"></a><span>
</span><a name="line-1337"></a><a name="checkPrecMatch"><a href="RnTypes.html#checkPrecMatch"><span class="hs-identifier">checkPrecMatch</span></a></a><span> </span><a name="local-6989586621679804008"><a href="#local-6989586621679804008"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804009"><a href="#local-6989586621679804009"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1338"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-6989586621679804010"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621679804009"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1339"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1340"></a><span>    </span><a name="local-6989586621679804010"><a href="#local-6989586621679804010"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679804011"><a href="#local-6989586621679804011"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679804012"><a href="#local-6989586621679804012"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679804013"><a href="#local-6989586621679804013"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679804014"><a href="#local-6989586621679804014"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1341"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621679804011"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679804013"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1342"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#checkPrec"><span class="hs-identifier hs-var">checkPrec</span></a><span> </span><a href="#local-6989586621679804008"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679804012"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1343"></a><span>           </span><a href="RnTypes.html#checkPrec"><span class="hs-identifier hs-var">checkPrec</span></a><span> </span><a href="#local-6989586621679804008"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679804014"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1346"></a><span>        </span><span class="hs-comment">-- This can happen.  Consider</span><span>
</span><a name="line-1347"></a><span>        </span><span class="hs-comment">--      a `op` True = ...</span><span>
</span><a name="line-1348"></a><span>        </span><span class="hs-comment">--      op          = ...</span><span>
</span><a name="line-1349"></a><span>        </span><span class="hs-comment">-- The infix flag comes from the first binding of the group</span><span>
</span><a name="line-1350"></a><span>        </span><span class="hs-comment">-- but the second eqn has no args (an error, but not discovered</span><span>
</span><a name="line-1351"></a><span>        </span><span class="hs-comment">-- until the type checker).  So we don't want to crash on the</span><span>
</span><a name="line-1352"></a><span>        </span><span class="hs-comment">-- second eqn.</span><span>
</span><a name="line-1353"></a><span>
</span><a name="line-1354"></a><span class="hs-identifier">checkPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1355"></a><a name="checkPrec"><a href="RnTypes.html#checkPrec"><span class="hs-identifier">checkPrec</span></a></a><span> </span><a name="local-6989586621679804015"><a href="#local-6989586621679804015"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-6989586621679804016"><a href="#local-6989586621679804016"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804017"><a href="#local-6989586621679804017"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1356"></a><span>    </span><a name="local-6989586621679804018"><a href="#local-6989586621679804018"><span class="hs-identifier">op_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804019"><a href="#local-6989586621679804019"><span class="hs-identifier">op_prec</span></a></a><span>  </span><a name="local-6989586621679804020"><a href="#local-6989586621679804020"><span class="hs-identifier">op_dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="#local-6989586621679804015"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1357"></a><span>    </span><a name="local-6989586621679804021"><a href="#local-6989586621679804021"><span class="hs-identifier">op1_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804022"><a href="#local-6989586621679804022"><span class="hs-identifier">op1_prec</span></a></a><span> </span><a name="local-6989586621679804023"><a href="#local-6989586621679804023"><span class="hs-identifier">op1_dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679804016"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1358"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-1359"></a><span>        </span><a name="local-6989586621679804024"><a href="#local-6989586621679804024"><span class="hs-identifier">inf_ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804022"><span class="hs-identifier hs-var">op1_prec</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679804019"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1360"></a><span>                 </span><span class="hs-special">(</span><a href="#local-6989586621679804022"><span class="hs-identifier hs-var">op1_prec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679804019"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1361"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621679804023"><span class="hs-identifier hs-var">op1_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804020"><span class="hs-identifier hs-var">op_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804017"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1362"></a><span>                   </span><a href="#local-6989586621679804023"><span class="hs-identifier hs-var">op1_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804020"><span class="hs-identifier hs-var">op_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679804017"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1363"></a><span>
</span><a name="line-1364"></a><span>        </span><a name="local-6989586621679804025"><a href="#local-6989586621679804025"><span class="hs-identifier">info</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621679804015"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span>          </span><a href="#local-6989586621679804018"><span class="hs-identifier hs-var">op_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1365"></a><span>        </span><a name="local-6989586621679804026"><a href="#local-6989586621679804026"><span class="hs-identifier">info1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679804016"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804021"><span class="hs-identifier hs-var">op1_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1366"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679804027"><a href="#local-6989586621679804027"><span class="hs-identifier">infol</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679804028"><a href="#local-6989586621679804028"><span class="hs-identifier">infor</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679804017"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804025"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804026"><span class="hs-identifier hs-var">info1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804026"><span class="hs-identifier hs-var">info1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804025"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679804024"><span class="hs-identifier hs-var">inf_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><a href="#local-6989586621679804027"><span class="hs-identifier hs-var">infol</span></a><span> </span><a href="#local-6989586621679804028"><span class="hs-identifier hs-var">infor</span></a><span class="hs-special">)</span><span>
</span><a name="line-1368"></a><span>
</span><a name="line-1369"></a><span class="hs-identifier">checkPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1370"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><span class="hs-comment">-- Check precedence of (arg op) or (op arg) respectively</span><span>
</span><a name="line-1373"></a><span class="hs-comment">-- If arg is itself an operator application, then either</span><span>
</span><a name="line-1374"></a><span class="hs-comment">--   (a) its precedence must be higher than that of op</span><span>
</span><a name="line-1375"></a><span class="hs-comment">--   (b) its precedency &amp; associativity must be the same as that of op</span><span>
</span><a name="line-1376"></a><span class="hs-identifier">checkSectionPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#FixityDirection"><span class="hs-identifier hs-type">FixityDirection</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1377"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1378"></a><a name="checkSectionPrec"><a href="RnTypes.html#checkSectionPrec"><span class="hs-identifier">checkSectionPrec</span></a></a><span> </span><a name="local-6989586621679804029"><a href="#local-6989586621679804029"><span class="hs-identifier">direction</span></a></a><span> </span><a name="local-6989586621679804030"><a href="#local-6989586621679804030"><span class="hs-identifier">section</span></a></a><span> </span><a name="local-6989586621679804031"><a href="#local-6989586621679804031"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679804032"><a href="#local-6989586621679804032"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679804032"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1380"></a><span>        </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804041"><a href="#local-6989586621679804041"><span class="hs-identifier">op'</span></a></a><span> </span><a name="local-6989586621679804042"><a href="#local-6989586621679804042"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679804034"><span class="hs-identifier hs-var">go_for_it</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679804041"><span class="hs-identifier hs-var">op'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804042"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-1381"></a><span>        </span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679804034"><span class="hs-identifier hs-var">go_for_it</span></a><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>     </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span>
</span><a name="line-1382"></a><span>        </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1383"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1384"></a><span>    </span><a name="local-6989586621679804033"><a href="#local-6989586621679804033"><span class="hs-identifier">op_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679804031"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1385"></a><span>    </span><a name="local-6989586621679804034"><a href="#local-6989586621679804034"><span class="hs-identifier">go_for_it</span></a></a><span> </span><a name="local-6989586621679804035"><a href="#local-6989586621679804035"><span class="hs-identifier">arg_op</span></a></a><span> </span><a name="local-6989586621679804036"><a href="#local-6989586621679804036"><span class="hs-identifier">arg_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804037"><a href="#local-6989586621679804037"><span class="hs-identifier">arg_prec</span></a></a><span> </span><a name="local-6989586621679804038"><a href="#local-6989586621679804038"><span class="hs-identifier">assoc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1386"></a><span>          </span><a name="local-6989586621679804039"><a href="#local-6989586621679804039"><span class="hs-identifier">op_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804040"><a href="#local-6989586621679804040"><span class="hs-identifier">op_prec</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#lookupFixityOp"><span class="hs-identifier hs-var">lookupFixityOp</span></a><span> </span><a href="#local-6989586621679804033"><span class="hs-identifier hs-var">op_name</span></a><span>
</span><a name="line-1387"></a><span>          </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804040"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679804037"><span class="hs-identifier hs-var">arg_prec</span></a><span>
</span><a name="line-1388"></a><span>                  </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804040"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679804037"><span class="hs-identifier hs-var">arg_prec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804029"><span class="hs-identifier hs-var">direction</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679804038"><span class="hs-identifier hs-var">assoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><span>                 </span><span class="hs-special">(</span><a href="RnTypes.html#sectionPrecErr"><span class="hs-identifier hs-var">sectionPrecErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621679804031"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804039"><span class="hs-identifier hs-var">op_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1390"></a><span>                                 </span><span class="hs-special">(</span><a href="#local-6989586621679804035"><span class="hs-identifier hs-var">arg_op</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804036"><span class="hs-identifier hs-var">arg_fix</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804030"><span class="hs-identifier hs-var">section</span></a><span class="hs-special">)</span><span>
</span><a name="line-1391"></a><span>
</span><a name="line-1392"></a><span class="hs-comment">-- | Look up the fixity for an operator name.  Be careful to use</span><span>
</span><a name="line-1393"></a><span class="hs-comment">-- 'lookupFieldFixityRn' for (possibly ambiguous) record fields</span><span>
</span><a name="line-1394"></a><span class="hs-comment">-- (see Trac #13132).</span><span>
</span><a name="line-1395"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1396"></a><a name="lookupFixityOp"><a href="RnTypes.html#lookupFixityOp"><span class="hs-identifier">lookupFixityOp</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a name="local-6989586621679804043"><a href="#local-6989586621679804043"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="#local-6989586621679804043"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1397"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="PrelNames.html#negateName"><span class="hs-identifier hs-var">negateName</span></a><span>
</span><a name="line-1398"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a name="local-6989586621679804044"><a href="#local-6989586621679804044"><span class="hs-identifier">u</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="PrelNames.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#unboundVarOcc"><span class="hs-identifier hs-var">unboundVarOcc</span></a><span> </span><a href="#local-6989586621679804044"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1399"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a name="local-6989586621679804045"><a href="#local-6989586621679804045"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFieldFixityRn"><span class="hs-identifier hs-var">lookupFieldFixityRn</span></a><span> </span><a href="#local-6989586621679804045"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1400"></a><span>
</span><a name="line-1401"></a><span>
</span><a name="line-1402"></a><span class="hs-comment">-- Precedence-related error messages</span><span>
</span><a name="line-1403"></a><span>
</span><a name="line-1404"></a><span class="hs-identifier">precParseErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1405"></a><a name="precParseErr"><a href="RnTypes.html#precParseErr"><span class="hs-identifier">precParseErr</span></a></a><span> </span><a name="local-6989586621679804046"><a href="#local-6989586621679804046"><span class="hs-identifier">op1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679804047"><a href="#local-6989586621679804047"><span class="hs-identifier">n1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804048"><a href="#local-6989586621679804048"><span class="hs-identifier">op2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679804049"><a href="#local-6989586621679804049"><span class="hs-identifier">n2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1406"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621679804047"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621679804049"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-1407"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><a name="line-1408"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1409"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Precedence parsing error&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1410"></a><span>      </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;cannot mix&quot;</span><span class="hs-special">,</span><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621679804046"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;and&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1411"></a><span>               </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621679804048"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1412"></a><span>               </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the same infix expression&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><span>
</span><a name="line-1414"></a><span class="hs-identifier">sectionPrecErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1415"></a><a name="sectionPrecErr"><a href="RnTypes.html#sectionPrecErr"><span class="hs-identifier">sectionPrecErr</span></a></a><span> </span><a name="local-6989586621679804050"><a href="#local-6989586621679804050"><span class="hs-identifier">op</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679804051"><a href="#local-6989586621679804051"><span class="hs-identifier">n1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804052"><a href="#local-6989586621679804052"><span class="hs-identifier">arg_op</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679804053"><a href="#local-6989586621679804053"><span class="hs-identifier">n2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804054"><a href="#local-6989586621679804054"><span class="hs-identifier">section</span></a></a><span>
</span><a name="line-1416"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621679804051"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621679804053"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-1417"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><a name="line-1418"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1419"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The operator&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621679804050"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;of a section&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1420"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;must have lower precedence than that of the operand,&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1421"></a><span>                      </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;namely&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621679804052"><span class="hs-identifier hs-var">arg_op</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1422"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the section:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804054"><span class="hs-identifier hs-var">section</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1423"></a><span>
</span><a name="line-1424"></a><span class="hs-identifier">is_unbound</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1425"></a><a name="is_unbound"><a href="RnTypes.html#is_unbound"><span class="hs-identifier">is_unbound</span></a></a><span> </span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1426"></a><span class="hs-identifier">is_unbound</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span class="hs-identifier">ppr_opfix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1429"></a><a name="ppr_opfix"><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier">ppr_opfix</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679804055"><a href="#local-6989586621679804055"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679804056"><a href="#local-6989586621679804056"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804057"><span class="hs-identifier hs-var">pp_op</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804056"><span class="hs-identifier hs-var">fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1430"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1431"></a><span>     </span><a name="local-6989586621679804057"><a href="#local-6989586621679804057"><span class="hs-identifier">pp_op</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679804055"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;prefix `-'&quot;</span><span>
</span><a name="line-1432"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804055"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-1433"></a><span>
</span><a name="line-1434"></a><span>
</span><a name="line-1435"></a><span class="hs-comment">{- *****************************************************
*                                                      *
                 Errors
*                                                      *
***************************************************** -}</span><span>
</span><a name="line-1440"></a><span>
</span><a name="line-1441"></a><span class="hs-identifier">unexpectedTypeSigErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1442"></a><a name="unexpectedTypeSigErr"><a href="RnTypes.html#unexpectedTypeSigErr"><span class="hs-identifier">unexpectedTypeSigErr</span></a></a><span> </span><a name="local-6989586621679804058"><a href="#local-6989586621679804058"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1443"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal type signature:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804058"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type signatures are only allowed in patterns with ScopedTypeVariables&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span>
</span><a name="line-1446"></a><span class="hs-identifier">badKindBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1447"></a><a name="badKindBndrs"><a href="RnTypes.html#badKindBndrs"><span class="hs-identifier">badKindBndrs</span></a></a><span> </span><a name="local-6989586621679804059"><a href="#local-6989586621679804059"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679804060"><a href="#local-6989586621679804060"><span class="hs-identifier">kvs</span></a></a><span>
</span><a name="line-1448"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span> </span><a href="#local-6989586621679804059"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1449"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected kind variable&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-6989586621679804060"><span class="hs-identifier hs-var">kvs</span></a><span>
</span><a name="line-1450"></a><span>                 </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-6989586621679804060"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use PolyKinds&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span>
</span><a name="line-1453"></a><span class="hs-identifier">badKindSigErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1454"></a><a name="badKindSigErr"><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier">badKindSigErr</span></a></a><span> </span><a name="local-6989586621679804061"><a href="#local-6989586621679804061"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679804062"><a href="#local-6989586621679804062"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679804063"><a href="#local-6989586621679804063"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1455"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621679804062"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1456"></a><span>    </span><a href="RnEnv.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span> </span><a href="#local-6989586621679804061"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1457"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind signature:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804063"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use KindSignatures&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>
</span><a name="line-1460"></a><span class="hs-identifier">dataKindsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1461"></a><a name="dataKindsErr"><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier">dataKindsErr</span></a></a><span> </span><a name="local-6989586621679804064"><a href="#local-6989586621679804064"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679804065"><a href="#local-6989586621679804065"><span class="hs-identifier">thing</span></a></a><span>
</span><a name="line-1462"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621679804066"><span class="hs-identifier hs-var">pp_what</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804065"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1463"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use DataKinds&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1464"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1465"></a><span>    </span><a name="local-6989586621679804066"><a href="#local-6989586621679804066"><span class="hs-identifier">pp_what</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621679804064"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1466"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1467"></a><span>
</span><a name="line-1468"></a><span class="hs-identifier">inTypeDoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1469"></a><a name="inTypeDoc"><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier">inTypeDoc</span></a></a><span> </span><a name="local-6989586621679804067"><a href="#local-6989586621679804067"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804067"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>
</span><a name="line-1471"></a><span class="hs-identifier">warnUnusedForAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><a name="warnUnusedForAll"><a href="RnTypes.html#warnUnusedForAll"><span class="hs-identifier">warnUnusedForAll</span></a></a><span> </span><a name="local-6989586621679804068"><a href="#local-6989586621679804068"><span class="hs-identifier">in_doc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679804069"><a href="#local-6989586621679804069"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679804070"><a href="#local-6989586621679804070"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679804071"><a href="#local-6989586621679804071"><span class="hs-identifier">used_names</span></a></a><span>
</span><a name="line-1473"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedForalls"><span class="hs-identifier hs-var">Opt_WarnUnusedForalls</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1474"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#hsTyVarName"><span class="hs-identifier hs-var">hsTyVarName</span></a><span> </span><a href="#local-6989586621679804070"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804071"><span class="hs-identifier hs-var">used_names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1475"></a><span>    </span><a href="TcRnMonad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedForalls"><span class="hs-identifier hs-var">Opt_WarnUnusedForalls</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804069"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1476"></a><span>    </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unused quantified type variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804070"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679804068"><span class="hs-identifier hs-var">in_doc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1478"></a><span>
</span><a name="line-1479"></a><span class="hs-identifier">opTyErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679803341"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679803341"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1480"></a><a name="opTyErr"><a href="RnTypes.html#opTyErr"><span class="hs-identifier">opTyErr</span></a></a><span> </span><a name="local-6989586621679804072"><a href="#local-6989586621679804072"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679804073"><a href="#local-6989586621679804073"><span class="hs-identifier">overall_ty</span></a></a><span>
</span><a name="line-1481"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal operator&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804072"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;in type&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804073"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1482"></a><span>         </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679804074"><span class="hs-identifier hs-var">extra</span></a><span>
</span><a name="line-1483"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1484"></a><span>    </span><a name="local-6989586621679804074"><a href="#local-6989586621679804074"><span class="hs-identifier">extra</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679804072"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#dot_tv_RDR"><span class="hs-identifier hs-var">dot_tv_RDR</span></a><span>
</span><a name="line-1485"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#perhapsForallMsg"><span class="hs-identifier hs-var">perhapsForallMsg</span></a><span>
</span><a name="line-1486"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1487"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use TypeOperators to allow operators in types&quot;</span><span>
</span><a name="line-1488"></a><span>
</span><a name="line-1489"></a><span class="hs-identifier">emptyNonSymsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1490"></a><a name="emptyNonSymsErr"><a href="RnTypes.html#emptyNonSymsErr"><span class="hs-identifier">emptyNonSymsErr</span></a></a><span> </span><a name="local-6989586621679804075"><a href="#local-6989586621679804075"><span class="hs-identifier">overall_ty</span></a></a><span>
</span><a name="line-1491"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Operator applied to too few arguments:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804075"><span class="hs-identifier hs-var">overall_ty</span></a><span>
</span><a name="line-1492"></a><span>
</span><a name="line-1493"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
      Finding the free type variables of a (HsType RdrName)
*                                                                      *
************************************************************************


Note [Kind and type-variable binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a type signature we may implicitly bind type variable and, more
recently, kind variables.  For example:
  *   f :: a -&gt; a
      f = ...
    Here we need to find the free type variables of (a -&gt; a),
    so that we know what to quantify

  *   class C (a :: k) where ...
    This binds 'k' in ..., as well as 'a'

  *   f (x :: a -&gt; [a]) = ....
    Here we bind 'a' in ....

  *   f (x :: T a -&gt; T (b :: k)) = ...
    Here we bind both 'a' and the kind variable 'k'

  *   type instance F (T (a :: Maybe k)) = ...a...k...
    Here we want to constrain the kind of 'a', and bind 'k'.

In general we want to walk over a type, and find
  * Its free type variables
  * The free kind variables of any kind signatures in the type

Hence we returns a pair (kind-vars, type vars)
See also Note [HsBSig binder lists] in HsTypes
-}</span><span>
</span><a name="line-1529"></a><span>
</span><a name="line-1530"></a><span class="hs-keyword">data</span><span> </span><a name="FreeKiTyVars"><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier">FreeKiTyVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FKTV"><a href="RnTypes.html#FKTV"><span class="hs-identifier">FKTV</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="fktv_kis"><a href="RnTypes.html#fktv_kis"><span class="hs-identifier">fktv_kis</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1531"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="_fktv_k_set"><a href="RnTypes.html#_fktv_k_set"><span class="hs-identifier">_fktv_k_set</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>  </span><span class="hs-comment">-- for efficiency,</span><span>
</span><a name="line-1532"></a><span>                                                  </span><span class="hs-comment">-- only used internally</span><span>
</span><a name="line-1533"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="fktv_tys"><a href="RnTypes.html#fktv_tys"><span class="hs-identifier">fktv_tys</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1534"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="_fktv_t_set"><a href="RnTypes.html#_fktv_t_set"><span class="hs-identifier">_fktv_t_set</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccSet"><span class="hs-identifier hs-type">OccSet</span></a><span>
</span><a name="line-1535"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="fktv_all"><a href="RnTypes.html#fktv_all"><span class="hs-identifier">fktv_all</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1536"></a><span>
</span><a name="line-1537"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1538"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679803330"><a href="#local-6989586621679803330"><span class="hs-identifier">kis</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679803331"><a href="#local-6989586621679803331"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803330"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679803331"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span class="hs-identifier">emptyFKTV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1541"></a><a name="emptyFKTV"><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier">emptyFKTV</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="OccName.html#emptyOccSet"><span class="hs-identifier hs-var">emptyOccSet</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="OccName.html#emptyOccSet"><span class="hs-identifier hs-var">emptyOccSet</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1542"></a><span>
</span><a name="line-1543"></a><span class="hs-identifier">freeKiTyVarsAllVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1544"></a><a name="freeKiTyVarsAllVars"><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier">freeKiTyVarsAllVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fktv_all</span><span>
</span><a name="line-1545"></a><span>
</span><a name="line-1546"></a><span class="hs-identifier">freeKiTyVarsKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1547"></a><a name="freeKiTyVarsKindVars"><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier">freeKiTyVarsKindVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fktv_kis</span><span>
</span><a name="line-1548"></a><span>
</span><a name="line-1549"></a><span class="hs-identifier">freeKiTyVarsTypeVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1550"></a><a name="freeKiTyVarsTypeVars"><a href="RnTypes.html#freeKiTyVarsTypeVars"><span class="hs-identifier">freeKiTyVarsTypeVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fktv_tys</span><span>
</span><a name="line-1551"></a><span>
</span><a name="line-1552"></a><span class="hs-identifier">filterInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1553"></a><a name="filterInScope"><a href="RnTypes.html#filterInScope"><span class="hs-identifier">filterInScope</span></a></a><span> </span><a name="local-6989586621679804076"><a href="#local-6989586621679804076"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804077"><a href="#local-6989586621679804077"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621679804078"><a href="#local-6989586621679804078"><span class="hs-identifier">k_set</span></a></a><span> </span><a name="local-6989586621679804079"><a href="#local-6989586621679804079"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679804080"><a href="#local-6989586621679804080"><span class="hs-identifier">t_set</span></a></a><span> </span><a name="local-6989586621679804081"><a href="#local-6989586621679804081"><span class="hs-identifier">all</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1554"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621679804082"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621679804077"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">)</span><span>
</span><a name="line-1555"></a><span>         </span><span class="hs-special">(</span><a href="OccName.html#filterOccSet"><span class="hs-identifier hs-var">filterOccSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679804083"><span class="hs-identifier hs-var">in_scope_occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804078"><span class="hs-identifier hs-var">k_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1556"></a><span>         </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621679804082"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621679804079"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1557"></a><span>         </span><span class="hs-special">(</span><a href="OccName.html#filterOccSet"><span class="hs-identifier hs-var">filterOccSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679804083"><span class="hs-identifier hs-var">in_scope_occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804080"><span class="hs-identifier hs-var">t_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1558"></a><span>         </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621679804082"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621679804081"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span>
</span><a name="line-1559"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1560"></a><span>    </span><a name="local-6989586621679804082"><a href="#local-6989586621679804082"><span class="hs-identifier">in_scope</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#inScope"><span class="hs-identifier hs-var">inScope</span></a><span> </span><a href="#local-6989586621679804076"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-1561"></a><span>    </span><a name="local-6989586621679804083"><a href="#local-6989586621679804083"><span class="hs-identifier">in_scope_occ</span></a></a><span> </span><a name="local-6989586621679804084"><a href="#local-6989586621679804084"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RdrName.html#lookupLocalRdrOcc"><span class="hs-identifier hs-var">lookupLocalRdrOcc</span></a><span> </span><a href="#local-6989586621679804076"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621679804084"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1562"></a><span>
</span><a name="line-1563"></a><span class="hs-identifier">inScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1564"></a><a name="inScope"><a href="RnTypes.html#inScope"><span class="hs-identifier">inScope</span></a></a><span> </span><a name="local-6989586621679804085"><a href="#local-6989586621679804085"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-6989586621679804086"><a href="#local-6989586621679804086"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804086"><span class="hs-identifier hs-var">rdr</span></a><span> </span><span class="hs-special">`</span><a href="RdrName.html#elemLocalRdrEnv"><span class="hs-identifier hs-var">elemLocalRdrEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804085"><span class="hs-identifier hs-var">rdr_env</span></a><span>
</span><a name="line-1565"></a><span>
</span><a name="line-1566"></a><span class="hs-identifier">extractHsTyRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1567"></a><span class="hs-comment">-- extractHsTyRdrNames finds the free (kind, type) variables of a HsType</span><span>
</span><a name="line-1568"></a><span class="hs-comment">--                        or the free (sort, kind) variables of a HsKind</span><span>
</span><a name="line-1569"></a><span class="hs-comment">-- It's used when making the for-alls explicit.</span><span>
</span><a name="line-1570"></a><span class="hs-comment">-- Does not return any wildcards</span><span>
</span><a name="line-1571"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, only the first</span><span>
</span><a name="line-1572"></a><span class="hs-comment">-- occurrence is returned.</span><span>
</span><a name="line-1573"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1574"></a><a name="extractHsTyRdrTyVars"><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier">extractHsTyRdrTyVars</span></a></a><span> </span><a name="local-6989586621679804087"><a href="#local-6989586621679804087"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1575"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804088"><a href="#local-6989586621679804088"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621679804089"><a href="#local-6989586621679804089"><span class="hs-identifier">k_set</span></a></a><span> </span><a name="local-6989586621679804090"><a href="#local-6989586621679804090"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679804091"><a href="#local-6989586621679804091"><span class="hs-identifier">t_set</span></a></a><span> </span><a name="local-6989586621679804092"><a href="#local-6989586621679804092"><span class="hs-identifier">all</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621679804087"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1576"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804088"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804089"><span class="hs-identifier hs-var">k_set</span></a><span>
</span><a name="line-1577"></a><span>                      </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804090"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804091"><span class="hs-identifier hs-var">t_set</span></a><span>
</span><a name="line-1578"></a><span>                      </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804092"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1579"></a><span>
</span><a name="line-1580"></a><span class="hs-comment">-- | Extracts free type and kind variables from types in a list.</span><span>
</span><a name="line-1581"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, only the first</span><span>
</span><a name="line-1582"></a><span class="hs-comment">-- occurrence is returned and the rest is filtered out.</span><span>
</span><a name="line-1583"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1584"></a><span class="hs-identifier">extractHsTysRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1585"></a><a name="extractHsTysRdrTyVars"><a href="RnTypes.html#extractHsTysRdrTyVars"><span class="hs-identifier">extractHsTysRdrTyVars</span></a></a><span> </span><a name="local-6989586621679804093"><a href="#local-6989586621679804093"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1586"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTysRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621679804093"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1587"></a><span>
</span><a name="line-1588"></a><span class="hs-comment">-- | Extracts free type and kind variables from types in a list.</span><span>
</span><a name="line-1589"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, all occurrences</span><span>
</span><a name="line-1590"></a><span class="hs-comment">-- are returned.</span><span>
</span><a name="line-1591"></a><span class="hs-identifier">extractHsTysRdrTyVarsDups</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1592"></a><a name="extractHsTysRdrTyVarsDups"><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier">extractHsTysRdrTyVarsDups</span></a></a><span> </span><a name="local-6989586621679804094"><a href="#local-6989586621679804094"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1593"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621679804094"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1594"></a><span>
</span><a name="line-1595"></a><span class="hs-comment">-- | Removes multiple occurrences of the same name from FreeKiTyVars.</span><span>
</span><a name="line-1596"></a><span class="hs-identifier">rmDupsInRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1597"></a><a name="rmDupsInRdrTyVars"><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier">rmDupsInRdrTyVars</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804095"><a href="#local-6989586621679804095"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621679804096"><a href="#local-6989586621679804096"><span class="hs-identifier">k_set</span></a></a><span> </span><a name="local-6989586621679804097"><a href="#local-6989586621679804097"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679804098"><a href="#local-6989586621679804098"><span class="hs-identifier">t_set</span></a></a><span> </span><a name="local-6989586621679804099"><a href="#local-6989586621679804099"><span class="hs-identifier">all</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1598"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804095"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804096"><span class="hs-identifier hs-var">k_set</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804097"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804098"><span class="hs-identifier hs-var">t_set</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621679804099"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span>
</span><a name="line-1599"></a><span>
</span><a name="line-1600"></a><span class="hs-identifier">extractRdrKindSigVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LFamilyResultSig"><span class="hs-identifier hs-type">LFamilyResultSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1601"></a><a name="extractRdrKindSigVars"><a href="RnTypes.html#extractRdrKindSigVars"><span class="hs-identifier">extractRdrKindSigVars</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804100"><a href="#local-6989586621679804100"><span class="hs-identifier">resultSig</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1602"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HsDecls.html#KindSig"><span class="hs-identifier hs-var">KindSig</span></a><span> </span><a name="local-6989586621679804103"><a href="#local-6989586621679804103"><span class="hs-identifier">k</span></a></a><span>                        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679804100"><span class="hs-identifier hs-var">resultSig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804101"><span class="hs-identifier hs-var">kindRdrNameFromSig</span></a><span> </span><a href="#local-6989586621679804103"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1603"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HsDecls.html#TyVarSig"><span class="hs-identifier hs-var">TyVarSig</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804104"><a href="#local-6989586621679804104"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679804100"><span class="hs-identifier hs-var">resultSig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804101"><span class="hs-identifier hs-var">kindRdrNameFromSig</span></a><span> </span><a href="#local-6989586621679804104"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1604"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1605"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679804101"><a href="#local-6989586621679804101"><span class="hs-identifier">kindRdrNameFromSig</span></a></a><span> </span><a name="local-6989586621679804102"><a href="#local-6989586621679804102"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier hs-var">freeKiTyVarsAllVars</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621679804102"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1606"></a><span>
</span><a name="line-1607"></a><span class="hs-identifier">extractDataDefnKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1608"></a><span class="hs-comment">-- Get the scoped kind variables mentioned free in the constructor decls</span><span>
</span><a name="line-1609"></a><span class="hs-comment">-- Eg    data T a = T1 (S (a :: k) | forall (b::k). T2 (S b)</span><span>
</span><a name="line-1610"></a><span class="hs-comment">-- Here k should scope over the whole definition</span><span>
</span><a name="line-1611"></a><a name="extractDataDefnKindVars"><a href="RnTypes.html#extractDataDefnKindVars"><span class="hs-identifier">extractDataDefnKindVars</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-var">HsDataDefn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804105"><a href="#local-6989586621679804105"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804106"><a href="#local-6989586621679804106"><span class="hs-identifier">ksig</span></a></a><span>
</span><a name="line-1612"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804107"><a href="#local-6989586621679804107"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804108"><a href="#local-6989586621679804108"><span class="hs-identifier">derivs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1613"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1614"></a><span>    </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621679804105"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1615"></a><span>     </span><a href="RnTypes.html#extract_mb"><span class="hs-identifier hs-var">extract_mb</span></a><span> </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="#local-6989586621679804106"><span class="hs-identifier hs-var">ksig</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1616"></a><span>     </span><a href="RnTypes.html#extract_sig_tys"><span class="hs-identifier hs-var">extract_sig_tys</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">deriv_clause_tys</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804108"><span class="hs-identifier hs-var">derivs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1617"></a><span>     </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804109"><span class="hs-identifier hs-var">extract_con</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span> </span><a href="#local-6989586621679804107"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1618"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1619"></a><span>    </span><a name="local-6989586621679804109"><a href="#local-6989586621679804109"><span class="hs-identifier">extract_con</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclGADT"><span class="hs-identifier hs-var">ConDeclGADT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804110"><a href="#local-6989586621679804110"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804110"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1620"></a><span>    </span><span class="hs-identifier">extract_con</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_qvars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804111"><a href="#local-6989586621679804111"><span class="hs-identifier">qvs</span></a></a><span>
</span><a name="line-1621"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804112"><a href="#local-6989586621679804112"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804113"><a href="#local-6989586621679804113"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804114"><a href="#local-6989586621679804114"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1622"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="HsTypes.html#hsQTvExplicit"><span class="hs-identifier hs-var">hsQTvExplicit</span></a><span> </span><a href="#local-6989586621679804111"><span class="hs-identifier hs-var">qvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804114"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1623"></a><span>        </span><a href="RnTypes.html#extract_mlctxt"><span class="hs-identifier hs-var">extract_mlctxt</span></a><span> </span><a href="#local-6989586621679804112"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1624"></a><span>        </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#hsConDeclArgTys"><span class="hs-identifier hs-var">hsConDeclArgTys</span></a><span> </span><a href="#local-6989586621679804113"><span class="hs-identifier hs-var">details</span></a><span class="hs-special">)</span><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1625"></a><span>
</span><a name="line-1626"></a><span class="hs-identifier">extract_mlctxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1627"></a><a name="extract_mlctxt"><a href="RnTypes.html#extract_mlctxt"><span class="hs-identifier">extract_mlctxt</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><a name="local-6989586621679804115"><a href="#local-6989586621679804115"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804115"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1628"></a><span class="hs-identifier">extract_mlctxt</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679804116"><a href="#local-6989586621679804116"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679804117"><a href="#local-6989586621679804117"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621679804116"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679804117"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">extract_lctxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1631"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1632"></a><a name="extract_lctxt"><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier">extract_lctxt</span></a></a><span> </span><a name="local-6989586621679804118"><a href="#local-6989586621679804118"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621679804119"><a href="#local-6989586621679804119"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621679804118"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679804119"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1633"></a><span>
</span><a name="line-1634"></a><span class="hs-identifier">extract_sig_tys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1635"></a><a name="extract_sig_tys"><a href="RnTypes.html#extract_sig_tys"><span class="hs-identifier">extract_sig_tys</span></a></a><span> </span><a name="local-6989586621679804120"><a href="#local-6989586621679804120"><span class="hs-identifier">sig_tys</span></a></a><span> </span><a name="local-6989586621679804121"><a href="#local-6989586621679804121"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1636"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679804122"><a href="#local-6989586621679804122"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621679804123"><a href="#local-6989586621679804123"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#hsSigType"><span class="hs-identifier hs-var">hsSigType</span></a><span> </span><a href="#local-6989586621679804122"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804123"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1637"></a><span>           </span><a href="#local-6989586621679804121"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679804120"><span class="hs-identifier hs-var">sig_tys</span></a><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span class="hs-identifier">extract_ltys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1640"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1641"></a><a name="extract_ltys"><a href="RnTypes.html#extract_ltys"><span class="hs-identifier">extract_ltys</span></a></a><span> </span><a name="local-6989586621679804124"><a href="#local-6989586621679804124"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621679804125"><a href="#local-6989586621679804125"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679804126"><a href="#local-6989586621679804126"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804124"><span class="hs-identifier hs-var">t_or_k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804126"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679804125"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1642"></a><span>
</span><a name="line-1643"></a><span class="hs-identifier">extract_mb</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679803340"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1644"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679803340"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1645"></a><a name="extract_mb"><a href="RnTypes.html#extract_mb"><span class="hs-identifier">extract_mb</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><a name="local-6989586621679804127"><a href="#local-6989586621679804127"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804127"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1646"></a><span class="hs-identifier">extract_mb</span><span> </span><a name="local-6989586621679804128"><a href="#local-6989586621679804128"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679804129"><a href="#local-6989586621679804129"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679804130"><a href="#local-6989586621679804130"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679804128"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679804129"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679804130"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1647"></a><span>
</span><a name="line-1648"></a><span class="hs-identifier">extract_lkind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1649"></a><a name="extract_lkind"><a href="RnTypes.html#extract_lkind"><span class="hs-identifier">extract_lkind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span>
</span><a name="line-1650"></a><span>
</span><a name="line-1651"></a><span class="hs-identifier">extract_lty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1652"></a><a name="extract_lty"><a href="RnTypes.html#extract_lty"><span class="hs-identifier">extract_lty</span></a></a><span> </span><a name="local-6989586621679804131"><a href="#local-6989586621679804131"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804132"><a href="#local-6989586621679804132"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679804133"><a href="#local-6989586621679804133"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1653"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679804132"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1654"></a><span>      </span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621679804134"><a href="#local-6989586621679804134"><span class="hs-identifier">ltv</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804134"><span class="hs-identifier hs-var">ltv</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1655"></a><span>      </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804135"><a href="#local-6989586621679804135"><span class="hs-identifier">ty</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804135"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1656"></a><span>      </span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621679804136"><a href="#local-6989586621679804136"><span class="hs-identifier">flds</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span>
</span><a name="line-1657"></a><span>                                           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cd_fld_type</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1658"></a><span>                                         </span><a href="#local-6989586621679804136"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1659"></a><span>      </span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621679804137"><a href="#local-6989586621679804137"><span class="hs-identifier">tys</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_apps"><span class="hs-identifier hs-var">extract_apps</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804137"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1660"></a><span>      </span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621679804138"><a href="#local-6989586621679804138"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679804139"><a href="#local-6989586621679804139"><span class="hs-identifier">ty2</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804138"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1661"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804139"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1662"></a><span>      </span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621679804140"><a href="#local-6989586621679804140"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804140"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1663"></a><span>      </span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621679804141"><a href="#local-6989586621679804141"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804141"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1664"></a><span>      </span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804142"><a href="#local-6989586621679804142"><span class="hs-identifier">tys</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804142"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1665"></a><span>      </span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621679804143"><a href="#local-6989586621679804143"><span class="hs-identifier">tys</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804143"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1666"></a><span>      </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621679804144"><a href="#local-6989586621679804144"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679804145"><a href="#local-6989586621679804145"><span class="hs-identifier">ty2</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804144"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1667"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804145"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1668"></a><span>      </span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804146"><a href="#local-6989586621679804146"><span class="hs-identifier">ty</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804146"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1669"></a><span>      </span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621679804147"><a href="#local-6989586621679804147"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679804148"><a href="#local-6989586621679804148"><span class="hs-identifier">ty2</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804147"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1670"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804148"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1671"></a><span>      </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621679804149"><a href="#local-6989586621679804149"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679804150"><a href="#local-6989586621679804150"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679804151"><a href="#local-6989586621679804151"><span class="hs-identifier">ty2</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804150"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1672"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804149"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1673"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804151"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1674"></a><span>      </span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621679804152"><a href="#local-6989586621679804152"><span class="hs-identifier">ty</span></a></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804152"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1675"></a><span>      </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>  </span><span class="hs-comment">-- The type is closed</span><span>
</span><a name="line-1676"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>  </span><span class="hs-comment">-- Type splices mention no tvs</span><span>
</span><a name="line-1677"></a><span>      </span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621679804153"><a href="#local-6989586621679804153"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804153"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1678"></a><span>      </span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804154"><a href="#local-6989586621679804154"><span class="hs-identifier">tys</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804154"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1679"></a><span>      </span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804155"><a href="#local-6989586621679804155"><span class="hs-identifier">tys</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804155"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1680"></a><span>      </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1681"></a><span>      </span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621679804156"><a href="#local-6989586621679804156"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679804157"><a href="#local-6989586621679804157"><span class="hs-identifier">ki</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804156"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1682"></a><span>                                   </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="#local-6989586621679804157"><span class="hs-identifier hs-var">ki</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1683"></a><span>      </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804158"><a href="#local-6989586621679804158"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804159"><a href="#local-6989586621679804159"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1684"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs</span></a><span> </span><a href="#local-6989586621679804158"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1685"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804159"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1686"></a><span>      </span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804160"><a href="#local-6989586621679804160"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679804161"><a href="#local-6989586621679804161"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1687"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804160"><span class="hs-identifier hs-var">ctxt</span></a><span>   </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1688"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804131"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804161"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1689"></a><span>      </span><span class="hs-comment">-- We deal with these separately in rnLHsTypeWithWildCards</span><span>
</span><a name="line-1690"></a><span>      </span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804133"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1691"></a><span>
</span><a name="line-1692"></a><span class="hs-identifier">extract_apps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1693"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsAppType"><span class="hs-identifier hs-type">LHsAppType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1694"></a><a name="extract_apps"><a href="RnTypes.html#extract_apps"><span class="hs-identifier">extract_apps</span></a></a><span> </span><a name="local-6989586621679804162"><a href="#local-6989586621679804162"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621679804163"><a href="#local-6989586621679804163"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679804164"><a href="#local-6989586621679804164"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_app"><span class="hs-identifier hs-var">extract_app</span></a><span> </span><a href="#local-6989586621679804162"><span class="hs-identifier hs-var">t_or_k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804164"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679804163"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1695"></a><span>
</span><a name="line-1696"></a><span class="hs-identifier">extract_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsAppType"><span class="hs-identifier hs-type">LHsAppType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1697"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1698"></a><a name="extract_app"><a href="RnTypes.html#extract_app"><span class="hs-identifier">extract_app</span></a></a><span> </span><a name="local-6989586621679804165"><a href="#local-6989586621679804165"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppInfix"><span class="hs-identifier hs-var">HsAppInfix</span></a><span> </span><a name="local-6989586621679804166"><a href="#local-6989586621679804166"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621679804167"><a href="#local-6989586621679804167"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621679804165"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804166"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679804167"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1699"></a><span class="hs-identifier">extract_app</span><span> </span><a name="local-6989586621679804168"><a href="#local-6989586621679804168"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppPrefix"><span class="hs-identifier hs-var">HsAppPrefix</span></a><span> </span><a name="local-6989586621679804169"><a href="#local-6989586621679804169"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679804170"><a href="#local-6989586621679804170"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621679804168"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621679804169"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679804170"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1700"></a><span>
</span><a name="line-1701"></a><span class="hs-identifier">extract_hs_tv_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1702"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1703"></a><span class="hs-comment">-- In (forall (a :: Maybe e). a -&gt; b) we have</span><span>
</span><a name="line-1704"></a><span class="hs-comment">--     'a' is bound by the forall</span><span>
</span><a name="line-1705"></a><span class="hs-comment">--     'b' is a free type variable</span><span>
</span><a name="line-1706"></a><span class="hs-comment">--     'e' is a free kind variable</span><span>
</span><a name="line-1707"></a><a name="extract_hs_tv_bndrs"><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier">extract_hs_tv_bndrs</span></a></a><span> </span><a name="local-6989586621679804171"><a href="#local-6989586621679804171"><span class="hs-identifier">tvs</span></a></a><span>
</span><a name="line-1708"></a><span>                    </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804172"><a href="#local-6989586621679804172"><span class="hs-identifier">acc_kvs</span></a></a><span> </span><a name="local-6989586621679804173"><a href="#local-6989586621679804173"><span class="hs-identifier">acc_k_set</span></a></a><span> </span><a name="local-6989586621679804174"><a href="#local-6989586621679804174"><span class="hs-identifier">acc_tvs</span></a></a><span> </span><a name="local-6989586621679804175"><a href="#local-6989586621679804175"><span class="hs-identifier">acc_t_set</span></a></a><span> </span><a name="local-6989586621679804176"><a href="#local-6989586621679804176"><span class="hs-identifier">acc_all</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1709"></a><span>                           </span><span class="hs-comment">-- Note accumulator comes first</span><span>
</span><a name="line-1710"></a><span>                    </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804177"><a href="#local-6989586621679804177"><span class="hs-identifier">body_kvs</span></a></a><span> </span><a name="local-6989586621679804178"><a href="#local-6989586621679804178"><span class="hs-identifier">body_k_set</span></a></a><span> </span><a name="local-6989586621679804179"><a href="#local-6989586621679804179"><span class="hs-identifier">body_tvs</span></a></a><span> </span><a name="local-6989586621679804180"><a href="#local-6989586621679804180"><span class="hs-identifier">body_t_set</span></a></a><span> </span><a name="local-6989586621679804181"><a href="#local-6989586621679804181"><span class="hs-identifier">body_all</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1711"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679804171"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1712"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1713"></a><span>    </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804177"><span class="hs-identifier hs-var">body_kvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804172"><span class="hs-identifier hs-var">acc_kvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804178"><span class="hs-identifier hs-var">body_k_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804173"><span class="hs-identifier hs-var">acc_k_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1714"></a><span>         </span><span class="hs-special">(</span><a href="#local-6989586621679804179"><span class="hs-identifier hs-var">body_tvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804174"><span class="hs-identifier hs-var">acc_tvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804180"><span class="hs-identifier hs-var">body_t_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804175"><span class="hs-identifier hs-var">acc_t_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1715"></a><span>         </span><span class="hs-special">(</span><a href="#local-6989586621679804181"><span class="hs-identifier hs-var">body_all</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804176"><span class="hs-identifier hs-var">acc_all</span></a><span class="hs-special">)</span><span>
</span><a name="line-1716"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1717"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804183"><a href="#local-6989586621679804183"><span class="hs-identifier">bndr_kvs</span></a></a><span> </span><a name="local-6989586621679804184"><a href="#local-6989586621679804184"><span class="hs-identifier">bndr_k_set</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1718"></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679804182"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804182"><a href="#local-6989586621679804182"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679804171"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1719"></a><span>
</span><a name="line-1720"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679804185"><a href="#local-6989586621679804185"><span class="hs-identifier">locals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccSet"><span class="hs-identifier hs-var">mkOccSet</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsTypes.html#hsLTyVarName"><span class="hs-identifier hs-var">hsLTyVarName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804171"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1721"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1722"></a><span>         </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804185"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804183"><span class="hs-identifier hs-var">bndr_kvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804177"><span class="hs-identifier hs-var">body_kvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804172"><span class="hs-identifier hs-var">acc_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1723"></a><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679804178"><span class="hs-identifier hs-var">body_k_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#minusOccSet"><span class="hs-identifier hs-var">minusOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804185"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804173"><span class="hs-identifier hs-var">acc_k_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804184"><span class="hs-identifier hs-var">bndr_k_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1724"></a><span>              </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804185"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804179"><span class="hs-identifier hs-var">body_tvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804174"><span class="hs-identifier hs-var">acc_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1725"></a><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679804180"><span class="hs-identifier hs-var">body_t_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#minusOccSet"><span class="hs-identifier hs-var">minusOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804185"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="OccName.html#unionOccSets"><span class="hs-identifier hs-var">unionOccSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804175"><span class="hs-identifier hs-var">acc_t_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1726"></a><span>              </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804185"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804183"><span class="hs-identifier hs-var">bndr_kvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804181"><span class="hs-identifier hs-var">body_all</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679804176"><span class="hs-identifier hs-var">acc_all</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1727"></a><span>
</span><a name="line-1728"></a><span class="hs-identifier">extract_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1729"></a><a name="extract_tv"><a href="RnTypes.html#extract_tv"><span class="hs-identifier">extract_tv</span></a></a><span> </span><a name="local-6989586621679804186"><a href="#local-6989586621679804186"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621679804187"><a href="#local-6989586621679804187"><span class="hs-identifier">ltv</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679804188"><a href="#local-6989586621679804188"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679804189"><a href="#local-6989586621679804189"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1730"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrTyVar"><span class="hs-identifier hs-var">isRdrTyVar</span></a><span> </span><a href="#local-6989586621679804188"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679804189"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1731"></a><span>      </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621679804192"><a href="#local-6989586621679804192"><span class="hs-identifier">kvs</span></a></a><span> </span><a name="local-6989586621679804193"><a href="#local-6989586621679804193"><span class="hs-identifier">k_set</span></a></a><span> </span><a name="local-6989586621679804194"><a href="#local-6989586621679804194"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679804195"><a href="#local-6989586621679804195"><span class="hs-identifier">t_set</span></a></a><span> </span><a name="local-6989586621679804196"><a href="#local-6989586621679804196"><span class="hs-identifier">all</span></a></a><span>
</span><a name="line-1732"></a><span>        </span><span class="hs-glyph">|</span><span>  </span><a href="TcRnTypes.html#isTypeLevel"><span class="hs-identifier hs-var">isTypeLevel</span></a><span> </span><a href="#local-6989586621679804186"><span class="hs-identifier hs-var">t_or_k</span></a><span>
</span><a name="line-1733"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804191"><span class="hs-identifier hs-var">not_exact</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804190"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804193"><span class="hs-identifier hs-var">k_set</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1734"></a><span>                </span><a href="RnTypes.html#mixedVarsErr"><span class="hs-identifier hs-var">mixedVarsErr</span></a><span> </span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span>
</span><a name="line-1735"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a href="#local-6989586621679804192"><span class="hs-identifier hs-var">kvs</span></a><span> </span><a href="#local-6989586621679804193"><span class="hs-identifier hs-var">k_set</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679804194"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804195"><span class="hs-identifier hs-var">t_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#extendOccSet"><span class="hs-identifier hs-var">extendOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804190"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1736"></a><span>                             </span><span class="hs-special">(</span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679804196"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1737"></a><span>        </span><span class="hs-glyph">|</span><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1738"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804191"><span class="hs-identifier hs-var">not_exact</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679804190"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#elemOccSet"><span class="hs-identifier hs-var">elemOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804195"><span class="hs-identifier hs-var">t_set</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1739"></a><span>                </span><a href="RnTypes.html#mixedVarsErr"><span class="hs-identifier hs-var">mixedVarsErr</span></a><span> </span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span>
</span><a name="line-1740"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679804192"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679804193"><span class="hs-identifier hs-var">k_set</span></a><span> </span><span class="hs-special">`</span><a href="OccName.html#extendOccSet"><span class="hs-identifier hs-var">extendOccSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679804190"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679804194"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679804195"><span class="hs-identifier hs-var">t_set</span></a><span>
</span><a name="line-1741"></a><span>                             </span><span class="hs-special">(</span><a href="#local-6989586621679804187"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679804196"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1742"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679804189"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1743"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1744"></a><span>    </span><a name="local-6989586621679804190"><a href="#local-6989586621679804190"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621679804188"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1745"></a><span>    </span><span class="hs-comment">-- See Note [TypeInType validity checking and Template Haskell]</span><span>
</span><a name="line-1746"></a><span>    </span><a name="local-6989586621679804191"><a href="#local-6989586621679804191"><span class="hs-identifier">not_exact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RdrName.html#isExact"><span class="hs-identifier hs-var">isExact</span></a><span> </span><a href="#local-6989586621679804188"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1747"></a><span>
</span><a name="line-1748"></a><span class="hs-identifier">mixedVarsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1749"></a><a name="mixedVarsErr"><a href="RnTypes.html#mixedVarsErr"><span class="hs-identifier">mixedVarsErr</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679804197"><a href="#local-6989586621679804197"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679804198"><a href="#local-6989586621679804198"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1750"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679804199"><a href="#local-6989586621679804199"><span class="hs-identifier">typeintype</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.3/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-1751"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679804199"><span class="hs-identifier hs-var">typeintype</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1752"></a><span>         </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-6989586621679804197"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679804198"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1753"></a><span>                        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;used as both a kind and a type&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1754"></a><span>                        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you intend to use TypeInType?&quot;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span class="hs-comment">-- just used in this module; seemed convenient here</span><span>
</span><a name="line-1757"></a><span class="hs-identifier">nubL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679803339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679803339"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679803339"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1758"></a><a name="nubL"><a href="RnTypes.html#nubL"><span class="hs-identifier">nubL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span> </span><a href="SrcLoc.html#eqLocated"><span class="hs-identifier hs-var">eqLocated</span></a><span>
</span><a name="line-1759"></a><span>
</span><a name="line-1760"></a><span class="hs-comment">{-
Note [TypeInType validity checking and Template Haskell]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
extract_tv enforces an invariant that no variable can be used as both a kind
and a type unless -XTypeInType is enabled. It does so by accumulating two sets
of variables' OccNames (one for type variables and one for kind variables) that
it has seen before. If a new type variable's OccName appears in the kind set,
then it errors, and similarly for kind variables and the type set.

This relies on the assumption that any two variables with the same OccName
are the same. While this is always true of user-written code, it is not always
true in the presence of Template Haskell! GHC Trac #12503 demonstrates a
scenario where two different Exact TH-generated names can have the same
OccName. As a result, if one of these Exact names is for a type variable
and the other Exact name is for a kind variable, then extracting them both
can lead to a spurious error in extract_tv.

To avoid such a scenario, we simply don't check the invariant in extract_tv
when the name is Exact. This allows Template Haskell users to write code that
uses -XPolyKinds without needing to enable -XTypeInType.

This is a somewhat arbitrary design choice, as adding this special case causes
this code to be accepted when spliced in via Template Haskell:

  data T1 k e
  class C1 b
  instance C1 (T1 k (e :: k))

Even if -XTypeInType is _not enabled. But accepting too many programs without
the prerequisite GHC extensions is better than the alternative, where some
programs would not be accepted unless enabling an extension which has nothing
to do with the code itself.
-}</span><span>
</span><a name="line-1793"></a></pre></body></html>