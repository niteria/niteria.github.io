<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TrieMap</span><span class="hs-special">(</span><span>
</span><a name="line-13"></a><span>   </span><span class="hs-comment">-- * Maps over Core expressions</span><span>
</span><a name="line-14"></a><span>   </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#emptyCoreMap"><span class="hs-identifier hs-var">emptyCoreMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#extendCoreMap"><span class="hs-identifier hs-var">extendCoreMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupCoreMap"><span class="hs-identifier hs-var">lookupCoreMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#foldCoreMap"><span class="hs-identifier hs-var">foldCoreMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>   </span><span class="hs-comment">-- * Maps over 'Type's</span><span>
</span><a name="line-16"></a><span>   </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#emptyTypeMap"><span class="hs-identifier hs-var">emptyTypeMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#extendTypeMap"><span class="hs-identifier hs-var">extendTypeMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupTypeMap"><span class="hs-identifier hs-var">lookupTypeMap</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#foldTypeMap"><span class="hs-identifier hs-var">foldTypeMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>   </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>   </span><span class="hs-comment">-- ** With explicit scoping</span><span>
</span><a name="line-19"></a><span>   </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#extendTypeMapWithScope"><span class="hs-identifier hs-var">extendTypeMapWithScope</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupTypeMapWithScope"><span class="hs-identifier hs-var">lookupTypeMapWithScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>   </span><a href="TrieMap.html#mkDeBruijnContext"><span class="hs-identifier hs-var">mkDeBruijnContext</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>   </span><span class="hs-comment">-- * Maps over 'Maybe' values</span><span>
</span><a name="line-22"></a><span>   </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>   </span><span class="hs-comment">-- * Maps over 'List' values</span><span>
</span><a name="line-24"></a><span>   </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>   </span><span class="hs-comment">-- * Maps over 'Literal's</span><span>
</span><a name="line-26"></a><span>   </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>   </span><span class="hs-comment">-- * 'TrieMap' class</span><span>
</span><a name="line-28"></a><span>   </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TrieMap.html#insertTM"><span class="hs-identifier hs-var">insertTM</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#deleteTM"><span class="hs-identifier hs-var">deleteTM</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>   </span><a href="TrieMap.html#lkDFreeVar"><span class="hs-identifier hs-var">lkDFreeVar</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#xtDFreeVar"><span class="hs-identifier hs-var">xtDFreeVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>   </span><a href="TrieMap.html#lkDNamed"><span class="hs-identifier hs-var">lkDNamed</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#xtDNamed"><span class="hs-identifier hs-var">xtDNamed</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>   </span><span class="hs-special">(</span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="Literal.html"><span class="hs-identifier">Literal</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="UniqDFM.html"><span class="hs-identifier">UniqDFM</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span class="hs-special">(</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span class="hs-special">(</span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span></a><span>    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">IntMap</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IntMap</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">{-
This module implements TrieMaps, which are finite mappings
whose key is a structured value like a CoreExpr or Type.

The code is very regular and boilerplate-like, but there is
some neat handling of *binders*.  In effect they are deBruijn
numbered on the fly.

The regular pattern for handling TrieMaps on data structures was first
described (to my knowledge) in Connelly and Morris's 1995 paper &quot;A
generalization of the Trie Data Structure&quot;; there is also an accessible
description of the idea in Okasaki's book &quot;Purely Functional Data
Structures&quot;, Section 10.3.2

************************************************************************
*                                                                      *
                   The TrieMap class
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">type</span><span> </span><a name="XT"><a href="TrieMap.html#XT"><span class="hs-identifier">XT</span></a></a><span> </span><a name="local-6989586621679326091"><a href="#local-6989586621679326091"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326091"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326091"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- How to alter a non-existent elt (Nothing)</span><span>
</span><a name="line-74"></a><span>                                </span><span class="hs-comment">--               or an existing elt (Just)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-keyword">class</span><span> </span><a name="TrieMap"><a href="TrieMap.html#TrieMap"><span class="hs-identifier">TrieMap</span></a></a><span> </span><a name="local-6989586621679326083"><a href="#local-6989586621679326083"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-77"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a name="local-6989586621679326083"><a href="#local-6989586621679326083"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-78"></a><span>   </span><span class="hs-identifier">emptyTM</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326084"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-79"></a><span>   </span><span class="hs-identifier">lookupTM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326085"><a href="#local-6989586621679326085"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326085"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326085"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-80"></a><span>   </span><span class="hs-identifier">alterTM</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326086"><a href="#local-6989586621679326086"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326086"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326086"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326086"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-81"></a><span>   </span><span class="hs-identifier">mapTM</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326087"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326088"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326087"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326088"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>   </span><span class="hs-identifier">foldTM</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326090"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326090"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326083"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326090"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326090"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-84"></a><span>      </span><span class="hs-comment">-- The unusual argument order here makes</span><span>
</span><a name="line-85"></a><span>      </span><span class="hs-comment">-- it easy to compose calls to foldTM;</span><span>
</span><a name="line-86"></a><span>      </span><span class="hs-comment">-- see for example fdE below</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">insertTM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326424"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326424"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326425"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326424"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326425"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326424"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326425"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-89"></a><a name="insertTM"><a href="TrieMap.html#insertTM"><span class="hs-identifier">insertTM</span></a></a><span> </span><a name="local-6989586621679326426"><a href="#local-6989586621679326426"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326427"><a href="#local-6989586621679326427"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326428"><a href="#local-6989586621679326428"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326426"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326427"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326428"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-identifier">deleteTM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326422"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326422"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326422"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326423"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326422"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326423"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-92"></a><a name="deleteTM"><a href="TrieMap.html#deleteTM"><span class="hs-identifier">deleteTM</span></a></a><span> </span><a name="local-6989586621679326429"><a href="#local-6989586621679326429"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326430"><a href="#local-6989586621679326430"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326429"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326430"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">----------------------</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- Recall that</span><span>
</span><a name="line-96"></a><span class="hs-comment">--   Control.Monad.(&gt;=&gt;) :: (a -&gt; Maybe b) -&gt; (b -&gt; Maybe c) -&gt; a -&gt; Maybe c</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-special">(</span><span class="hs-operator">&gt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326420"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326420"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326421"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326421"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- Reverse function composition (do f first, then g)</span><span>
</span><a name="line-100"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&gt;.&gt;</span><span>
</span><a name="line-101"></a><span class="hs-special">(</span><a name="local-6989586621679326431"><a href="#local-6989586621679326431"><span class="hs-identifier">f</span></a></a><span> </span><a name="%3E.%3E"><a href="TrieMap.html#%3E.%3E"><span class="hs-operator">&gt;.&gt;</span></a></a><span> </span><a name="local-6989586621679326432"><a href="#local-6989586621679326432"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326433"><a href="#local-6989586621679326433"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326432"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326431"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326433"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">|&gt;</span><span class="hs-special">,</span><span> </span><span class="hs-operator">|&gt;&gt;</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-special">(</span><span class="hs-operator">|&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679326417"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326417"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326418"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326418"><span class="hs-identifier hs-type">b</span></a><span>     </span><span class="hs-comment">-- Reverse application</span><span>
</span><a name="line-105"></a><a name="local-6989586621679326434"><a href="#local-6989586621679326434"><span class="hs-identifier">x</span></a></a><span> </span><a name="%7C%3E"><a href="TrieMap.html#%7C%3E"><span class="hs-operator">|&gt;</span></a></a><span> </span><a name="local-6989586621679326435"><a href="#local-6989586621679326435"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326435"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326434"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">----------------------</span><span>
</span><a name="line-108"></a><span class="hs-special">(</span><span class="hs-operator">|&gt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span>
</span><a name="line-109"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326416"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326416"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326416"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326416"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326414"><span class="hs-identifier hs-type">m2</span></a><span> </span><a href="#local-6989586621679326415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span class="hs-special">(</span><a name="%7C%3E%3E"><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator">|&gt;&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326436"><a href="#local-6989586621679326436"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326437"><a href="#local-6989586621679326437"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326436"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679326437"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#deMaybe"><span class="hs-identifier hs-var">deMaybe</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-identifier">deMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326412"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326412"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326413"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326412"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326413"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-115"></a><a name="deMaybe"><a href="TrieMap.html#deMaybe"><span class="hs-identifier">deMaybe</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-116"></a><span class="hs-identifier">deMaybe</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326438"><a href="#local-6989586621679326438"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326438"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   IntMaps
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IntMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IntMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-129"></a><span>  </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326283"><a href="#local-6989586621679326283"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326284"><a href="#local-6989586621679326284"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679326283"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326284"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtInt"><span class="hs-identifier hs-var">xtInt</span></a><span>
</span><a name="line-131"></a><span>  </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326285"><a href="#local-6989586621679326285"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326286"><a href="#local-6989586621679326286"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326287"><a href="#local-6989586621679326287"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#foldr"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679326285"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326287"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679326286"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-132"></a><span>  </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326288"><a href="#local-6989586621679326288"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326289"><a href="#local-6989586621679326289"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679326288"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326289"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-identifier">xtInt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326411"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IntMap</span></a><span> </span><a href="#local-6989586621679326411"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IntMap</span></a><span> </span><a href="#local-6989586621679326411"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-135"></a><a name="xtInt"><a href="TrieMap.html#xtInt"><span class="hs-identifier">xtInt</span></a></a><span> </span><a name="local-6989586621679326439"><a href="#local-6989586621679326439"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326440"><a href="#local-6989586621679326440"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326441"><a href="#local-6989586621679326441"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#alter"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679326440"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326439"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326441"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679326274"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><span class="hs-special">(</span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="#local-6989586621679326274"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><span class="hs-special">(</span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="#local-6989586621679326274"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326274"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-139"></a><span>  </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-140"></a><span>  </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span></a><span>
</span><a name="line-141"></a><span>  </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326275"><a href="#local-6989586621679326275"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326276"><a href="#local-6989586621679326276"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326277"><a href="#local-6989586621679326277"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#alter"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679326276"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326275"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326277"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-142"></a><span>  </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326278"><a href="#local-6989586621679326278"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326279"><a href="#local-6989586621679326279"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326280"><a href="#local-6989586621679326280"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679326278"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326280"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679326279"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-143"></a><span>  </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326281"><a href="#local-6989586621679326281"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326282"><a href="#local-6989586621679326282"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679326281"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326282"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">{-
Note [foldTM determinism]
~~~~~~~~~~~~~~~~~~~~~~~~~
We want foldTM to be deterministic, which is why we have an instance of
TrieMap for UniqDFM, but not for UniqFM. Here's an example of some things that
go wrong if foldTM is nondeterministic. Consider:

  f a b = return (a &lt;&gt; b)

Depending on the order that the typechecker generates constraints you
get either:

  f :: (Monad m, Monoid a) =&gt; a -&gt; a -&gt; m a

or:

  f :: (Monoid a, Monad m) =&gt; a -&gt; a -&gt; m a

The generated code will be different after desugaring as the dictionaries
will be bound in different orders, leading to potential ABI incompatibility.

One way to solve this would be to notice that the typeclasses could be
sorted alphabetically.

Unfortunately that doesn't quite work with this example:

  f a b = let x = a &lt;&gt; a; y = b &lt;&gt; b in x

where you infer:

  f :: (Monoid m, Monoid m1) =&gt; m1 -&gt; m -&gt; m1

or:

  f :: (Monoid m1, Monoid m) =&gt; m1 -&gt; m -&gt; m1

Here you could decide to take the order of the type variables in the type
according to depth first traversal and use it to order the constraints.

The real trouble starts when the user enables incoherent instances and
the compiler has to make an arbitrary choice. Consider:

  class T a b where
    go :: a -&gt; b -&gt; String

  instance (Show b) =&gt; T Int b where
    go a b = show a ++ show b

  instance (Show a) =&gt; T a Bool where
    go a b = show a ++ show b

  f = go 10 True

GHC is free to choose either dictionary to implement f, but for the sake of
determinism we'd like it to be consistent when compiling the same sources
with the same flags.

inert_dicts :: DictMap is implemented with a TrieMap. In getUnsolvedInerts it
gets converted to a bag of (Wanted) Cts using a fold. Then in
solve_simple_wanteds it's merged with other WantedConstraints. We want the
conversion to a bag to be deterministic. For that purpose we use UniqDFM
instead of UniqFM to implement the TrieMap.

See Note [Deterministic UniqFM] in UniqDFM for more details on how it's made
deterministic.
-}</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="UniqDFM.html#UniqDFM"><span class="hs-identifier hs-type">UniqDFM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="UniqDFM.html#UniqDFM"><span class="hs-identifier hs-type">UniqDFM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-215"></a><span>  </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqDFM.html#emptyUDFM"><span class="hs-identifier hs-var">emptyUDFM</span></a><span>
</span><a name="line-216"></a><span>  </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326264"><a href="#local-6989586621679326264"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326265"><a href="#local-6989586621679326265"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqDFM.html#lookupUDFM"><span class="hs-identifier hs-var">lookupUDFM</span></a><span> </span><a href="#local-6989586621679326265"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679326264"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-217"></a><span>  </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326266"><a href="#local-6989586621679326266"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326267"><a href="#local-6989586621679326267"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326268"><a href="#local-6989586621679326268"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqDFM.html#alterUDFM"><span class="hs-identifier hs-var">alterUDFM</span></a><span> </span><a href="#local-6989586621679326267"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326268"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679326266"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-218"></a><span>  </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326269"><a href="#local-6989586621679326269"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326270"><a href="#local-6989586621679326270"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326271"><a href="#local-6989586621679326271"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqDFM.html#foldUDFM"><span class="hs-identifier hs-var">foldUDFM</span></a><span> </span><a href="#local-6989586621679326269"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326271"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679326270"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-219"></a><span>  </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326272"><a href="#local-6989586621679326272"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326273"><a href="#local-6989586621679326273"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqDFM.html#mapUDFM"><span class="hs-identifier hs-var">mapUDFM</span></a><span> </span><a href="#local-6989586621679326272"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326273"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Maybes
*                                                                      *
************************************************************************

If              m is a map from k -&gt; val
then (MaybeMap m) is a map from (Maybe k) -&gt; val
-}</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-keyword">data</span><span> </span><a name="MaybeMap"><a href="TrieMap.html#MaybeMap"><span class="hs-identifier">MaybeMap</span></a></a><span> </span><a name="local-6989586621679326081"><a href="#local-6989586621679326081"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326082"><a href="#local-6989586621679326082"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MM"><a href="TrieMap.html#MM"><span class="hs-identifier">MM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="mm_nothing"><a href="TrieMap.html#mm_nothing"><span class="hs-identifier">mm_nothing</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326082"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a name="mm_just"><a href="TrieMap.html#mm_just"><span class="hs-identifier">mm_just</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679326081"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326082"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326263"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326263"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-235"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326263"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326263"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#MM"><span class="hs-identifier hs-var">MM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mm_nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-237"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkMaybe"><span class="hs-identifier hs-var">lkMaybe</span></a><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span>
</span><a name="line-238"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtMaybe"><span class="hs-identifier hs-var">xtMaybe</span></a><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span>
</span><a name="line-239"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdMaybe"><span class="hs-identifier hs-var">fdMaybe</span></a><span>
</span><a name="line-240"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapMb"><span class="hs-identifier hs-var">mapMb</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-identifier">mapMb</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326408"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326409"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326410"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326408"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326409"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326408"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326410"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-243"></a><a name="mapMb"><a href="TrieMap.html#mapMb"><span class="hs-identifier">mapMb</span></a></a><span> </span><a name="local-6989586621679326442"><a href="#local-6989586621679326442"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MM"><span class="hs-identifier hs-var">MM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mm_nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326443"><a href="#local-6989586621679326443"><span class="hs-identifier">mn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326444"><a href="#local-6989586621679326444"><span class="hs-identifier">mj</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#MM"><span class="hs-identifier hs-var">MM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mm_nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679326442"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326443"><span class="hs-identifier hs-var">mn</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326442"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326444"><span class="hs-identifier hs-var">mj</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-identifier">lkMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326407"><a href="#local-6989586621679326407"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679326404"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326405"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326407"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326407"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326404"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326405"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326406"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326406"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-248"></a><a name="lkMaybe"><a href="TrieMap.html#lkMaybe"><span class="hs-identifier">lkMaybe</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mm_nothing</span><span>
</span><a name="line-249"></a><span class="hs-identifier">lkMaybe</span><span> </span><a name="local-6989586621679326445"><a href="#local-6989586621679326445"><span class="hs-identifier">lk</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326446"><a href="#local-6989586621679326446"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="#local-6989586621679326445"><span class="hs-identifier hs-var">lk</span></a><span> </span><a href="#local-6989586621679326446"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">xtMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326403"><a href="#local-6989586621679326403"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679326400"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326403"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326403"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326403"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326400"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326402"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326402"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326402"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-253"></a><a name="xtMaybe"><a href="TrieMap.html#xtMaybe"><span class="hs-identifier">xtMaybe</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><a name="local-6989586621679326447"><a href="#local-6989586621679326447"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326448"><a href="#local-6989586621679326448"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326448"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mm_nothing</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326447"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mm_nothing</span><span> </span><a href="#local-6989586621679326448"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-254"></a><span class="hs-identifier">xtMaybe</span><span> </span><a name="local-6989586621679326449"><a href="#local-6989586621679326449"><span class="hs-identifier">tr</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326450"><a href="#local-6989586621679326450"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326451"><a href="#local-6989586621679326451"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326452"><a href="#local-6989586621679326452"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326452"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mm_just</span><span> </span><a href="#local-6989586621679326452"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679326449"><span class="hs-identifier hs-var">tr</span></a><span> </span><a href="#local-6989586621679326450"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679326451"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-identifier">fdMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326397"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326398"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326399"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326399"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a><span> </span><a href="#local-6989586621679326397"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326398"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326399"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326399"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-257"></a><a name="fdMaybe"><a href="TrieMap.html#fdMaybe"><span class="hs-identifier">fdMaybe</span></a></a><span> </span><a name="local-6989586621679326453"><a href="#local-6989586621679326453"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326454"><a href="#local-6989586621679326454"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldMaybe"><span class="hs-identifier hs-var">foldMaybe</span></a><span> </span><a href="#local-6989586621679326453"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mm_nothing</span><span> </span><a href="#local-6989586621679326454"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326453"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mm_just</span><span> </span><a href="#local-6989586621679326454"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Lists
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-keyword">data</span><span> </span><a name="ListMap"><a href="TrieMap.html#ListMap"><span class="hs-identifier">ListMap</span></a></a><span> </span><a name="local-6989586621679326079"><a href="#local-6989586621679326079"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326080"><a href="#local-6989586621679326080"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LM"><a href="TrieMap.html#LM"><span class="hs-identifier">LM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="lm_nil"><a href="TrieMap.html#lm_nil"><span class="hs-identifier">lm_nil</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326080"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-270"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="lm_cons"><a href="TrieMap.html#lm_cons"><span class="hs-identifier">lm_cons</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679326079"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326079"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326080"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326262"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326262"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-273"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326262"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326262"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-274"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lm_nil</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-275"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkList"><span class="hs-identifier hs-var">lkList</span></a><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span>
</span><a name="line-276"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtList"><span class="hs-identifier hs-var">xtList</span></a><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span>
</span><a name="line-277"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdList"><span class="hs-identifier hs-var">fdList</span></a><span>
</span><a name="line-278"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapList"><span class="hs-identifier hs-var">mapList</span></a><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-identifier">mapList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326394"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326395"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326396"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326394"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326394"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326396"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-281"></a><a name="mapList"><a href="TrieMap.html#mapList"><span class="hs-identifier">mapList</span></a></a><span> </span><a name="local-6989586621679326455"><a href="#local-6989586621679326455"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lm_nil</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326456"><a href="#local-6989586621679326456"><span class="hs-identifier">mnil</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326457"><a href="#local-6989586621679326457"><span class="hs-identifier">mcons</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lm_nil</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679326455"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326456"><span class="hs-identifier hs-var">mnil</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326455"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326457"><span class="hs-identifier hs-var">mcons</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-identifier">lkList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326390"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326393"><a href="#local-6989586621679326393"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679326391"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326390"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326393"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326393"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679326391"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326390"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326392"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326392"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-286"></a><a name="lkList"><a href="TrieMap.html#lkList"><span class="hs-identifier">lkList</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lm_nil</span><span>
</span><a name="line-287"></a><span class="hs-identifier">lkList</span><span> </span><a name="local-6989586621679326458"><a href="#local-6989586621679326458"><span class="hs-identifier">lk</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326459"><a href="#local-6989586621679326459"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679326460"><a href="#local-6989586621679326460"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="#local-6989586621679326458"><span class="hs-identifier hs-var">lk</span></a><span> </span><a href="#local-6989586621679326459"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkList"><span class="hs-identifier hs-var">lkList</span></a><span> </span><a href="#local-6989586621679326458"><span class="hs-identifier hs-var">lk</span></a><span> </span><a href="#local-6989586621679326460"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-identifier">xtList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326386"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326389"><a href="#local-6989586621679326389"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679326387"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326389"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326386"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326389"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326386"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326389"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679326387"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326388"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326386"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326388"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326386"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326388"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-291"></a><a name="xtList"><a href="TrieMap.html#xtList"><span class="hs-identifier">xtList</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621679326461"><a href="#local-6989586621679326461"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326462"><a href="#local-6989586621679326462"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326462"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lm_nil</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326461"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lm_nil</span><span> </span><a href="#local-6989586621679326462"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-292"></a><span class="hs-identifier">xtList</span><span> </span><a name="local-6989586621679326463"><a href="#local-6989586621679326463"><span class="hs-identifier">tr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326464"><a href="#local-6989586621679326464"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679326465"><a href="#local-6989586621679326465"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326466"><a href="#local-6989586621679326466"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326467"><a href="#local-6989586621679326467"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326467"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lm_cons</span><span> </span><a href="#local-6989586621679326467"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679326463"><span class="hs-identifier hs-var">tr</span></a><span> </span><a href="#local-6989586621679326464"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtList"><span class="hs-identifier hs-var">xtList</span></a><span> </span><a href="#local-6989586621679326463"><span class="hs-identifier hs-var">tr</span></a><span> </span><a href="#local-6989586621679326465"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679326466"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-identifier">fdList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679326383"><a href="#local-6989586621679326383"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326384"><a href="#local-6989586621679326384"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679326385"><a href="#local-6989586621679326385"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326383"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-295"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326384"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326385"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326385"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="#local-6989586621679326383"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326384"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326385"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326385"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-296"></a><a name="fdList"><a href="TrieMap.html#fdList"><span class="hs-identifier">fdList</span></a></a><span> </span><a name="local-6989586621679326468"><a href="#local-6989586621679326468"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326469"><a href="#local-6989586621679326469"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldMaybe"><span class="hs-identifier hs-var">foldMaybe</span></a><span> </span><a href="#local-6989586621679326468"><span class="hs-identifier hs-var">k</span></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier">lm_nil</span><span> </span><a href="#local-6989586621679326469"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span>    </span><span class="hs-special">(</span><a href="TrieMap.html#fdList"><span class="hs-identifier hs-var">fdList</span></a><span> </span><a href="#local-6989586621679326468"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lm_cons</span><span> </span><a href="#local-6989586621679326469"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-identifier">foldMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326382"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326382"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326382"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326382"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-300"></a><a name="foldMaybe"><a href="TrieMap.html#foldMaybe"><span class="hs-identifier">foldMaybe</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><a name="local-6989586621679326470"><a href="#local-6989586621679326470"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326470"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-301"></a><span class="hs-identifier">foldMaybe</span><span> </span><a name="local-6989586621679326471"><a href="#local-6989586621679326471"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326472"><a href="#local-6989586621679326472"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326473"><a href="#local-6989586621679326473"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326471"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326472"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679326473"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Basic maps
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-identifier">lkDNamed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621679326379"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679326379"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a><span> </span><a href="#local-6989586621679326380"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326380"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-312"></a><a name="lkDNamed"><a href="TrieMap.html#lkDNamed"><span class="hs-identifier">lkDNamed</span></a></a><span> </span><a name="local-6989586621679326474"><a href="#local-6989586621679326474"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679326475"><a href="#local-6989586621679326475"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#lookupDNameEnv"><span class="hs-identifier hs-var">lookupDNameEnv</span></a><span> </span><a href="#local-6989586621679326475"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679326474"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-identifier">xtDNamed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621679326377"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679326377"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a><span> </span><a href="#local-6989586621679326378"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a><span> </span><a href="#local-6989586621679326378"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-315"></a><a name="xtDNamed"><a href="TrieMap.html#xtDNamed"><span class="hs-identifier">xtDNamed</span></a></a><span> </span><a name="local-6989586621679326476"><a href="#local-6989586621679326476"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679326477"><a href="#local-6989586621679326477"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326478"><a href="#local-6989586621679326478"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#alterDNameEnv"><span class="hs-identifier hs-var">alterDNameEnv</span></a><span> </span><a href="#local-6989586621679326477"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326478"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679326476"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">------------------------</span><span>
</span><a name="line-318"></a><span class="hs-keyword">type</span><span> </span><a name="LiteralMap"><a href="TrieMap.html#LiteralMap"><span class="hs-identifier">LiteralMap</span></a></a><span>  </span><a name="local-6989586621679326078"><a href="#local-6989586621679326078"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><a href="#local-6989586621679326078"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-identifier">emptyLiteralMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><a href="#local-6989586621679326376"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-321"></a><a name="emptyLiteralMap"><a href="TrieMap.html#emptyLiteralMap"><span class="hs-identifier">emptyLiteralMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-identifier">lkLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><a href="#local-6989586621679326375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326375"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-324"></a><a name="lkLit"><a href="TrieMap.html#lkLit"><span class="hs-identifier">lkLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">xtLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326374"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><a href="#local-6989586621679326374"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><a href="#local-6989586621679326374"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-327"></a><a name="xtLit"><a href="TrieMap.html#xtLit"><span class="hs-identifier">xtLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   GenMap
*                                                                      *
************************************************************************

Note [Compressed TrieMap]
~~~~~~~~~~~~~~~~~~~~~~~~~

The GenMap constructor augments TrieMaps with leaf compression.  This helps
solve the performance problem detailed in #9960: suppose we have a handful
H of entries in a TrieMap, each with a very large key, size K. If you fold over
such a TrieMap you'd expect time O(H). That would certainly be true of an
association list! But with TrieMap we actually have to navigate down a long
singleton structure to get to the elements, so it takes time O(K*H).  This
can really hurt on many type-level computation benchmarks:
see for example T9872d.

The point of a TrieMap is that you need to navigate to the point where only one
key remains, and then things should be fast.  So the point of a SingletonMap
is that, once we are down to a single (key,value) pair, we stop and
just use SingletonMap.

'EmptyMap' provides an even more basic (but essential) optimization: if there is
nothing in the map, don't bother building out the (possibly infinite) recursive
TrieMap structure!
-}</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-keyword">data</span><span> </span><a name="GenMap"><a href="TrieMap.html#GenMap"><span class="hs-identifier">GenMap</span></a></a><span> </span><a name="local-6989586621679326076"><a href="#local-6989586621679326076"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326077"><a href="#local-6989586621679326077"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-359"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="EmptyMap"><a href="TrieMap.html#EmptyMap"><span class="hs-identifier">EmptyMap</span></a></a><span>
</span><a name="line-360"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="SingletonMap"><a href="TrieMap.html#SingletonMap"><span class="hs-identifier">SingletonMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326076"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326077"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-361"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="MultiMap"><a href="TrieMap.html#MultiMap"><span class="hs-identifier">MultiMap</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326076"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326077"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679326258"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326259"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326258"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326259"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326258"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-364"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Empty map&quot;</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679326260"><a href="#local-6989586621679326260"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Singleton map&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326260"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-366"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><a name="local-6989586621679326261"><a href="#local-6989586621679326261"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326261"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- TODO undecidable instance</span><span>
</span><a name="line-369"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326257"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326257"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326257"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-370"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326257"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326257"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-371"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-372"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span>
</span><a name="line-373"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span>
</span><a name="line-374"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdG"><span class="hs-identifier hs-var">fdG</span></a><span>
</span><a name="line-375"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapG"><span class="hs-identifier hs-var">mapG</span></a><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- NB: Be careful about RULES and type families (#5821).  So we should make sure</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- to specify @Key TypeMapX@ (and not @DeBruijn Type@, the reduced form)</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-pragma">{-# SPECIALIZE lkG :: Key TypeMapX     -&gt; TypeMapG a     -&gt; Maybe a #-}</span><span>
</span><a name="line-381"></a><span class="hs-pragma">{-# SPECIALIZE lkG :: Key CoercionMapX -&gt; CoercionMapG a -&gt; Maybe a #-}</span><span>
</span><a name="line-382"></a><span class="hs-pragma">{-# SPECIALIZE lkG :: Key CoreMapX     -&gt; CoreMapG a     -&gt; Maybe a #-}</span><span>
</span><a name="line-383"></a><span class="hs-identifier">lkG</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326369"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326369"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326369"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326369"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326370"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326370"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-384"></a><a name="lkG"><a href="TrieMap.html#lkG"><span class="hs-identifier">lkG</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-385"></a><span class="hs-identifier">lkG</span><span> </span><a name="local-6989586621679326479"><a href="#local-6989586621679326479"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a name="local-6989586621679326480"><a href="#local-6989586621679326480"><span class="hs-identifier">k'</span></a></a><span> </span><a name="local-6989586621679326481"><a href="#local-6989586621679326481"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679326479"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326480"><span class="hs-identifier hs-var">k'</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326481"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-386"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-387"></a><span class="hs-identifier">lkG</span><span> </span><a name="local-6989586621679326482"><a href="#local-6989586621679326482"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><a name="local-6989586621679326483"><a href="#local-6989586621679326483"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><a href="#local-6989586621679326482"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326483"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-pragma">{-# SPECIALIZE xtG :: Key TypeMapX     -&gt; XT a -&gt; TypeMapG a -&gt; TypeMapG a #-}</span><span>
</span><a name="line-390"></a><span class="hs-pragma">{-# SPECIALIZE xtG :: Key CoercionMapX -&gt; XT a -&gt; CoercionMapG a -&gt; CoercionMapG a #-}</span><span>
</span><a name="line-391"></a><span class="hs-pragma">{-# SPECIALIZE xtG :: Key CoreMapX     -&gt; XT a -&gt; CoreMapG a -&gt; CoreMapG a #-}</span><span>
</span><a name="line-392"></a><span class="hs-identifier">xtG</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326364"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326364"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><a href="#local-6989586621679326364"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326365"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326364"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326365"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326364"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326365"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-393"></a><a name="xtG"><a href="TrieMap.html#xtG"><span class="hs-identifier">xtG</span></a></a><span> </span><a name="local-6989586621679326484"><a href="#local-6989586621679326484"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326485"><a href="#local-6989586621679326485"><span class="hs-identifier">f</span></a></a><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-394"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679326485"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-395"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326486"><a href="#local-6989586621679326486"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a href="#local-6989586621679326484"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326486"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-396"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-397"></a><span class="hs-identifier">xtG</span><span> </span><a name="local-6989586621679326487"><a href="#local-6989586621679326487"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326488"><a href="#local-6989586621679326488"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326489"><a href="#local-6989586621679326489"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a name="local-6989586621679326490"><a href="#local-6989586621679326490"><span class="hs-identifier">k'</span></a></a><span> </span><a name="local-6989586621679326491"><a href="#local-6989586621679326491"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679326490"><span class="hs-identifier hs-var">k'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326487"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-399"></a><span>    </span><span class="hs-comment">-- The new key matches the (single) key already in the tree.  Hence,</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-comment">-- apply @f@ to @Just v'@ and build a singleton or empty map depending</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-comment">-- on the 'Just'/'Nothing' response respectively.</span><span>
</span><a name="line-402"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679326488"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326491"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-403"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326492"><a href="#local-6989586621679326492"><span class="hs-identifier">v''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a href="#local-6989586621679326490"><span class="hs-identifier hs-var">k'</span></a><span> </span><a href="#local-6989586621679326492"><span class="hs-identifier hs-var">v''</span></a><span>
</span><a name="line-404"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-405"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-406"></a><span>    </span><span class="hs-comment">-- We've hit a singleton tree for a different key than the one we are</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-comment">-- searching for. Hence apply @f@ to @Nothing@. If result is @Nothing@ then</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-comment">-- we can just return the old map. If not, we need a map with *two*</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-comment">-- entries. The easiest way to do that is to insert two items into an empty</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-comment">-- map of type @m a@.</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679326488"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-412"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326489"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-413"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326493"><a href="#local-6989586621679326493"><span class="hs-identifier">v</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326490"><span class="hs-identifier hs-var">k'</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326491"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>                           </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326487"><span class="hs-identifier hs-var">k</span></a><span>  </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326493"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>                           </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span>
</span><a name="line-416"></a><span class="hs-identifier">xtG</span><span> </span><a name="local-6989586621679326494"><a href="#local-6989586621679326494"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326495"><a href="#local-6989586621679326495"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><a name="local-6989586621679326496"><a href="#local-6989586621679326496"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326494"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326495"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326496"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span class="hs-pragma">{-# SPECIALIZE mapG :: (a -&gt; b) -&gt; TypeMapG a     -&gt; TypeMapG b #-}</span><span>
</span><a name="line-419"></a><span class="hs-pragma">{-# SPECIALIZE mapG :: (a -&gt; b) -&gt; CoercionMapG a -&gt; CoercionMapG b #-}</span><span>
</span><a name="line-420"></a><span class="hs-pragma">{-# SPECIALIZE mapG :: (a -&gt; b) -&gt; CoreMapG a     -&gt; CoreMapG b #-}</span><span>
</span><a name="line-421"></a><span class="hs-identifier">mapG</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326355"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326356"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326357"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326355"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326356"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326355"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326357"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-422"></a><a name="mapG"><a href="TrieMap.html#mapG"><span class="hs-identifier">mapG</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-423"></a><span class="hs-identifier">mapG</span><span> </span><a name="local-6989586621679326497"><a href="#local-6989586621679326497"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a name="local-6989586621679326498"><a href="#local-6989586621679326498"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326499"><a href="#local-6989586621679326499"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><a href="#local-6989586621679326498"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326497"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326499"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span class="hs-identifier">mapG</span><span> </span><a name="local-6989586621679326500"><a href="#local-6989586621679326500"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><a name="local-6989586621679326501"><a href="#local-6989586621679326501"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326500"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326501"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-pragma">{-# SPECIALIZE fdG :: (a -&gt; b -&gt; b) -&gt; TypeMapG a     -&gt; b -&gt; b #-}</span><span>
</span><a name="line-427"></a><span class="hs-pragma">{-# SPECIALIZE fdG :: (a -&gt; b -&gt; b) -&gt; CoercionMapG a -&gt; b -&gt; b #-}</span><span>
</span><a name="line-428"></a><span class="hs-pragma">{-# SPECIALIZE fdG :: (a -&gt; b -&gt; b) -&gt; CoreMapG a     -&gt; b -&gt; b #-}</span><span>
</span><a name="line-429"></a><span class="hs-identifier">fdG</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="#local-6989586621679326346"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326347"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326348"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326348"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="#local-6989586621679326346"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679326347"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326348"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326348"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-430"></a><a name="fdG"><a href="TrieMap.html#fdG"><span class="hs-identifier">fdG</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679326502"><a href="#local-6989586621679326502"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326502"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-431"></a><span class="hs-identifier">fdG</span><span> </span><a name="local-6989586621679326503"><a href="#local-6989586621679326503"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#SingletonMap"><span class="hs-identifier hs-var">SingletonMap</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679326504"><a href="#local-6989586621679326504"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679326505"><a href="#local-6989586621679326505"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326503"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326504"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326505"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-432"></a><span class="hs-identifier">fdG</span><span> </span><a name="local-6989586621679326506"><a href="#local-6989586621679326506"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#MultiMap"><span class="hs-identifier hs-var">MultiMap</span></a><span> </span><a name="local-6989586621679326507"><a href="#local-6989586621679326507"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326506"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326507"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   CoreMap
*                                                                      *
************************************************************************

Note [Binders]
~~~~~~~~~~~~~~
 * In general we check binders as late as possible because types are
   less likely to differ than expression structure.  That's why
      cm_lam :: CoreMapG (TypeMapG a)
   rather than
      cm_lam :: TypeMapG (CoreMapG a)

 * We don't need to look at the type of some binders, notalby
     - the case binder in (Case _ b _ _)
     - the binders in an alternative
   because they are totally fixed by the context

Note [Empty case alternatives]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* For a key (Case e b ty (alt:alts))  we don't need to look the return type
  'ty', because every alternative has that type.

* For a key (Case e b ty []) we MUST look at the return type 'ty', because
  otherwise (Case (error () &quot;urk&quot;) _ Int  []) would compare equal to
            (Case (error () &quot;urk&quot;) _ Bool [])
  which is utterly wrong (Trac #6097)

We could compare the return type regardless, but the wildly common case
is that it's unnecessary, so we have two fields (cm_case and cm_ecase)
for the two possibilities.  Only cm_ecase looks at the type.

See also Note [Empty case alternatives] in CoreSyn.
-}</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">-- | @CoreMap a@ is a map from 'CoreExpr' to @a@.  If you are a client, this</span><span>
</span><a name="line-472"></a><span class="hs-comment">-- is the type you want.</span><span>
</span><a name="line-473"></a><span class="hs-keyword">newtype</span><span> </span><a name="CoreMap"><a href="TrieMap.html#CoreMap"><span class="hs-identifier">CoreMap</span></a></a><span> </span><a name="local-6989586621679326075"><a href="#local-6989586621679326075"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CoreMap"><a href="TrieMap.html#CoreMap"><span class="hs-identifier">CoreMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><a href="#local-6989586621679326075"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-476"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-477"></a><span>    </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-478"></a><span>    </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326248"><a href="#local-6989586621679326248"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><a name="local-6989586621679326249"><a href="#local-6989586621679326249"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326248"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326249"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-479"></a><span>    </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326250"><a href="#local-6989586621679326250"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326251"><a href="#local-6989586621679326251"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><a name="local-6989586621679326252"><a href="#local-6989586621679326252"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326250"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326251"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326252"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>    </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326253"><a href="#local-6989586621679326253"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><a name="local-6989586621679326254"><a href="#local-6989586621679326254"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326253"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326254"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-481"></a><span>    </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326255"><a href="#local-6989586621679326255"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><a name="local-6989586621679326256"><a href="#local-6989586621679326256"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-var">CoreMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326255"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326256"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">-- | @CoreMapG a@ is a map from @DeBruijn CoreExpr@ to @a@.  The extended</span><span>
</span><a name="line-484"></a><span class="hs-comment">-- key makes it suitable for recursive traversal, since it can track binders,</span><span>
</span><a name="line-485"></a><span class="hs-comment">-- but it is strictly internal to this module.  If you are including a 'CoreMap'</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- inside another 'TrieMap', this is the type you want.</span><span>
</span><a name="line-487"></a><span class="hs-keyword">type</span><span> </span><a name="CoreMapG"><a href="TrieMap.html#CoreMapG"><span class="hs-identifier">CoreMapG</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-comment">-- | @CoreMapX a@ is the base map from @DeBruijn CoreExpr@ to @a@, but without</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- the 'GenMap' optimization.</span><span>
</span><a name="line-491"></a><span class="hs-keyword">data</span><span> </span><a name="CoreMapX"><a href="TrieMap.html#CoreMapX"><span class="hs-identifier">CoreMapX</span></a></a><span> </span><a name="local-6989586621679326074"><a href="#local-6989586621679326074"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CM"><a href="TrieMap.html#CM"><span class="hs-identifier">CM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="cm_var"><a href="TrieMap.html#cm_var"><span class="hs-identifier">cm_var</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-493"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_lit"><a href="TrieMap.html#cm_lit"><span class="hs-identifier">cm_lit</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-494"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_co"><a href="TrieMap.html#cm_co"><span class="hs-identifier">cm_co</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoercionMapG"><span class="hs-identifier hs-type">CoercionMapG</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-495"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_type"><a href="TrieMap.html#cm_type"><span class="hs-identifier">cm_type</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-496"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_cast"><a href="TrieMap.html#cm_cast"><span class="hs-identifier">cm_cast</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapG"><span class="hs-identifier hs-type">CoercionMapG</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_tick"><a href="TrieMap.html#cm_tick"><span class="hs-identifier">cm_tick</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TickishMap"><span class="hs-identifier hs-type">TickishMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_app"><a href="TrieMap.html#cm_app"><span class="hs-identifier">cm_app</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_lam"><a href="TrieMap.html#cm_lam"><span class="hs-identifier">cm_lam</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Note [Binders]</span><span>
</span><a name="line-500"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_letn"><a href="TrieMap.html#cm_letn"><span class="hs-identifier">cm_letn</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_letr"><a href="TrieMap.html#cm_letr"><span class="hs-identifier">cm_letr</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_case"><a href="TrieMap.html#cm_case"><span class="hs-identifier">cm_case</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#ListMap"><span class="hs-identifier hs-type">ListMap</span></a><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="cm_ecase"><a href="TrieMap.html#cm_ecase"><span class="hs-identifier">cm_ecase</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326074"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Note [Empty case alternatives]</span><span>
</span><a name="line-504"></a><span>     </span><span class="hs-special">}</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-507"></a><span>  </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326193"><a href="#local-6989586621679326193"><span class="hs-identifier">env1</span></a></a><span> </span><a name="local-6989586621679326194"><a href="#local-6989586621679326194"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326195"><a href="#local-6989586621679326195"><span class="hs-identifier">env2</span></a></a><span> </span><a name="local-6989586621679326196"><a href="#local-6989586621679326196"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326194"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679326196"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-508"></a><span>    </span><a name="local-6989586621679326197"><a href="#local-6989586621679326197"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679326198"><a href="#local-6989586621679326198"><span class="hs-identifier">v1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679326199"><a href="#local-6989586621679326199"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326198"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326199"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-509"></a><span>                            </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326200"><a href="#local-6989586621679326200"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326201"><a href="#local-6989586621679326201"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326200"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326201"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-510"></a><span>                            </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326198"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326199"><span class="hs-identifier hs-var">v2</span></a><span>
</span><a name="line-511"></a><span>                            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-512"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><a name="local-6989586621679326202"><a href="#local-6989586621679326202"><span class="hs-identifier">lit1</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><a name="local-6989586621679326203"><a href="#local-6989586621679326203"><span class="hs-identifier">lit2</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326202"><span class="hs-identifier hs-var">lit1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326203"><span class="hs-identifier hs-var">lit2</span></a><span>
</span><a name="line-513"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-6989586621679326204"><a href="#local-6989586621679326204"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-6989586621679326205"><a href="#local-6989586621679326205"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326204"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326205"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-6989586621679326206"><a href="#local-6989586621679326206"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-6989586621679326207"><a href="#local-6989586621679326207"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326206"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326207"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-515"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-6989586621679326208"><a href="#local-6989586621679326208"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679326209"><a href="#local-6989586621679326209"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-6989586621679326210"><a href="#local-6989586621679326210"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679326211"><a href="#local-6989586621679326211"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326209"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326211"><span class="hs-identifier hs-var">co2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326208"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679326210"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-516"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679326212"><a href="#local-6989586621679326212"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679326213"><a href="#local-6989586621679326213"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679326214"><a href="#local-6989586621679326214"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-6989586621679326215"><a href="#local-6989586621679326215"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326212"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679326214"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326213"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679326215"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-517"></a><span>    </span><span class="hs-comment">-- This seems a bit dodgy, see 'eqTickish'</span><span>
</span><a name="line-518"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><a name="local-6989586621679326216"><a href="#local-6989586621679326216"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679326217"><a href="#local-6989586621679326217"><span class="hs-identifier">e1</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><a name="local-6989586621679326218"><a href="#local-6989586621679326218"><span class="hs-identifier">n2</span></a></a><span> </span><a name="local-6989586621679326219"><a href="#local-6989586621679326219"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326216"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326218"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326217"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679326219"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679326220"><a href="#local-6989586621679326220"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679326221"><a href="#local-6989586621679326221"><span class="hs-identifier">e1</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="CoreSyn.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679326222"><a href="#local-6989586621679326222"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679326223"><a href="#local-6989586621679326223"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-521"></a><span>      </span><span class="hs-glyph">=</span><span>  </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679326220"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679326222"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-522"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326220"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326221"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326222"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326223"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-6989586621679326224"><a href="#local-6989586621679326224"><span class="hs-identifier">v1</span></a></a><span> </span><a name="local-6989586621679326225"><a href="#local-6989586621679326225"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326226"><a href="#local-6989586621679326226"><span class="hs-identifier">e1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-6989586621679326227"><a href="#local-6989586621679326227"><span class="hs-identifier">v2</span></a></a><span> </span><a name="local-6989586621679326228"><a href="#local-6989586621679326228"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326229"><a href="#local-6989586621679326229"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>      </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326225"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679326228"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-526"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326224"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326226"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326227"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326229"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-6989586621679326230"><a href="#local-6989586621679326230"><span class="hs-identifier">ps1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326231"><a href="#local-6989586621679326231"><span class="hs-identifier">e1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-6989586621679326232"><a href="#local-6989586621679326232"><span class="hs-identifier">ps2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326233"><a href="#local-6989586621679326233"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679326230"><span class="hs-identifier hs-var">ps1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679326232"><span class="hs-identifier hs-var">ps2</span></a><span>
</span><a name="line-530"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326238"><span class="hs-identifier hs-var">env1'</span></a><span> </span><a href="#local-6989586621679326235"><span class="hs-identifier hs-var">rs1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326239"><span class="hs-identifier hs-var">env2'</span></a><span> </span><a href="#local-6989586621679326237"><span class="hs-identifier hs-var">rs2</span></a><span>
</span><a name="line-531"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326238"><span class="hs-identifier hs-var">env1'</span></a><span> </span><a href="#local-6989586621679326231"><span class="hs-identifier hs-var">e1</span></a><span>  </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326239"><span class="hs-identifier hs-var">env2'</span></a><span> </span><a href="#local-6989586621679326233"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-532"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-533"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679326234"><a href="#local-6989586621679326234"><span class="hs-identifier">bs1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679326235"><a href="#local-6989586621679326235"><span class="hs-identifier">rs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621679326230"><span class="hs-identifier hs-var">ps1</span></a><span>
</span><a name="line-534"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679326236"><a href="#local-6989586621679326236"><span class="hs-identifier">bs2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679326237"><a href="#local-6989586621679326237"><span class="hs-identifier">rs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621679326232"><span class="hs-identifier hs-var">ps2</span></a><span>
</span><a name="line-535"></a><span>        </span><a name="local-6989586621679326238"><a href="#local-6989586621679326238"><span class="hs-identifier">env1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326234"><span class="hs-identifier hs-var">bs1</span></a><span>
</span><a name="line-536"></a><span>        </span><a name="local-6989586621679326239"><a href="#local-6989586621679326239"><span class="hs-identifier">env2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326236"><span class="hs-identifier hs-var">bs2</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a name="local-6989586621679326240"><a href="#local-6989586621679326240"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679326241"><a href="#local-6989586621679326241"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679326242"><a href="#local-6989586621679326242"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679326243"><a href="#local-6989586621679326243"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a name="local-6989586621679326244"><a href="#local-6989586621679326244"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679326245"><a href="#local-6989586621679326245"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679326246"><a href="#local-6989586621679326246"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679326247"><a href="#local-6989586621679326247"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679326243"><span class="hs-identifier hs-var">a1</span></a><span>   </span><span class="hs-comment">-- See Note [Empty case alternatives]</span><span>
</span><a name="line-540"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679326247"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326240"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679326244"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326242"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326246"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-541"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-542"></a><span>      </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679326197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326240"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679326244"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326193"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326241"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326243"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326195"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326245"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326247"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-identifier">emptyE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326345"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-547"></a><a name="emptyE"><a href="TrieMap.html#emptyE"><span class="hs-identifier">emptyE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CM"><span class="hs-identifier hs-var">CM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyLiteralMap"><span class="hs-identifier hs-var">emptyLiteralMap</span></a><span>
</span><a name="line-548"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-549"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-550"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lam</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-551"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-552"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-555"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-556"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyE"><span class="hs-identifier hs-var">emptyE</span></a><span>
</span><a name="line-557"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkE"><span class="hs-identifier hs-var">lkE</span></a><span>
</span><a name="line-558"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtE"><span class="hs-identifier hs-var">xtE</span></a><span>
</span><a name="line-559"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdE"><span class="hs-identifier hs-var">fdE</span></a><span>
</span><a name="line-560"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapE"><span class="hs-identifier hs-var">mapE</span></a><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">--------------------------</span><span>
</span><a name="line-563"></a><span class="hs-identifier">mapE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326343"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326344"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326343"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326344"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-564"></a><a name="mapE"><a href="TrieMap.html#mapE"><span class="hs-identifier">mapE</span></a></a><span> </span><a name="local-6989586621679326508"><a href="#local-6989586621679326508"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CM"><span class="hs-identifier hs-var">CM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326509"><a href="#local-6989586621679326509"><span class="hs-identifier">cvar</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326510"><a href="#local-6989586621679326510"><span class="hs-identifier">clit</span></a></a><span>
</span><a name="line-565"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326511"><a href="#local-6989586621679326511"><span class="hs-identifier">cco</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326512"><a href="#local-6989586621679326512"><span class="hs-identifier">ctype</span></a></a><span>
</span><a name="line-566"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326513"><a href="#local-6989586621679326513"><span class="hs-identifier">ccast</span></a></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326514"><a href="#local-6989586621679326514"><span class="hs-identifier">capp</span></a></a><span>
</span><a name="line-567"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lam</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326515"><a href="#local-6989586621679326515"><span class="hs-identifier">clam</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326516"><a href="#local-6989586621679326516"><span class="hs-identifier">cletn</span></a></a><span>
</span><a name="line-568"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326517"><a href="#local-6989586621679326517"><span class="hs-identifier">cletr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326518"><a href="#local-6989586621679326518"><span class="hs-identifier">ccase</span></a></a><span>
</span><a name="line-569"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326519"><a href="#local-6989586621679326519"><span class="hs-identifier">cecase</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326520"><a href="#local-6989586621679326520"><span class="hs-identifier">ctick</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CM"><span class="hs-identifier hs-var">CM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326509"><span class="hs-identifier hs-var">cvar</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326510"><span class="hs-identifier hs-var">clit</span></a><span>
</span><a name="line-571"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326511"><span class="hs-identifier hs-var">cco</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326512"><span class="hs-identifier hs-var">ctype</span></a><span>
</span><a name="line-572"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326513"><span class="hs-identifier hs-var">ccast</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326514"><span class="hs-identifier hs-var">capp</span></a><span>
</span><a name="line-573"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_lam</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326515"><span class="hs-identifier hs-var">clam</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326516"><span class="hs-identifier hs-var">cletn</span></a><span>
</span><a name="line-574"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_letr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326517"><span class="hs-identifier hs-var">cletr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326518"><span class="hs-identifier hs-var">ccase</span></a><span>
</span><a name="line-575"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326519"><span class="hs-identifier hs-var">cecase</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326508"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326520"><span class="hs-identifier hs-var">ctick</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-comment">--------------------------</span><span>
</span><a name="line-578"></a><span class="hs-identifier">lookupCoreMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326342"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326342"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-579"></a><a name="lookupCoreMap"><a href="TrieMap.html#lookupCoreMap"><span class="hs-identifier">lookupCoreMap</span></a></a><span> </span><a name="local-6989586621679326521"><a href="#local-6989586621679326521"><span class="hs-identifier">cm</span></a></a><span> </span><a name="local-6989586621679326522"><a href="#local-6989586621679326522"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><a href="#local-6989586621679326522"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679326521"><span class="hs-identifier hs-var">cm</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-identifier">extendCoreMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326341"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326341"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326341"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-582"></a><a name="extendCoreMap"><a href="TrieMap.html#extendCoreMap"><span class="hs-identifier">extendCoreMap</span></a></a><span> </span><a name="local-6989586621679326523"><a href="#local-6989586621679326523"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326524"><a href="#local-6989586621679326524"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679326525"><a href="#local-6989586621679326525"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326524"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326525"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326523"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">foldCoreMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326340"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326340"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326340"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326340"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-585"></a><a name="foldCoreMap"><a href="TrieMap.html#foldCoreMap"><span class="hs-identifier">foldCoreMap</span></a></a><span> </span><a name="local-6989586621679326526"><a href="#local-6989586621679326526"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326527"><a href="#local-6989586621679326527"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679326528"><a href="#local-6989586621679326528"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326526"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326528"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679326527"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-identifier">emptyCoreMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326338"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-588"></a><a name="emptyCoreMap"><a href="TrieMap.html#emptyCoreMap"><span class="hs-identifier">emptyCoreMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-589"></a><span>
</span><a name="line-590"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679326191"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a><span> </span><a href="#local-6989586621679326191"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-591"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621679326192"><a href="#local-6989586621679326192"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CoreMap elts&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326192"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-594"></a><span class="hs-identifier">fdE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326336"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326337"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326337"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326336"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326337"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326337"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-595"></a><a name="fdE"><a href="TrieMap.html#fdE"><span class="hs-identifier">fdE</span></a></a><span> </span><a name="local-6989586621679326529"><a href="#local-6989586621679326529"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326530"><a href="#local-6989586621679326530"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-596"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_var</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-597"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_lit</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_co</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_type</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-600"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_cast</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_tick</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_app</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_lam</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_letn</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_letr</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-606"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_case</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-607"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326529"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cm_ecase</span><span> </span><a href="#local-6989586621679326530"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span class="hs-comment">-- lkE: lookup in trie for expressions</span><span>
</span><a name="line-610"></a><span class="hs-identifier">lkE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326335"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326335"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-611"></a><a name="lkE"><a href="TrieMap.html#lkE"><span class="hs-identifier">lkE</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326531"><a href="#local-6989586621679326531"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326532"><a href="#local-6989586621679326532"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326533"><a href="#local-6989586621679326533"><span class="hs-identifier">cm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326534"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326532"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679326533"><span class="hs-identifier hs-var">cm</span></a><span>
</span><a name="line-612"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-613"></a><span>    </span><a name="local-6989586621679326534"><a href="#local-6989586621679326534"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679326535"><a href="#local-6989586621679326535"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_var</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkVar"><span class="hs-identifier hs-var">lkVar</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326535"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-614"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><a name="local-6989586621679326536"><a href="#local-6989586621679326536"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_lit</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkLit"><span class="hs-identifier hs-var">lkLit</span></a><span> </span><a href="#local-6989586621679326536"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-615"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-6989586621679326537"><a href="#local-6989586621679326537"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326537"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-6989586621679326538"><a href="#local-6989586621679326538"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_co</span><span>   </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326538"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-6989586621679326539"><a href="#local-6989586621679326539"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679326540"><a href="#local-6989586621679326540"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326539"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326540"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><a name="local-6989586621679326541"><a href="#local-6989586621679326541"><span class="hs-identifier">tickish</span></a></a><span> </span><a name="local-6989586621679326542"><a href="#local-6989586621679326542"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326542"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkTickish"><span class="hs-identifier hs-var">lkTickish</span></a><span> </span><a href="#local-6989586621679326541"><span class="hs-identifier hs-var">tickish</span></a><span>
</span><a name="line-619"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679326543"><a href="#local-6989586621679326543"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679326544"><a href="#local-6989586621679326544"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_app</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326544"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326543"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679326545"><a href="#local-6989586621679326545"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326546"><a href="#local-6989586621679326546"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_lam</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326545"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326546"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>                              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326545"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-622"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-6989586621679326547"><a href="#local-6989586621679326547"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679326548"><a href="#local-6989586621679326548"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326549"><a href="#local-6989586621679326549"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326548"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-623"></a><span>                              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326547"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326549"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326547"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-624"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-6989586621679326550"><a href="#local-6989586621679326550"><span class="hs-identifier">prs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326551"><a href="#local-6989586621679326551"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679326552"><a href="#local-6989586621679326552"><span class="hs-identifier">bndrs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679326553"><a href="#local-6989586621679326553"><span class="hs-identifier">rhss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621679326550"><span class="hs-identifier hs-var">prs</span></a><span>
</span><a name="line-625"></a><span>                                  </span><a name="local-6989586621679326554"><a href="#local-6989586621679326554"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326552"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-626"></a><span>                              </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">cm_letr</span><span>
</span><a name="line-627"></a><span>                                 </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkList"><span class="hs-identifier hs-var">lkList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326554"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326553"><span class="hs-identifier hs-var">rhss</span></a><span>
</span><a name="line-628"></a><span>                                 </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326554"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326551"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>                                 </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkList"><span class="hs-identifier hs-var">lkList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a><span> </span><a href="#local-6989586621679326554"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326552"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-630"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a name="local-6989586621679326555"><a href="#local-6989586621679326555"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679326556"><a href="#local-6989586621679326556"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679326557"><a href="#local-6989586621679326557"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- See Note [Empty case alternatives]</span><span>
</span><a name="line-631"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-keyword">as</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326555"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326557"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326555"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>                              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkList"><span class="hs-identifier hs-var">lkList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#lkA"><span class="hs-identifier hs-var">lkA</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326556"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326334"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326334"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoreMapX"><span class="hs-identifier hs-type">CoreMapX</span></a><span> </span><a href="#local-6989586621679326334"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-636"></a><a name="xtE"><a href="TrieMap.html#xtE"><span class="hs-identifier">xtE</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326559"><a href="#local-6989586621679326559"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679326560"><a href="#local-6989586621679326560"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>              </span><a name="local-6989586621679326561"><a href="#local-6989586621679326561"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326562"><a href="#local-6989586621679326562"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326562"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_var</span><span> </span><a href="#local-6989586621679326562"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-637"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtVar"><span class="hs-identifier hs-var">xtVar</span></a><span> </span><a href="#local-6989586621679326559"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326560"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326561"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-638"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326563"><a href="#local-6989586621679326563"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a name="local-6989586621679326564"><a href="#local-6989586621679326564"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>             </span><a name="local-6989586621679326565"><a href="#local-6989586621679326565"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326566"><a href="#local-6989586621679326566"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326566"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_type</span><span> </span><a href="#local-6989586621679326566"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-639"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326563"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326564"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326565"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-640"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326567"><a href="#local-6989586621679326567"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-6989586621679326568"><a href="#local-6989586621679326568"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><a name="local-6989586621679326569"><a href="#local-6989586621679326569"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326570"><a href="#local-6989586621679326570"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326570"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_co</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_co</span><span> </span><a href="#local-6989586621679326570"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-641"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326567"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326568"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326569"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-642"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="CoreSyn.html#Lit"><span class="hs-identifier hs-var">Lit</span></a><span> </span><a name="local-6989586621679326571"><a href="#local-6989586621679326571"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>              </span><a name="local-6989586621679326572"><a href="#local-6989586621679326572"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326573"><a href="#local-6989586621679326573"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326573"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_lit</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_lit</span><span> </span><a href="#local-6989586621679326573"><span class="hs-identifier hs-var">m</span></a><span>  </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtLit"><span class="hs-identifier hs-var">xtLit</span></a><span> </span><a href="#local-6989586621679326571"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679326572"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-643"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326574"><a href="#local-6989586621679326574"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-6989586621679326575"><a href="#local-6989586621679326575"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679326576"><a href="#local-6989586621679326576"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><a name="local-6989586621679326577"><a href="#local-6989586621679326577"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326578"><a href="#local-6989586621679326578"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326578"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_cast</span><span> </span><a href="#local-6989586621679326578"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326574"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326575"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326574"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326576"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326577"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-645"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326579"><a href="#local-6989586621679326579"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span> </span><a name="local-6989586621679326580"><a href="#local-6989586621679326580"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679326581"><a href="#local-6989586621679326581"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><a name="local-6989586621679326582"><a href="#local-6989586621679326582"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326583"><a href="#local-6989586621679326583"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326583"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_tick</span><span> </span><a href="#local-6989586621679326583"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326579"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326581"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtTickish"><span class="hs-identifier hs-var">xtTickish</span></a><span> </span><a href="#local-6989586621679326580"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679326582"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-647"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326584"><a href="#local-6989586621679326584"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679326585"><a href="#local-6989586621679326585"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679326586"><a href="#local-6989586621679326586"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><a name="local-6989586621679326587"><a href="#local-6989586621679326587"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326588"><a href="#local-6989586621679326588"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326588"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_app</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_app</span><span> </span><a href="#local-6989586621679326588"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326584"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326586"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326584"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326585"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326587"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-649"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326589"><a href="#local-6989586621679326589"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679326590"><a href="#local-6989586621679326590"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326591"><a href="#local-6989586621679326591"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>            </span><a name="local-6989586621679326592"><a href="#local-6989586621679326592"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326593"><a href="#local-6989586621679326593"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326593"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_lam</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_lam</span><span> </span><a href="#local-6989586621679326593"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-650"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326589"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326590"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326591"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtBndr"><span class="hs-identifier hs-var">xtBndr</span></a><span> </span><a href="#local-6989586621679326589"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326590"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326592"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-652"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326594"><a href="#local-6989586621679326594"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span> </span><a name="local-6989586621679326595"><a href="#local-6989586621679326595"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679326596"><a href="#local-6989586621679326596"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326597"><a href="#local-6989586621679326597"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326598"><a href="#local-6989586621679326598"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326599"><a href="#local-6989586621679326599"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326599"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_letn</span><span> </span><a href="#local-6989586621679326599"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-653"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326594"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326595"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326597"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-654"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326594"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326596"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtBndr"><span class="hs-identifier hs-var">xtBndr</span></a><span> </span><a href="#local-6989586621679326594"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326595"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679326598"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-656"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326600"><a href="#local-6989586621679326600"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><a name="local-6989586621679326601"><a href="#local-6989586621679326601"><span class="hs-identifier">prs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326602"><a href="#local-6989586621679326602"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><a name="local-6989586621679326603"><a href="#local-6989586621679326603"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326604"><a href="#local-6989586621679326604"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326604"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_letr</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-657"></a><span>                                              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679326605"><a href="#local-6989586621679326605"><span class="hs-identifier">bndrs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679326606"><a href="#local-6989586621679326606"><span class="hs-identifier">rhss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621679326601"><span class="hs-identifier hs-var">prs</span></a><span>
</span><a name="line-658"></a><span>                                                  </span><a name="local-6989586621679326607"><a href="#local-6989586621679326607"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326600"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326605"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-659"></a><span>                                              </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">cm_letr</span><span> </span><a href="#local-6989586621679326604"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-660"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span>  </span><a href="TrieMap.html#xtList"><span class="hs-identifier hs-var">xtList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326607"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326606"><span class="hs-identifier hs-var">rhss</span></a><span>
</span><a name="line-661"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326607"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326602"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtList"><span class="hs-identifier hs-var">xtList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#xtBndr"><span class="hs-identifier hs-var">xtBndr</span></a><span> </span><a href="#local-6989586621679326607"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>                                                            </span><a href="#local-6989586621679326605"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679326603"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-664"></a><span class="hs-identifier">xtE</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326608"><a href="#local-6989586621679326608"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a name="local-6989586621679326609"><a href="#local-6989586621679326609"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679326610"><a href="#local-6989586621679326610"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679326611"><a href="#local-6989586621679326611"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><a name="local-6989586621679326613"><a href="#local-6989586621679326613"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326614"><a href="#local-6989586621679326614"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-665"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-keyword">as</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326614"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_ecase</span><span> </span><a href="#local-6989586621679326614"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326608"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326609"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326608"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326611"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326613"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-667"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326614"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cm_case</span><span> </span><a href="#local-6989586621679326614"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326608"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326609"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>                                                 </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679326615"><a href="#local-6989586621679326615"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326608"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326610"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-669"></a><span>                                                     </span><span class="hs-keyword">in</span><span> </span><a href="TrieMap.html#xtList"><span class="hs-identifier hs-var">xtList</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#xtA"><span class="hs-identifier hs-var">xtA</span></a><span> </span><a href="#local-6989586621679326615"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679326613"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span class="hs-comment">-- TODO: this seems a bit dodgy, see 'eqTickish'</span><span>
</span><a name="line-672"></a><span class="hs-keyword">type</span><span> </span><a name="TickishMap"><a href="TrieMap.html#TickishMap"><span class="hs-identifier">TickishMap</span></a></a><span> </span><a name="local-6989586621679326073"><a href="#local-6989586621679326073"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Tickish"><span class="hs-identifier hs-type">Tickish</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326073"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-673"></a><span class="hs-identifier">lkTickish</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#Tickish"><span class="hs-identifier hs-type">Tickish</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TickishMap"><span class="hs-identifier hs-type">TickishMap</span></a><span> </span><a href="#local-6989586621679326333"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326333"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-674"></a><a name="lkTickish"><a href="TrieMap.html#lkTickish"><span class="hs-identifier">lkTickish</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-identifier">xtTickish</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#Tickish"><span class="hs-identifier hs-type">Tickish</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326332"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TickishMap"><span class="hs-identifier hs-type">TickishMap</span></a><span> </span><a href="#local-6989586621679326332"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TickishMap"><span class="hs-identifier hs-type">TickishMap</span></a><span> </span><a href="#local-6989586621679326332"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-677"></a><a name="xtTickish"><a href="TrieMap.html#xtTickish"><span class="hs-identifier">xtTickish</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-comment">------------------------</span><span>
</span><a name="line-680"></a><span class="hs-keyword">data</span><span> </span><a name="AltMap"><a href="TrieMap.html#AltMap"><span class="hs-identifier">AltMap</span></a></a><span> </span><a name="local-6989586621679326072"><a href="#local-6989586621679326072"><span class="hs-identifier">a</span></a></a><span>   </span><span class="hs-comment">-- A single alternative</span><span>
</span><a name="line-681"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="AM"><a href="TrieMap.html#AM"><span class="hs-identifier">AM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="am_deflt"><a href="TrieMap.html#am_deflt"><span class="hs-identifier">am_deflt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><a href="#local-6989586621679326072"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-682"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="am_data"><a href="TrieMap.html#am_data"><span class="hs-identifier">am_data</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="NameEnv.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><a href="#local-6989586621679326072"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="am_lit"><a href="TrieMap.html#am_lit"><span class="hs-identifier">am_lit</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#LiteralMap"><span class="hs-identifier hs-type">LiteralMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoreMapG"><span class="hs-identifier hs-type">CoreMapG</span></a><span> </span><a href="#local-6989586621679326072"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-686"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span>
</span><a name="line-687"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#AM"><span class="hs-identifier hs-var">AM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-688"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_data</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyDNameEnv"><span class="hs-identifier hs-var">emptyDNameEnv</span></a><span>
</span><a name="line-689"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_lit</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyLiteralMap"><span class="hs-identifier hs-var">emptyLiteralMap</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-690"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkA"><span class="hs-identifier hs-var">lkA</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-691"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtA"><span class="hs-identifier hs-var">xtA</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-692"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdA"><span class="hs-identifier hs-var">fdA</span></a><span>
</span><a name="line-693"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapA"><span class="hs-identifier hs-var">mapA</span></a><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-696"></a><span>  </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326174"><a href="#local-6989586621679326174"><span class="hs-identifier">env1</span></a></a><span> </span><a name="local-6989586621679326175"><a href="#local-6989586621679326175"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326176"><a href="#local-6989586621679326176"><span class="hs-identifier">env2</span></a></a><span> </span><a name="local-6989586621679326177"><a href="#local-6989586621679326177"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326178"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326175"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679326177"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-697"></a><span>    </span><a name="local-6989586621679326178"><a href="#local-6989586621679326178"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326179"><a href="#local-6989586621679326179"><span class="hs-identifier">rhs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326180"><a href="#local-6989586621679326180"><span class="hs-identifier">rhs2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326174"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326179"><span class="hs-identifier hs-var">rhs1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326176"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326180"><span class="hs-identifier hs-var">rhs2</span></a><span>
</span><a name="line-699"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><a name="local-6989586621679326181"><a href="#local-6989586621679326181"><span class="hs-identifier">lit1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326182"><a href="#local-6989586621679326182"><span class="hs-identifier">rhs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><a name="local-6989586621679326183"><a href="#local-6989586621679326183"><span class="hs-identifier">lit2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326184"><a href="#local-6989586621679326184"><span class="hs-identifier">rhs2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326181"><span class="hs-identifier hs-var">lit1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326183"><span class="hs-identifier hs-var">lit2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326174"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326182"><span class="hs-identifier hs-var">rhs1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326176"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326184"><span class="hs-identifier hs-var">rhs2</span></a><span>
</span><a name="line-701"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a name="local-6989586621679326185"><a href="#local-6989586621679326185"><span class="hs-identifier">dc1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326186"><a href="#local-6989586621679326186"><span class="hs-identifier">bs1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326187"><a href="#local-6989586621679326187"><span class="hs-identifier">rhs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a name="local-6989586621679326188"><a href="#local-6989586621679326188"><span class="hs-identifier">dc2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326189"><a href="#local-6989586621679326189"><span class="hs-identifier">bs2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326190"><a href="#local-6989586621679326190"><span class="hs-identifier">rhs2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326185"><span class="hs-identifier hs-var">dc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326188"><span class="hs-identifier hs-var">dc2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-703"></a><span>          </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326174"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679326186"><span class="hs-identifier hs-var">bs1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326187"><span class="hs-identifier hs-var">rhs1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326176"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679326189"><span class="hs-identifier hs-var">bs2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326190"><span class="hs-identifier hs-var">rhs2</span></a><span>
</span><a name="line-704"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-identifier">mapA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326330"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326331"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326330"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326331"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-707"></a><a name="mapA"><a href="TrieMap.html#mapA"><span class="hs-identifier">mapA</span></a></a><span> </span><a name="local-6989586621679326616"><a href="#local-6989586621679326616"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#AM"><span class="hs-identifier hs-var">AM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326617"><a href="#local-6989586621679326617"><span class="hs-identifier">adeflt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_data</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326618"><a href="#local-6989586621679326618"><span class="hs-identifier">adata</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326619"><a href="#local-6989586621679326619"><span class="hs-identifier">alit</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#AM"><span class="hs-identifier hs-var">AM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326616"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326617"><span class="hs-identifier hs-var">adeflt</span></a><span>
</span><a name="line-709"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_data</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326616"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326618"><span class="hs-identifier hs-var">adata</span></a><span>
</span><a name="line-710"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">am_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326616"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326619"><span class="hs-identifier hs-var">alit</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-711"></a><span>
</span><a name="line-712"></a><span class="hs-identifier">lkA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326329"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326329"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-713"></a><a name="lkA"><a href="TrieMap.html#lkA"><span class="hs-identifier">lkA</span></a></a><span> </span><a name="local-6989586621679326620"><a href="#local-6989586621679326620"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span>    </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326621"><a href="#local-6989586621679326621"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326620"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326621"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span class="hs-identifier">lkA</span><span> </span><a name="local-6989586621679326622"><a href="#local-6989586621679326622"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><a name="local-6989586621679326623"><a href="#local-6989586621679326623"><span class="hs-identifier">lit</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326624"><a href="#local-6989586621679326624"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_lit</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkLit"><span class="hs-identifier hs-var">lkLit</span></a><span> </span><a href="#local-6989586621679326623"><span class="hs-identifier hs-var">lit</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326622"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326624"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span class="hs-identifier">lkA</span><span> </span><a name="local-6989586621679326625"><a href="#local-6989586621679326625"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a name="local-6989586621679326626"><a href="#local-6989586621679326626"><span class="hs-identifier">dc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326627"><a href="#local-6989586621679326627"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326628"><a href="#local-6989586621679326628"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_data</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkDNamed"><span class="hs-identifier hs-var">lkDNamed</span></a><span> </span><a href="#local-6989586621679326626"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-716"></a><span>                                        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326625"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326627"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326628"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-identifier">xtA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoreSyn.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326328"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326328"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326328"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-719"></a><a name="xtA"><a href="TrieMap.html#xtA"><span class="hs-identifier">xtA</span></a></a><span> </span><a name="local-6989586621679326629"><a href="#local-6989586621679326629"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326630"><a href="#local-6989586621679326630"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-6989586621679326631"><a href="#local-6989586621679326631"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326632"><a href="#local-6989586621679326632"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-720"></a><span>    </span><a href="#local-6989586621679326632"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_deflt</span><span> </span><a href="#local-6989586621679326632"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326629"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326630"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326631"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-721"></a><span class="hs-identifier">xtA</span><span> </span><a name="local-6989586621679326633"><a href="#local-6989586621679326633"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a><span> </span><a name="local-6989586621679326634"><a href="#local-6989586621679326634"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679326635"><a href="#local-6989586621679326635"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679326636"><a href="#local-6989586621679326636"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326637"><a href="#local-6989586621679326637"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-722"></a><span>    </span><a href="#local-6989586621679326637"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_lit</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_lit</span><span> </span><a href="#local-6989586621679326637"><span class="hs-identifier hs-var">m</span></a><span>   </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtLit"><span class="hs-identifier hs-var">xtLit</span></a><span> </span><a href="#local-6989586621679326634"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326633"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326635"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326636"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-723"></a><span class="hs-identifier">xtA</span><span> </span><a name="local-6989586621679326638"><a href="#local-6989586621679326638"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a><span> </span><a name="local-6989586621679326639"><a href="#local-6989586621679326639"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326640"><a href="#local-6989586621679326640"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326641"><a href="#local-6989586621679326641"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326642"><a href="#local-6989586621679326642"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326643"><a href="#local-6989586621679326643"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-724"></a><span>    </span><a href="#local-6989586621679326643"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">am_data</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">am_data</span><span> </span><a href="#local-6989586621679326643"><span class="hs-identifier hs-var">m</span></a><span>  </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtDNamed"><span class="hs-identifier hs-var">xtDNamed</span></a><span> </span><a href="#local-6989586621679326639"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-725"></a><span>                             </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="#local-6989586621679326638"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326640"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326641"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326642"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-identifier">fdA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326326"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326327"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326327"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#AltMap"><span class="hs-identifier hs-type">AltMap</span></a><span> </span><a href="#local-6989586621679326326"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326327"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326327"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-728"></a><a name="fdA"><a href="TrieMap.html#fdA"><span class="hs-identifier">fdA</span></a></a><span> </span><a name="local-6989586621679326644"><a href="#local-6989586621679326644"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326645"><a href="#local-6989586621679326645"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326644"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">am_deflt</span><span> </span><a href="#local-6989586621679326645"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326644"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">am_data</span><span> </span><a href="#local-6989586621679326645"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326644"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">am_lit</span><span> </span><a href="#local-6989586621679326645"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Coercions
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-comment">-- We should really never care about the contents of a coercion. Instead,</span><span>
</span><a name="line-741"></a><span class="hs-comment">-- just look up the coercion's type.</span><span>
</span><a name="line-742"></a><span class="hs-keyword">newtype</span><span> </span><a name="CoercionMap"><a href="TrieMap.html#CoercionMap"><span class="hs-identifier">CoercionMap</span></a></a><span> </span><a name="local-6989586621679326071"><a href="#local-6989586621679326071"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CoercionMap"><a href="TrieMap.html#CoercionMap"><span class="hs-identifier">CoercionMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapG"><span class="hs-identifier hs-type">CoercionMapG</span></a><span> </span><a href="#local-6989586621679326071"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-745"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-746"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-747"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326165"><a href="#local-6989586621679326165"><span class="hs-identifier">k</span></a></a><span>  </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><a name="local-6989586621679326166"><a href="#local-6989586621679326166"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326165"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326166"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-748"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326167"><a href="#local-6989586621679326167"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326168"><a href="#local-6989586621679326168"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><a name="local-6989586621679326169"><a href="#local-6989586621679326169"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326167"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326168"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326169"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326170"><a href="#local-6989586621679326170"><span class="hs-identifier">k</span></a></a><span>    </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><a name="local-6989586621679326171"><a href="#local-6989586621679326171"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326170"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326171"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-750"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326172"><a href="#local-6989586621679326172"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><a name="local-6989586621679326173"><a href="#local-6989586621679326173"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326172"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326173"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-keyword">type</span><span> </span><a name="CoercionMapG"><a href="TrieMap.html#CoercionMapG"><span class="hs-identifier">CoercionMapG</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span>
</span><a name="line-753"></a><span class="hs-keyword">newtype</span><span> </span><a name="CoercionMapX"><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier">CoercionMapX</span></a></a><span> </span><a name="local-6989586621679326070"><a href="#local-6989586621679326070"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CoercionMapX"><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier">CoercionMapX</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326070"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-756"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-757"></a><span>  </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-758"></a><span>  </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkC"><span class="hs-identifier hs-var">lkC</span></a><span>
</span><a name="line-759"></a><span>  </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtC"><span class="hs-identifier hs-var">xtC</span></a><span>
</span><a name="line-760"></a><span>  </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326161"><a href="#local-6989586621679326161"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><a name="local-6989586621679326162"><a href="#local-6989586621679326162"><span class="hs-identifier">core_tm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326161"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326162"><span class="hs-identifier hs-var">core_tm</span></a><span>
</span><a name="line-761"></a><span>  </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326163"><a href="#local-6989586621679326163"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><a name="local-6989586621679326164"><a href="#local-6989586621679326164"><span class="hs-identifier">core_tm</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326163"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326164"><span class="hs-identifier hs-var">core_tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-762"></a><span>
</span><a name="line-763"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-764"></a><span>  </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326157"><a href="#local-6989586621679326157"><span class="hs-identifier">env1</span></a></a><span> </span><a name="local-6989586621679326158"><a href="#local-6989586621679326158"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326159"><a href="#local-6989586621679326159"><span class="hs-identifier">env2</span></a></a><span> </span><a name="local-6989586621679326160"><a href="#local-6989586621679326160"><span class="hs-identifier">co2</span></a></a><span>
</span><a name="line-765"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326157"><span class="hs-identifier hs-var">env1</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-6989586621679326158"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span>
</span><a name="line-766"></a><span>      </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326159"><span class="hs-identifier hs-var">env2</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-6989586621679326160"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span class="hs-identifier">lkC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span> </span><a href="#local-6989586621679326325"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326325"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-769"></a><a name="lkC"><a href="TrieMap.html#lkC"><span class="hs-identifier">lkC</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326646"><a href="#local-6989586621679326646"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326647"><a href="#local-6989586621679326647"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><a name="local-6989586621679326648"><a href="#local-6989586621679326648"><span class="hs-identifier">core_tm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkT"><span class="hs-identifier hs-var">lkT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326646"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-6989586621679326647"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>                                        </span><a href="#local-6989586621679326648"><span class="hs-identifier hs-var">core_tm</span></a><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-identifier">xtC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326324"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span> </span><a href="#local-6989586621679326324"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a><span> </span><a href="#local-6989586621679326324"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-773"></a><a name="xtC"><a href="TrieMap.html#xtC"><span class="hs-identifier">xtC</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326649"><a href="#local-6989586621679326649"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326650"><a href="#local-6989586621679326650"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326651"><a href="#local-6989586621679326651"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><a name="local-6989586621679326652"><a href="#local-6989586621679326652"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#xtT"><span class="hs-identifier hs-var">xtT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326649"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-6989586621679326650"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326651"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326652"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Types
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-comment">-- | @TypeMapG a@ is a map from @DeBruijn Type@ to @a@.  The extended</span><span>
</span><a name="line-785"></a><span class="hs-comment">-- key makes it suitable for recursive traversal, since it can track binders,</span><span>
</span><a name="line-786"></a><span class="hs-comment">-- but it is strictly internal to this module.  If you are including a 'TypeMap'</span><span>
</span><a name="line-787"></a><span class="hs-comment">-- inside another 'TrieMap', this is the type you want. Note that this</span><span>
</span><a name="line-788"></a><span class="hs-comment">-- lookup does not do a kind-check. Thus, all keys in this map must have</span><span>
</span><a name="line-789"></a><span class="hs-comment">-- the same kind. Also note that this map respects the distinction between</span><span>
</span><a name="line-790"></a><span class="hs-comment">-- @Type@ and @Constraint@, despite the fact that they are equivalent type</span><span>
</span><a name="line-791"></a><span class="hs-comment">-- synonyms in Core.</span><span>
</span><a name="line-792"></a><span class="hs-keyword">type</span><span> </span><a name="TypeMapG"><a href="TrieMap.html#TypeMapG"><span class="hs-identifier">TypeMapG</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span>
</span><a name="line-793"></a><span>
</span><a name="line-794"></a><span class="hs-comment">-- | @TypeMapX a@ is the base map from @DeBruijn Type@ to @a@, but without the</span><span>
</span><a name="line-795"></a><span class="hs-comment">-- 'GenMap' optimization.</span><span>
</span><a name="line-796"></a><span class="hs-keyword">data</span><span> </span><a name="TypeMapX"><a href="TrieMap.html#TypeMapX"><span class="hs-identifier">TypeMapX</span></a></a><span> </span><a name="local-6989586621679326069"><a href="#local-6989586621679326069"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-797"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TM"><a href="TrieMap.html#TM"><span class="hs-identifier">TM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="tm_var"><a href="TrieMap.html#tm_var"><span class="hs-identifier">tm_var</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-798"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="tm_app"><a href="TrieMap.html#tm_app"><span class="hs-identifier">tm_app</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="tm_tycon"><a href="TrieMap.html#tm_tycon"><span class="hs-identifier">tm_tycon</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="NameEnv.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-800"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="tm_forall"><a href="TrieMap.html#tm_forall"><span class="hs-identifier">tm_forall</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- See Note [Binders]</span><span>
</span><a name="line-801"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="tm_tylit"><a href="TrieMap.html#tm_tylit"><span class="hs-identifier">tm_tylit</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-802"></a><span>       </span><span class="hs-special">,</span><span> </span><a name="tm_coerce"><a href="TrieMap.html#tm_coerce"><span class="hs-identifier">tm_coerce</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326069"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-803"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-804"></a><span>    </span><span class="hs-comment">-- Note that there is no tyconapp case; see Note [Equality on AppTys] in Type</span><span>
</span><a name="line-805"></a><span>
</span><a name="line-806"></a><span class="hs-comment">-- | Squeeze out any synonyms, and change TyConApps to nested AppTys. Why the</span><span>
</span><a name="line-807"></a><span class="hs-comment">-- last one? See Note [Equality on AppTys] in Type</span><span>
</span><a name="line-808"></a><span class="hs-comment">--</span><span>
</span><a name="line-809"></a><span class="hs-comment">-- Note, however, that we keep Constraint and Type apart here, despite the fact</span><span>
</span><a name="line-810"></a><span class="hs-comment">-- that they are both synonyms of TYPE 'LiftedRep (see #11715).</span><span>
</span><a name="line-811"></a><span class="hs-identifier">trieMapView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-812"></a><a name="trieMapView"><a href="TrieMap.html#trieMapView"><span class="hs-identifier">trieMapView</span></a></a><span> </span><a name="local-6989586621679326653"><a href="#local-6989586621679326653"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-813"></a><span>  </span><span class="hs-comment">-- First check for TyConApps that need to be expanded to</span><span>
</span><a name="line-814"></a><span>  </span><span class="hs-comment">-- AppTy chains.</span><span>
</span><a name="line-815"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326654"><a href="#local-6989586621679326654"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326655"><a href="#local-6989586621679326655"><span class="hs-identifier">tys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679326653"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-816"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679326654"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326655"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span>  </span><span class="hs-comment">-- Then resolve any remaining nullary synonyms.</span><span>
</span><a name="line-819"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326656"><a href="#local-6989586621679326656"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a><span> </span><a href="#local-6989586621679326653"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326656"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-820"></a><span class="hs-identifier">trieMapView</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-823"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-824"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyT"><span class="hs-identifier hs-var">emptyT</span></a><span>
</span><a name="line-825"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkT"><span class="hs-identifier hs-var">lkT</span></a><span>
</span><a name="line-826"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtT"><span class="hs-identifier hs-var">xtT</span></a><span>
</span><a name="line-827"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdT"><span class="hs-identifier hs-var">fdT</span></a><span>
</span><a name="line-828"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapT"><span class="hs-identifier hs-var">mapT</span></a><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-831"></a><span>  </span><a name="local-6989586621679326119"><a href="#local-6989586621679326119"><span class="hs-identifier">env_t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326120"><a href="#local-6989586621679326120"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326121"><a href="#local-6989586621679326121"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679326122"><a href="#local-6989586621679326122"><span class="hs-identifier">env_t'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326123"><a href="#local-6989586621679326123"><span class="hs-identifier">env'</span></a></a><span> </span><a name="local-6989586621679326124"><a href="#local-6989586621679326124"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-832"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326125"><a href="#local-6989586621679326125"><span class="hs-identifier">new_t</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a><span> </span><a href="#local-6989586621679326121"><span class="hs-identifier hs-var">t</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326125"><span class="hs-identifier hs-var">new_t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326122"><span class="hs-identifier hs-var">env_t'</span></a><span>
</span><a name="line-833"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326126"><a href="#local-6989586621679326126"><span class="hs-identifier">new_t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a><span> </span><a href="#local-6989586621679326124"><span class="hs-identifier hs-var">t'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326119"><span class="hs-identifier hs-var">env_t</span></a><span>       </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326126"><span class="hs-identifier hs-var">new_t'</span></a><span>
</span><a name="line-834"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-835"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326121"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679326124"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-836"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679326127"><a href="#local-6989586621679326127"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326127"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326124"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-837"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679326128"><a href="#local-6989586621679326128"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326121"><span class="hs-identifier hs-var">t</span></a><span>  </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326128"><span class="hs-identifier hs-var">t1'</span></a><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679326129"><a href="#local-6989586621679326129"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679326130"><a href="#local-6989586621679326130"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326129"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326130"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-841"></a><span>                </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326131"><a href="#local-6989586621679326131"><span class="hs-identifier">bv</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326132"><a href="#local-6989586621679326132"><span class="hs-identifier">bv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326131"><span class="hs-identifier hs-var">bv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326132"><span class="hs-identifier hs-var">bv'</span></a><span>
</span><a name="line-842"></a><span>                </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326129"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326130"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-843"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-844"></a><span>                </span><span class="hs-comment">-- See Note [Equality on AppTys] in Type</span><span>
</span><a name="line-845"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679326133"><a href="#local-6989586621679326133"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679326134"><a href="#local-6989586621679326134"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326135"><a href="#local-6989586621679326135"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326136"><a href="#local-6989586621679326136"><span class="hs-identifier">t1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326137"><a href="#local-6989586621679326137"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679326135"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-846"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326133"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326136"><span class="hs-identifier hs-var">t1'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326134"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326137"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-847"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679326138"><a href="#local-6989586621679326138"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679326139"><a href="#local-6989586621679326139"><span class="hs-identifier">t1'</span></a></a><span> </span><a name="local-6989586621679326140"><a href="#local-6989586621679326140"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326141"><a href="#local-6989586621679326141"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679326142"><a href="#local-6989586621679326142"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679326138"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-848"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326141"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326139"><span class="hs-identifier hs-var">t1'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326142"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326140"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-849"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679326143"><a href="#local-6989586621679326143"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679326144"><a href="#local-6989586621679326144"><span class="hs-identifier">t2</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679326145"><a href="#local-6989586621679326145"><span class="hs-identifier">t1'</span></a></a><span> </span><a name="local-6989586621679326146"><a href="#local-6989586621679326146"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-850"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326143"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326145"><span class="hs-identifier hs-var">t1'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326144"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326146"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-851"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679326147"><a href="#local-6989586621679326147"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679326148"><a href="#local-6989586621679326148"><span class="hs-identifier">tys</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679326149"><a href="#local-6989586621679326149"><span class="hs-identifier">tc'</span></a></a><span> </span><a name="local-6989586621679326150"><a href="#local-6989586621679326150"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326147"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326149"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326148"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326150"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-853"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679326151"><a href="#local-6989586621679326151"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679326152"><a href="#local-6989586621679326152"><span class="hs-identifier">l'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326151"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679326152"><span class="hs-identifier hs-var">l'</span></a><span>
</span><a name="line-855"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679326153"><a href="#local-6989586621679326153"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326154"><a href="#local-6989586621679326154"><span class="hs-identifier">ty</span></a></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679326155"><a href="#local-6989586621679326155"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326156"><a href="#local-6989586621679326156"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679326153"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>    </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679326155"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-857"></a><span>               </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326153"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326154"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326123"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326155"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326156"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-858"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-859"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-860"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-861"></a><span>
</span><a name="line-862"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING #-}</span><span>
</span><a name="line-863"></a><span>         </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621679326117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-864"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621679326118"><a href="#local-6989586621679326118"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TypeMap elts&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326118"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>
</span><a name="line-866"></a><span class="hs-identifier">emptyT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326323"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-867"></a><a name="emptyT"><a href="TrieMap.html#emptyT"><span class="hs-identifier">emptyT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-868"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_app</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-869"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyDNameEnv"><span class="hs-identifier hs-var">emptyDNameEnv</span></a><span>
</span><a name="line-870"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#EmptyMap"><span class="hs-identifier hs-var">EmptyMap</span></a><span>
</span><a name="line-871"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tylit</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTyLitMap"><span class="hs-identifier hs-var">emptyTyLitMap</span></a><span>
</span><a name="line-872"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_coerce</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-873"></a><span>
</span><a name="line-874"></a><span class="hs-identifier">mapT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326321"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326322"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326321"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326322"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-875"></a><a name="mapT"><a href="TrieMap.html#mapT"><span class="hs-identifier">mapT</span></a></a><span> </span><a name="local-6989586621679326657"><a href="#local-6989586621679326657"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326658"><a href="#local-6989586621679326658"><span class="hs-identifier">tvar</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326659"><a href="#local-6989586621679326659"><span class="hs-identifier">tapp</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326660"><a href="#local-6989586621679326660"><span class="hs-identifier">ttycon</span></a></a><span>
</span><a name="line-876"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326661"><a href="#local-6989586621679326661"><span class="hs-identifier">tforall</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tylit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326662"><a href="#local-6989586621679326662"><span class="hs-identifier">tlit</span></a></a><span>
</span><a name="line-877"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_coerce</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326663"><a href="#local-6989586621679326663"><span class="hs-identifier">tcoerce</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_var</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326658"><span class="hs-identifier hs-var">tvar</span></a><span>
</span><a name="line-879"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_app</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326659"><span class="hs-identifier hs-var">tapp</span></a><span>
</span><a name="line-880"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326660"><span class="hs-identifier hs-var">ttycon</span></a><span>
</span><a name="line-881"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326661"><span class="hs-identifier hs-var">tforall</span></a><span>
</span><a name="line-882"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_tylit</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326662"><span class="hs-identifier hs-var">tlit</span></a><span>
</span><a name="line-883"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tm_coerce</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679326657"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326663"><span class="hs-identifier hs-var">tcoerce</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-884"></a><span>
</span><a name="line-885"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-886"></a><span class="hs-identifier">lkT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326320"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326320"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-887"></a><a name="lkT"><a href="TrieMap.html#lkT"><span class="hs-identifier">lkT</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326664"><a href="#local-6989586621679326664"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326665"><a href="#local-6989586621679326665"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326666"><a href="#local-6989586621679326666"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326667"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326665"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679326666"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-888"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-889"></a><span>    </span><a name="local-6989586621679326667"><a href="#local-6989586621679326667"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679326668"><a href="#local-6989586621679326668"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326669"><a href="#local-6989586621679326669"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TrieMap.html#trieMapView"><span class="hs-identifier hs-var">trieMapView</span></a><span> </span><a href="#local-6989586621679326668"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326667"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326669"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-890"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679326670"><a href="#local-6989586621679326670"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_var</span><span>    </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkVar"><span class="hs-identifier hs-var">lkVar</span></a><span> </span><a href="#local-6989586621679326664"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326670"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-891"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679326671"><a href="#local-6989586621679326671"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679326672"><a href="#local-6989586621679326672"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_app</span><span>    </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326664"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326671"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>                                               </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326664"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326672"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-893"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679326673"><a href="#local-6989586621679326673"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_tycon</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkDNamed"><span class="hs-identifier hs-var">lkDNamed</span></a><span> </span><a href="#local-6989586621679326673"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-894"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679326674"><a href="#local-6989586621679326674"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;lkT TyConApp&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326674"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679326675"><a href="#local-6989586621679326675"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_tylit</span><span>  </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkTyLit"><span class="hs-identifier hs-var">lkTyLit</span></a><span> </span><a href="#local-6989586621679326675"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-896"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679326676"><a href="#local-6989586621679326676"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326677"><a href="#local-6989586621679326677"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326664"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326676"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326677"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-897"></a><span>                                               </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a><span> </span><a href="TrieMap.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a><span> </span><a href="#local-6989586621679326664"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326676"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-898"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679326678"><a href="#local-6989586621679326678"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;lkT FunTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326678"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679326679"><a href="#local-6989586621679326679"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326667"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679326679"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-900"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_coerce</span><span>
</span><a name="line-901"></a><span>
</span><a name="line-902"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-903"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326319"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326319"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326319"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-904"></a><a name="xtT"><a href="TrieMap.html#xtT"><span class="hs-identifier">xtT</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326680"><a href="#local-6989586621679326680"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326681"><a href="#local-6989586621679326681"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326682"><a href="#local-6989586621679326682"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326683"><a href="#local-6989586621679326683"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326684"><a href="#local-6989586621679326684"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TrieMap.html#trieMapView"><span class="hs-identifier hs-var">trieMapView</span></a><span> </span><a href="#local-6989586621679326681"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtT"><span class="hs-identifier hs-var">xtT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326680"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326684"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326682"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326683"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-905"></a><span>
</span><a name="line-906"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326685"><a href="#local-6989586621679326685"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679326686"><a href="#local-6989586621679326686"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><a name="local-6989586621679326687"><a href="#local-6989586621679326687"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326688"><a href="#local-6989586621679326688"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326688"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_var</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_var</span><span> </span><a href="#local-6989586621679326688"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtVar"><span class="hs-identifier hs-var">xtVar</span></a><span> </span><a href="#local-6989586621679326685"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326686"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326687"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-907"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326689"><a href="#local-6989586621679326689"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679326690"><a href="#local-6989586621679326690"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679326691"><a href="#local-6989586621679326691"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><a name="local-6989586621679326692"><a href="#local-6989586621679326692"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326693"><a href="#local-6989586621679326693"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326693"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_app</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_app</span><span> </span><a href="#local-6989586621679326693"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326689"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326690"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>                                                            </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326689"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326691"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326692"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-909"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679326694"><a href="#local-6989586621679326694"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621679326695"><a href="#local-6989586621679326695"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326696"><a href="#local-6989586621679326696"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326696"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_tycon</span><span> </span><a href="#local-6989586621679326696"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtDNamed"><span class="hs-identifier hs-var">xtDNamed</span></a><span> </span><a href="#local-6989586621679326694"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679326695"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-910"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679326697"><a href="#local-6989586621679326697"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><a name="local-6989586621679326698"><a href="#local-6989586621679326698"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326699"><a href="#local-6989586621679326699"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326699"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_tylit</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_tylit</span><span> </span><a href="#local-6989586621679326699"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtTyLit"><span class="hs-identifier hs-var">xtTyLit</span></a><span> </span><a href="#local-6989586621679326697"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679326698"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-911"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326700"><a href="#local-6989586621679326700"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679326701"><a href="#local-6989586621679326701"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><a name="local-6989586621679326702"><a href="#local-6989586621679326702"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326703"><a href="#local-6989586621679326703"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtT"><span class="hs-identifier hs-var">xtT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326701"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326702"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326703"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-912"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679326704"><a href="#local-6989586621679326704"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326705"><a href="#local-6989586621679326705"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326705"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_coerce</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_coerce</span><span> </span><a href="#local-6989586621679326705"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679326704"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-913"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326706"><a href="#local-6989586621679326706"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679326707"><a href="#local-6989586621679326707"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326708"><a href="#local-6989586621679326708"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621679326709"><a href="#local-6989586621679326709"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326710"><a href="#local-6989586621679326710"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-914"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326710"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tm_forall</span><span> </span><a href="#local-6989586621679326710"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326706"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326707"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326708"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-915"></a><span>                                </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtBndr"><span class="hs-identifier hs-var">xtBndr</span></a><span> </span><a href="#local-6989586621679326706"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326707"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679326709"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-916"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><a name="local-6989586621679326711"><a href="#local-6989586621679326711"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;xtT TyConApp&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326711"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span class="hs-identifier">xtT</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><a name="local-6989586621679326712"><a href="#local-6989586621679326712"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;xtT FunTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679326712"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-identifier">fdT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326317"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326318"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326318"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a><span> </span><a href="#local-6989586621679326317"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326318"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326318"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-920"></a><a name="fdT"><a href="TrieMap.html#fdT"><span class="hs-identifier">fdT</span></a></a><span> </span><a name="local-6989586621679326713"><a href="#local-6989586621679326713"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326714"><a href="#local-6989586621679326714"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_var</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-921"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_app</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_tycon</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-923"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_forall</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-924"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTyLit"><span class="hs-identifier hs-var">foldTyLit</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_tylit</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-925"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldMaybe"><span class="hs-identifier hs-var">foldMaybe</span></a><span> </span><a href="#local-6989586621679326713"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tm_coerce</span><span> </span><a href="#local-6989586621679326714"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-comment">------------------------</span><span>
</span><a name="line-928"></a><span class="hs-keyword">data</span><span> </span><a name="TyLitMap"><a href="TrieMap.html#TyLitMap"><span class="hs-identifier">TyLitMap</span></a></a><span> </span><a name="local-6989586621679326068"><a href="#local-6989586621679326068"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TLM"><a href="TrieMap.html#TLM"><span class="hs-identifier">TLM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="tlm_number"><a href="TrieMap.html#tlm_number"><span class="hs-identifier">tlm_number</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><a href="#local-6989586621679326068"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-929"></a><span>                      </span><span class="hs-special">,</span><span> </span><a name="tlm_string"><a href="TrieMap.html#tlm_string"><span class="hs-identifier">tlm_string</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><a href="#local-6989586621679326068"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-930"></a><span>                      </span><span class="hs-special">}</span><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-933"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span>
</span><a name="line-934"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTyLitMap"><span class="hs-identifier hs-var">emptyTyLitMap</span></a><span>
</span><a name="line-935"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkTyLit"><span class="hs-identifier hs-var">lkTyLit</span></a><span>
</span><a name="line-936"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtTyLit"><span class="hs-identifier hs-var">xtTyLit</span></a><span>
</span><a name="line-937"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTyLit"><span class="hs-identifier hs-var">foldTyLit</span></a><span>
</span><a name="line-938"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTyLit"><span class="hs-identifier hs-var">mapTyLit</span></a><span>
</span><a name="line-939"></a><span>
</span><a name="line-940"></a><span class="hs-identifier">emptyTyLitMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326316"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-941"></a><a name="emptyTyLitMap"><a href="TrieMap.html#emptyTyLitMap"><span class="hs-identifier">emptyTyLitMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TLM"><span class="hs-identifier hs-var">TLM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-942"></a><span>
</span><a name="line-943"></a><span class="hs-identifier">mapTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326314"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326315"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326314"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326315"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-944"></a><a name="mapTyLit"><a href="TrieMap.html#mapTyLit"><span class="hs-identifier">mapTyLit</span></a></a><span> </span><a name="local-6989586621679326715"><a href="#local-6989586621679326715"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TLM"><span class="hs-identifier hs-var">TLM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326716"><a href="#local-6989586621679326716"><span class="hs-identifier">tn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326717"><a href="#local-6989586621679326717"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TLM"><span class="hs-identifier hs-var">TLM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679326715"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326716"><span class="hs-identifier hs-var">tn</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679326715"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326717"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span class="hs-identifier">lkTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326313"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326313"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-948"></a><a name="lkTyLit"><a href="TrieMap.html#lkTyLit"><span class="hs-identifier">lkTyLit</span></a></a><span> </span><a name="local-6989586621679326718"><a href="#local-6989586621679326718"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-949"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679326718"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-950"></a><span>    </span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-6989586621679326719"><a href="#local-6989586621679326719"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679326719"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-951"></a><span>    </span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-6989586621679326720"><a href="#local-6989586621679326720"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679326720"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-952"></a><span>
</span><a name="line-953"></a><span class="hs-identifier">xtTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326312"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326312"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326312"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-954"></a><a name="xtTyLit"><a href="TrieMap.html#xtTyLit"><span class="hs-identifier">xtTyLit</span></a></a><span> </span><a name="local-6989586621679326721"><a href="#local-6989586621679326721"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679326722"><a href="#local-6989586621679326722"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326723"><a href="#local-6989586621679326723"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-955"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679326721"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-956"></a><span>    </span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-6989586621679326724"><a href="#local-6989586621679326724"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326723"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tlm_number</span><span> </span><a href="#local-6989586621679326723"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#alter"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679326722"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326724"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-957"></a><span>    </span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-6989586621679326725"><a href="#local-6989586621679326725"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326723"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tlm_string</span><span> </span><a href="#local-6989586621679326723"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#alter"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679326722"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326725"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-958"></a><span>
</span><a name="line-959"></a><span class="hs-identifier">foldTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326310"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326311"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326311"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a><span> </span><a href="#local-6989586621679326310"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326311"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326311"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-960"></a><a name="foldTyLit"><a href="TrieMap.html#foldTyLit"><span class="hs-identifier">foldTyLit</span></a></a><span> </span><a name="local-6989586621679326726"><a href="#local-6989586621679326726"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679326727"><a href="#local-6989586621679326727"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><span class="hs-special">(</span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679326726"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tlm_string</span><span> </span><a href="#local-6989586621679326727"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><span class="hs-special">(</span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679326726"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tlm_number</span><span> </span><a href="#local-6989586621679326727"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span>
</span><a name="line-963"></a><span class="hs-comment">-------------------------------------------------</span><span>
</span><a name="line-964"></a><span class="hs-comment">-- | @TypeMap a@ is a map from 'Type' to @a@.  If you are a client, this</span><span>
</span><a name="line-965"></a><span class="hs-comment">-- is the type you want. The keys in this map may have different kinds.</span><span>
</span><a name="line-966"></a><span class="hs-keyword">newtype</span><span> </span><a name="TypeMap"><a href="TrieMap.html#TypeMap"><span class="hs-identifier">TypeMap</span></a></a><span> </span><a name="local-6989586621679326067"><a href="#local-6989586621679326067"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TypeMap"><a href="TrieMap.html#TypeMap"><span class="hs-identifier">TypeMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326067"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-identifier">lkTT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326309"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326309"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-969"></a><a name="lkTT"><a href="TrieMap.html#lkTT"><span class="hs-identifier">lkTT</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326728"><a href="#local-6989586621679326728"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326729"><a href="#local-6989586621679326729"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><a name="local-6989586621679326730"><a href="#local-6989586621679326730"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326728"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679326729"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326730"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-970"></a><span>                          </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326728"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326729"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-identifier">xtTT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326308"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326308"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326308"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-973"></a><a name="xtTT"><a href="TrieMap.html#xtTT"><span class="hs-identifier">xtTT</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326731"><a href="#local-6989586621679326731"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326732"><a href="#local-6989586621679326732"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679326733"><a href="#local-6989586621679326733"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><a name="local-6989586621679326734"><a href="#local-6989586621679326734"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-974"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326734"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326731"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679326732"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-975"></a><span>               </span><a href="TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326731"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326732"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326733"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-976"></a><span>
</span><a name="line-977"></a><span class="hs-comment">-- Below are some client-oriented functions which operate on 'TypeMap'.</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-980"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-981"></a><span>    </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-982"></a><span>    </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326108"><a href="#local-6989586621679326108"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326109"><a href="#local-6989586621679326109"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkTT"><span class="hs-identifier hs-var">lkTT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326108"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326109"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-983"></a><span>    </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326110"><a href="#local-6989586621679326110"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326111"><a href="#local-6989586621679326111"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326112"><a href="#local-6989586621679326112"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtTT"><span class="hs-identifier hs-var">xtTT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326110"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326111"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326112"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-984"></a><span>    </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326113"><a href="#local-6989586621679326113"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><a name="local-6989586621679326114"><a href="#local-6989586621679326114"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326113"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326114"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-985"></a><span>    </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326115"><a href="#local-6989586621679326115"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><a name="local-6989586621679326116"><a href="#local-6989586621679326116"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326115"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326116"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>
</span><a name="line-987"></a><span class="hs-identifier">foldTypeMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326306"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326307"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326307"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326307"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326306"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326307"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-988"></a><a name="foldTypeMap"><a href="TrieMap.html#foldTypeMap"><span class="hs-identifier">foldTypeMap</span></a></a><span> </span><a name="local-6989586621679326735"><a href="#local-6989586621679326735"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326736"><a href="#local-6989586621679326736"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679326737"><a href="#local-6989586621679326737"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326735"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679326737"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679326736"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span class="hs-identifier">emptyTypeMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326305"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-991"></a><a name="emptyTypeMap"><a href="TrieMap.html#emptyTypeMap"><span class="hs-identifier">emptyTypeMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-992"></a><span>
</span><a name="line-993"></a><span class="hs-identifier">lookupTypeMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326304"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326304"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-994"></a><a name="lookupTypeMap"><a href="TrieMap.html#lookupTypeMap"><span class="hs-identifier">lookupTypeMap</span></a></a><span> </span><a name="local-6989586621679326738"><a href="#local-6989586621679326738"><span class="hs-identifier">cm</span></a></a><span> </span><a name="local-6989586621679326739"><a href="#local-6989586621679326739"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><a href="#local-6989586621679326739"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679326738"><span class="hs-identifier hs-var">cm</span></a><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span class="hs-identifier">extendTypeMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326303"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326303"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326303"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-997"></a><a name="extendTypeMap"><a href="TrieMap.html#extendTypeMap"><span class="hs-identifier">extendTypeMap</span></a></a><span> </span><a name="local-6989586621679326740"><a href="#local-6989586621679326740"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326741"><a href="#local-6989586621679326741"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679326742"><a href="#local-6989586621679326742"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326741"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326742"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326740"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-998"></a><span>
</span><a name="line-999"></a><span class="hs-identifier">lookupTypeMapWithScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326302"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326302"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1000"></a><a name="lookupTypeMapWithScope"><a href="TrieMap.html#lookupTypeMapWithScope"><span class="hs-identifier">lookupTypeMapWithScope</span></a></a><span> </span><a name="local-6989586621679326743"><a href="#local-6989586621679326743"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326744"><a href="#local-6989586621679326744"><span class="hs-identifier">cm</span></a></a><span> </span><a name="local-6989586621679326745"><a href="#local-6989586621679326745"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkTT"><span class="hs-identifier hs-var">lkTT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326744"><span class="hs-identifier hs-var">cm</span></a><span> </span><a href="#local-6989586621679326745"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326743"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1001"></a><span>
</span><a name="line-1002"></a><span class="hs-comment">-- | Extend a 'TypeMap' with a type in the given context.</span><span>
</span><a name="line-1003"></a><span class="hs-comment">-- @extendTypeMapWithScope m (mkDeBruijnContext [a,b,c]) t v@ is equivalent to</span><span>
</span><a name="line-1004"></a><span class="hs-comment">-- @extendTypeMap m (forall a b c. t) v@, but allows reuse of the context over</span><span>
</span><a name="line-1005"></a><span class="hs-comment">-- multiple insertions.</span><span>
</span><a name="line-1006"></a><span class="hs-identifier">extendTypeMapWithScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326301"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326301"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a><span> </span><a href="#local-6989586621679326301"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1007"></a><a name="extendTypeMapWithScope"><a href="TrieMap.html#extendTypeMapWithScope"><span class="hs-identifier">extendTypeMapWithScope</span></a></a><span> </span><a name="local-6989586621679326746"><a href="#local-6989586621679326746"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679326747"><a href="#local-6989586621679326747"><span class="hs-identifier">cm</span></a></a><span> </span><a name="local-6989586621679326748"><a href="#local-6989586621679326748"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679326749"><a href="#local-6989586621679326749"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtTT"><span class="hs-identifier hs-var">xtTT</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326747"><span class="hs-identifier hs-var">cm</span></a><span> </span><a href="#local-6989586621679326748"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679326749"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326746"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-comment">-- | Construct a deBruijn environment with the given variables in scope.</span><span>
</span><a name="line-1010"></a><span class="hs-comment">-- e.g. @mkDeBruijnEnv [a,b,c]@ constructs a context @forall a b c.@</span><span>
</span><a name="line-1011"></a><span class="hs-identifier">mkDeBruijnContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span>
</span><a name="line-1012"></a><a name="mkDeBruijnContext"><a href="TrieMap.html#mkDeBruijnContext"><span class="hs-identifier">mkDeBruijnContext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-1013"></a><span>
</span><a name="line-1014"></a><span class="hs-comment">-- | A 'LooseTypeMap' doesn't do a kind-check. Thus, when lookup up (t |&gt; g),</span><span>
</span><a name="line-1015"></a><span class="hs-comment">-- you'll find entries inserted under (t), even if (g) is non-reflexive.</span><span>
</span><a name="line-1016"></a><span class="hs-keyword">newtype</span><span> </span><a name="LooseTypeMap"><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier">LooseTypeMap</span></a></a><span> </span><a name="local-6989586621679326066"><a href="#local-6989586621679326066"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-1017"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LooseTypeMap"><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier">LooseTypeMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span> </span><a href="#local-6989586621679326066"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>
</span><a name="line-1019"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1020"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1021"></a><span>  </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><a href="TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a><span>
</span><a name="line-1022"></a><span>  </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><a name="local-6989586621679326099"><a href="#local-6989586621679326099"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><a name="local-6989586621679326100"><a href="#local-6989586621679326100"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326099"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326100"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1023"></a><span>  </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span> </span><a name="local-6989586621679326101"><a href="#local-6989586621679326101"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326102"><a href="#local-6989586621679326102"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><a name="local-6989586621679326103"><a href="#local-6989586621679326103"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a><span> </span><a href="#local-6989586621679326101"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326102"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326103"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1024"></a><span>  </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span> </span><a name="local-6989586621679326104"><a href="#local-6989586621679326104"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><a name="local-6989586621679326105"><a href="#local-6989586621679326105"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326104"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326105"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1025"></a><span>  </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span> </span><a name="local-6989586621679326106"><a href="#local-6989586621679326106"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><a name="local-6989586621679326107"><a href="#local-6989586621679326107"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326106"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326107"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Variables
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1034"></a><span>
</span><a name="line-1035"></a><span class="hs-keyword">type</span><span> </span><a name="BoundVar"><a href="TrieMap.html#BoundVar"><span class="hs-identifier">BoundVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>  </span><span class="hs-comment">-- Bound variables are deBruijn numbered</span><span>
</span><a name="line-1036"></a><span class="hs-keyword">type</span><span> </span><a name="BoundVarMap"><a href="TrieMap.html#BoundVarMap"><span class="hs-identifier">BoundVarMap</span></a></a><span> </span><a name="local-6989586621679326065"><a href="#local-6989586621679326065"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IntMap</span></a><span> </span><a href="#local-6989586621679326065"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1037"></a><span>
</span><a name="line-1038"></a><span class="hs-keyword">data</span><span> </span><a name="CmEnv"><a href="TrieMap.html#CmEnv"><span class="hs-identifier">CmEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CME"><a href="TrieMap.html#CME"><span class="hs-identifier">CME</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="cme_next"><a href="TrieMap.html#cme_next"><span class="hs-identifier">cme_next</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="TrieMap.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a><span>
</span><a name="line-1039"></a><span>                 </span><span class="hs-special">,</span><span> </span><a name="cme_env"><a href="TrieMap.html#cme_env"><span class="hs-identifier">cme_env</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a><span> </span><a href="TrieMap.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1040"></a><span>
</span><a name="line-1041"></a><span class="hs-identifier">emptyCME</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span>
</span><a name="line-1042"></a><a name="emptyCME"><a href="TrieMap.html#emptyCME"><span class="hs-identifier">emptyCME</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CME"><span class="hs-identifier hs-var">CME</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cme_next</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cme_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1043"></a><span>
</span><a name="line-1044"></a><span class="hs-identifier">extendCME</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span>
</span><a name="line-1045"></a><a name="extendCME"><a href="TrieMap.html#extendCME"><span class="hs-identifier">extendCME</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CME"><span class="hs-identifier hs-var">CME</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cme_next</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326750"><a href="#local-6989586621679326750"><span class="hs-identifier">bv</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cme_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326751"><a href="#local-6989586621679326751"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326752"><a href="#local-6989586621679326752"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-1046"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#CME"><span class="hs-identifier hs-var">CME</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cme_next</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326750"><span class="hs-identifier hs-var">bv</span></a><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cme_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-6989586621679326751"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326752"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326750"><span class="hs-identifier hs-var">bv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-identifier">extendCMEs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span>
</span><a name="line-1049"></a><a name="extendCMEs"><a href="TrieMap.html#extendCMEs"><span class="hs-identifier">extendCMEs</span></a></a><span> </span><a name="local-6989586621679326753"><a href="#local-6989586621679326753"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326754"><a href="#local-6989586621679326754"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="TrieMap.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a><span> </span><a href="#local-6989586621679326753"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326754"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span class="hs-identifier">lookupCME</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TrieMap.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a><span>
</span><a name="line-1052"></a><a name="lookupCME"><a href="TrieMap.html#lookupCME"><span class="hs-identifier">lookupCME</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#CME"><span class="hs-identifier hs-var">CME</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cme_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326755"><a href="#local-6989586621679326755"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679326756"><a href="#local-6989586621679326756"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679326755"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326756"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1053"></a><span>
</span><a name="line-1054"></a><span class="hs-comment">-- | @DeBruijn a@ represents @a@ modulo alpha-renaming.  This is achieved</span><span>
</span><a name="line-1055"></a><span class="hs-comment">-- by equipping the value with a 'CmEnv', which tracks an on-the-fly deBruijn</span><span>
</span><a name="line-1056"></a><span class="hs-comment">-- numbering.  This allows us to define an 'Eq' instance for @DeBruijn a@, even</span><span>
</span><a name="line-1057"></a><span class="hs-comment">-- if this was not (easily) possible for @a@.  Note: we purposely don't</span><span>
</span><a name="line-1058"></a><span class="hs-comment">-- export the constructor.  Make a helper function if you find yourself</span><span>
</span><a name="line-1059"></a><span class="hs-comment">-- needing it.</span><span>
</span><a name="line-1060"></a><span class="hs-keyword">data</span><span> </span><a name="DeBruijn"><a href="TrieMap.html#DeBruijn"><span class="hs-identifier">DeBruijn</span></a></a><span> </span><a name="local-6989586621679326064"><a href="#local-6989586621679326064"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="D"><a href="TrieMap.html#D"><span class="hs-identifier">D</span></a></a><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><a href="#local-6989586621679326064"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span class="hs-comment">-- | Synthesizes a @DeBruijn a@ from an @a@, by assuming that there are no</span><span>
</span><a name="line-1063"></a><span class="hs-comment">-- bound binders (an empty 'CmEnv').  This is usually what you want if there</span><span>
</span><a name="line-1064"></a><span class="hs-comment">-- isn't already a 'CmEnv' in scope.</span><span>
</span><a name="line-1065"></a><span class="hs-identifier">deBruijnize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679326300"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="#local-6989586621679326300"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1066"></a><a name="deBruijnize"><a href="TrieMap.html#deBruijnize"><span class="hs-identifier">deBruijnize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-1067"></a><span>
</span><a name="line-1068"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><a href="#local-6989586621679326092"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="TrieMap.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679326092"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1069"></a><span>    </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1070"></a><span>    </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326093"><a href="#local-6989586621679326093"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326094"><a href="#local-6989586621679326094"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679326095"><a href="#local-6989586621679326095"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679326096"><a href="#local-6989586621679326096"><span class="hs-identifier">env'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679326097"><a href="#local-6989586621679326097"><span class="hs-identifier">x'</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679326098"><a href="#local-6989586621679326098"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326093"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326094"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326096"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326097"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1071"></a><span>                                      </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326093"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326095"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326096"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679326098"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-identifier">_</span><span>            </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span class="hs-comment">--------- Variable binders -------------</span><span>
</span><a name="line-1075"></a><span>
</span><a name="line-1076"></a><span class="hs-comment">-- | A 'BndrMap' is a 'TypeMapG' which allows us to distinguish between</span><span>
</span><a name="line-1077"></a><span class="hs-comment">-- binding forms whose binders have different types.  For example,</span><span>
</span><a name="line-1078"></a><span class="hs-comment">-- if we are doing a 'TrieMap' lookup on @\(x :: Int) -&gt; ()@, we should</span><span>
</span><a name="line-1079"></a><span class="hs-comment">-- not pick up an entry in the 'TrieMap' for @\(x :: Bool) -&gt; ()@:</span><span>
</span><a name="line-1080"></a><span class="hs-comment">-- we can disambiguate this by matching on the type (or kind, if this</span><span>
</span><a name="line-1081"></a><span class="hs-comment">-- a binder in a type) of the binder.</span><span>
</span><a name="line-1082"></a><span class="hs-keyword">type</span><span> </span><a name="BndrMap"><a href="TrieMap.html#BndrMap"><span class="hs-identifier">BndrMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a><span>
</span><a name="line-1083"></a><span>
</span><a name="line-1084"></a><span class="hs-comment">-- Note [Binders]</span><span>
</span><a name="line-1085"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~</span><span>
</span><a name="line-1086"></a><span class="hs-comment">-- We need to use 'BndrMap' for 'Coercion', 'CoreExpr' AND 'Type', since all</span><span>
</span><a name="line-1087"></a><span class="hs-comment">-- of these data types have binding forms.</span><span>
</span><a name="line-1088"></a><span>
</span><a name="line-1089"></a><span class="hs-identifier">lkBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326299"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326299"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1090"></a><a name="lkBndr"><a href="TrieMap.html#lkBndr"><span class="hs-identifier">lkBndr</span></a></a><span> </span><a name="local-6989586621679326757"><a href="#local-6989586621679326757"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326758"><a href="#local-6989586621679326758"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326759"><a href="#local-6989586621679326759"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326757"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679326758"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326759"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1091"></a><span>
</span><a name="line-1092"></a><span class="hs-identifier">xtBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326298"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326298"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a><span> </span><a href="#local-6989586621679326298"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1093"></a><a name="xtBndr"><a href="TrieMap.html#xtBndr"><span class="hs-identifier">xtBndr</span></a></a><span> </span><a name="local-6989586621679326760"><a href="#local-6989586621679326760"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326761"><a href="#local-6989586621679326761"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326762"><a href="#local-6989586621679326762"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a href="#local-6989586621679326760"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679326761"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679326762"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1094"></a><span>
</span><a name="line-1095"></a><span class="hs-comment">--------- Variable occurrence -------------</span><span>
</span><a name="line-1096"></a><span class="hs-keyword">data</span><span> </span><a name="VarMap"><a href="TrieMap.html#VarMap"><span class="hs-identifier">VarMap</span></a></a><span> </span><a name="local-6989586621679326063"><a href="#local-6989586621679326063"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VM"><a href="TrieMap.html#VM"><span class="hs-identifier">VM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="vm_bvar"><a href="TrieMap.html#vm_bvar"><span class="hs-identifier">vm_bvar</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#BoundVarMap"><span class="hs-identifier hs-type">BoundVarMap</span></a><span> </span><a href="#local-6989586621679326063"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- Bound variable</span><span>
</span><a name="line-1097"></a><span>                   </span><span class="hs-special">,</span><span> </span><a name="vm_fvar"><a href="TrieMap.html#vm_fvar"><span class="hs-identifier">vm_fvar</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a><span> </span><a href="#local-6989586621679326063"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>      </span><span class="hs-comment">-- Free variable</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span class="hs-keyword">instance</span><span> </span><a href="TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1100"></a><span>   </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-1101"></a><span>   </span><a name="local-8214565720324100893"><a href="TrieMap.html#emptyTM"><span class="hs-identifier">emptyTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#VM"><span class="hs-identifier hs-var">VM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../containers-0.5.10.2/src/%{MODULE/./-}.html#%{NAME}/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IntMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#emptyDVarEnv"><span class="hs-identifier hs-var">emptyDVarEnv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1102"></a><span>   </span><a name="local-8214565720324100894"><a href="TrieMap.html#lookupTM"><span class="hs-identifier">lookupTM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#lkVar"><span class="hs-identifier hs-var">lkVar</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-1103"></a><span>   </span><a name="local-8214565720324100895"><a href="TrieMap.html#alterTM"><span class="hs-identifier">alterTM</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#xtVar"><span class="hs-identifier hs-var">xtVar</span></a><span> </span><a href="TrieMap.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a><span>
</span><a name="line-1104"></a><span>   </span><a name="local-8214565720324100897"><a href="TrieMap.html#foldTM"><span class="hs-identifier">foldTM</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#fdVar"><span class="hs-identifier hs-var">fdVar</span></a><span>
</span><a name="line-1105"></a><span>   </span><a name="local-8214565720324100896"><a href="TrieMap.html#mapTM"><span class="hs-identifier">mapTM</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapVar"><span class="hs-identifier hs-var">mapVar</span></a><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span class="hs-identifier">mapVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326296"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679326297"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326296"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326297"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1108"></a><a name="mapVar"><a href="TrieMap.html#mapVar"><span class="hs-identifier">mapVar</span></a></a><span> </span><a name="local-6989586621679326763"><a href="#local-6989586621679326763"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TrieMap.html#VM"><span class="hs-identifier hs-var">VM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326764"><a href="#local-6989586621679326764"><span class="hs-identifier">bv</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679326765"><a href="#local-6989586621679326765"><span class="hs-identifier">fv</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#VM"><span class="hs-identifier hs-var">VM</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326763"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326764"><span class="hs-identifier hs-var">bv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#mapTM"><span class="hs-identifier hs-var">mapTM</span></a><span> </span><a href="#local-6989586621679326763"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326765"><span class="hs-identifier hs-var">fv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><span class="hs-identifier">lkVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326295"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326295"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1112"></a><a name="lkVar"><a href="TrieMap.html#lkVar"><span class="hs-identifier">lkVar</span></a></a><span> </span><a name="local-6989586621679326766"><a href="#local-6989586621679326766"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326767"><a href="#local-6989586621679326767"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-1113"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326768"><a href="#local-6989586621679326768"><span class="hs-identifier">bv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326766"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326767"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a><span> </span><a href="#local-6989586621679326768"><span class="hs-identifier hs-var">bv</span></a><span>
</span><a name="line-1114"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><a href="TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a><span> </span><a href="TrieMap.html#lkDFreeVar"><span class="hs-identifier hs-var">lkDFreeVar</span></a><span> </span><a href="#local-6989586621679326767"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1115"></a><span>
</span><a name="line-1116"></a><span class="hs-identifier">xtVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TrieMap.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326294"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326294"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326294"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1117"></a><a name="xtVar"><a href="TrieMap.html#xtVar"><span class="hs-identifier">xtVar</span></a></a><span> </span><a name="local-6989586621679326769"><a href="#local-6989586621679326769"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679326770"><a href="#local-6989586621679326770"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326771"><a href="#local-6989586621679326771"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326772"><a href="#local-6989586621679326772"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1118"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679326773"><a href="#local-6989586621679326773"><span class="hs-identifier">bv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TrieMap.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a><span> </span><a href="#local-6989586621679326769"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326770"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326772"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">vm_bvar</span><span> </span><a href="#local-6989586621679326772"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a><span> </span><a href="#local-6989586621679326773"><span class="hs-identifier hs-var">bv</span></a><span> </span><a href="#local-6989586621679326771"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1119"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679326772"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">vm_fvar</span><span> </span><a href="#local-6989586621679326772"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="TrieMap.html#xtDFreeVar"><span class="hs-identifier hs-var">xtDFreeVar</span></a><span> </span><a href="#local-6989586621679326770"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679326771"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1120"></a><span>
</span><a name="line-1121"></a><span class="hs-identifier">fdVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679326292"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326293"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326293"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a><span> </span><a href="#local-6989586621679326292"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326293"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679326293"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1122"></a><a name="fdVar"><a href="TrieMap.html#fdVar"><span class="hs-identifier">fdVar</span></a></a><span> </span><a name="local-6989586621679326774"><a href="#local-6989586621679326774"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679326775"><a href="#local-6989586621679326775"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326774"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">vm_bvar</span><span> </span><a href="#local-6989586621679326775"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>          </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a><span> </span><a href="#local-6989586621679326774"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">vm_fvar</span><span> </span><a href="#local-6989586621679326775"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1124"></a><span>
</span><a name="line-1125"></a><span class="hs-identifier">lkDFreeVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarEnv.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a><span> </span><a href="#local-6989586621679326291"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679326291"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1126"></a><a name="lkDFreeVar"><a href="TrieMap.html#lkDFreeVar"><span class="hs-identifier">lkDFreeVar</span></a></a><span> </span><a name="local-6989586621679326776"><a href="#local-6989586621679326776"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621679326777"><a href="#local-6989586621679326777"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#lookupDVarEnv"><span class="hs-identifier hs-var">lookupDVarEnv</span></a><span> </span><a href="#local-6989586621679326777"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679326776"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1127"></a><span>
</span><a name="line-1128"></a><span class="hs-identifier">xtDFreeVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a><span> </span><a href="#local-6989586621679326290"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarEnv.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a><span> </span><a href="#local-6989586621679326290"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarEnv.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a><span> </span><a href="#local-6989586621679326290"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1129"></a><a name="xtDFreeVar"><a href="TrieMap.html#xtDFreeVar"><span class="hs-identifier">xtDFreeVar</span></a></a><span> </span><a name="local-6989586621679326778"><a href="#local-6989586621679326778"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679326779"><a href="#local-6989586621679326779"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679326780"><a href="#local-6989586621679326780"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#alterDVarEnv"><span class="hs-identifier hs-var">alterDVarEnv</span></a><span> </span><a href="#local-6989586621679326779"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679326780"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679326778"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1130"></a></pre></body></html>