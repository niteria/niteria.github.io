<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The AQUA Project, Glasgow University, 1996-1998


TcHsSyn: Specialisations of the @HsSyn@ syntax for the typechecker

This module is an extension of @HsSyn@ syntax, for use in the type
checker.
-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE CPP, TupleSections #-}</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcHsSyn</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>        </span><span class="hs-comment">-- * Extracting types from HsSyn</span><span>
</span><a name="line-16"></a><span>        </span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>        </span><span class="hs-comment">-- * Other HsSyn functions</span><span>
</span><a name="line-19"></a><span>        </span><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier hs-var">mkHsDictLet</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsApp"><span class="hs-identifier hs-var">mkHsApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="HsTypes.html#mkHsAppTy"><span class="hs-identifier hs-var">mkHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>        </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier hs-var">shortCutLit</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsOverLitName"><span class="hs-identifier hs-var">hsOverLitName</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">-- * re-exported from TcMonad</span><span>
</span><a name="line-26"></a><span>        </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdSet"><span class="hs-identifier hs-type">TcIdSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>        </span><span class="hs-comment">-- * Zonking</span><span>
</span><a name="line-29"></a><span>        </span><span class="hs-comment">-- | For a description of &quot;zonking&quot;, see Note [What is zonking?]</span><span>
</span><a name="line-30"></a><span>        </span><span class="hs-comment">-- in TcMType</span><span>
</span><a name="line-31"></a><span>        </span><a href="TcHsSyn.html#zonkTopDecls"><span class="hs-identifier hs-var">zonkTopDecls</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTopExpr"><span class="hs-identifier hs-var">zonkTopExpr</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTopLExpr"><span class="hs-identifier hs-var">zonkTopLExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="TcHsSyn.html#zonkTopBndrs"><span class="hs-identifier hs-var">zonkTopBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="TcHsSyn.html#zonkTyVarBindersX"><span class="hs-identifier hs-var">zonkTyVarBindersX</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyVarBinderX"><span class="hs-identifier hs-var">zonkTyVarBinderX</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier hs-var">zonkTyVarOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkSigType"><span class="hs-identifier hs-var">zonkSigType</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="IdInfo.html"><span class="hs-identifier">IdInfo</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="TcMType.html"><span class="hs-identifier">TcMType</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Literal.html"><span class="hs-identifier">Literal</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="UniqFM.html"><span class="hs-identifier">UniqFM</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
       Extracting the type from HsSyn
*                                                                      *
************************************************************************

-}</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-identifier">hsLPatType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-86"></a><a name="hsLPatType"><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier">hsLPatType</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629797"><a href="#local-6989586621679629797"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span> </span><a href="#local-6989586621679629797"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-89"></a><a name="hsPatType"><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier">hsPatType</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-6989586621679629798"><a href="#local-6989586621679629798"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-6989586621679629798"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-90"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a name="local-6989586621679629799"><a href="#local-6989586621679629799"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629799"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-91"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629800"><a href="#local-6989586621679629800"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621679629800"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-92"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-6989586621679629801"><a href="#local-6989586621679629801"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-6989586621679629801"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-93"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-6989586621679629802"><a href="#local-6989586621679629802"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-6989586621679629802"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-6989586621679629803"><a href="#local-6989586621679629803"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span> </span><a href="#local-6989586621679629803"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-95"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><a name="local-6989586621679629804"><a href="#local-6989586621679629804"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679629804"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629805"><a href="#local-6989586621679629805"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629805"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-97"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629806"><a href="#local-6989586621679629806"><span class="hs-identifier">ty</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkListTy"><span class="hs-identifier hs-var">mkListTy</span></a><span> </span><a href="#local-6989586621679629806"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-98"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679629807"><a href="#local-6989586621679629807"><span class="hs-identifier">ty</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629807"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-99"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629808"><a href="#local-6989586621679629808"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkPArrTy"><span class="hs-identifier hs-var">mkPArrTy</span></a><span> </span><a href="#local-6989586621679629808"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-100"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629809"><a href="#local-6989586621679629809"><span class="hs-identifier">bx</span></a></a><span> </span><a name="local-6989586621679629810"><a href="#local-6989586621679629810"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkTupleTy"><span class="hs-identifier hs-var">mkTupleTy</span></a><span> </span><a href="#local-6989586621679629809"><span class="hs-identifier hs-var">bx</span></a><span> </span><a href="#local-6989586621679629810"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-101"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629811"><a href="#local-6989586621679629811"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkSumTy"><span class="hs-identifier hs-var">mkSumTy</span></a><span> </span><a href="#local-6989586621679629811"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-102"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629812"><a href="#local-6989586621679629812"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629813"><a href="#local-6989586621679629813"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>                                      </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span> </span><a href="#local-6989586621679629812"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621679629813"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-104"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629814"><a href="#local-6989586621679629814"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629814"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-105"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629815"><a href="#local-6989586621679629815"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629815"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-106"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629816"><a href="#local-6989586621679629816"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629816"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-107"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629817"><a href="#local-6989586621679629817"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629817"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-108"></a><span class="hs-identifier">hsPatType</span><span> </span><a name="local-6989586621679629818"><a href="#local-6989586621679629818"><span class="hs-identifier">p</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;hsPatType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679629818"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-111"></a><a name="hsLitType"><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier">hsLitType</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsChar"><span class="hs-identifier hs-var">HsChar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#charTy"><span class="hs-identifier hs-var">charTy</span></a><span>
</span><a name="line-112"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsCharPrim"><span class="hs-identifier hs-var">HsCharPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#stringTy"><span class="hs-identifier hs-var">stringTy</span></a><span>
</span><a name="line-114"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsStringPrim"><span class="hs-identifier hs-var">HsStringPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>
</span><a name="line-115"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#intTy"><span class="hs-identifier hs-var">intTy</span></a><span>
</span><a name="line-116"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>
</span><a name="line-117"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>
</span><a name="line-118"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt64Prim"><span class="hs-identifier hs-var">HsInt64Prim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a><span>
</span><a name="line-119"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWord64Prim"><span class="hs-identifier hs-var">HsWord64Prim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a><span>
</span><a name="line-120"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInteger"><span class="hs-identifier hs-var">HsInteger</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629819"><a href="#local-6989586621679629819"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629819"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629820"><a href="#local-6989586621679629820"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629820"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFloatPrim"><span class="hs-identifier hs-var">HsFloatPrim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span>
</span><a name="line-123"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsDoublePrim"><span class="hs-identifier hs-var">HsDoublePrim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- Overloaded literals. Here mainly because it uses isIntTy etc</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#OverLitVal"><span class="hs-identifier hs-type">OverLitVal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><a name="shortCutLit"><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier">shortCutLit</span></a></a><span> </span><a name="local-6989586621679629821"><a href="#local-6989586621679629821"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><a name="local-6989586621679629822"><a href="#local-6989586621679629822"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679629823"><a href="#local-6989586621679629823"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629824"><a href="#local-6989586621679629824"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isIntTy"><span class="hs-identifier hs-var">isIntTy</span></a><span> </span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span>  </span><a href="#local-6989586621679629821"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="#local-6989586621679629822"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isWordTy"><span class="hs-identifier hs-var">isWordTy</span></a><span> </span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Literal.html#inWordRange"><span class="hs-identifier hs-var">inWordRange</span></a><span> </span><a href="#local-6989586621679629821"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-131"></a><span>                                   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><a href="#local-6989586621679629822"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isIntegerTy"><span class="hs-identifier hs-var">isIntegerTy</span></a><span> </span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInteger"><span class="hs-identifier hs-var">HsInteger</span></a><span> </span><a href="#local-6989586621679629822"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier hs-var">shortCutLit</span></a><span> </span><a href="#local-6989586621679629821"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#integralFractionalLit"><span class="hs-identifier hs-var">integralFractionalLit</span></a><span> </span><a href="#local-6989586621679629823"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-134"></a><span>        </span><span class="hs-comment">-- The 'otherwise' case is important</span><span>
</span><a name="line-135"></a><span>        </span><span class="hs-comment">-- Consider (3 :: Float).  Syntactically it looks like an IntLit,</span><span>
</span><a name="line-136"></a><span>        </span><span class="hs-comment">-- so we'll call shortCutIntLit, but of course it's a float</span><span>
</span><a name="line-137"></a><span>        </span><span class="hs-comment">-- This can make a big difference for programs with a lot of</span><span>
</span><a name="line-138"></a><span>        </span><span class="hs-comment">-- literals, compiled without -O</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><a name="local-6989586621679629825"><a href="#local-6989586621679629825"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629826"><a href="#local-6989586621679629826"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isFloatTy"><span class="hs-identifier hs-var">isFloatTy</span></a><span> </span><a href="#local-6989586621679629826"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a><span>  </span><span class="hs-special">(</span><a href="HsLit.html#HsFloatPrim"><span class="hs-identifier hs-var">HsFloatPrim</span></a><span> </span><a href="#local-6989586621679629825"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isDoubleTy"><span class="hs-identifier hs-var">isDoubleTy</span></a><span> </span><a href="#local-6989586621679629826"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsDoublePrim"><span class="hs-identifier hs-var">HsDoublePrim</span></a><span> </span><a href="#local-6989586621679629825"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span> </span><a name="local-6989586621679629827"><a href="#local-6989586621679629827"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679629828"><a href="#local-6989586621679629828"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629829"><a href="#local-6989586621679629829"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a><span> </span><a href="#local-6989586621679629829"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a href="#local-6989586621679629827"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679629828"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">mkLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-150"></a><a name="mkLit"><a href="TcHsSyn.html#mkLit"><span class="hs-identifier">mkLit</span></a></a><span> </span><a name="local-6989586621679629830"><a href="#local-6989586621679629830"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679629831"><a href="#local-6989586621679629831"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsDataCon"><span class="hs-identifier hs-var">nlHsDataCon</span></a><span> </span><a href="#local-6989586621679629830"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><a href="#local-6989586621679629831"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-153"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#OverLitVal"><span class="hs-identifier hs-type">OverLitVal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-154"></a><span class="hs-comment">-- Get the canonical 'fromX' name for a particular OverLitVal</span><span>
</span><a name="line-155"></a><a name="hsOverLitName"><a href="TcHsSyn.html#hsOverLitName"><span class="hs-identifier">hsOverLitName</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromIntegerName"><span class="hs-identifier hs-var">fromIntegerName</span></a><span>
</span><a name="line-156"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromRationalName"><span class="hs-identifier hs-var">fromRationalName</span></a><span>
</span><a name="line-157"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromStringName"><span class="hs-identifier hs-var">fromStringName</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-HsBinds]{Running a substitution over @HsBinds@}
*                                                                      *
************************************************************************

The rest of the zonking is done *after* typechecking.
The main zonking pass runs over the bindings

 a) to convert TcTyVars to TyVars etc, dereferencing any bindings etc
 b) convert unbound TcTyVar to Void
 c) convert each TcId to an Id by zonking its type

The type variables are converted by binding mutable tyvars to immutable ones
and then zonking as normal.

The Ids are converted by binding them in the normal Tc envt; that
way we maintain sharing; eg an Id is zonked at its binding site and they
all occurrences of that Id point to the common zonked copy

It's all pretty boring stuff, because HsSyn is such a large type, and
the environment manipulation is tiresome.
-}</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-185"></a><span class="hs-keyword">type</span><span> </span><a name="UnboundTyVarZonker"><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier">UnboundTyVarZonker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-186"></a><span>        </span><span class="hs-comment">-- How to zonk an unbound type variable</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- The TcTyVar is</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-comment">--     (a) a MetaTv</span><span>
</span><a name="line-189"></a><span>        </span><span class="hs-comment">--     (b) Flexi and</span><span>
</span><a name="line-190"></a><span>        </span><span class="hs-comment">--     (c) its kind is already zonked</span><span>
</span><a name="line-191"></a><span>        </span><span class="hs-comment">-- Note [Zonking the LHS of a RULE]</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | A ZonkEnv carries around several bits.</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- The UnboundTyVarZonker just zaps unbouned meta-tyvars to Any (as</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- defined in zonkTypeZapping), except on the LHS of rules. See</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- Note [Zonking the LHS of a RULE].</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- The (TyCoVarEnv TyVar) and is just an optimisation: when binding a</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- tyvar or covar, we zonk the kind right away and add a mapping to</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- the env. This prevents re-zonking the kind at every occurrence. But</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- this is *just* an optimisation.</span><span>
</span><a name="line-202"></a><span class="hs-comment">--</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- The final (IdEnv Var) optimises zonking for Ids. It is</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- knot-tied. We must be careful never to put coercion variables</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- (which are Ids, after all) in the knot-tied env, because coercions</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- can appear in types, and we sometimes inspect a zonked type in this</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- module.</span><span>
</span><a name="line-208"></a><span class="hs-comment">--</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-210"></a><span class="hs-keyword">data</span><span> </span><a name="ZonkEnv"><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier">ZonkEnv</span></a></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ZonkEnv"><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier">ZonkEnv</span></a></a><span>
</span><a name="line-212"></a><span>      </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-213"></a><span>      </span><span class="hs-special">(</span><a href="VarEnv.html#TyCoVarEnv"><span class="hs-identifier hs-type">TyCoVarEnv</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>      </span><span class="hs-special">(</span><a href="VarEnv.html#IdEnv"><span class="hs-identifier hs-type">IdEnv</span></a><span>      </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- What variables are in scope</span><span>
</span><a name="line-215"></a><span>        </span><span class="hs-comment">-- Maps an Id or EvVar to its zonked version; both have the same Name</span><span>
</span><a name="line-216"></a><span>        </span><span class="hs-comment">-- Note that all evidence (coercion variables as well as dictionaries)</span><span>
</span><a name="line-217"></a><span>        </span><span class="hs-comment">--      are kept in the ZonkEnv</span><span>
</span><a name="line-218"></a><span>        </span><span class="hs-comment">-- Only *type* abstraction is done by side effect</span><span>
</span><a name="line-219"></a><span>        </span><span class="hs-comment">-- Is only consulted lazily; hence knot-tying</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-222"></a><span>  </span><a name="local-8214565720323871022"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629785"><a href="#local-6989586621679629785"><span class="hs-identifier">_ty_env</span></a></a><span> </span><a name="local-6989586621679629786"><a href="#local-6989586621679629786"><span class="hs-identifier">var_env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#pprUFM"><span class="hs-identifier hs-var">pprUFM</span></a><span> </span><a href="#local-6989586621679629786"><span class="hs-identifier hs-var">var_env</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- The EvBinds have to already be zonked, but that's usually the case.</span><span>
</span><a name="line-226"></a><span class="hs-identifier">emptyZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-227"></a><a name="emptyZonkEnv"><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier">emptyZonkEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a><span> </span><a href="TcHsSyn.html#zonkTypeZapping"><span class="hs-identifier hs-var">zonkTypeZapping</span></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-identifier">mkEmptyZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-230"></a><a name="mkEmptyZonkEnv"><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier">mkEmptyZonkEnv</span></a></a><span> </span><a name="local-6989586621679629832"><a href="#local-6989586621679629832"><span class="hs-identifier">zonker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629832"><span class="hs-identifier hs-var">zonker</span></a><span> </span><a href="VarEnv.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a><span> </span><a href="VarEnv.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- | Extend the knot-tied environment.</span><span>
</span><a name="line-233"></a><span class="hs-identifier">extendIdZonkEnvRec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-234"></a><a name="extendIdZonkEnvRec"><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier">extendIdZonkEnvRec</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679629833"><a href="#local-6989586621679629833"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-6989586621679629834"><a href="#local-6989586621679629834"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-6989586621679629835"><a href="#local-6989586621679629835"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629836"><a href="#local-6989586621679629836"><span class="hs-identifier">ids</span></a></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-comment">-- NB: Don't look at the var to decide which env't to put it in. That</span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-comment">-- would end up knot-tying all the env'ts.</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629833"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-6989586621679629834"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-6989586621679629835"><span class="hs-identifier hs-var">id_env</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679629837"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><a href="#local-6989586621679629837"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679629837"><a href="#local-6989586621679629837"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629836"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-comment">-- Given coercion variables will actually end up here. That's OK though:</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-comment">-- coercion variables are never looked up in the knot-tied env't, so zonking</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-comment">-- them simply doesn't get optimised. No one gets hurt. An improvement (?)</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-comment">-- would be to do SCC analysis in zonkEvBinds and then only knot-tie the</span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-comment">-- recursive groups. But perhaps the time it takes to do the analysis is</span><span>
</span><a name="line-243"></a><span>  </span><span class="hs-comment">-- more than the savings.</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-identifier">extendZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-246"></a><a name="extendZonkEnv"><a href="TcHsSyn.html#extendZonkEnv"><span class="hs-identifier">extendZonkEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679629838"><a href="#local-6989586621679629838"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-6989586621679629839"><a href="#local-6989586621679629839"><span class="hs-identifier">tyco_env</span></a></a><span> </span><a name="local-6989586621679629840"><a href="#local-6989586621679629840"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629841"><a href="#local-6989586621679629841"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-247"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629838"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-6989586621679629839"><span class="hs-identifier hs-var">tyco_env</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679629844"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><a href="#local-6989586621679629844"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679629844"><a href="#local-6989586621679629844"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629842"><span class="hs-identifier hs-var">tycovars</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>                    </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-6989586621679629840"><span class="hs-identifier hs-var">id_env</span></a><span>   </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679629845"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><a href="#local-6989586621679629845"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679629845"><a href="#local-6989586621679629845"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629843"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629842"><a href="#local-6989586621679629842"><span class="hs-identifier">tycovars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629843"><a href="#local-6989586621679629843"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a><span> </span><a href="#local-6989586621679629841"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">extendIdZonkEnv1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-252"></a><a name="extendIdZonkEnv1"><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier">extendIdZonkEnv1</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679629846"><a href="#local-6989586621679629846"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-6989586621679629847"><a href="#local-6989586621679629847"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-6989586621679629848"><a href="#local-6989586621679629848"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629849"><a href="#local-6989586621679629849"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629846"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-6989586621679629847"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">id_env</span></a><span> </span><a href="#local-6989586621679629849"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679629849"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-identifier">extendTyZonkEnv1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-256"></a><a name="extendTyZonkEnv1"><a href="TcHsSyn.html#extendTyZonkEnv1"><span class="hs-identifier">extendTyZonkEnv1</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679629850"><a href="#local-6989586621679629850"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-6989586621679629851"><a href="#local-6989586621679629851"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-6989586621679629852"><a href="#local-6989586621679629852"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629853"><a href="#local-6989586621679629853"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-257"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629850"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><a href="#local-6989586621679629853"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679629853"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">id_env</span></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">setZonkType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-260"></a><a name="setZonkType"><a href="TcHsSyn.html#setZonkType"><span class="hs-identifier">setZonkType</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629854"><a href="#local-6989586621679629854"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-6989586621679629855"><a href="#local-6989586621679629855"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629856"><a href="#local-6989586621679629856"><span class="hs-identifier">zonk_ty</span></a></a><span>
</span><a name="line-261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-6989586621679629854"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><a href="#local-6989586621679629855"><span class="hs-identifier hs-var">id_env</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-identifier">zonkEnvIds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#TypeEnv"><span class="hs-identifier hs-type">TypeEnv</span></a><span>
</span><a name="line-264"></a><a name="zonkEnvIds"><a href="TcHsSyn.html#zonkEnvIds"><span class="hs-identifier">zonkEnvIds</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679629857"><a href="#local-6989586621679629857"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-265"></a><span>  </span><a href="NameEnv.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679629858"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AnId"><span class="hs-identifier hs-var">AnId</span></a><span> </span><a href="#local-6989586621679629858"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679629858"><a href="#local-6989586621679629858"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="UniqFM.html#nonDetEltsUFM"><span class="hs-identifier hs-var">nonDetEltsUFM</span></a><span> </span><a href="#local-6989586621679629857"><span class="hs-identifier hs-var">id_env</span></a><span class="hs-special">]</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here because we forget the ordering</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-comment">-- immediately by creating a TypeEnv</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">zonkIdOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- Ids defined in this module should be in the envt;</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- ignore others.  (Actually, data constructors are also</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- not LocalVars, even when locally defined, but that is fine.)</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- (Also foreign-imported things aren't currently in the ZonkEnv;</span><span>
</span><a name="line-274"></a><span class="hs-comment">--  that's ok because they don't need zonking.)</span><span>
</span><a name="line-275"></a><span class="hs-comment">--</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- Actually, Template Haskell works in 'chunks' of declarations, and</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- an earlier chunk won't be in the 'env' that the zonking phase</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- carries around.  Instead it'll be in the tcg_gbl_env, already fully</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- zonked.  There's no point in looking it up there (except for error</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- checking), and it's not conveniently to hand; hence the simple</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- 'orElse' case in the LocalVar branch.</span><span>
</span><a name="line-282"></a><span class="hs-comment">--</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- Even without template splices, in module Main, the checking of</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- 'main' is done as a separate chunk.</span><span>
</span><a name="line-285"></a><a name="zonkIdOcc"><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier">zonkIdOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679629859"><a href="#local-6989586621679629859"><span class="hs-identifier">_zonk_ty</span></a></a><span> </span><a name="local-6989586621679629860"><a href="#local-6989586621679629860"><span class="hs-identifier">_ty_env</span></a></a><span> </span><a name="local-6989586621679629861"><a href="#local-6989586621679629861"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679629862"><a href="#local-6989586621679629862"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isLocalVar"><span class="hs-identifier hs-var">isLocalVar</span></a><span> </span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679629861"><span class="hs-identifier hs-var">id_env</span></a><span> </span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span>
</span><a name="line-287"></a><span>                    </span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-identifier">zonkIdOccs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-291"></a><a name="zonkIdOccs"><a href="TcHsSyn.html#zonkIdOccs"><span class="hs-identifier">zonkIdOccs</span></a></a><span> </span><a name="local-6989586621679629863"><a href="#local-6989586621679629863"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629864"><a href="#local-6989586621679629864"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679629863"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- zonkIdBndr is used *after* typechecking to get the Id's type</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- to its final form.  The TyVarEnv give</span><span>
</span><a name="line-295"></a><span class="hs-identifier">zonkIdBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-296"></a><a name="zonkIdBndr"><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier">zonkIdBndr</span></a></a><span> </span><a name="local-6989586621679629865"><a href="#local-6989586621679629865"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629866"><a href="#local-6989586621679629866"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-297"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679629867"><a href="#local-6989586621679629867"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679629865"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>       </span><a href="TcMType.html#ensureNotLevPoly"><span class="hs-identifier hs-var">ensureNotLevPoly</span></a><span> </span><a href="#local-6989586621679629867"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-299"></a><span>         </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type of binder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#modifyIdInfo"><span class="hs-identifier hs-var">modifyIdInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="IdInfo.html#setLevityInfoWithType"><span class="hs-identifier hs-var">setLevityInfoWithType</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679629867"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Id.html#setIdType"><span class="hs-identifier hs-var">setIdType</span></a><span> </span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679629867"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">zonkIdBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-304"></a><a name="zonkIdBndrs"><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier">zonkIdBndrs</span></a></a><span> </span><a name="local-6989586621679629868"><a href="#local-6989586621679629868"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629869"><a href="#local-6989586621679629869"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629868"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629869"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">zonkTopBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-307"></a><a name="zonkTopBndrs"><a href="TcHsSyn.html#zonkTopBndrs"><span class="hs-identifier">zonkTopBndrs</span></a></a><span> </span><a name="local-6989586621679629870"><a href="#local-6989586621679629870"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-6989586621679629870"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-identifier">zonkFieldOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><a name="zonkFieldOcc"><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier">zonkFieldOcc</span></a></a><span> </span><a name="local-6989586621679629871"><a href="#local-6989586621679629871"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><a name="local-6989586621679629872"><a href="#local-6989586621679629872"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679629873"><a href="#local-6989586621679629873"><span class="hs-identifier">sel</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><a href="#local-6989586621679629872"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629871"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629873"><span class="hs-identifier hs-var">sel</span></a><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-identifier">zonkEvBndrsX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-313"></a><a name="zonkEvBndrsX"><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier">zonkEvBndrsX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier hs-var">zonkEvBndrX</span></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-identifier">zonkEvBndrX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- Works for dictionaries and coercions</span><span>
</span><a name="line-317"></a><a name="zonkEvBndrX"><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier">zonkEvBndrX</span></a></a><span> </span><a name="local-6989586621679629874"><a href="#local-6989586621679629874"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629875"><a href="#local-6989586621679629875"><span class="hs-identifier">var</span></a></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679629876"><a href="#local-6989586621679629876"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier hs-var">zonkEvBndr</span></a><span> </span><a href="#local-6989586621679629874"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629875"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-319"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendZonkEnv"><span class="hs-identifier hs-var">extendZonkEnv</span></a><span> </span><a href="#local-6989586621679629874"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679629876"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629876"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-identifier">zonkEvBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- Works for dictionaries and coercions</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- Does not extend the ZonkEnv</span><span>
</span><a name="line-324"></a><a name="zonkEvBndr"><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier">zonkEvBndr</span></a></a><span> </span><a name="local-6989586621679629877"><a href="#local-6989586621679629877"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629878"><a href="#local-6989586621679629878"><span class="hs-identifier">var</span></a></a><span>
</span><a name="line-325"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679629879"><a href="#local-6989586621679629879"><span class="hs-identifier">var_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679629878"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-326"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629880"><a href="#local-6989586621679629880"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-327"></a><span>           </span><span class="hs-pragma">{-# SCC &quot;zonkEvBndr_zonkTcTypeToType&quot; #-}</span><span>
</span><a name="line-328"></a><span>           </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679629877"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629879"><span class="hs-identifier hs-var">var_ty</span></a><span>
</span><a name="line-329"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a><span> </span><a href="#local-6989586621679629878"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679629880"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-identifier">zonkEvVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-332"></a><a name="zonkEvVarOcc"><a href="TcHsSyn.html#zonkEvVarOcc"><span class="hs-identifier">zonkEvVarOcc</span></a></a><span> </span><a name="local-6989586621679629881"><a href="#local-6989586621679629881"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629882"><a href="#local-6989586621679629882"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-333"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-6989586621679629882"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-334"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier hs-var">zonkCoVarOcc</span></a><span> </span><a href="#local-6989586621679629881"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629882"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-335"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-336"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679629881"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629882"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-identifier">zonkTyBndrsX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-339"></a><a name="zonkTyBndrsX"><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier">zonkTyBndrsX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-identifier">zonkTyBndrX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span class="hs-comment">-- This guarantees to return a TyVar (not a TcTyVar)</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- then we add it to the envt, so all occurrences are replaced</span><span>
</span><a name="line-344"></a><a name="zonkTyBndrX"><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier">zonkTyBndrX</span></a></a><span> </span><a name="local-6989586621679629883"><a href="#local-6989586621679629883"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629884"><a href="#local-6989586621679629884"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-345"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679629885"><a href="#local-6989586621679629885"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679629883"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679629884"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>               </span><span class="hs-comment">-- Internal names tidy up better, for iface files.</span><span>
</span><a name="line-348"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679629886"><a href="#local-6989586621679629886"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span> </span><a href="#local-6989586621679629884"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629885"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-349"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendTyZonkEnv1"><span class="hs-identifier hs-var">extendTyZonkEnv1</span></a><span> </span><a href="#local-6989586621679629883"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629886"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629886"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">zonkTyVarBindersX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVarBndr"><span class="hs-identifier hs-type">TyVarBndr</span></a><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><a href="#local-6989586621679629796"><span class="hs-identifier hs-type">vis</span></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVarBndr"><span class="hs-identifier hs-type">TyVarBndr</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><a href="#local-6989586621679629796"><span class="hs-identifier hs-type">vis</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><a name="zonkTyVarBindersX"><a href="TcHsSyn.html#zonkTyVarBindersX"><span class="hs-identifier">zonkTyVarBindersX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkTyVarBinderX"><span class="hs-identifier hs-var">zonkTyVarBinderX</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-identifier">zonkTyVarBinderX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVarBndr"><span class="hs-identifier hs-type">TyVarBndr</span></a><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><a href="#local-6989586621679629795"><span class="hs-identifier hs-type">vis</span></a><span>
</span><a name="line-356"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVarBndr"><span class="hs-identifier hs-type">TyVarBndr</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><a href="#local-6989586621679629795"><span class="hs-identifier hs-type">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span class="hs-comment">-- Takes a TcTyVar and guarantees to return a TyVar</span><span>
</span><a name="line-358"></a><a name="zonkTyVarBinderX"><a href="TcHsSyn.html#zonkTyVarBinderX"><span class="hs-identifier">zonkTyVarBinderX</span></a></a><span> </span><a name="local-6989586621679629887"><a href="#local-6989586621679629887"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679629888"><a href="#local-6989586621679629888"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679629889"><a href="#local-6989586621679629889"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629890"><a href="#local-6989586621679629890"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629891"><a href="#local-6989586621679629891"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-6989586621679629887"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629888"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-360"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629890"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679629891"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-6989586621679629889"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-identifier">zonkTopExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><a name="zonkTopExpr"><a href="TcHsSyn.html#zonkTopExpr"><span class="hs-identifier">zonkTopExpr</span></a></a><span> </span><a name="local-6989586621679629892"><a href="#local-6989586621679629892"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-6989586621679629892"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-identifier">zonkTopLExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-366"></a><a name="zonkTopLExpr"><a href="TcHsSyn.html#zonkTopLExpr"><span class="hs-identifier">zonkTopLExpr</span></a></a><span> </span><a name="local-6989586621679629893"><a href="#local-6989586621679629893"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-6989586621679629893"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-identifier">zonkTopDecls</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-369"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-370"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span>
</span><a name="line-371"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HscTypes.html#TypeEnv"><span class="hs-identifier hs-type">TypeEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-372"></a><span>                     </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-373"></a><span>                     </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span>
</span><a name="line-374"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-375"></a><span>                     </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-376"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span>    </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-377"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span>    </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-378"></a><a name="zonkTopDecls"><a href="TcHsSyn.html#zonkTopDecls"><span class="hs-identifier">zonkTopDecls</span></a></a><span> </span><a name="local-6989586621679629894"><a href="#local-6989586621679629894"><span class="hs-identifier">ev_binds</span></a></a><span> </span><a name="local-6989586621679629895"><a href="#local-6989586621679629895"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621679629896"><a href="#local-6989586621679629896"><span class="hs-identifier">rules</span></a></a><span> </span><a name="local-6989586621679629897"><a href="#local-6989586621679629897"><span class="hs-identifier">vects</span></a></a><span> </span><a name="local-6989586621679629898"><a href="#local-6989586621679629898"><span class="hs-identifier">imp_specs</span></a></a><span> </span><a name="local-6989586621679629899"><a href="#local-6989586621679629899"><span class="hs-identifier">fords</span></a></a><span>
</span><a name="line-379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629900"><a href="#local-6989586621679629900"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629901"><a href="#local-6989586621679629901"><span class="hs-identifier">ev_binds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-6989586621679629894"><span class="hs-identifier hs-var">ev_binds</span></a><span>
</span><a name="line-380"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629902"><a href="#local-6989586621679629902"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629903"><a href="#local-6989586621679629903"><span class="hs-identifier">binds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier hs-var">zonkRecMonoBinds</span></a><span> </span><a href="#local-6989586621679629900"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679629895"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-381"></a><span>                        </span><span class="hs-comment">-- Top level is implicitly recursive</span><span>
</span><a name="line-382"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629904"><a href="#local-6989586621679629904"><span class="hs-identifier">rules'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRules"><span class="hs-identifier hs-var">zonkRules</span></a><span> </span><a href="#local-6989586621679629902"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679629896"><span class="hs-identifier hs-var">rules</span></a><span>
</span><a name="line-383"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629905"><a href="#local-6989586621679629905"><span class="hs-identifier">vects'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkVects"><span class="hs-identifier hs-var">zonkVects</span></a><span> </span><a href="#local-6989586621679629902"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679629897"><span class="hs-identifier hs-var">vects</span></a><span>
</span><a name="line-384"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629906"><a href="#local-6989586621679629906"><span class="hs-identifier">specs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier hs-var">zonkLTcSpecPrags</span></a><span> </span><a href="#local-6989586621679629902"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var">imp_specs</span></a><span>
</span><a name="line-385"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629907"><a href="#local-6989586621679629907"><span class="hs-identifier">fords'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkForeignExports"><span class="hs-identifier hs-var">zonkForeignExports</span></a><span> </span><a href="#local-6989586621679629902"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679629899"><span class="hs-identifier hs-var">fords</span></a><span>
</span><a name="line-386"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEnvIds"><span class="hs-identifier hs-var">zonkEnvIds</span></a><span> </span><a href="#local-6989586621679629902"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629901"><span class="hs-identifier hs-var">ev_binds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629903"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629907"><span class="hs-identifier hs-var">fords'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629906"><span class="hs-identifier hs-var">specs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629904"><span class="hs-identifier hs-var">rules'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629905"><span class="hs-identifier hs-var">vects'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-389"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><a name="zonkLocalBinds"><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier">zonkLocalBinds</span></a></a><span> </span><a name="local-6989586621679629908"><a href="#local-6989586621679629908"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span>
</span><a name="line-391"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629908"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsIn"><span class="hs-identifier hs-var">ValBindsIn</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;zonkLocalBinds&quot;</span><span> </span><span class="hs-comment">-- Not in typechecker output</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><a name="local-6989586621679629909"><a href="#local-6989586621679629909"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a name="local-6989586621679629910"><a href="#local-6989586621679629910"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621679629911"><a href="#local-6989586621679629911"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629922"><a href="#local-6989586621679629922"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629923"><a href="#local-6989586621679629923"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629912"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679629909"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629910"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-398"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629922"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a href="#local-6989586621679629923"><span class="hs-identifier hs-var">new_binds</span></a><span> </span><a href="#local-6989586621679629911"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-399"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-400"></a><span>    </span><a name="local-6989586621679629912"><a href="#local-6989586621679629912"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679629913"><a href="#local-6989586621679629913"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-401"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629913"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679629914"><a href="#local-6989586621679629914"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679629915"><a href="#local-6989586621679629915"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-6989586621679629916"><a href="#local-6989586621679629916"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679629917"><a href="#local-6989586621679629917"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629918"><a href="#local-6989586621679629918"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629919"><a href="#local-6989586621679629919"><span class="hs-identifier">b'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier hs-var">zonkRecMonoBinds</span></a><span> </span><a href="#local-6989586621679629914"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629916"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-404"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629920"><a href="#local-6989586621679629920"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629921"><a href="#local-6989586621679629921"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629912"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679629918"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679629917"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-405"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629920"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629915"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-6989586621679629919"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679629921"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><a name="local-6989586621679629924"><a href="#local-6989586621679629924"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBinds"><span class="hs-identifier hs-var">IPBinds</span></a><span> </span><a name="local-6989586621679629925"><a href="#local-6989586621679629925"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621679629926"><a href="#local-6989586621679629926"><span class="hs-identifier">dict_binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-408"></a><span>    </span><a name="local-6989586621679629932"><a href="#local-6989586621679629932"><span class="hs-identifier">new_binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-6989586621679629927"><span class="hs-identifier hs-var">zonk_ip_bind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629925"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-409"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-410"></a><span>        </span><a name="local-6989586621679629933"><a href="#local-6989586621679629933"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679629924"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679629934"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679629934"><a href="#local-6989586621679629934"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679629932"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">]</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679629935"><a href="#local-6989586621679629935"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629936"><a href="#local-6989586621679629936"><span class="hs-identifier">new_dict_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-6989586621679629933"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679629926"><span class="hs-identifier hs-var">dict_binds</span></a><span>
</span><a name="line-412"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629935"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBinds"><span class="hs-identifier hs-var">IPBinds</span></a><span> </span><a href="#local-6989586621679629932"><span class="hs-identifier hs-var">new_binds</span></a><span> </span><a href="#local-6989586621679629936"><span class="hs-identifier hs-var">new_dict_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-414"></a><span>    </span><a name="local-6989586621679629927"><a href="#local-6989586621679629927"><span class="hs-identifier">zonk_ip_bind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><a name="local-6989586621679629928"><a href="#local-6989586621679629928"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679629929"><a href="#local-6989586621679629929"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679629930"><a href="#local-6989586621679629930"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#mapIPNameTc"><span class="hs-identifier hs-var">mapIPNameTc</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629924"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629928"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-416"></a><span>             </span><a name="local-6989586621679629931"><a href="#local-6989586621679629931"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679629924"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629929"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-417"></a><span>             </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><a href="#local-6989586621679629930"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-6989586621679629931"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-420"></a><span class="hs-identifier">zonkRecMonoBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><a name="zonkRecMonoBinds"><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier">zonkRecMonoBinds</span></a></a><span> </span><a name="local-6989586621679629937"><a href="#local-6989586621679629937"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629938"><a href="#local-6989586621679629938"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-422"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679629939"><a href="#local-6989586621679629939"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-423"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679629940"><a href="#local-6989586621679629940"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679629937"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span> </span><a href="#local-6989586621679629939"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629941"><a href="#local-6989586621679629941"><span class="hs-identifier">binds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier hs-var">zonkMonoBinds</span></a><span> </span><a href="#local-6989586621679629940"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679629938"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-425"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629940"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629941"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-428"></a><span class="hs-identifier">zonkMonoBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><a name="zonkMonoBinds"><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier">zonkMonoBinds</span></a></a><span> </span><a name="local-6989586621679629942"><a href="#local-6989586621679629942"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629943"><a href="#local-6989586621679629943"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#mapBagM"><span class="hs-identifier hs-var">mapBagM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_lbind"><span class="hs-identifier hs-var">zonk_lbind</span></a><span> </span><a href="#local-6989586621679629942"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629943"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-identifier">zonk_lbind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><a name="zonk_lbind"><a href="TcHsSyn.html#zonk_lbind"><span class="hs-identifier">zonk_lbind</span></a></a><span> </span><a name="local-6989586621679629944"><a href="#local-6989586621679629944"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_bind"><span class="hs-identifier hs-var">zonk_bind</span></a><span> </span><a href="#local-6989586621679629944"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-identifier">zonk_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><a name="zonk_bind"><a href="TcHsSyn.html#zonk_bind"><span class="hs-identifier">zonk_bind</span></a></a><span> </span><a name="local-6989586621679629945"><a href="#local-6989586621679629945"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629946"><a href="#local-6989586621679629946"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629947"><a href="#local-6989586621679629947"><span class="hs-identifier">pat</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629948"><a href="#local-6989586621679629948"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629949"><a href="#local-6989586621679629949"><span class="hs-identifier">ty</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629950"><a href="#local-6989586621679629950"><span class="hs-identifier">_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629951"><a href="#local-6989586621679629951"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679629945"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629947"><span class="hs-identifier hs-var">pat</span></a><span>            </span><span class="hs-comment">-- Env already extended</span><span>
</span><a name="line-437"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629952"><a href="#local-6989586621679629952"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier hs-var">zonkGRHSs</span></a><span> </span><a href="#local-6989586621679629945"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679629948"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-438"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629953"><a href="#local-6989586621679629953"><span class="hs-identifier">new_ty</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679629945"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629949"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-439"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629946"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629951"><span class="hs-identifier hs-var">new_pat</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629952"><span class="hs-identifier hs-var">new_grhss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629953"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-6989586621679629954"><a href="#local-6989586621679629954"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629955"><a href="#local-6989586621679629955"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629956"><a href="#local-6989586621679629956"><span class="hs-identifier">expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629957"><a href="#local-6989586621679629957"><span class="hs-identifier">inl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679629958"><a href="#local-6989586621679629958"><span class="hs-identifier">new_var</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629954"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629955"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-443"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629959"><a href="#local-6989586621679629959"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679629954"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629956"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-444"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629958"><span class="hs-identifier hs-var">new_var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629959"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629957"><span class="hs-identifier hs-var">inl</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-6989586621679629960"><a href="#local-6989586621679629960"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629961"><a href="#local-6989586621679629961"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679629962"><a href="#local-6989586621679629962"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679629963"><a href="#local-6989586621679629963"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629964"><a href="#local-6989586621679629964"><span class="hs-identifier">ms</span></a></a><span>
</span><a name="line-447"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629965"><a href="#local-6989586621679629965"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679629966"><a href="#local-6989586621679629966"><span class="hs-identifier">new_var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629960"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629963"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-449"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629967"><a href="#local-6989586621679629967"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629968"><a href="#local-6989586621679629968"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679629960"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629965"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-450"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629969"><a href="#local-6989586621679629969"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679629967"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679629964"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-451"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629961"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679629962"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679629966"><span class="hs-identifier hs-var">new_var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629969"><span class="hs-identifier hs-var">new_ms</span></a><span>
</span><a name="line-452"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629968"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-6989586621679629970"><a href="#local-6989586621679629970"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629971"><a href="#local-6989586621679629971"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629972"><a href="#local-6989586621679629972"><span class="hs-identifier">evs</span></a></a><span>
</span><a name="line-455"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629973"><a href="#local-6989586621679629973"><span class="hs-identifier">ev_binds</span></a></a><span>
</span><a name="line-456"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629974"><a href="#local-6989586621679629974"><span class="hs-identifier">exports</span></a></a><span>
</span><a name="line-457"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629975"><a href="#local-6989586621679629975"><span class="hs-identifier">val_binds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629985"><a href="#local-6989586621679629985"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629986"><a href="#local-6989586621679629986"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-6989586621679629970"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629971"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-460"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629987"><a href="#local-6989586621679629987"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629988"><a href="#local-6989586621679629988"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-6989586621679629985"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-6989586621679629972"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-461"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629989"><a href="#local-6989586621679629989"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629990"><a href="#local-6989586621679629990"><span class="hs-identifier">new_ev_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds_s"><span class="hs-identifier hs-var">zonkTcEvBinds_s</span></a><span> </span><a href="#local-6989586621679629987"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679629973"><span class="hs-identifier hs-var">ev_binds</span></a><span>
</span><a name="line-462"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679629995"><a href="#local-6989586621679629995"><span class="hs-identifier">new_val_bind</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679629996"><a href="#local-6989586621679629996"><span class="hs-identifier">new_exports</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679629991"><a href="#local-6989586621679629991"><span class="hs-identifier">new_val_binds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-463"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679629992"><a href="#local-6989586621679629992"><span class="hs-identifier">env3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679629989"><span class="hs-identifier hs-var">env2</span></a><span>
</span><a name="line-464"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span> </span><a href="#local-6989586621679629991"><span class="hs-identifier hs-var">new_val_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629993"><a href="#local-6989586621679629993"><span class="hs-identifier">new_val_binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier hs-var">zonkMonoBinds</span></a><span> </span><a href="#local-6989586621679629992"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679629975"><span class="hs-identifier hs-var">val_binds</span></a><span>
</span><a name="line-466"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679629994"><a href="#local-6989586621679629994"><span class="hs-identifier">new_exports</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629976"><span class="hs-identifier hs-var">zonkExport</span></a><span> </span><a href="#local-6989586621679629992"><span class="hs-identifier hs-var">env3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629974"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-467"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629993"><span class="hs-identifier hs-var">new_val_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679629994"><span class="hs-identifier hs-var">new_exports</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-468"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629986"><span class="hs-identifier hs-var">new_tyvars</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629988"><span class="hs-identifier hs-var">new_evs</span></a><span>
</span><a name="line-469"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629990"><span class="hs-identifier hs-var">new_ev_binds</span></a><span>
</span><a name="line-470"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629996"><span class="hs-identifier hs-var">new_exports</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629995"><span class="hs-identifier hs-var">new_val_bind</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-471"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-472"></a><span>    </span><a name="local-6989586621679629976"><a href="#local-6989586621679629976"><span class="hs-identifier">zonkExport</span></a></a><span> </span><a name="local-6989586621679629977"><a href="#local-6989586621679629977"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ABE"><span class="hs-identifier hs-var">ABE</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">abe_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629978"><a href="#local-6989586621679629978"><span class="hs-identifier">wrap</span></a></a><span>
</span><a name="line-473"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_poly</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629979"><a href="#local-6989586621679629979"><span class="hs-identifier">poly_id</span></a></a><span>
</span><a name="line-474"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_mono</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629980"><a href="#local-6989586621679629980"><span class="hs-identifier">mono_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_prags</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629981"><a href="#local-6989586621679629981"><span class="hs-identifier">prags</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679629982"><a href="#local-6989586621679629982"><span class="hs-identifier">new_poly_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679629977"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629979"><span class="hs-identifier hs-var">poly_id</span></a><span>
</span><a name="line-476"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679629983"><a href="#local-6989586621679629983"><span class="hs-identifier">new_wrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679629977"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629978"><span class="hs-identifier hs-var">wrap</span></a><span>
</span><a name="line-477"></a><span>             </span><a name="local-6989586621679629984"><a href="#local-6989586621679629984"><span class="hs-identifier">new_prags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier hs-var">zonkSpecPrags</span></a><span> </span><a href="#local-6989586621679629977"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629981"><span class="hs-identifier hs-var">prags</span></a><span>
</span><a name="line-478"></a><span>             </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ABE"><span class="hs-identifier hs-var">ABE</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">abe_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629983"><span class="hs-identifier hs-var">new_wrap</span></a><span>
</span><a name="line-479"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_poly</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629982"><span class="hs-identifier hs-var">new_poly_id</span></a><span>
</span><a name="line-480"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_mono</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679629977"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679629980"><span class="hs-identifier hs-var">mono_id</span></a><span>
</span><a name="line-481"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_prags</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679629984"><span class="hs-identifier hs-var">new_prags</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-6989586621679629997"><a href="#local-6989586621679629997"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679629998"><a href="#local-6989586621679629998"><span class="hs-identifier">outer_bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679629999"><a href="#local-6989586621679629999"><span class="hs-identifier">tyvars</span></a></a><span>
</span><a name="line-484"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630000"><a href="#local-6989586621679630000"><span class="hs-identifier">evs</span></a></a><span>
</span><a name="line-485"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_export</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630001"><a href="#local-6989586621679630001"><span class="hs-identifier">poly</span></a></a><span>
</span><a name="line-486"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_prags</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630002"><a href="#local-6989586621679630002"><span class="hs-identifier">prags</span></a></a><span>
</span><a name="line-487"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_ev_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630003"><a href="#local-6989586621679630003"><span class="hs-identifier">ev_bind</span></a></a><span>
</span><a name="line-488"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_bind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630004"><a href="#local-6989586621679630004"><span class="hs-identifier">lbind</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-489"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630005"><a href="#local-6989586621679630005"><span class="hs-identifier">bind_loc</span></a></a><span> </span><a name="local-6989586621679630006"><a href="#local-6989586621679630006"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630007"><a href="#local-6989586621679630007"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679630008"><a href="#local-6989586621679630008"><span class="hs-identifier">local</span></a></a><span>
</span><a name="line-490"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630009"><a href="#local-6989586621679630009"><span class="hs-identifier">ms</span></a></a><span>
</span><a name="line-491"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630010"><a href="#local-6989586621679630010"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630004"><span class="hs-identifier hs-var">lbind</span></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630011"><a href="#local-6989586621679630011"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630012"><a href="#local-6989586621679630012"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-6989586621679629997"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-6989586621679629999"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-494"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630013"><a href="#local-6989586621679630013"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630014"><a href="#local-6989586621679630014"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-6989586621679630011"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-6989586621679630000"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-495"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630015"><a href="#local-6989586621679630015"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630016"><a href="#local-6989586621679630016"><span class="hs-identifier">new_ev_bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-6989586621679630013"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630003"><span class="hs-identifier hs-var">ev_bind</span></a><span>
</span><a name="line-496"></a><span>           </span><span class="hs-comment">-- Inline zonk_bind (FunBind ...) because we wish to skip</span><span>
</span><a name="line-497"></a><span>           </span><span class="hs-comment">-- the check for representation-polymorphic binders. The</span><span>
</span><a name="line-498"></a><span>           </span><span class="hs-comment">-- local binder in the FunBind in an AbsBindsSig is never actually</span><span>
</span><a name="line-499"></a><span>           </span><span class="hs-comment">-- bound in Core -- indeed, that's the whole point of AbsBindsSig.</span><span>
</span><a name="line-500"></a><span>           </span><span class="hs-comment">-- just calling zonk_bind causes #11405.</span><span>
</span><a name="line-501"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630017"><a href="#local-6989586621679630017"><span class="hs-identifier">new_local</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630015"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630008"><span class="hs-identifier hs-var">local</span></a><span>
</span><a name="line-502"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630018"><a href="#local-6989586621679630018"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630019"><a href="#local-6989586621679630019"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630015"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630010"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-503"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630020"><a href="#local-6989586621679630020"><span class="hs-identifier">new_ms</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630018"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630009"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-504"></a><span>           </span><span class="hs-comment">-- If there is a representation polymorphism problem, it will</span><span>
</span><a name="line-505"></a><span>           </span><span class="hs-comment">-- be caught here:</span><span>
</span><a name="line-506"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630021"><a href="#local-6989586621679630021"><span class="hs-identifier">new_poly_id</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630015"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630001"><span class="hs-identifier hs-var">poly</span></a><span>
</span><a name="line-507"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630022"><a href="#local-6989586621679630022"><span class="hs-identifier">new_prags</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier hs-var">zonkSpecPrags</span></a><span> </span><a href="#local-6989586621679630015"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630002"><span class="hs-identifier hs-var">prags</span></a><span>
</span><a name="line-508"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630023"><a href="#local-6989586621679630023"><span class="hs-identifier">new_val_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630005"><span class="hs-identifier hs-var">bind_loc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630006"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630007"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679630017"><span class="hs-identifier hs-var">new_local</span></a><span>
</span><a name="line-509"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630020"><span class="hs-identifier hs-var">new_ms</span></a><span>
</span><a name="line-510"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630019"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630012"><span class="hs-identifier hs-var">new_tyvars</span></a><span>
</span><a name="line-512"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630014"><span class="hs-identifier hs-var">new_evs</span></a><span>
</span><a name="line-513"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_export</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630021"><span class="hs-identifier hs-var">new_poly_id</span></a><span>
</span><a name="line-514"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_prags</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630022"><span class="hs-identifier hs-var">new_prags</span></a><span>
</span><a name="line-515"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_ev_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630016"><span class="hs-identifier hs-var">new_ev_bind</span></a><span>
</span><a name="line-516"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_bind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630023"><span class="hs-identifier hs-var">new_val_bind</span></a><span>  </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-519"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonk_bind&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679629998"><span class="hs-identifier hs-var">outer_bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-6989586621679630024"><a href="#local-6989586621679630024"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a name="local-6989586621679630025"><a href="#local-6989586621679630025"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630026"><a href="#local-6989586621679630026"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679630027"><a href="#local-6989586621679630027"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-522"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630028"><a href="#local-6989586621679630028"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-523"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630029"><a href="#local-6989586621679630029"><span class="hs-identifier">lpat</span></a></a><span>
</span><a name="line-524"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630030"><a href="#local-6989586621679630030"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630031"><a href="#local-6989586621679630031"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630024"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630027"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-526"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630032"><a href="#local-6989586621679630032"><span class="hs-identifier">details'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPatSynDetails"><span class="hs-identifier hs-var">zonkPatSynDetails</span></a><span> </span><a href="#local-6989586621679630024"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630028"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-527"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630033"><a href="#local-6989586621679630033"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630034"><a href="#local-6989586621679630034"><span class="hs-identifier">lpat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630024"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630029"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-528"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630035"><a href="#local-6989586621679630035"><span class="hs-identifier">_env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630036"><a href="#local-6989586621679630036"><span class="hs-identifier">dir'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPatSynDir"><span class="hs-identifier hs-var">zonkPatSynDir</span></a><span> </span><a href="#local-6989586621679630033"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630030"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-529"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-530"></a><span>                  </span><a href="#local-6989586621679630025"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630026"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679630031"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-531"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630032"><span class="hs-identifier hs-var">details'</span></a><span>
</span><a name="line-532"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630034"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-533"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630036"><span class="hs-identifier hs-var">dir'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-identifier">zonkPatSynDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-536"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-538"></a><a name="zonkPatSynDetails"><a href="TcHsSyn.html#zonkPatSynDetails"><span class="hs-identifier">zonkPatSynDetails</span></a></a><span> </span><a name="local-6989586621679630037"><a href="#local-6989586621679630037"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630037"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-541"></a><a name="zonkPatSynDir"><a href="TcHsSyn.html#zonkPatSynDir"><span class="hs-identifier">zonkPatSynDir</span></a></a><span> </span><a name="local-6989586621679630038"><a href="#local-6989586621679630038"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630038"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span class="hs-special">)</span><span>
</span><a name="line-542"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><a name="local-6989586621679630039"><a href="#local-6989586621679630039"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630039"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><a name="local-6989586621679630040"><a href="#local-6989586621679630040"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span> </span><a name="local-6989586621679630041"><a href="#local-6989586621679630041"><span class="hs-identifier">mg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-544"></a><span>    </span><a name="local-6989586621679630042"><a href="#local-6989586621679630042"><span class="hs-identifier">mg'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630040"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630041"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-545"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630040"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span> </span><a href="#local-6989586621679630042"><span class="hs-identifier hs-var">mg'</span></a><span class="hs-special">)</span><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-identifier">zonkSpecPrags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#TcSpecPrags"><span class="hs-identifier hs-type">TcSpecPrags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="HsBinds.html#TcSpecPrags"><span class="hs-identifier hs-type">TcSpecPrags</span></a><span>
</span><a name="line-548"></a><a name="zonkSpecPrags"><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier">zonkSpecPrags</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><a href="HsBinds.html#IsDefaultMethod"><span class="hs-identifier hs-var">IsDefaultMethod</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="HsBinds.html#IsDefaultMethod"><span class="hs-identifier hs-var">IsDefaultMethod</span></a><span>
</span><a name="line-549"></a><span class="hs-identifier">zonkSpecPrags</span><span> </span><a name="local-6989586621679630043"><a href="#local-6989586621679630043"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrags"><span class="hs-identifier hs-var">SpecPrags</span></a><span> </span><a name="local-6989586621679630044"><a href="#local-6989586621679630044"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630045"><a href="#local-6989586621679630045"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier hs-var">zonkLTcSpecPrags</span></a><span> </span><a href="#local-6989586621679630043"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630044"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-550"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrags"><span class="hs-identifier hs-var">SpecPrags</span></a><span> </span><a href="#local-6989586621679630045"><span class="hs-identifier hs-var">ps'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-identifier">zonkLTcSpecPrags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span>
</span><a name="line-553"></a><a name="zonkLTcSpecPrags"><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier">zonkLTcSpecPrags</span></a></a><span> </span><a name="local-6989586621679630046"><a href="#local-6989586621679630046"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630047"><a href="#local-6989586621679630047"><span class="hs-identifier">ps</span></a></a><span>
</span><a name="line-554"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679630048"><span class="hs-identifier hs-var">zonk_prag</span></a><span> </span><a href="#local-6989586621679630047"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-555"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-556"></a><span>    </span><a name="local-6989586621679630048"><a href="#local-6989586621679630048"><span class="hs-identifier">zonk_prag</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630049"><a href="#local-6989586621679630049"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrag"><span class="hs-identifier hs-var">SpecPrag</span></a><span> </span><a name="local-6989586621679630050"><a href="#local-6989586621679630050"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679630051"><a href="#local-6989586621679630051"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621679630052"><a href="#local-6989586621679630052"><span class="hs-identifier">inl</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630053"><a href="#local-6989586621679630053"><span class="hs-identifier">co_fn'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630046"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630051"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-558"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630049"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrag"><span class="hs-identifier hs-var">SpecPrag</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679630046"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630050"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630053"><span class="hs-identifier hs-var">co_fn'</span></a><span> </span><a href="#local-6989586621679630052"><span class="hs-identifier hs-var">inl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Match-GRHSs]{Match and GRHSs}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-567"></a><span>
</span><a name="line-568"></a><span class="hs-identifier">zonkMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-569"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629794"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629794"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629794"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629794"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-571"></a><a name="zonkMatchGroup"><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier">zonkMatchGroup</span></a></a><span> </span><a name="local-6989586621679630054"><a href="#local-6989586621679630054"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630055"><a href="#local-6989586621679630055"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630056"><a href="#local-6989586621679630056"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630057"><a href="#local-6989586621679630057"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630058"><a href="#local-6989586621679630058"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-572"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630059"><a href="#local-6989586621679630059"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630060"><a href="#local-6989586621679630060"><span class="hs-identifier">origin</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-573"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630061"><a href="#local-6989586621679630061"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkMatch"><span class="hs-identifier hs-var">zonkMatch</span></a><span> </span><a href="#local-6989586621679630054"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630055"><span class="hs-identifier hs-var">zBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630057"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-574"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630062"><a href="#local-6989586621679630062"><span class="hs-identifier">arg_tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span> </span><a href="#local-6989586621679630054"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630058"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-575"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630063"><a href="#local-6989586621679630063"><span class="hs-identifier">res_ty'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630054"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630059"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-576"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630056"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630061"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630062"><span class="hs-identifier hs-var">arg_tys'</span></a><span>
</span><a name="line-577"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630063"><span class="hs-identifier hs-var">res_ty'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630060"><span class="hs-identifier hs-var">origin</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-identifier">zonkMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-580"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-581"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-582"></a><a name="zonkMatch"><a href="TcHsSyn.html#zonkMatch"><span class="hs-identifier">zonkMatch</span></a></a><span> </span><a name="local-6989586621679630064"><a href="#local-6989586621679630064"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630065"><a href="#local-6989586621679630065"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630066"><a href="#local-6989586621679630066"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a name="local-6989586621679630067"><a href="#local-6989586621679630067"><span class="hs-identifier">mf</span></a></a><span> </span><a name="local-6989586621679630068"><a href="#local-6989586621679630068"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630069"><a href="#local-6989586621679630069"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630070"><a href="#local-6989586621679630070"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630071"><a href="#local-6989586621679630071"><span class="hs-identifier">new_pats</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630064"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630068"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-584"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630072"><a href="#local-6989586621679630072"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier hs-var">zonkGRHSs</span></a><span> </span><a href="#local-6989586621679630070"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630065"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630069"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-585"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630066"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="#local-6989586621679630067"><span class="hs-identifier hs-var">mf</span></a><span> </span><a href="#local-6989586621679630071"><span class="hs-identifier hs-var">new_pats</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621679630072"><span class="hs-identifier hs-var">new_grhss</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-588"></a><span class="hs-identifier">zonkGRHSs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-589"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629792"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629792"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629792"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629792"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><a name="zonkGRHSs"><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier">zonkGRHSs</span></a></a><span> </span><a name="local-6989586621679630073"><a href="#local-6989586621679630073"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630074"><a href="#local-6989586621679630074"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a name="local-6989586621679630075"><a href="#local-6989586621679630075"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630076"><a href="#local-6989586621679630076"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630077"><a href="#local-6989586621679630077"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-593"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679630078"><a href="#local-6989586621679630078"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630079"><a href="#local-6989586621679630079"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-6989586621679630073"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630077"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-594"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-595"></a><span>        </span><a name="local-6989586621679630080"><a href="#local-6989586621679630080"><span class="hs-identifier">zonk_grhs</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-6989586621679630081"><a href="#local-6989586621679630081"><span class="hs-identifier">guarded</span></a></a><span> </span><a name="local-6989586621679630082"><a href="#local-6989586621679630082"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-596"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630083"><a href="#local-6989586621679630083"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630084"><a href="#local-6989586621679630084"><span class="hs-identifier">new_guarded</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630078"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630081"><span class="hs-identifier hs-var">guarded</span></a><span>
</span><a name="line-597"></a><span>               </span><a name="local-6989586621679630085"><a href="#local-6989586621679630085"><span class="hs-identifier">new_rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630074"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630083"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630082"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-598"></a><span>               </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="#local-6989586621679630084"><span class="hs-identifier hs-var">new_guarded</span></a><span> </span><a href="#local-6989586621679630085"><span class="hs-identifier hs-var">new_rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>    </span><a name="local-6989586621679630086"><a href="#local-6989586621679630086"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-6989586621679630080"><span class="hs-identifier hs-var">zonk_grhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630075"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-600"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a href="#local-6989586621679630086"><span class="hs-identifier hs-var">new_grhss</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630076"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630079"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-HsExpr]{Running a zonkitution over a TypeCheckedExpr}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-identifier">zonkLExprs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-611"></a><span class="hs-identifier">zonkLExpr</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span class="hs-identifier">zonkExpr</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><a name="zonkLExprs"><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier">zonkLExprs</span></a></a><span> </span><a name="local-6989586621679630087"><a href="#local-6989586621679630087"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630088"><a href="#local-6989586621679630088"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630087"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630088"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-615"></a><a name="zonkLExpr"><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier">zonkLExpr</span></a></a><span>  </span><a name="local-6989586621679630089"><a href="#local-6989586621679630089"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630090"><a href="#local-6989586621679630090"><span class="hs-identifier">expr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630089"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630090"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><a name="zonkExpr"><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier">zonkExpr</span></a></a><span> </span><a name="local-6989586621679630091"><a href="#local-6989586621679630091"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630092"><a href="#local-6989586621679630092"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630093"><a href="#local-6989586621679630093"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isDataConId_maybe</span><span> </span><a href="Id.html#isDataConId_maybe"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Id.html#isDataConId_maybe"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Id.html#isDataConId_maybe"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630092"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679630091"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630093"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630094"><a href="#local-6989586621679630094"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsConLikeOut"><span class="hs-identifier hs-var">HsConLikeOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679630094"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a><span> </span><a name="local-6989586621679630095"><a href="#local-6989586621679630095"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a><span> </span><a href="#local-6989586621679630095"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>
</span><a name="line-626"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630096"><a href="#local-6989586621679630096"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><a href="HsExpr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679630096"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630097"><a href="#local-6989586621679630097"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><a name="local-6989586621679630098"><a href="#local-6989586621679630098"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679630099"><a href="#local-6989586621679630099"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630100"><a href="#local-6989586621679630100"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630097"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630099"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-630"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><a href="#local-6989586621679630098"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679630100"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a name="local-6989586621679630101"><a href="#local-6989586621679630101"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="#local-6989586621679630101"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630102"><a href="#local-6989586621679630102"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a name="local-6989586621679630103"><a href="#local-6989586621679630103"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630104"><a href="#local-6989586621679630104"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-6989586621679630102"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630103"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-637"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a href="#local-6989586621679630104"><span class="hs-identifier hs-var">lit'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630105"><a href="#local-6989586621679630105"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a name="local-6989586621679630106"><a href="#local-6989586621679630106"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630107"><a href="#local-6989586621679630107"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630105"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630106"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-641"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="#local-6989586621679630107"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630108"><a href="#local-6989586621679630108"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><a name="local-6989586621679630109"><a href="#local-6989586621679630109"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630110"><a href="#local-6989586621679630110"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630108"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630109"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-645"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><a href="#local-6989586621679630110"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630111"><a href="#local-6989586621679630111"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a name="local-6989586621679630112"><a href="#local-6989586621679630112"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630113"><a href="#local-6989586621679630113"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630114"><a href="#local-6989586621679630114"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630111"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630112"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-649"></a><span>       </span><a name="local-6989586621679630115"><a href="#local-6989586621679630115"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630111"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630113"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-650"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-6989586621679630114"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630115"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630116"><a href="#local-6989586621679630116"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppTypeOut"><span class="hs-identifier hs-var">HsAppTypeOut</span></a><span> </span><a name="local-6989586621679630117"><a href="#local-6989586621679630117"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679630118"><a href="#local-6989586621679630118"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630119"><a href="#local-6989586621679630119"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630116"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630117"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-654"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppTypeOut"><span class="hs-identifier hs-var">HsAppTypeOut</span></a><span> </span><a href="#local-6989586621679630119"><span class="hs-identifier hs-var">new_e</span></a><span> </span><a href="#local-6989586621679630118"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>       </span><span class="hs-comment">-- NB: the type is an HsType; can't zonk that!</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630120"><a href="#local-6989586621679630120"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsRnBracketOut"><span class="hs-identifier hs-var">HsRnBracketOut</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonkExpr: HsRnBracketOut&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679630120"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630121"><a href="#local-6989586621679630121"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTcBracketOut"><span class="hs-identifier hs-var">HsTcBracketOut</span></a><span> </span><a name="local-6989586621679630122"><a href="#local-6989586621679630122"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679630123"><a href="#local-6989586621679630123"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-661"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630128"><a href="#local-6989586621679630128"><span class="hs-identifier">bs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679630124"><span class="hs-identifier hs-var">zonk_b</span></a><span> </span><a href="#local-6989586621679630123"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-662"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTcBracketOut"><span class="hs-identifier hs-var">HsTcBracketOut</span></a><span> </span><a href="#local-6989586621679630122"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-6989586621679630128"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-664"></a><span>    </span><a name="local-6989586621679630124"><a href="#local-6989586621679630124"><span class="hs-identifier">zonk_b</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a><span> </span><a name="local-6989586621679630125"><a href="#local-6989586621679630125"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679630126"><a href="#local-6989586621679630126"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630127"><a href="#local-6989586621679630127"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630121"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630126"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-665"></a><span>                                      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a><span> </span><a href="#local-6989586621679630125"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679630127"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a name="local-6989586621679630129"><a href="#local-6989586621679630129"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier hs-var">s</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Should not happen</span><span>
</span><a name="line-668"></a><span>                           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a href="#local-6989586621679630129"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>
</span><a name="line-670"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630130"><a href="#local-6989586621679630130"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a name="local-6989586621679630131"><a href="#local-6989586621679630131"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630132"><a href="#local-6989586621679630132"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679630133"><a href="#local-6989586621679630133"><span class="hs-identifier">fixity</span></a></a><span> </span><a name="local-6989586621679630134"><a href="#local-6989586621679630134"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630135"><a href="#local-6989586621679630135"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630130"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630131"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-672"></a><span>       </span><a name="local-6989586621679630136"><a href="#local-6989586621679630136"><span class="hs-identifier">new_op</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630130"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630132"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-673"></a><span>       </span><a name="local-6989586621679630137"><a href="#local-6989586621679630137"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630130"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630134"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-674"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679630135"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630136"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-6989586621679630133"><span class="hs-identifier hs-var">fixity</span></a><span> </span><a href="#local-6989586621679630137"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630138"><a href="#local-6989586621679630138"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a name="local-6989586621679630139"><a href="#local-6989586621679630139"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630140"><a href="#local-6989586621679630140"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630141"><a href="#local-6989586621679630141"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630142"><a href="#local-6989586621679630142"><span class="hs-identifier">new_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630138"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630140"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-678"></a><span>       </span><a name="local-6989586621679630143"><a href="#local-6989586621679630143"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630141"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679630139"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-679"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a href="#local-6989586621679630143"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630142"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span>
</span><a name="line-681"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630144"><a href="#local-6989586621679630144"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a name="local-6989586621679630145"><a href="#local-6989586621679630145"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630146"><a href="#local-6989586621679630146"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630144"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630145"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-683"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="#local-6989586621679630146"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630147"><a href="#local-6989586621679630147"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a><span> </span><a name="local-6989586621679630148"><a href="#local-6989586621679630148"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630149"><a href="#local-6989586621679630149"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630150"><a href="#local-6989586621679630150"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630147"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630148"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-687"></a><span>       </span><a name="local-6989586621679630151"><a href="#local-6989586621679630151"><span class="hs-identifier">new_op</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630147"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630149"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-688"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a><span> </span><a href="#local-6989586621679630150"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630151"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630152"><a href="#local-6989586621679630152"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><a name="local-6989586621679630153"><a href="#local-6989586621679630153"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679630154"><a href="#local-6989586621679630154"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630155"><a href="#local-6989586621679630155"><span class="hs-identifier">new_op</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630152"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630153"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-692"></a><span>       </span><a name="local-6989586621679630156"><a href="#local-6989586621679630156"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630152"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630154"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-693"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><a href="#local-6989586621679630155"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-6989586621679630156"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630157"><a href="#local-6989586621679630157"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a name="local-6989586621679630158"><a href="#local-6989586621679630158"><span class="hs-identifier">tup_args</span></a></a><span> </span><a name="local-6989586621679630159"><a href="#local-6989586621679630159"><span class="hs-identifier">boxed</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-696"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630167"><a href="#local-6989586621679630167"><span class="hs-identifier">new_tup_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679630160"><span class="hs-identifier hs-var">zonk_tup_arg</span></a><span> </span><a href="#local-6989586621679630158"><span class="hs-identifier hs-var">tup_args</span></a><span>
</span><a name="line-697"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a href="#local-6989586621679630167"><span class="hs-identifier hs-var">new_tup_args</span></a><span> </span><a href="#local-6989586621679630159"><span class="hs-identifier hs-var">boxed</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-698"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-699"></a><span>    </span><a name="local-6989586621679630160"><a href="#local-6989586621679630160"><span class="hs-identifier">zonk_tup_arg</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630161"><a href="#local-6989586621679630161"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><a name="local-6989586621679630162"><a href="#local-6989586621679630162"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630163"><a href="#local-6989586621679630163"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630157"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630162"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-700"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630161"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><a href="#local-6989586621679630163"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-701"></a><span>    </span><span class="hs-identifier">zonk_tup_arg</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630164"><a href="#local-6989586621679630164"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a name="local-6989586621679630165"><a href="#local-6989586621679630165"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630166"><a href="#local-6989586621679630166"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630157"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630165"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-702"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630164"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a href="#local-6989586621679630166"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630168"><a href="#local-6989586621679630168"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitSum"><span class="hs-identifier hs-var">ExplicitSum</span></a><span> </span><a name="local-6989586621679630169"><a href="#local-6989586621679630169"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679630170"><a href="#local-6989586621679630170"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621679630171"><a href="#local-6989586621679630171"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630172"><a href="#local-6989586621679630172"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-705"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630173"><a href="#local-6989586621679630173"><span class="hs-identifier">new_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630168"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630172"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-706"></a><span>       </span><a name="local-6989586621679630174"><a href="#local-6989586621679630174"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630168"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630171"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-707"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitSum"><span class="hs-identifier hs-var">ExplicitSum</span></a><span> </span><a href="#local-6989586621679630169"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679630170"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621679630174"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630173"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630175"><a href="#local-6989586621679630175"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a name="local-6989586621679630176"><a href="#local-6989586621679630176"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630177"><a href="#local-6989586621679630177"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630178"><a href="#local-6989586621679630178"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630175"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630176"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-711"></a><span>       </span><a name="local-6989586621679630179"><a href="#local-6989586621679630179"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630175"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630177"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-712"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a href="#local-6989586621679630178"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630179"><span class="hs-identifier hs-var">new_ms</span></a><span class="hs-special">)</span><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630180"><a href="#local-6989586621679630180"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a name="local-6989586621679630181"><a href="#local-6989586621679630181"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630182"><a href="#local-6989586621679630182"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679630183"><a href="#local-6989586621679630183"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630184"><a href="#local-6989586621679630184"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630180"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630181"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-716"></a><span>       </span><a name="local-6989586621679630185"><a href="#local-6989586621679630185"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630180"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630182"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-717"></a><span>       </span><a name="local-6989586621679630186"><a href="#local-6989586621679630186"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630180"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630183"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-718"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621679630184"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630185"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-6989586621679630186"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>
</span><a name="line-720"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630187"><a href="#local-6989586621679630187"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630188"><a href="#local-6989586621679630188"><span class="hs-identifier">fun</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630189"><a href="#local-6989586621679630189"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630190"><a href="#local-6989586621679630190"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679630191"><a href="#local-6989586621679630191"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-721"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630192"><a href="#local-6989586621679630192"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630193"><a href="#local-6989586621679630193"><span class="hs-identifier">new_fun</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630187"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630188"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-722"></a><span>       </span><a name="local-6989586621679630194"><a href="#local-6989586621679630194"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630192"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630189"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-723"></a><span>       </span><a name="local-6989586621679630195"><a href="#local-6989586621679630195"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630192"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630190"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-724"></a><span>       </span><a name="local-6989586621679630196"><a href="#local-6989586621679630196"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630192"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630191"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-725"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679630193"><span class="hs-identifier hs-var">new_fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630194"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630195"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-6989586621679630196"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630197"><a href="#local-6989586621679630197"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a><span> </span><a name="local-6989586621679630198"><a href="#local-6989586621679630198"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630199"><a href="#local-6989586621679630199"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630206"><a href="#local-6989586621679630206"><span class="hs-identifier">alts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-6989586621679630200"><span class="hs-identifier hs-var">zonk_alt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630199"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-729"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630207"><a href="#local-6989586621679630207"><span class="hs-identifier">ty'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630197"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630198"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-730"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a><span> </span><a href="#local-6989586621679630207"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679630206"><span class="hs-identifier hs-var">alts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-731"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679630200"><a href="#local-6989586621679630200"><span class="hs-identifier">zonk_alt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-6989586621679630201"><a href="#local-6989586621679630201"><span class="hs-identifier">guard</span></a></a><span> </span><a name="local-6989586621679630202"><a href="#local-6989586621679630202"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-732"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630203"><a href="#local-6989586621679630203"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630204"><a href="#local-6989586621679630204"><span class="hs-identifier">guard'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630197"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630201"><span class="hs-identifier hs-var">guard</span></a><span>
</span><a name="line-733"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630205"><a href="#local-6989586621679630205"><span class="hs-identifier">expr'</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630203"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679630202"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-734"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="#local-6989586621679630204"><span class="hs-identifier hs-var">guard'</span></a><span> </span><a href="#local-6989586621679630205"><span class="hs-identifier hs-var">expr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-735"></a><span>
</span><a name="line-736"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630208"><a href="#local-6989586621679630208"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630209"><a href="#local-6989586621679630209"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630210"><a href="#local-6989586621679630210"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630211"><a href="#local-6989586621679630211"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-737"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630212"><a href="#local-6989586621679630212"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630213"><a href="#local-6989586621679630213"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-6989586621679630208"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630210"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-738"></a><span>       </span><a name="local-6989586621679630214"><a href="#local-6989586621679630214"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630212"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="#local-6989586621679630211"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-739"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630209"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630213"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630214"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630215"><a href="#local-6989586621679630215"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a name="local-6989586621679630216"><a href="#local-6989586621679630216"><span class="hs-identifier">do_or_lc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630217"><a href="#local-6989586621679630217"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630218"><a href="#local-6989586621679630218"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630219"><a href="#local-6989586621679630219"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630220"><a href="#local-6989586621679630220"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630215"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630218"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-743"></a><span>       </span><a name="local-6989586621679630221"><a href="#local-6989586621679630221"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630215"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630219"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-744"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a href="#local-6989586621679630216"><span class="hs-identifier hs-var">do_or_lc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630217"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630220"><span class="hs-identifier hs-var">new_stmts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630221"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-745"></a><span>
</span><a name="line-746"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630222"><a href="#local-6989586621679630222"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a name="local-6989586621679630223"><a href="#local-6989586621679630223"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630224"><a href="#local-6989586621679630224"><span class="hs-identifier">wit</span></a></a><span> </span><a name="local-6989586621679630225"><a href="#local-6989586621679630225"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630230"><a href="#local-6989586621679630230"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630231"><a href="#local-6989586621679630231"><span class="hs-identifier">new_wit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630226"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-6989586621679630222"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630224"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-748"></a><span>       </span><a name="local-6989586621679630232"><a href="#local-6989586621679630232"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630230"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630223"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-749"></a><span>       </span><a name="local-6989586621679630233"><a href="#local-6989586621679630233"><span class="hs-identifier">new_exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier hs-var">zonkLExprs</span></a><span> </span><a href="#local-6989586621679630230"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630225"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-750"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a href="#local-6989586621679630232"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621679630231"><span class="hs-identifier hs-var">new_wit</span></a><span> </span><a href="#local-6989586621679630233"><span class="hs-identifier hs-var">new_exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679630226"><a href="#local-6989586621679630226"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-6989586621679630227"><a href="#local-6989586621679630227"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630227"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>         </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-6989586621679630228"><a href="#local-6989586621679630228"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630229"><a href="#local-6989586621679630229"><span class="hs-identifier">fln</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630228"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630229"><span class="hs-identifier hs-var">fln</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630234"><a href="#local-6989586621679630234"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><a name="local-6989586621679630235"><a href="#local-6989586621679630235"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630236"><a href="#local-6989586621679630236"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-755"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630237"><a href="#local-6989586621679630237"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630234"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630235"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-756"></a><span>       </span><a name="local-6989586621679630238"><a href="#local-6989586621679630238"><span class="hs-identifier">new_exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier hs-var">zonkLExprs</span></a><span> </span><a href="#local-6989586621679630234"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630236"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-757"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><a href="#local-6989586621679630237"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621679630238"><span class="hs-identifier hs-var">new_exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>
</span><a name="line-759"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630239"><a href="#local-6989586621679630239"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630240"><a href="#local-6989586621679630240"><span class="hs-identifier">expr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630241"><a href="#local-6989586621679630241"><span class="hs-identifier">con_expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630242"><a href="#local-6989586621679630242"><span class="hs-identifier">rbinds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-760"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630243"><a href="#local-6989586621679630243"><span class="hs-identifier">new_con_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630239"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630241"><span class="hs-identifier hs-var">con_expr</span></a><span>
</span><a name="line-761"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630244"><a href="#local-6989586621679630244"><span class="hs-identifier">new_rbinds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecFields"><span class="hs-identifier hs-var">zonkRecFields</span></a><span> </span><a href="#local-6989586621679630239"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630242"><span class="hs-identifier hs-var">rbinds</span></a><span>
</span><a name="line-762"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630240"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630243"><span class="hs-identifier hs-var">new_con_expr</span></a><span>
</span><a name="line-763"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630244"><span class="hs-identifier hs-var">new_rbinds</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-764"></a><span>
</span><a name="line-765"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630245"><a href="#local-6989586621679630245"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630246"><a href="#local-6989586621679630246"><span class="hs-identifier">expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630247"><a href="#local-6989586621679630247"><span class="hs-identifier">rbinds</span></a></a><span>
</span><a name="line-766"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630248"><a href="#local-6989586621679630248"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_in_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630249"><a href="#local-6989586621679630249"><span class="hs-identifier">in_tys</span></a></a><span>
</span><a name="line-767"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_out_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630250"><a href="#local-6989586621679630250"><span class="hs-identifier">out_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630251"><a href="#local-6989586621679630251"><span class="hs-identifier">req_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630252"><a href="#local-6989586621679630252"><span class="hs-identifier">new_expr</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630245"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630246"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-769"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630253"><a href="#local-6989586621679630253"><span class="hs-identifier">new_in_tys</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630245"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630249"><span class="hs-identifier hs-var">in_tys</span></a><span>
</span><a name="line-770"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630254"><a href="#local-6989586621679630254"><span class="hs-identifier">new_out_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630245"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630250"><span class="hs-identifier hs-var">out_tys</span></a><span>
</span><a name="line-771"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630255"><a href="#local-6989586621679630255"><span class="hs-identifier">new_rbinds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecUpdFields"><span class="hs-identifier hs-var">zonkRecUpdFields</span></a><span> </span><a href="#local-6989586621679630245"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630247"><span class="hs-identifier hs-var">rbinds</span></a><span>
</span><a name="line-772"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630256"><a href="#local-6989586621679630256"><span class="hs-identifier">new_recwrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630245"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630251"><span class="hs-identifier hs-var">req_wrap</span></a><span>
</span><a name="line-773"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630252"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679630255"><span class="hs-identifier hs-var">new_rbinds</span></a><span>
</span><a name="line-774"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630248"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_in_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630253"><span class="hs-identifier hs-var">new_in_tys</span></a><span>
</span><a name="line-775"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_out_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630254"><span class="hs-identifier hs-var">new_out_tys</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630256"><span class="hs-identifier hs-var">new_recwrap</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-776"></a><span>
</span><a name="line-777"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630257"><a href="#local-6989586621679630257"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySigOut"><span class="hs-identifier hs-var">ExprWithTySigOut</span></a><span> </span><a name="local-6989586621679630258"><a href="#local-6989586621679630258"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679630259"><a href="#local-6989586621679630259"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630260"><a href="#local-6989586621679630260"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630257"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630258"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-779"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySigOut"><span class="hs-identifier hs-var">ExprWithTySigOut</span></a><span> </span><a href="#local-6989586621679630260"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679630259"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-780"></a><span>
</span><a name="line-781"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630261"><a href="#local-6989586621679630261"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a><span> </span><a name="local-6989586621679630262"><a href="#local-6989586621679630262"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630263"><a href="#local-6989586621679630263"><span class="hs-identifier">wit</span></a></a><span> </span><a name="local-6989586621679630264"><a href="#local-6989586621679630264"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-782"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630269"><a href="#local-6989586621679630269"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630270"><a href="#local-6989586621679630270"><span class="hs-identifier">new_wit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630265"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-6989586621679630261"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630263"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-783"></a><span>       </span><a name="local-6989586621679630271"><a href="#local-6989586621679630271"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630261"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630262"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-784"></a><span>       </span><a name="local-6989586621679630272"><a href="#local-6989586621679630272"><span class="hs-identifier">new_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier hs-var">zonkArithSeq</span></a><span> </span><a href="#local-6989586621679630269"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630264"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-785"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a><span> </span><a href="#local-6989586621679630271"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630270"><span class="hs-identifier hs-var">new_wit</span></a><span> </span><a href="#local-6989586621679630272"><span class="hs-identifier hs-var">new_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-786"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679630265"><a href="#local-6989586621679630265"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-6989586621679630266"><a href="#local-6989586621679630266"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630266"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>         </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-6989586621679630267"><a href="#local-6989586621679630267"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630268"><a href="#local-6989586621679630268"><span class="hs-identifier">fln</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630267"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630268"><span class="hs-identifier hs-var">fln</span></a><span>
</span><a name="line-788"></a><span>
</span><a name="line-789"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630273"><a href="#local-6989586621679630273"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PArrSeq"><span class="hs-identifier hs-var">PArrSeq</span></a><span> </span><a name="local-6989586621679630274"><a href="#local-6989586621679630274"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630275"><a href="#local-6989586621679630275"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-790"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630276"><a href="#local-6989586621679630276"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630273"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630274"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-791"></a><span>       </span><a name="local-6989586621679630277"><a href="#local-6989586621679630277"><span class="hs-identifier">new_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier hs-var">zonkArithSeq</span></a><span> </span><a href="#local-6989586621679630273"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630275"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-792"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PArrSeq"><span class="hs-identifier hs-var">PArrSeq</span></a><span> </span><a href="#local-6989586621679630276"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630277"><span class="hs-identifier hs-var">new_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-793"></a><span>
</span><a name="line-794"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630278"><a href="#local-6989586621679630278"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSCC"><span class="hs-identifier hs-var">HsSCC</span></a><span> </span><a name="local-6989586621679630279"><a href="#local-6989586621679630279"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679630280"><a href="#local-6989586621679630280"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679630281"><a href="#local-6989586621679630281"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-795"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630282"><a href="#local-6989586621679630282"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630278"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630281"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-796"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSCC"><span class="hs-identifier hs-var">HsSCC</span></a><span> </span><a href="#local-6989586621679630279"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679630280"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-6989586621679630282"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630283"><a href="#local-6989586621679630283"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTickPragma"><span class="hs-identifier hs-var">HsTickPragma</span></a><span> </span><a name="local-6989586621679630284"><a href="#local-6989586621679630284"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679630285"><a href="#local-6989586621679630285"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621679630286"><a href="#local-6989586621679630286"><span class="hs-identifier">srcInfo</span></a></a><span> </span><a name="local-6989586621679630287"><a href="#local-6989586621679630287"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630288"><a href="#local-6989586621679630288"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630283"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630287"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-800"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTickPragma"><span class="hs-identifier hs-var">HsTickPragma</span></a><span> </span><a href="#local-6989586621679630284"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679630285"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679630286"><span class="hs-identifier hs-var">srcInfo</span></a><span> </span><a href="#local-6989586621679630288"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-801"></a><span>
</span><a name="line-802"></a><span class="hs-comment">-- hdaume: core annotations</span><span>
</span><a name="line-803"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630289"><a href="#local-6989586621679630289"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCoreAnn"><span class="hs-identifier hs-var">HsCoreAnn</span></a><span> </span><a name="local-6989586621679630290"><a href="#local-6989586621679630290"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679630291"><a href="#local-6989586621679630291"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679630292"><a href="#local-6989586621679630292"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630293"><a href="#local-6989586621679630293"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630289"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630292"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-805"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCoreAnn"><span class="hs-identifier hs-var">HsCoreAnn</span></a><span> </span><a href="#local-6989586621679630290"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679630291"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-6989586621679630293"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span class="hs-comment">-- arrow notation extensions</span><span>
</span><a name="line-808"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630294"><a href="#local-6989586621679630294"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><a name="local-6989586621679630295"><a href="#local-6989586621679630295"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630296"><a href="#local-6989586621679630296"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630297"><a href="#local-6989586621679630297"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630298"><a href="#local-6989586621679630298"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630294"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630295"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-810"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630299"><a href="#local-6989586621679630299"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier hs-var">zonkCmdTop</span></a><span> </span><a href="#local-6989586621679630297"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630296"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-811"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><a href="#local-6989586621679630298"><span class="hs-identifier hs-var">new_pat</span></a><span> </span><a href="#local-6989586621679630299"><span class="hs-identifier hs-var">new_body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span class="hs-comment">-- StaticPointers extension</span><span>
</span><a name="line-814"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630300"><a href="#local-6989586621679630300"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a><span> </span><a name="local-6989586621679630301"><a href="#local-6989586621679630301"><span class="hs-identifier">fvs</span></a></a><span> </span><a name="local-6989586621679630302"><a href="#local-6989586621679630302"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-815"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a><span> </span><a href="#local-6989586621679630301"><span class="hs-identifier hs-var">fvs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630300"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630302"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-6989586621679630303"><a href="#local-6989586621679630303"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a name="local-6989586621679630304"><a href="#local-6989586621679630304"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621679630305"><a href="#local-6989586621679630305"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-818"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630306"><a href="#local-6989586621679630306"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630307"><a href="#local-6989586621679630307"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630303"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630304"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-819"></a><span>       </span><a name="local-6989586621679630308"><a href="#local-6989586621679630308"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630306"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630305"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-820"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a href="#local-6989586621679630307"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><a href="#local-6989586621679630308"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630309"><a href="#local-6989586621679630309"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679630309"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-823"></a><span>
</span><a name="line-824"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630310"><a href="#local-6989586621679630310"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonkExpr&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679630310"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-827"></a><span class="hs-comment">{-
Note [Skolems in zonkSyntaxExpr]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider rebindable syntax with something like

  (&gt;&gt;=) :: (forall x. blah) -&gt; (forall y. blah') -&gt; blah''

The x and y become skolems that are in scope when type-checking the
arguments to the bind. This means that we must extend the ZonkEnv with
these skolems when zonking the arguments to the bind. But the skolems
are different between the two arguments, and so we should theoretically
carry around different environments to use for the different arguments.

However, this becomes a logistical nightmare, especially in dealing with
the more exotic Stmt forms. So, we simplify by making the critical
assumption that the uniques of the skolems are different. (This assumption
is justified by the use of newUnique in TcMType.instSkolTyCoVarX.)
Now, we can safely just extend one environment.
-}</span><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span class="hs-comment">-- See Note [Skolems in zonkSyntaxExpr]</span><span>
</span><a name="line-848"></a><span class="hs-identifier">zonkSyntaxExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-849"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-850"></a><a name="zonkSyntaxExpr"><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier">zonkSyntaxExpr</span></a></a><span> </span><a name="local-6989586621679630311"><a href="#local-6989586621679630311"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630312"><a href="#local-6989586621679630312"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-851"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630313"><a href="#local-6989586621679630313"><span class="hs-identifier">arg_wraps</span></a></a><span>
</span><a name="line-852"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630314"><a href="#local-6989586621679630314"><span class="hs-identifier">res_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-853"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630315"><a href="#local-6989586621679630315"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630316"><a href="#local-6989586621679630316"><span class="hs-identifier">res_wrap'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630311"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630314"><span class="hs-identifier hs-var">res_wrap</span></a><span>
</span><a name="line-854"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630317"><a href="#local-6989586621679630317"><span class="hs-identifier">expr'</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630315"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-6989586621679630312"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-855"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630318"><a href="#local-6989586621679630318"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630319"><a href="#local-6989586621679630319"><span class="hs-identifier">arg_wraps'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630315"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-6989586621679630313"><span class="hs-identifier hs-var">arg_wraps</span></a><span>
</span><a name="line-856"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630318"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630317"><span class="hs-identifier hs-var">expr'</span></a><span>
</span><a name="line-857"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630319"><span class="hs-identifier hs-var">arg_wraps'</span></a><span>
</span><a name="line-858"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630316"><span class="hs-identifier hs-var">res_wrap'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-859"></a><span>
</span><a name="line-860"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-861"></a><span>
</span><a name="line-862"></a><span class="hs-identifier">zonkLCmd</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-863"></a><span class="hs-identifier">zonkCmd</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-864"></a><span>
</span><a name="line-865"></a><a name="zonkLCmd"><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier">zonkLCmd</span></a></a><span>  </span><a name="local-6989586621679630320"><a href="#local-6989586621679630320"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630321"><a href="#local-6989586621679630321"><span class="hs-identifier">cmd</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier hs-var">zonkCmd</span></a><span> </span><a href="#local-6989586621679630320"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630321"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><a name="zonkCmd"><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier">zonkCmd</span></a></a><span> </span><a name="local-6989586621679630322"><a href="#local-6989586621679630322"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a name="local-6989586621679630323"><a href="#local-6989586621679630323"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679630324"><a href="#local-6989586621679630324"><span class="hs-identifier">cmd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630325"><a href="#local-6989586621679630325"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630326"><a href="#local-6989586621679630326"><span class="hs-identifier">w'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630322"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630323"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-869"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630327"><a href="#local-6989586621679630327"><span class="hs-identifier">cmd'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier hs-var">zonkCmd</span></a><span> </span><a href="#local-6989586621679630325"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630324"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-870"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a href="#local-6989586621679630326"><span class="hs-identifier hs-var">w'</span></a><span> </span><a href="#local-6989586621679630327"><span class="hs-identifier hs-var">cmd'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-871"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630328"><a href="#local-6989586621679630328"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a><span> </span><a name="local-6989586621679630329"><a href="#local-6989586621679630329"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630330"><a href="#local-6989586621679630330"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679630331"><a href="#local-6989586621679630331"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630332"><a href="#local-6989586621679630332"><span class="hs-identifier">ho</span></a></a><span> </span><a name="local-6989586621679630333"><a href="#local-6989586621679630333"><span class="hs-identifier">rl</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-872"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630334"><a href="#local-6989586621679630334"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630328"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630329"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-873"></a><span>       </span><a name="local-6989586621679630335"><a href="#local-6989586621679630335"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630328"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630330"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-874"></a><span>       </span><a name="local-6989586621679630336"><a href="#local-6989586621679630336"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630328"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630331"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-875"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a><span> </span><a href="#local-6989586621679630334"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630335"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-6989586621679630336"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621679630332"><span class="hs-identifier hs-var">ho</span></a><span> </span><a href="#local-6989586621679630333"><span class="hs-identifier hs-var">rl</span></a><span class="hs-special">)</span><span>
</span><a name="line-876"></a><span>
</span><a name="line-877"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630337"><a href="#local-6989586621679630337"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a name="local-6989586621679630338"><a href="#local-6989586621679630338"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679630339"><a href="#local-6989586621679630339"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679630340"><a href="#local-6989586621679630340"><span class="hs-identifier">fixity</span></a></a><span> </span><a name="local-6989586621679630341"><a href="#local-6989586621679630341"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630342"><a href="#local-6989586621679630342"><span class="hs-identifier">new_op</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630337"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630338"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-879"></a><span>       </span><a name="local-6989586621679630343"><a href="#local-6989586621679630343"><span class="hs-identifier">new_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier hs-var">zonkCmdTop</span></a><span> </span><a href="#local-6989586621679630337"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630341"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-880"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621679630342"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-6989586621679630339"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679630340"><span class="hs-identifier hs-var">fixity</span></a><span> </span><a href="#local-6989586621679630343"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-881"></a><span>
</span><a name="line-882"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630344"><a href="#local-6989586621679630344"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a><span> </span><a name="local-6989586621679630345"><a href="#local-6989586621679630345"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679630346"><a href="#local-6989586621679630346"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630347"><a href="#local-6989586621679630347"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630344"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630345"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-884"></a><span>       </span><a name="local-6989586621679630348"><a href="#local-6989586621679630348"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630344"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630346"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-885"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a><span> </span><a href="#local-6989586621679630347"><span class="hs-identifier hs-var">new_c</span></a><span> </span><a href="#local-6989586621679630348"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span>
</span><a name="line-887"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630349"><a href="#local-6989586621679630349"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a><span> </span><a name="local-6989586621679630350"><a href="#local-6989586621679630350"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630351"><a href="#local-6989586621679630351"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630349"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630350"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-889"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a><span> </span><a href="#local-6989586621679630351"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630352"><a href="#local-6989586621679630352"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a><span> </span><a name="local-6989586621679630353"><a href="#local-6989586621679630353"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630354"><a href="#local-6989586621679630354"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630352"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630353"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-893"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a><span> </span><a href="#local-6989586621679630354"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">)</span><span>
</span><a name="line-894"></a><span>
</span><a name="line-895"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630355"><a href="#local-6989586621679630355"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a><span> </span><a name="local-6989586621679630356"><a href="#local-6989586621679630356"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630357"><a href="#local-6989586621679630357"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-896"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630358"><a href="#local-6989586621679630358"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630355"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630356"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-897"></a><span>       </span><a name="local-6989586621679630359"><a href="#local-6989586621679630359"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-6989586621679630355"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630357"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-898"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a><span> </span><a href="#local-6989586621679630358"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-6989586621679630359"><span class="hs-identifier hs-var">new_ms</span></a><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630360"><a href="#local-6989586621679630360"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a><span> </span><a name="local-6989586621679630361"><a href="#local-6989586621679630361"><span class="hs-identifier">eCond</span></a></a><span> </span><a name="local-6989586621679630362"><a href="#local-6989586621679630362"><span class="hs-identifier">ePred</span></a></a><span> </span><a name="local-6989586621679630363"><a href="#local-6989586621679630363"><span class="hs-identifier">cThen</span></a></a><span> </span><a name="local-6989586621679630364"><a href="#local-6989586621679630364"><span class="hs-identifier">cElse</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-901"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630369"><a href="#local-6989586621679630369"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630370"><a href="#local-6989586621679630370"><span class="hs-identifier">new_eCond</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630365"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-6989586621679630360"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630361"><span class="hs-identifier hs-var">eCond</span></a><span>
</span><a name="line-902"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630371"><a href="#local-6989586621679630371"><span class="hs-identifier">new_ePred</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630369"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630362"><span class="hs-identifier hs-var">ePred</span></a><span>
</span><a name="line-903"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630372"><a href="#local-6989586621679630372"><span class="hs-identifier">new_cThen</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630369"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630363"><span class="hs-identifier hs-var">cThen</span></a><span>
</span><a name="line-904"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630373"><a href="#local-6989586621679630373"><span class="hs-identifier">new_cElse</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630369"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630364"><span class="hs-identifier hs-var">cElse</span></a><span>
</span><a name="line-905"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a><span> </span><a href="#local-6989586621679630370"><span class="hs-identifier hs-var">new_eCond</span></a><span> </span><a href="#local-6989586621679630371"><span class="hs-identifier hs-var">new_ePred</span></a><span> </span><a href="#local-6989586621679630372"><span class="hs-identifier hs-var">new_cThen</span></a><span> </span><a href="#local-6989586621679630373"><span class="hs-identifier hs-var">new_cElse</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-906"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-907"></a><span>    </span><a name="local-6989586621679630365"><a href="#local-6989586621679630365"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-6989586621679630366"><a href="#local-6989586621679630366"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630366"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>    </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-6989586621679630367"><a href="#local-6989586621679630367"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630368"><a href="#local-6989586621679630368"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630367"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630368"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-909"></a><span>
</span><a name="line-910"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630374"><a href="#local-6989586621679630374"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630375"><a href="#local-6989586621679630375"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630376"><a href="#local-6989586621679630376"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630377"><a href="#local-6989586621679630377"><span class="hs-identifier">cmd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-911"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630378"><a href="#local-6989586621679630378"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630379"><a href="#local-6989586621679630379"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-6989586621679630374"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630376"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-912"></a><span>       </span><a name="local-6989586621679630380"><a href="#local-6989586621679630380"><span class="hs-identifier">new_cmd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630378"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="#local-6989586621679630377"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-913"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630375"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630379"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630380"><span class="hs-identifier hs-var">new_cmd</span></a><span class="hs-special">)</span><span>
</span><a name="line-914"></a><span>
</span><a name="line-915"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-6989586621679630381"><a href="#local-6989586621679630381"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630382"><a href="#local-6989586621679630382"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630383"><a href="#local-6989586621679630383"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630384"><a href="#local-6989586621679630384"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-916"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630385"><a href="#local-6989586621679630385"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630381"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630383"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-917"></a><span>       </span><a name="local-6989586621679630386"><a href="#local-6989586621679630386"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630381"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630384"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-918"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630382"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630385"><span class="hs-identifier hs-var">new_stmts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630386"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span>
</span><a name="line-924"></a><span class="hs-identifier">zonkCmdTop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-925"></a><a name="zonkCmdTop"><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier">zonkCmdTop</span></a></a><span> </span><a name="local-6989586621679630387"><a href="#local-6989586621679630387"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630388"><a href="#local-6989586621679630388"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_cmd_top"><span class="hs-identifier hs-var">zonk_cmd_top</span></a><span> </span><a href="#local-6989586621679630387"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630388"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-identifier">zonk_cmd_top</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-type">HsCmdTop</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-type">HsCmdTop</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-928"></a><a name="zonk_cmd_top"><a href="TcHsSyn.html#zonk_cmd_top"><span class="hs-identifier">zonk_cmd_top</span></a></a><span> </span><a name="local-6989586621679630389"><a href="#local-6989586621679630389"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a name="local-6989586621679630390"><a href="#local-6989586621679630390"><span class="hs-identifier">cmd</span></a></a><span> </span><a name="local-6989586621679630391"><a href="#local-6989586621679630391"><span class="hs-identifier">stack_tys</span></a></a><span> </span><a name="local-6989586621679630392"><a href="#local-6989586621679630392"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630393"><a href="#local-6989586621679630393"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630394"><a href="#local-6989586621679630394"><span class="hs-identifier">new_cmd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-6989586621679630389"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630390"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-930"></a><span>       </span><a name="local-6989586621679630395"><a href="#local-6989586621679630395"><span class="hs-identifier">new_stack_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630389"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630391"><span class="hs-identifier hs-var">stack_tys</span></a><span>
</span><a name="line-931"></a><span>       </span><a name="local-6989586621679630396"><a href="#local-6989586621679630396"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630389"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630392"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-932"></a><span>       </span><a name="local-6989586621679630397"><a href="#local-6989586621679630397"><span class="hs-identifier">new_ids</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapSndM"><span class="hs-identifier hs-var">mapSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630389"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630393"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span>       </span><span class="hs-identifier">MASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isLiftedTypeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#isLiftedTypeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><span class="hs-identifier">new_stack_tys</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><span>         </span><span class="hs-comment">-- desugarer assumes that this is not levity polymorphic...</span><span>
</span><a name="line-936"></a><span>         </span><span class="hs-comment">-- but indeed it should always be lifted due to the typing</span><span>
</span><a name="line-937"></a><span>         </span><span class="hs-comment">-- rules for arrows</span><span>
</span><a name="line-938"></a><span>
</span><a name="line-939"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a href="#local-6989586621679630394"><span class="hs-identifier hs-var">new_cmd</span></a><span> </span><a href="#local-6989586621679630395"><span class="hs-identifier hs-var">new_stack_tys</span></a><span> </span><a href="#local-6989586621679630396"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621679630397"><span class="hs-identifier hs-var">new_ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>
</span><a name="line-941"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-942"></a><span class="hs-identifier">zonkCoFn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span>
</span><a name="line-943"></a><a name="zonkCoFn"><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier">zonkCoFn</span></a></a><span> </span><a name="local-6989586621679630398"><a href="#local-6989586621679630398"><span class="hs-identifier">env</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630398"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span class="hs-special">)</span><span>
</span><a name="line-944"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630399"><a href="#local-6989586621679630399"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a name="local-6989586621679630400"><a href="#local-6989586621679630400"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679630401"><a href="#local-6989586621679630401"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630402"><a href="#local-6989586621679630402"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630403"><a href="#local-6989586621679630403"><span class="hs-identifier">c1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630399"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630400"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-945"></a><span>                                    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630404"><a href="#local-6989586621679630404"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630405"><a href="#local-6989586621679630405"><span class="hs-identifier">c2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630402"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630401"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-946"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630404"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a href="#local-6989586621679630403"><span class="hs-identifier hs-var">c1'</span></a><span> </span><a href="#local-6989586621679630405"><span class="hs-identifier hs-var">c2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-947"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630406"><a href="#local-6989586621679630406"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a name="local-6989586621679630407"><a href="#local-6989586621679630407"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679630408"><a href="#local-6989586621679630408"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-6989586621679630409"><a href="#local-6989586621679630409"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679630410"><a href="#local-6989586621679630410"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630411"><a href="#local-6989586621679630411"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630412"><a href="#local-6989586621679630412"><span class="hs-identifier">c1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630406"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630407"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-948"></a><span>                                     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630413"><a href="#local-6989586621679630413"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630414"><a href="#local-6989586621679630414"><span class="hs-identifier">c2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630411"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630408"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-949"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630415"><a href="#local-6989586621679630415"><span class="hs-identifier">t1'</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630413"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630409"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-950"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630413"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a href="#local-6989586621679630412"><span class="hs-identifier hs-var">c1'</span></a><span> </span><a href="#local-6989586621679630414"><span class="hs-identifier hs-var">c2'</span></a><span> </span><a href="#local-6989586621679630415"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621679630410"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-951"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630416"><a href="#local-6989586621679630416"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621679630417"><a href="#local-6989586621679630417"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630418"><a href="#local-6989586621679630418"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-6989586621679630416"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630417"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-952"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630416"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a href="#local-6989586621679630418"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-953"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630419"><a href="#local-6989586621679630419"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a name="local-6989586621679630420"><a href="#local-6989586621679630420"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630421"><a href="#local-6989586621679630421"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630422"><a href="#local-6989586621679630422"><span class="hs-identifier">ev'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier hs-var">zonkEvBndrX</span></a><span> </span><a href="#local-6989586621679630419"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630420"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-954"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630421"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a href="#local-6989586621679630422"><span class="hs-identifier hs-var">ev'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-955"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630423"><a href="#local-6989586621679630423"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a name="local-6989586621679630424"><a href="#local-6989586621679630424"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630425"><a href="#local-6989586621679630425"><span class="hs-identifier">arg'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630423"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630424"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-956"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630423"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a href="#local-6989586621679630425"><span class="hs-identifier hs-var">arg'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-957"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630426"><a href="#local-6989586621679630426"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a name="local-6989586621679630427"><a href="#local-6989586621679630427"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-958"></a><span>                              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630428"><a href="#local-6989586621679630428"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630429"><a href="#local-6989586621679630429"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-6989586621679630426"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630427"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-959"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630428"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a href="#local-6989586621679630429"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-960"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630430"><a href="#local-6989586621679630430"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a name="local-6989586621679630431"><a href="#local-6989586621679630431"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630432"><a href="#local-6989586621679630432"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630430"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630431"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-961"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630430"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a href="#local-6989586621679630432"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-962"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-6989586621679630433"><a href="#local-6989586621679630433"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a name="local-6989586621679630434"><a href="#local-6989586621679630434"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630435"><a href="#local-6989586621679630435"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630436"><a href="#local-6989586621679630436"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-6989586621679630433"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630434"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-963"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630435"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a href="#local-6989586621679630436"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-964"></a><span>
</span><a name="line-965"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-966"></a><span class="hs-identifier">zonkOverLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-967"></a><a name="zonkOverLit"><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier">zonkOverLit</span></a></a><span> </span><a name="local-6989586621679630437"><a href="#local-6989586621679630437"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630438"><a href="#local-6989586621679630438"><span class="hs-identifier">lit</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ol_witness</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630439"><a href="#local-6989586621679630439"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ol_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630440"><a href="#local-6989586621679630440"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-968"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630441"><a href="#local-6989586621679630441"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630437"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630440"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-969"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630442"><a href="#local-6989586621679630442"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630437"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630439"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-970"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630438"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ol_witness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630442"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ol_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630441"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-973"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-974"></a><span>
</span><a name="line-975"></a><a name="zonkArithSeq"><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier">zonkArithSeq</span></a></a><span> </span><a name="local-6989586621679630443"><a href="#local-6989586621679630443"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a name="local-6989586621679630444"><a href="#local-6989586621679630444"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-976"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630445"><a href="#local-6989586621679630445"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630443"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630444"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-977"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="#local-6989586621679630445"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-6989586621679630446"><a href="#local-6989586621679630446"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThen"><span class="hs-identifier hs-var">FromThen</span></a><span> </span><a name="local-6989586621679630447"><a href="#local-6989586621679630447"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630448"><a href="#local-6989586621679630448"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630449"><a href="#local-6989586621679630449"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630446"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630447"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-981"></a><span>       </span><a name="local-6989586621679630450"><a href="#local-6989586621679630450"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630446"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630448"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-982"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThen"><span class="hs-identifier hs-var">FromThen</span></a><span> </span><a href="#local-6989586621679630449"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630450"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-983"></a><span>
</span><a name="line-984"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-6989586621679630451"><a href="#local-6989586621679630451"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromTo"><span class="hs-identifier hs-var">FromTo</span></a><span> </span><a name="local-6989586621679630452"><a href="#local-6989586621679630452"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630453"><a href="#local-6989586621679630453"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-985"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630454"><a href="#local-6989586621679630454"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630451"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630452"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-986"></a><span>       </span><a name="local-6989586621679630455"><a href="#local-6989586621679630455"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630451"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630453"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-987"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromTo"><span class="hs-identifier hs-var">FromTo</span></a><span> </span><a href="#local-6989586621679630454"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630455"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-988"></a><span>
</span><a name="line-989"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-6989586621679630456"><a href="#local-6989586621679630456"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThenTo"><span class="hs-identifier hs-var">FromThenTo</span></a><span> </span><a name="local-6989586621679630457"><a href="#local-6989586621679630457"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630458"><a href="#local-6989586621679630458"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679630459"><a href="#local-6989586621679630459"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-990"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630460"><a href="#local-6989586621679630460"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630456"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630457"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-991"></a><span>       </span><a name="local-6989586621679630461"><a href="#local-6989586621679630461"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630456"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630458"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-992"></a><span>       </span><a name="local-6989586621679630462"><a href="#local-6989586621679630462"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630456"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630459"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-993"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThenTo"><span class="hs-identifier hs-var">FromThenTo</span></a><span> </span><a href="#local-6989586621679630460"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-6989586621679630461"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-6989586621679630462"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-994"></a><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-997"></a><span class="hs-identifier">zonkStmts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-998"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629791"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629791"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-999"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629791"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629791"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1000"></a><a name="zonkStmts"><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier">zonkStmts</span></a></a><span> </span><a name="local-6989586621679630463"><a href="#local-6989586621679630463"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630463"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1001"></a><span class="hs-identifier">zonkStmts</span><span> </span><a name="local-6989586621679630464"><a href="#local-6989586621679630464"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630465"><a href="#local-6989586621679630465"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630466"><a href="#local-6989586621679630466"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679630467"><a href="#local-6989586621679630467"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630468"><a href="#local-6989586621679630468"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630469"><a href="#local-6989586621679630469"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocSndM"><span class="hs-identifier hs-var">wrapLocSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkStmt"><span class="hs-identifier hs-var">zonkStmt</span></a><span> </span><a href="#local-6989586621679630464"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630465"><span class="hs-identifier hs-var">zBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630466"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1002"></a><span>                                </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630470"><a href="#local-6989586621679630470"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630471"><a href="#local-6989586621679630471"><span class="hs-identifier">ss'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630468"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630465"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630467"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1003"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630470"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630469"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679630471"><span class="hs-identifier hs-var">ss'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1004"></a><span>
</span><a name="line-1005"></a><span class="hs-identifier">zonkStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-1006"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1007"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1008"></a><a name="zonkStmt"><a href="TcHsSyn.html#zonkStmt"><span class="hs-identifier">zonkStmt</span></a></a><span> </span><a name="local-6989586621679630472"><a href="#local-6989586621679630472"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a name="local-6989586621679630473"><a href="#local-6989586621679630473"><span class="hs-identifier">stmts_w_bndrs</span></a></a><span> </span><a name="local-6989586621679630474"><a href="#local-6989586621679630474"><span class="hs-identifier">mzip_op</span></a></a><span> </span><a name="local-6989586621679630475"><a href="#local-6989586621679630475"><span class="hs-identifier">bind_op</span></a></a><span> </span><a name="local-6989586621679630476"><a href="#local-6989586621679630476"><span class="hs-identifier">bind_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1009"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630486"><a href="#local-6989586621679630486"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630487"><a href="#local-6989586621679630487"><span class="hs-identifier">new_bind_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630472"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630475"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-1010"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630488"><a href="#local-6989586621679630488"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630486"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630476"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-1011"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630489"><a href="#local-6989586621679630489"><span class="hs-identifier">new_stmts_w_bndrs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630477"><span class="hs-identifier hs-var">zonk_branch</span></a><span> </span><a href="#local-6989586621679630486"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630473"><span class="hs-identifier hs-var">stmts_w_bndrs</span></a><span>
</span><a name="line-1012"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630490"><a href="#local-6989586621679630490"><span class="hs-identifier">new_binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679630493"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630492"><a href="#local-6989586621679630492"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630489"><span class="hs-identifier hs-var">new_stmts_w_bndrs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630493"><a href="#local-6989586621679630493"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630492"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1013"></a><span>             </span><a name="local-6989586621679630491"><a href="#local-6989586621679630491"><span class="hs-identifier">env2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630486"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630490"><span class="hs-identifier hs-var">new_binders</span></a><span>
</span><a name="line-1014"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630494"><a href="#local-6989586621679630494"><span class="hs-identifier">new_mzip</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630491"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630474"><span class="hs-identifier hs-var">mzip_op</span></a><span>
</span><a name="line-1015"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630491"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a href="#local-6989586621679630489"><span class="hs-identifier hs-var">new_stmts_w_bndrs</span></a><span> </span><a href="#local-6989586621679630494"><span class="hs-identifier hs-var">new_mzip</span></a><span> </span><a href="#local-6989586621679630487"><span class="hs-identifier hs-var">new_bind_op</span></a><span> </span><a href="#local-6989586621679630488"><span class="hs-identifier hs-var">new_bind_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1016"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1017"></a><span>    </span><a name="local-6989586621679630477"><a href="#local-6989586621679630477"><span class="hs-identifier">zonk_branch</span></a></a><span> </span><a name="local-6989586621679630478"><a href="#local-6989586621679630478"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a name="local-6989586621679630479"><a href="#local-6989586621679630479"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-6989586621679630480"><a href="#local-6989586621679630480"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621679630481"><a href="#local-6989586621679630481"><span class="hs-identifier">return_op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630482"><a href="#local-6989586621679630482"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630483"><a href="#local-6989586621679630483"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630478"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630479"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1019"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630484"><a href="#local-6989586621679630484"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630485"><a href="#local-6989586621679630485"><span class="hs-identifier">new_return</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630482"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630481"><span class="hs-identifier hs-var">return_op</span></a><span>
</span><a name="line-1020"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a href="#local-6989586621679630483"><span class="hs-identifier hs-var">new_stmts</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOccs"><span class="hs-identifier hs-var">zonkIdOccs</span></a><span> </span><a href="#local-6989586621679630484"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630480"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630485"><span class="hs-identifier hs-var">new_return</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1021"></a><span>
</span><a name="line-1022"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630495"><a href="#local-6989586621679630495"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630496"><a href="#local-6989586621679630496"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630497"><a href="#local-6989586621679630497"><span class="hs-identifier">segStmts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630498"><a href="#local-6989586621679630498"><span class="hs-identifier">lvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630499"><a href="#local-6989586621679630499"><span class="hs-identifier">rvs</span></a></a><span>
</span><a name="line-1023"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630500"><a href="#local-6989586621679630500"><span class="hs-identifier">ret_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630501"><a href="#local-6989586621679630501"><span class="hs-identifier">mfix_id</span></a></a><span>
</span><a name="line-1024"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630502"><a href="#local-6989586621679630502"><span class="hs-identifier">bind_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630503"><a href="#local-6989586621679630503"><span class="hs-identifier">bind_ty</span></a></a><span>
</span><a name="line-1025"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630504"><a href="#local-6989586621679630504"><span class="hs-identifier">later_rets</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630505"><a href="#local-6989586621679630505"><span class="hs-identifier">rec_rets</span></a></a><span>
</span><a name="line-1026"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630506"><a href="#local-6989586621679630506"><span class="hs-identifier">ret_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1027"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630507"><a href="#local-6989586621679630507"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630508"><a href="#local-6989586621679630508"><span class="hs-identifier">new_bind_id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630495"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630502"><span class="hs-identifier hs-var">bind_id</span></a><span>
</span><a name="line-1028"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630509"><a href="#local-6989586621679630509"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630510"><a href="#local-6989586621679630510"><span class="hs-identifier">new_mfix_id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630507"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630501"><span class="hs-identifier hs-var">mfix_id</span></a><span>
</span><a name="line-1029"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630511"><a href="#local-6989586621679630511"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630512"><a href="#local-6989586621679630512"><span class="hs-identifier">new_ret_id</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630509"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630500"><span class="hs-identifier hs-var">ret_id</span></a><span>
</span><a name="line-1030"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630513"><a href="#local-6989586621679630513"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630503"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-1031"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630514"><a href="#local-6989586621679630514"><span class="hs-identifier">new_rvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630499"><span class="hs-identifier hs-var">rvs</span></a><span>
</span><a name="line-1032"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630515"><a href="#local-6989586621679630515"><span class="hs-identifier">new_lvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630498"><span class="hs-identifier hs-var">lvs</span></a><span>
</span><a name="line-1033"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630516"><a href="#local-6989586621679630516"><span class="hs-identifier">new_ret_ty</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630506"><span class="hs-identifier hs-var">ret_ty</span></a><span>
</span><a name="line-1034"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630517"><a href="#local-6989586621679630517"><span class="hs-identifier">env4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630514"><span class="hs-identifier hs-var">new_rvs</span></a><span>
</span><a name="line-1035"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630518"><a href="#local-6989586621679630518"><span class="hs-identifier">env5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630519"><a href="#local-6989586621679630519"><span class="hs-identifier">new_segStmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630517"><span class="hs-identifier hs-var">env4</span></a><span> </span><a href="#local-6989586621679630496"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630497"><span class="hs-identifier hs-var">segStmts</span></a><span>
</span><a name="line-1036"></a><span>        </span><span class="hs-comment">-- Zonk the ret-expressions in an envt that</span><span>
</span><a name="line-1037"></a><span>        </span><span class="hs-comment">-- has the polymorphic bindings in the envt</span><span>
</span><a name="line-1038"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630520"><a href="#local-6989586621679630520"><span class="hs-identifier">new_later_rets</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630518"><span class="hs-identifier hs-var">env5</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630504"><span class="hs-identifier hs-var">later_rets</span></a><span>
</span><a name="line-1039"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630521"><a href="#local-6989586621679630521"><span class="hs-identifier">new_rec_rets</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630518"><span class="hs-identifier hs-var">env5</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630505"><span class="hs-identifier hs-var">rec_rets</span></a><span>
</span><a name="line-1040"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630511"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630515"><span class="hs-identifier hs-var">new_lvs</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Only the lvs are needed</span><span>
</span><a name="line-1041"></a><span>                 </span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630519"><span class="hs-identifier hs-var">new_segStmts</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630515"><span class="hs-identifier hs-var">new_lvs</span></a><span>
</span><a name="line-1042"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630514"><span class="hs-identifier hs-var">new_rvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630512"><span class="hs-identifier hs-var">new_ret_id</span></a><span>
</span><a name="line-1043"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630510"><span class="hs-identifier hs-var">new_mfix_id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630508"><span class="hs-identifier hs-var">new_bind_id</span></a><span>
</span><a name="line-1044"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630513"><span class="hs-identifier hs-var">new_bind_ty</span></a><span>
</span><a name="line-1045"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630520"><span class="hs-identifier hs-var">new_later_rets</span></a><span>
</span><a name="line-1046"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630521"><span class="hs-identifier hs-var">new_rec_rets</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630516"><span class="hs-identifier hs-var">new_ret_ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630522"><a href="#local-6989586621679630522"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630523"><a href="#local-6989586621679630523"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a name="local-6989586621679630524"><a href="#local-6989586621679630524"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679630525"><a href="#local-6989586621679630525"><span class="hs-identifier">then_op</span></a></a><span> </span><a name="local-6989586621679630526"><a href="#local-6989586621679630526"><span class="hs-identifier">guard_op</span></a></a><span> </span><a name="local-6989586621679630527"><a href="#local-6989586621679630527"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1049"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630528"><a href="#local-6989586621679630528"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630529"><a href="#local-6989586621679630529"><span class="hs-identifier">new_then_op</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630522"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630525"><span class="hs-identifier hs-var">then_op</span></a><span>
</span><a name="line-1050"></a><span>       </span><span class="hs-special">(</span><a name="local-6989586621679630530"><a href="#local-6989586621679630530"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630531"><a href="#local-6989586621679630531"><span class="hs-identifier">new_guard_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630528"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630526"><span class="hs-identifier hs-var">guard_op</span></a><span>
</span><a name="line-1051"></a><span>       </span><a name="local-6989586621679630532"><a href="#local-6989586621679630532"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630523"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630530"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630524"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1052"></a><span>       </span><a name="local-6989586621679630533"><a href="#local-6989586621679630533"><span class="hs-identifier">new_ty</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630530"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630527"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1053"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630530"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a href="#local-6989586621679630532"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-6989586621679630529"><span class="hs-identifier hs-var">new_then_op</span></a><span> </span><a href="#local-6989586621679630531"><span class="hs-identifier hs-var">new_guard_op</span></a><span> </span><a href="#local-6989586621679630533"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1054"></a><span>
</span><a name="line-1055"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630534"><a href="#local-6989586621679630534"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630535"><a href="#local-6989586621679630535"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a name="local-6989586621679630536"><a href="#local-6989586621679630536"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679630537"><a href="#local-6989586621679630537"><span class="hs-identifier">noret</span></a></a><span> </span><a name="local-6989586621679630538"><a href="#local-6989586621679630538"><span class="hs-identifier">ret_op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630539"><a href="#local-6989586621679630539"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630540"><a href="#local-6989586621679630540"><span class="hs-identifier">new_ret</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630534"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630538"><span class="hs-identifier hs-var">ret_op</span></a><span>
</span><a name="line-1057"></a><span>       </span><a name="local-6989586621679630541"><a href="#local-6989586621679630541"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630535"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630539"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630536"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1058"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630534"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a href="#local-6989586621679630541"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-6989586621679630537"><span class="hs-identifier hs-var">noret</span></a><span> </span><a href="#local-6989586621679630540"><span class="hs-identifier hs-var">new_ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630542"><a href="#local-6989586621679630542"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630543"><a href="#local-6989586621679630543"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630544"><a href="#local-6989586621679630544"><span class="hs-identifier">binderMap</span></a></a><span>
</span><a name="line-1061"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630545"><a href="#local-6989586621679630545"><span class="hs-identifier">by</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630546"><a href="#local-6989586621679630546"><span class="hs-identifier">form</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630547"><a href="#local-6989586621679630547"><span class="hs-identifier">using</span></a></a><span>
</span><a name="line-1062"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630548"><a href="#local-6989586621679630548"><span class="hs-identifier">return_op</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630549"><a href="#local-6989586621679630549"><span class="hs-identifier">bind_op</span></a></a><span>
</span><a name="line-1063"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind_arg_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630550"><a href="#local-6989586621679630550"><span class="hs-identifier">bind_arg_ty</span></a></a><span>
</span><a name="line-1064"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630551"><a href="#local-6989586621679630551"><span class="hs-identifier">liftM_op</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1066"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630558"><a href="#local-6989586621679630558"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630559"><a href="#local-6989586621679630559"><span class="hs-identifier">bind_op'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630542"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630549"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-1067"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630560"><a href="#local-6989586621679630560"><span class="hs-identifier">bind_arg_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630558"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630550"><span class="hs-identifier hs-var">bind_arg_ty</span></a><span>
</span><a name="line-1068"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630561"><a href="#local-6989586621679630561"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630562"><a href="#local-6989586621679630562"><span class="hs-identifier">stmts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630558"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630543"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1069"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630563"><a href="#local-6989586621679630563"><span class="hs-identifier">by'</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#fmapMaybeM"><span class="hs-identifier hs-var">fmapMaybeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630561"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630545"><span class="hs-identifier hs-var">by</span></a><span>
</span><a name="line-1070"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630564"><a href="#local-6989586621679630564"><span class="hs-identifier">using'</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630561"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630547"><span class="hs-identifier hs-var">using</span></a><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630565"><a href="#local-6989586621679630565"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630566"><a href="#local-6989586621679630566"><span class="hs-identifier">return_op'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630561"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630548"><span class="hs-identifier hs-var">return_op</span></a><span>
</span><a name="line-1073"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630567"><a href="#local-6989586621679630567"><span class="hs-identifier">binderMap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630552"><span class="hs-identifier hs-var">zonkBinderMapEntry</span></a><span> </span><a href="#local-6989586621679630565"><span class="hs-identifier hs-var">env3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630544"><span class="hs-identifier hs-var">binderMap</span></a><span>
</span><a name="line-1074"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630568"><a href="#local-6989586621679630568"><span class="hs-identifier">liftM_op'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630565"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630551"><span class="hs-identifier hs-var">liftM_op</span></a><span>
</span><a name="line-1075"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630569"><a href="#local-6989586621679630569"><span class="hs-identifier">env3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630565"><span class="hs-identifier hs-var">env3</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="#local-6989586621679630567"><span class="hs-identifier hs-var">binderMap'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630569"><span class="hs-identifier hs-var">env3'</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630562"><span class="hs-identifier hs-var">stmts'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630567"><span class="hs-identifier hs-var">binderMap'</span></a><span>
</span><a name="line-1077"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630563"><span class="hs-identifier hs-var">by'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630546"><span class="hs-identifier hs-var">form</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630564"><span class="hs-identifier hs-var">using'</span></a><span>
</span><a name="line-1078"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630566"><span class="hs-identifier hs-var">return_op'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630559"><span class="hs-identifier hs-var">bind_op'</span></a><span>
</span><a name="line-1079"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind_arg_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630560"><span class="hs-identifier hs-var">bind_arg_ty'</span></a><span>
</span><a name="line-1080"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630568"><span class="hs-identifier hs-var">liftM_op'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1081"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1082"></a><span>    </span><a name="local-6989586621679630552"><a href="#local-6989586621679630552"><span class="hs-identifier">zonkBinderMapEntry</span></a></a><span> </span><a name="local-6989586621679630553"><a href="#local-6989586621679630553"><span class="hs-identifier">env</span></a></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679630554"><a href="#local-6989586621679630554"><span class="hs-identifier">oldBinder</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630555"><a href="#local-6989586621679630555"><span class="hs-identifier">newBinder</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1083"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630556"><a href="#local-6989586621679630556"><span class="hs-identifier">oldBinder'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679630553"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630554"><span class="hs-identifier hs-var">oldBinder</span></a><span>
</span><a name="line-1084"></a><span>        </span><a name="local-6989586621679630557"><a href="#local-6989586621679630557"><span class="hs-identifier">newBinder'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630553"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630555"><span class="hs-identifier hs-var">newBinder</span></a><span>
</span><a name="line-1085"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630556"><span class="hs-identifier hs-var">oldBinder'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630557"><span class="hs-identifier hs-var">newBinder'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630570"><a href="#local-6989586621679630570"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630571"><a href="#local-6989586621679630571"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630572"><a href="#local-6989586621679630572"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630573"><a href="#local-6989586621679630573"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630574"><a href="#local-6989586621679630574"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-6989586621679630570"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630572"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1089"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630573"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630571"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630574"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1090"></a><span>
</span><a name="line-1091"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630575"><a href="#local-6989586621679630575"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630576"><a href="#local-6989586621679630576"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-6989586621679630577"><a href="#local-6989586621679630577"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630578"><a href="#local-6989586621679630578"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679630579"><a href="#local-6989586621679630579"><span class="hs-identifier">bind_op</span></a></a><span> </span><a name="local-6989586621679630580"><a href="#local-6989586621679630580"><span class="hs-identifier">fail_op</span></a></a><span> </span><a name="local-6989586621679630581"><a href="#local-6989586621679630581"><span class="hs-identifier">bind_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1092"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630582"><a href="#local-6989586621679630582"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630583"><a href="#local-6989586621679630583"><span class="hs-identifier">new_bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630575"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630579"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-1093"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630584"><a href="#local-6989586621679630584"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630582"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630581"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-1094"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630585"><a href="#local-6989586621679630585"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630576"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-6989586621679630582"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630578"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1095"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630586"><a href="#local-6989586621679630586"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630587"><a href="#local-6989586621679630587"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630582"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630577"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1096"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630588"><a href="#local-6989586621679630588"><span class="hs-identifier">new_fail</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630582"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630580"><span class="hs-identifier hs-var">fail_op</span></a><span>
</span><a name="line-1097"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630586"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="#local-6989586621679630587"><span class="hs-identifier hs-var">new_pat</span></a><span> </span><a href="#local-6989586621679630585"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-6989586621679630583"><span class="hs-identifier hs-var">new_bind</span></a><span> </span><a href="#local-6989586621679630588"><span class="hs-identifier hs-var">new_fail</span></a><span> </span><a href="#local-6989586621679630584"><span class="hs-identifier hs-var">new_bind_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span class="hs-comment">-- Scopes: join &gt; ops (in reverse order) &gt; pats (in forward order)</span><span>
</span><a name="line-1100"></a><span class="hs-comment">--              &gt; rest of stmts</span><span>
</span><a name="line-1101"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-6989586621679630589"><a href="#local-6989586621679630589"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630590"><a href="#local-6989586621679630590"><span class="hs-identifier">_zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><a name="local-6989586621679630591"><a href="#local-6989586621679630591"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679630592"><a href="#local-6989586621679630592"><span class="hs-identifier">mb_join</span></a></a><span> </span><a name="local-6989586621679630593"><a href="#local-6989586621679630593"><span class="hs-identifier">body_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630639"><a href="#local-6989586621679630639"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630640"><a href="#local-6989586621679630640"><span class="hs-identifier">new_mb_join</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630594"><span class="hs-identifier hs-var">zonk_join</span></a><span> </span><a href="#local-6989586621679630589"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630592"><span class="hs-identifier hs-var">mb_join</span></a><span>
</span><a name="line-1103"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630641"><a href="#local-6989586621679630641"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630642"><a href="#local-6989586621679630642"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630597"><span class="hs-identifier hs-var">zonk_args</span></a><span> </span><a href="#local-6989586621679630639"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630591"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1104"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630643"><a href="#local-6989586621679630643"><span class="hs-identifier">new_body_ty</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630641"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630593"><span class="hs-identifier hs-var">body_ty</span></a><span>
</span><a name="line-1105"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630641"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><a href="#local-6989586621679630642"><span class="hs-identifier hs-var">new_args</span></a><span> </span><a href="#local-6989586621679630640"><span class="hs-identifier hs-var">new_mb_join</span></a><span> </span><a href="#local-6989586621679630643"><span class="hs-identifier hs-var">new_body_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1106"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1107"></a><span>    </span><a name="local-6989586621679630594"><a href="#local-6989586621679630594"><span class="hs-identifier">zonk_join</span></a></a><span> </span><a name="local-6989586621679630600"><a href="#local-6989586621679630600"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630600"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><span>    </span><span class="hs-identifier">zonk_join</span><span> </span><a name="local-6989586621679630601"><a href="#local-6989586621679630601"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630602"><a href="#local-6989586621679630602"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630601"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630602"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-1109"></a><span>
</span><a name="line-1110"></a><span>    </span><a name="local-6989586621679630595"><a href="#local-6989586621679630595"><span class="hs-identifier">get_pat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a name="local-6989586621679630603"><a href="#local-6989586621679630603"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630603"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1111"></a><span>    </span><span class="hs-identifier">get_pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630604"><a href="#local-6989586621679630604"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630604"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1112"></a><span>
</span><a name="line-1113"></a><span>    </span><a name="local-6989586621679630596"><a href="#local-6989586621679630596"><span class="hs-identifier">replace_pat</span></a></a><span> </span><a name="local-6989586621679630605"><a href="#local-6989586621679630605"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630606"><a href="#local-6989586621679630606"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630607"><a href="#local-6989586621679630607"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630606"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a href="#local-6989586621679630605"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679630607"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>    </span><span class="hs-identifier">replace_pat</span><span> </span><a name="local-6989586621679630608"><a href="#local-6989586621679630608"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630609"><a href="#local-6989586621679630609"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a name="local-6989586621679630610"><a href="#local-6989586621679630610"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679630611"><a href="#local-6989586621679630611"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630609"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a href="#local-6989586621679630610"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679630611"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679630608"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><span>
</span><a name="line-1118"></a><span>    </span><a name="local-6989586621679630597"><a href="#local-6989586621679630597"><span class="hs-identifier">zonk_args</span></a></a><span> </span><a name="local-6989586621679630612"><a href="#local-6989586621679630612"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630613"><a href="#local-6989586621679630613"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1119"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630614"><a href="#local-6989586621679630614"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630615"><a href="#local-6989586621679630615"><span class="hs-identifier">new_args_rev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630598"><span class="hs-identifier hs-var">zonk_args_rev</span></a><span> </span><a href="#local-6989586621679630612"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679630613"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630616"><a href="#local-6989586621679630616"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630617"><a href="#local-6989586621679630617"><span class="hs-identifier">new_pats</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630614"><span class="hs-identifier hs-var">env1</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679630595"><span class="hs-identifier hs-var">get_pat</span></a><span> </span><a href="#local-6989586621679630613"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630616"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="#local-6989586621679630596"><span class="hs-identifier hs-var">replace_pat</span></a><span> </span><a href="#local-6989586621679630617"><span class="hs-identifier hs-var">new_pats</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679630615"><span class="hs-identifier hs-var">new_args_rev</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span>     </span><span class="hs-comment">-- these need to go backward, because if any operators are higher-rank,</span><span>
</span><a name="line-1124"></a><span>     </span><span class="hs-comment">-- later operators may introduce skolems that are in scope for earlier</span><span>
</span><a name="line-1125"></a><span>     </span><span class="hs-comment">-- arguments</span><span>
</span><a name="line-1126"></a><span>    </span><a name="local-6989586621679630598"><a href="#local-6989586621679630598"><span class="hs-identifier">zonk_args_rev</span></a></a><span> </span><a name="local-6989586621679630618"><a href="#local-6989586621679630618"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679630619"><a href="#local-6989586621679630619"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630620"><a href="#local-6989586621679630620"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679630621"><a href="#local-6989586621679630621"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1127"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630622"><a href="#local-6989586621679630622"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630623"><a href="#local-6989586621679630623"><span class="hs-identifier">new_op</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630618"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630619"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1128"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630624"><a href="#local-6989586621679630624"><span class="hs-identifier">new_arg</span></a></a><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630599"><span class="hs-identifier hs-var">zonk_arg</span></a><span> </span><a href="#local-6989586621679630622"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630620"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1129"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630625"><a href="#local-6989586621679630625"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630626"><a href="#local-6989586621679630626"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630598"><span class="hs-identifier hs-var">zonk_args_rev</span></a><span> </span><a href="#local-6989586621679630622"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630621"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1130"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630625"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630623"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630624"><span class="hs-identifier hs-var">new_arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679630626"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1131"></a><span>    </span><span class="hs-identifier">zonk_args_rev</span><span> </span><a name="local-6989586621679630627"><a href="#local-6989586621679630627"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630627"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span>
</span><a name="line-1133"></a><span>    </span><a name="local-6989586621679630599"><a href="#local-6989586621679630599"><span class="hs-identifier">zonk_arg</span></a></a><span> </span><a name="local-6989586621679630628"><a href="#local-6989586621679630628"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a name="local-6989586621679630629"><a href="#local-6989586621679630629"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630630"><a href="#local-6989586621679630630"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1134"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630631"><a href="#local-6989586621679630631"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630628"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630630"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1135"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a href="#local-6989586621679630629"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679630631"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1136"></a><span>    </span><span class="hs-identifier">zonk_arg</span><span> </span><a name="local-6989586621679630632"><a href="#local-6989586621679630632"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a name="local-6989586621679630633"><a href="#local-6989586621679630633"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-6989586621679630634"><a href="#local-6989586621679630634"><span class="hs-identifier">ret</span></a></a><span> </span><a name="local-6989586621679630635"><a href="#local-6989586621679630635"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630636"><a href="#local-6989586621679630636"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630637"><a href="#local-6989586621679630637"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-6989586621679630632"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630633"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1138"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630638"><a href="#local-6989586621679630638"><span class="hs-identifier">new_ret</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-6989586621679630636"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630634"><span class="hs-identifier hs-var">ret</span></a><span>
</span><a name="line-1139"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a href="#local-6989586621679630637"><span class="hs-identifier hs-var">new_stmts</span></a><span> </span><a href="#local-6989586621679630638"><span class="hs-identifier hs-var">new_ret</span></a><span> </span><a href="#local-6989586621679630635"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1140"></a><span>
</span><a name="line-1141"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-1142"></a><span class="hs-identifier">zonkRecFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsRecordBinds"><span class="hs-identifier hs-type">HsRecordBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRecordBinds"><span class="hs-identifier hs-type">HsRecordBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-1143"></a><a name="zonkRecFields"><a href="TcHsSyn.html#zonkRecFields"><span class="hs-identifier">zonkRecFields</span></a></a><span> </span><a name="local-6989586621679630644"><a href="#local-6989586621679630644"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-6989586621679630645"><a href="#local-6989586621679630645"><span class="hs-identifier">flds</span></a></a><span> </span><a name="local-6989586621679630646"><a href="#local-6989586621679630646"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1144"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630652"><a href="#local-6989586621679630652"><span class="hs-identifier">flds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679630647"><span class="hs-identifier hs-var">zonk_rbind</span></a><span> </span><a href="#local-6989586621679630645"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1145"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a href="#local-6989586621679630652"><span class="hs-identifier hs-var">flds'</span></a><span> </span><a href="#local-6989586621679630646"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1146"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1147"></a><span>    </span><a name="local-6989586621679630647"><a href="#local-6989586621679630647"><span class="hs-identifier">zonk_rbind</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630648"><a href="#local-6989586621679630648"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630649"><a href="#local-6989586621679630649"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630650"><a href="#local-6989586621679630650"><span class="hs-identifier">new_id</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier hs-var">zonkFieldOcc</span></a><span> </span><a href="#local-6989586621679630644"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><a href="#local-6989586621679630649"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1149"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630651"><a href="#local-6989586621679630651"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630644"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621679630649"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1150"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630648"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630649"><span class="hs-identifier hs-var">fld</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630650"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-1151"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630651"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span class="hs-identifier">zonkRecUpdFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecUpdField"><span class="hs-identifier hs-type">LHsRecUpdField</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecUpdField"><span class="hs-identifier hs-type">LHsRecUpdField</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span>
</span><a name="line-1154"></a><a name="zonkRecUpdFields"><a href="TcHsSyn.html#zonkRecUpdFields"><span class="hs-identifier">zonkRecUpdFields</span></a></a><span> </span><a name="local-6989586621679630653"><a href="#local-6989586621679630653"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679630654"><span class="hs-identifier hs-var">zonk_rbind</span></a><span>
</span><a name="line-1155"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1156"></a><span>    </span><a name="local-6989586621679630654"><a href="#local-6989586621679630654"><span class="hs-identifier">zonk_rbind</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630655"><a href="#local-6989586621679630655"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630656"><a href="#local-6989586621679630656"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1157"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630657"><a href="#local-6989586621679630657"><span class="hs-identifier">new_id</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier hs-var">zonkFieldOcc</span></a><span> </span><a href="#local-6989586621679630653"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsRecUpdFieldOcc"><span class="hs-identifier hs-var">hsRecUpdFieldOcc</span></a><span> </span><a href="#local-6989586621679630656"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1158"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630658"><a href="#local-6989586621679630658"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630653"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621679630656"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1159"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630655"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630656"><span class="hs-identifier hs-var">fld</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="HsTypes.html#ambiguousFieldOcc"><span class="hs-identifier hs-var">ambiguousFieldOcc</span></a><span> </span><a href="#local-6989586621679630657"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-1160"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630658"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1161"></a><span>
</span><a name="line-1162"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-1163"></a><span class="hs-identifier">mapIPNameTc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679629788"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-6989586621679629789"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629788"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1164"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679629789"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1165"></a><a name="mapIPNameTc"><a href="TcHsSyn.html#mapIPNameTc"><span class="hs-identifier">mapIPNameTc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679630659"><a href="#local-6989586621679630659"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-6989586621679630659"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1166"></a><span class="hs-identifier">mapIPNameTc</span><span> </span><a name="local-6989586621679630660"><a href="#local-6989586621679630660"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679630661"><a href="#local-6989586621679630661"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679630662"><a href="#local-6989586621679630662"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630660"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679630661"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1167"></a><span>                             </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-6989586621679630662"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1168"></a><span>
</span><a name="line-1169"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Pats]{Patterns}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1176"></a><span>
</span><a name="line-1177"></a><span class="hs-identifier">zonkPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span class="hs-comment">-- Extend the environment as we go, because it's possible for one</span><span>
</span><a name="line-1179"></a><span class="hs-comment">-- pattern to bind something that is used in another (inside or</span><span>
</span><a name="line-1180"></a><span class="hs-comment">-- to the right)</span><span>
</span><a name="line-1181"></a><a name="zonkPat"><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier">zonkPat</span></a></a><span> </span><a name="local-6989586621679630663"><a href="#local-6989586621679630663"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630664"><a href="#local-6989586621679630664"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocSndM"><span class="hs-identifier hs-var">wrapLocSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_pat"><span class="hs-identifier hs-var">zonk_pat</span></a><span> </span><a href="#local-6989586621679630663"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630664"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1182"></a><span>
</span><a name="line-1183"></a><span class="hs-identifier">zonk_pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1184"></a><a name="zonk_pat"><a href="TcHsSyn.html#zonk_pat"><span class="hs-identifier">zonk_pat</span></a></a><span> </span><a name="local-6989586621679630665"><a href="#local-6989586621679630665"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-6989586621679630666"><a href="#local-6989586621679630666"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1185"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630667"><a href="#local-6989586621679630667"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630668"><a href="#local-6989586621679630668"><span class="hs-identifier">p'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630665"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630666"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1186"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630667"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="#local-6989586621679630668"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1187"></a><span>
</span><a name="line-1188"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630669"><a href="#local-6989586621679630669"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a name="local-6989586621679630670"><a href="#local-6989586621679630670"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1189"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630671"><a href="#local-6989586621679630671"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630669"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630670"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1190"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#ensureNotLevPoly"><span class="hs-identifier hs-var">ensureNotLevPoly</span></a><span> </span><a href="#local-6989586621679630671"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1191"></a><span>            </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a wildcard pattern&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1192"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630669"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="#local-6989586621679630671"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1193"></a><span>
</span><a name="line-1194"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630672"><a href="#local-6989586621679630672"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630673"><a href="#local-6989586621679630673"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630674"><a href="#local-6989586621679630674"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1195"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630675"><a href="#local-6989586621679630675"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630672"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630674"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1196"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-6989586621679630672"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630675"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630673"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630675"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1197"></a><span>
</span><a name="line-1198"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630676"><a href="#local-6989586621679630676"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-6989586621679630677"><a href="#local-6989586621679630677"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1199"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630678"><a href="#local-6989586621679630678"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630679"><a href="#local-6989586621679630679"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630676"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630677"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1200"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630678"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span>  </span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a href="#local-6989586621679630679"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630680"><a href="#local-6989586621679630680"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-6989586621679630681"><a href="#local-6989586621679630681"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630682"><a href="#local-6989586621679630682"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630683"><a href="#local-6989586621679630683"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630680"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630681"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1204"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630682"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span>  </span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a href="#local-6989586621679630683"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1205"></a><span>
</span><a name="line-1206"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630684"><a href="#local-6989586621679630684"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630685"><a href="#local-6989586621679630685"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679630686"><a href="#local-6989586621679630686"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630687"><a href="#local-6989586621679630687"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630688"><a href="#local-6989586621679630688"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630684"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630686"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1208"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630689"><a href="#local-6989586621679630689"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630690"><a href="#local-6989586621679630690"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-6989586621679630684"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630688"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630687"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1209"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630689"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679630688"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630690"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1210"></a><span>
</span><a name="line-1211"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630691"><a href="#local-6989586621679630691"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a name="local-6989586621679630692"><a href="#local-6989586621679630692"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679630693"><a href="#local-6989586621679630693"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630694"><a href="#local-6989586621679630694"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630695"><a href="#local-6989586621679630695"><span class="hs-identifier">expr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630692"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1213"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630696"><a href="#local-6989586621679630696"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630697"><a href="#local-6989586621679630697"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630693"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1214"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630698"><a href="#local-6989586621679630698"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630694"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1215"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630696"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a href="#local-6989586621679630695"><span class="hs-identifier hs-var">expr'</span></a><span> </span><a href="#local-6989586621679630697"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-6989586621679630698"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1216"></a><span>
</span><a name="line-1217"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630699"><a href="#local-6989586621679630699"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621679630700"><a href="#local-6989586621679630700"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679630701"><a href="#local-6989586621679630701"><span class="hs-identifier">ty</span></a></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1218"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630702"><a href="#local-6989586621679630702"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630699"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630701"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1219"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630703"><a href="#local-6989586621679630703"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630704"><a href="#local-6989586621679630704"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630699"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630700"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1220"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630703"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="#local-6989586621679630704"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-6989586621679630702"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1221"></a><span>
</span><a name="line-1222"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630705"><a href="#local-6989586621679630705"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621679630706"><a href="#local-6989586621679630706"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679630707"><a href="#local-6989586621679630707"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630708"><a href="#local-6989586621679630708"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679630709"><a href="#local-6989586621679630709"><span class="hs-identifier">wit</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1223"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630710"><a href="#local-6989586621679630710"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630711"><a href="#local-6989586621679630711"><span class="hs-identifier">wit'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630705"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630709"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-1224"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630712"><a href="#local-6989586621679630712"><span class="hs-identifier">ty2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630710"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679630708"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1225"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630713"><a href="#local-6989586621679630713"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630710"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679630707"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1226"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630714"><a href="#local-6989586621679630714"><span class="hs-identifier">env''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630715"><a href="#local-6989586621679630715"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630710"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679630706"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1227"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630714"><span class="hs-identifier hs-var">env''</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="#local-6989586621679630715"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-6989586621679630713"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630712"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><a href="#local-6989586621679630711"><span class="hs-identifier hs-var">wit'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1228"></a><span>
</span><a name="line-1229"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630716"><a href="#local-6989586621679630716"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-6989586621679630717"><a href="#local-6989586621679630717"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679630718"><a href="#local-6989586621679630718"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1230"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630719"><a href="#local-6989586621679630719"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630716"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630718"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1231"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630720"><a href="#local-6989586621679630720"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630721"><a href="#local-6989586621679630721"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630716"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630717"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1232"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630720"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a href="#local-6989586621679630721"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-6989586621679630719"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1233"></a><span>
</span><a name="line-1234"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630722"><a href="#local-6989586621679630722"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-6989586621679630723"><a href="#local-6989586621679630723"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679630724"><a href="#local-6989586621679630724"><span class="hs-identifier">boxed</span></a></a><span> </span><a name="local-6989586621679630725"><a href="#local-6989586621679630725"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630726"><a href="#local-6989586621679630726"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630722"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630725"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1236"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630727"><a href="#local-6989586621679630727"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630728"><a href="#local-6989586621679630728"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630722"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630723"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1237"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630727"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="#local-6989586621679630728"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-6989586621679630724"><span class="hs-identifier hs-var">boxed</span></a><span> </span><a href="#local-6989586621679630726"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1238"></a><span>
</span><a name="line-1239"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630729"><a href="#local-6989586621679630729"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><a name="local-6989586621679630730"><a href="#local-6989586621679630730"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630731"><a href="#local-6989586621679630731"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679630732"><a href="#local-6989586621679630732"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621679630733"><a href="#local-6989586621679630733"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1240"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630734"><a href="#local-6989586621679630734"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630729"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630733"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1241"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630735"><a href="#local-6989586621679630735"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630736"><a href="#local-6989586621679630736"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630729"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630730"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1242"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630735"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><a href="#local-6989586621679630736"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-6989586621679630731"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679630732"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621679630734"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1243"></a><span>
</span><a name="line-1244"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630737"><a href="#local-6989586621679630737"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630738"><a href="#local-6989586621679630738"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630739"><a href="#local-6989586621679630739"><span class="hs-identifier">tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630740"><a href="#local-6989586621679630740"><span class="hs-identifier">tyvars</span></a></a><span>
</span><a name="line-1245"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630741"><a href="#local-6989586621679630741"><span class="hs-identifier">evs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630742"><a href="#local-6989586621679630742"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1246"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630743"><a href="#local-6989586621679630743"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630744"><a href="#local-6989586621679630744"><span class="hs-identifier">wrapper</span></a></a><span>
</span><a name="line-1247"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630745"><a href="#local-6989586621679630745"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1249"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630747"><a href="#local-6989586621679630747"><span class="hs-identifier">new_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630737"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630739"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span>          </span><span class="hs-comment">-- an unboxed tuple pattern (but only an unboxed tuple pattern)</span><span>
</span><a name="line-1252"></a><span>          </span><span class="hs-comment">-- might have levity-polymorphic arguments. Check for this badness.</span><span>
</span><a name="line-1253"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679630745"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1254"></a><span>            </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-6989586621679630748"><a href="#local-6989586621679630748"><span class="hs-identifier">dc</span></a></a><span>
</span><a name="line-1255"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-6989586621679630748"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="TcMType.html#checkForLevPoly"><span class="hs-identifier hs-var">checkForLevPoly</span></a><span> </span><a href="#local-6989586621679630746"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var">dropRuntimeRepArgs</span></a><span> </span><a href="#local-6989586621679630747"><span class="hs-identifier hs-var">new_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1257"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1258"></a><span>
</span><a name="line-1259"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630749"><a href="#local-6989586621679630749"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630750"><a href="#local-6989586621679630750"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-6989586621679630737"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630740"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-1260"></a><span>          </span><span class="hs-comment">-- Must zonk the existential variables, because their</span><span>
</span><a name="line-1261"></a><span>          </span><span class="hs-comment">-- /kind/ need potential zonking.</span><span>
</span><a name="line-1262"></a><span>          </span><span class="hs-comment">-- cf typecheck/should_compile/tc221.hs</span><span>
</span><a name="line-1263"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630751"><a href="#local-6989586621679630751"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630752"><a href="#local-6989586621679630752"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-6989586621679630749"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-6989586621679630741"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-1264"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630753"><a href="#local-6989586621679630753"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630754"><a href="#local-6989586621679630754"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-6989586621679630751"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630742"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1265"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630755"><a href="#local-6989586621679630755"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630756"><a href="#local-6989586621679630756"><span class="hs-identifier">new_wrapper</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630753"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630744"><span class="hs-identifier hs-var">wrapper</span></a><span>
</span><a name="line-1266"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630757"><a href="#local-6989586621679630757"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630758"><a href="#local-6989586621679630758"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkConStuff"><span class="hs-identifier hs-var">zonkConStuff</span></a><span> </span><a href="#local-6989586621679630755"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-6989586621679630743"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1267"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630757"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630738"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630747"><span class="hs-identifier hs-var">new_tys</span></a><span class="hs-special">,</span><span>
</span><a name="line-1268"></a><span>                            </span><span class="hs-identifier">pat_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630750"><span class="hs-identifier hs-var">new_tyvars</span></a><span class="hs-special">,</span><span>
</span><a name="line-1269"></a><span>                            </span><span class="hs-identifier">pat_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630752"><span class="hs-identifier hs-var">new_evs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1270"></a><span>                            </span><span class="hs-identifier">pat_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630754"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">,</span><span>
</span><a name="line-1271"></a><span>                            </span><span class="hs-identifier">pat_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630758"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">,</span><span>
</span><a name="line-1272"></a><span>                            </span><span class="hs-identifier">pat_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630756"><span class="hs-identifier hs-var">new_wrapper</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1273"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1274"></a><span>    </span><a name="local-6989586621679630746"><a href="#local-6989586621679630746"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type of an element of an unboxed tuple pattern:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679630738"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1275"></a><span>
</span><a name="line-1276"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630759"><a href="#local-6989586621679630759"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-6989586621679630760"><a href="#local-6989586621679630760"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630759"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="#local-6989586621679630760"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1277"></a><span>
</span><a name="line-1278"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630761"><a href="#local-6989586621679630761"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-6989586621679630762"><a href="#local-6989586621679630762"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630763"><a href="#local-6989586621679630763"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1279"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630764"><a href="#local-6989586621679630764"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630761"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630763"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1280"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630765"><a href="#local-6989586621679630765"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630766"><a href="#local-6989586621679630766"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630761"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630762"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1281"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630765"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a href="#local-6989586621679630766"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-6989586621679630764"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630767"><a href="#local-6989586621679630767"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630768"><a href="#local-6989586621679630768"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630769"><a href="#local-6989586621679630769"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630770"><a href="#local-6989586621679630770"><span class="hs-identifier">mb_neg</span></a></a><span> </span><a name="local-6989586621679630771"><a href="#local-6989586621679630771"><span class="hs-identifier">eq_expr</span></a></a><span> </span><a name="local-6989586621679630772"><a href="#local-6989586621679630772"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630773"><a href="#local-6989586621679630773"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630774"><a href="#local-6989586621679630774"><span class="hs-identifier">eq_expr'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630767"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630771"><span class="hs-identifier hs-var">eq_expr</span></a><span>
</span><a name="line-1285"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630776"><a href="#local-6989586621679630776"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630777"><a href="#local-6989586621679630777"><span class="hs-identifier">mb_neg'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679630770"><span class="hs-identifier hs-var">mb_neg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1286"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630773"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1287"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630775"><a href="#local-6989586621679630775"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630773"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630775"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1288"></a><span>
</span><a name="line-1289"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630778"><a href="#local-6989586621679630778"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-6989586621679630776"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630769"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-1290"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630779"><a href="#local-6989586621679630779"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630776"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630772"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1291"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630776"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630768"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630778"><span class="hs-identifier hs-var">lit'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630777"><span class="hs-identifier hs-var">mb_neg'</span></a><span> </span><a href="#local-6989586621679630774"><span class="hs-identifier hs-var">eq_expr'</span></a><span> </span><a href="#local-6989586621679630779"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630780"><a href="#local-6989586621679630780"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630781"><a href="#local-6989586621679630781"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679630782"><a href="#local-6989586621679630782"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630783"><a href="#local-6989586621679630783"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630784"><a href="#local-6989586621679630784"><span class="hs-identifier">lit1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630785"><a href="#local-6989586621679630785"><span class="hs-identifier">lit2</span></a></a><span> </span><a name="local-6989586621679630786"><a href="#local-6989586621679630786"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679630787"><a href="#local-6989586621679630787"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621679630788"><a href="#local-6989586621679630788"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1294"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630789"><a href="#local-6989586621679630789"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630790"><a href="#local-6989586621679630790"><span class="hs-identifier">e1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630780"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-6989586621679630786"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1295"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630791"><a href="#local-6989586621679630791"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630792"><a href="#local-6989586621679630792"><span class="hs-identifier">e2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-6989586621679630789"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630787"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1296"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630793"><a href="#local-6989586621679630793"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630791"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630782"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1297"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630794"><a href="#local-6989586621679630794"><span class="hs-identifier">lit1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-6989586621679630791"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630784"><span class="hs-identifier hs-var">lit1</span></a><span>
</span><a name="line-1298"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630795"><a href="#local-6989586621679630795"><span class="hs-identifier">lit2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-6989586621679630791"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630785"><span class="hs-identifier hs-var">lit2</span></a><span>
</span><a name="line-1299"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630796"><a href="#local-6989586621679630796"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630791"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630788"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1300"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-6989586621679630791"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-6989586621679630793"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span>
</span><a name="line-1301"></a><span>                  </span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630781"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679630793"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630783"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630794"><span class="hs-identifier hs-var">lit1'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630795"><span class="hs-identifier hs-var">lit2'</span></a><span> </span><a href="#local-6989586621679630790"><span class="hs-identifier hs-var">e1'</span></a><span> </span><a href="#local-6989586621679630792"><span class="hs-identifier hs-var">e2'</span></a><span> </span><a href="#local-6989586621679630796"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1302"></a><span>
</span><a name="line-1303"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-6989586621679630797"><a href="#local-6989586621679630797"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a name="local-6989586621679630798"><a href="#local-6989586621679630798"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621679630799"><a href="#local-6989586621679630799"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679630800"><a href="#local-6989586621679630800"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1304"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630801"><a href="#local-6989586621679630801"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630802"><a href="#local-6989586621679630802"><span class="hs-identifier">co_fn'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-6989586621679630797"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630798"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-1305"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630803"><a href="#local-6989586621679630803"><span class="hs-identifier">env''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630804"><a href="#local-6989586621679630804"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630801"><span class="hs-identifier hs-var">env'</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679630799"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630805"><a href="#local-6989586621679630805"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630803"><span class="hs-identifier hs-var">env''</span></a><span> </span><a href="#local-6989586621679630800"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1307"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630803"><span class="hs-identifier hs-var">env''</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a href="#local-6989586621679630802"><span class="hs-identifier hs-var">co_fn'</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679630804"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630805"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1308"></a><span>
</span><a name="line-1309"></a><span class="hs-identifier">zonk_pat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630806"><a href="#local-6989586621679630806"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonk_pat&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679630806"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1310"></a><span>
</span><a name="line-1311"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1312"></a><span class="hs-identifier">zonkConStuff</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-1313"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsConDetails"><span class="hs-identifier hs-type">HsConDetails</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="#local-6989586621679629787"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1314"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-1315"></a><span>                     </span><a href="HsTypes.html#HsConDetails"><span class="hs-identifier hs-type">HsConDetails</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="#local-6989586621679629787"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1316"></a><a name="zonkConStuff"><a href="TcHsSyn.html#zonkConStuff"><span class="hs-identifier">zonkConStuff</span></a></a><span> </span><a name="local-6989586621679630807"><a href="#local-6989586621679630807"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-6989586621679630808"><a href="#local-6989586621679630808"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1317"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630809"><a href="#local-6989586621679630809"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630810"><a href="#local-6989586621679630810"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630807"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630808"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1318"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630809"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621679630810"><span class="hs-identifier hs-var">pats'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1319"></a><span>
</span><a name="line-1320"></a><span class="hs-identifier">zonkConStuff</span><span> </span><a name="local-6989586621679630811"><a href="#local-6989586621679630811"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621679630812"><a href="#local-6989586621679630812"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679630813"><a href="#local-6989586621679630813"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1321"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630814"><a href="#local-6989586621679630814"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630815"><a href="#local-6989586621679630815"><span class="hs-identifier">p1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630811"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-6989586621679630812"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1322"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630816"><a href="#local-6989586621679630816"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630817"><a href="#local-6989586621679630817"><span class="hs-identifier">p2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630814"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630813"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1323"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630816"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679630815"><span class="hs-identifier hs-var">p1'</span></a><span> </span><a href="#local-6989586621679630817"><span class="hs-identifier hs-var">p2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1324"></a><span>
</span><a name="line-1325"></a><span class="hs-identifier">zonkConStuff</span><span> </span><a name="local-6989586621679630818"><a href="#local-6989586621679630818"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-6989586621679630819"><a href="#local-6989586621679630819"><span class="hs-identifier">rpats</span></a></a><span> </span><a name="local-6989586621679630820"><a href="#local-6989586621679630820"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1326"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630821"><a href="#local-6989586621679630821"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630822"><a href="#local-6989586621679630822"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630818"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630819"><span class="hs-identifier hs-var">rpats</span></a><span class="hs-special">)</span><span>
</span><a name="line-1327"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630823"><a href="#local-6989586621679630823"><span class="hs-identifier">rpats'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630824"><a href="#local-6989586621679630824"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630825"><a href="#local-6989586621679630825"><span class="hs-identifier">rp</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679630826"><a href="#local-6989586621679630826"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630824"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630825"><span class="hs-identifier hs-var">rp</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630826"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1328"></a><span>                               </span><a href="#local-6989586621679630819"><span class="hs-identifier hs-var">rpats</span></a><span> </span><a href="#local-6989586621679630822"><span class="hs-identifier hs-var">pats'</span></a><span>
</span><a name="line-1329"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630821"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a href="#local-6989586621679630823"><span class="hs-identifier hs-var">rpats'</span></a><span> </span><a href="#local-6989586621679630820"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1330"></a><span>        </span><span class="hs-comment">-- Field selectors have declared types; hence no zonking</span><span>
</span><a name="line-1331"></a><span>
</span><a name="line-1332"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1333"></a><span class="hs-identifier">zonkPats</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><a name="zonkPats"><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier">zonkPats</span></a></a><span> </span><a name="local-6989586621679630827"><a href="#local-6989586621679630827"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630827"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1335"></a><span class="hs-identifier">zonkPats</span><span> </span><a name="local-6989586621679630828"><a href="#local-6989586621679630828"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630829"><a href="#local-6989586621679630829"><span class="hs-identifier">pat</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679630830"><a href="#local-6989586621679630830"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630831"><a href="#local-6989586621679630831"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630832"><a href="#local-6989586621679630832"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-6989586621679630828"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630829"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1336"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630833"><a href="#local-6989586621679630833"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630834"><a href="#local-6989586621679630834"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-6989586621679630831"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-6989586621679630830"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1337"></a><span>                             </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630833"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630832"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679630834"><span class="hs-identifier hs-var">pats'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1338"></a><span>
</span><a name="line-1339"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Foreign]{Foreign exports}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1346"></a><span>
</span><a name="line-1347"></a><span class="hs-identifier">zonkForeignExports</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1348"></a><a name="zonkForeignExports"><a href="TcHsSyn.html#zonkForeignExports"><span class="hs-identifier">zonkForeignExports</span></a></a><span> </span><a name="local-6989586621679630835"><a href="#local-6989586621679630835"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630836"><a href="#local-6989586621679630836"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkForeignExport"><span class="hs-identifier hs-var">zonkForeignExport</span></a><span> </span><a href="#local-6989586621679630835"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630836"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1349"></a><span>
</span><a name="line-1350"></a><span class="hs-identifier">zonkForeignExport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><a name="zonkForeignExport"><a href="TcHsSyn.html#zonkForeignExport"><span class="hs-identifier">zonkForeignExport</span></a></a><span> </span><a name="local-6989586621679630837"><a href="#local-6989586621679630837"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630838"><a href="#local-6989586621679630838"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630839"><a href="#local-6989586621679630839"><span class="hs-identifier">co</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630840"><a href="#local-6989586621679630840"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1352"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679630837"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630838"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1353"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630839"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1354"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630840"><span class="hs-identifier hs-var">spec</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1355"></a><span class="hs-identifier">zonkForeignExport</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630841"><a href="#local-6989586621679630841"><span class="hs-identifier">for_imp</span></a></a><span>
</span><a name="line-1356"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679630841"><span class="hs-identifier hs-var">for_imp</span></a><span>     </span><span class="hs-comment">-- Foreign imports don't need zonking</span><span>
</span><a name="line-1357"></a><span>
</span><a name="line-1358"></a><span class="hs-identifier">zonkRules</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1359"></a><a name="zonkRules"><a href="TcHsSyn.html#zonkRules"><span class="hs-identifier">zonkRules</span></a></a><span> </span><a name="local-6989586621679630842"><a href="#local-6989586621679630842"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630843"><a href="#local-6989586621679630843"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkRule"><span class="hs-identifier hs-var">zonkRule</span></a><span> </span><a href="#local-6989586621679630842"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630843"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1360"></a><span>
</span><a name="line-1361"></a><span class="hs-identifier">zonkRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1362"></a><a name="zonkRule"><a href="TcHsSyn.html#zonkRule"><span class="hs-identifier">zonkRule</span></a></a><span> </span><a name="local-6989586621679630844"><a href="#local-6989586621679630844"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsRule"><span class="hs-identifier hs-var">HsRule</span></a><span> </span><a name="local-6989586621679630845"><a href="#local-6989586621679630845"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679630846"><a href="#local-6989586621679630846"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630847"><a href="#local-6989586621679630847"><span class="hs-identifier">vars</span></a></a><span class="hs-comment">{-::[RuleBndr TcId]-}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679630848"><a href="#local-6989586621679630848"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679630849"><a href="#local-6989586621679630849"><span class="hs-identifier">fv_lhs</span></a></a><span> </span><a name="local-6989586621679630850"><a href="#local-6989586621679630850"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679630851"><a href="#local-6989586621679630851"><span class="hs-identifier">fv_rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1363"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630863"><a href="#local-6989586621679630863"><span class="hs-identifier">env_inside</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630864"><a href="#local-6989586621679630864"><span class="hs-identifier">new_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="#local-6989586621679630852"><span class="hs-identifier hs-var">zonk_bndr</span></a><span> </span><a href="#local-6989586621679630844"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630847"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630865"><a href="#local-6989586621679630865"><span class="hs-identifier">env_lhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#setZonkType"><span class="hs-identifier hs-var">setZonkType</span></a><span> </span><a href="#local-6989586621679630863"><span class="hs-identifier hs-var">env_inside</span></a><span> </span><a href="TcHsSyn.html#zonkTvSkolemising"><span class="hs-identifier hs-var">zonkTvSkolemising</span></a><span>
</span><a name="line-1366"></a><span>              </span><span class="hs-comment">-- See Note [Zonking the LHS of a RULE]</span><span>
</span><a name="line-1367"></a><span>
</span><a name="line-1368"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630866"><a href="#local-6989586621679630866"><span class="hs-identifier">new_lhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630865"><span class="hs-identifier hs-var">env_lhs</span></a><span>    </span><a href="#local-6989586621679630848"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1369"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630867"><a href="#local-6989586621679630867"><span class="hs-identifier">new_rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630863"><span class="hs-identifier hs-var">env_inside</span></a><span> </span><a href="#local-6989586621679630850"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1370"></a><span>
</span><a name="line-1371"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsRule"><span class="hs-identifier hs-var">HsRule</span></a><span> </span><a href="#local-6989586621679630845"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679630846"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-6989586621679630864"><span class="hs-identifier hs-var">new_bndrs</span></a><span> </span><a href="#local-6989586621679630866"><span class="hs-identifier hs-var">new_lhs</span></a><span> </span><a href="#local-6989586621679630849"><span class="hs-identifier hs-var">fv_lhs</span></a><span> </span><a href="#local-6989586621679630867"><span class="hs-identifier hs-var">new_rhs</span></a><span> </span><a href="#local-6989586621679630851"><span class="hs-identifier hs-var">fv_rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1372"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1373"></a><span>   </span><a name="local-6989586621679630852"><a href="#local-6989586621679630852"><span class="hs-identifier">zonk_bndr</span></a></a><span> </span><a name="local-6989586621679630854"><a href="#local-6989586621679630854"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630855"><a href="#local-6989586621679630855"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679630856"><a href="#local-6989586621679630856"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679630857"><a href="#local-6989586621679630857"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1374"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630858"><a href="#local-6989586621679630858"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630859"><a href="#local-6989586621679630859"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679630853"><span class="hs-identifier hs-var">zonk_it</span></a><span> </span><a href="#local-6989586621679630854"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630857"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1375"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630858"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630855"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679630856"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679630859"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1376"></a><span>   </span><span class="hs-identifier">zonk_bndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndrSig"><span class="hs-identifier hs-var">RuleBndrSig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;zonk_bndr RuleBndrSig&quot;</span><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span>   </span><a name="local-6989586621679630853"><a href="#local-6989586621679630853"><span class="hs-identifier">zonk_it</span></a></a><span> </span><a name="local-6989586621679630860"><a href="#local-6989586621679630860"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630861"><a href="#local-6989586621679630861"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-1379"></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-6989586621679630861"><span class="hs-identifier hs-var">v</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630862"><a href="#local-6989586621679630862"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630860"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630861"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1380"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630860"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679630862"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630862"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1381"></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span>                    </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-6989586621679630860"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630861"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1383"></a><span>                    </span><span class="hs-comment">-- DV: used to be return (env,v) but that is plain</span><span>
</span><a name="line-1384"></a><span>                    </span><span class="hs-comment">-- wrong because we may need to go inside the kind</span><span>
</span><a name="line-1385"></a><span>                    </span><span class="hs-comment">-- of v and zonk there!</span><span>
</span><a name="line-1386"></a><span>
</span><a name="line-1387"></a><span class="hs-identifier">zonkVects</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1388"></a><a name="zonkVects"><a href="TcHsSyn.html#zonkVects"><span class="hs-identifier">zonkVects</span></a></a><span> </span><a name="local-6989586621679630868"><a href="#local-6989586621679630868"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkVect"><span class="hs-identifier hs-var">zonkVect</span></a><span> </span><a href="#local-6989586621679630868"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><span>
</span><a name="line-1390"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#VectDecl"><span class="hs-identifier hs-type">VectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#VectDecl"><span class="hs-identifier hs-type">VectDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1391"></a><a name="zonkVect"><a href="TcHsSyn.html#zonkVect"><span class="hs-identifier">zonkVect</span></a></a><span> </span><a name="local-6989586621679630869"><a href="#local-6989586621679630869"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVect"><span class="hs-identifier hs-var">HsVect</span></a><span> </span><a name="local-6989586621679630870"><a href="#local-6989586621679630870"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679630871"><a href="#local-6989586621679630871"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679630872"><a href="#local-6989586621679630872"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1392"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630873"><a href="#local-6989586621679630873"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630869"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630871"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1393"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630874"><a href="#local-6989586621679630874"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-6989586621679630869"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630872"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1394"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVect"><span class="hs-identifier hs-var">HsVect</span></a><span> </span><a href="#local-6989586621679630870"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679630873"><span class="hs-identifier hs-var">v'</span></a><span> </span><a href="#local-6989586621679630874"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-1395"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1396"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-6989586621679630875"><a href="#local-6989586621679630875"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsNoVect"><span class="hs-identifier hs-var">HsNoVect</span></a><span> </span><a name="local-6989586621679630876"><a href="#local-6989586621679630876"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679630877"><a href="#local-6989586621679630877"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1397"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630878"><a href="#local-6989586621679630878"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630875"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630877"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1398"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsNoVect"><span class="hs-identifier hs-var">HsNoVect</span></a><span> </span><a href="#local-6989586621679630876"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679630878"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1399"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1400"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-6989586621679630879"><a href="#local-6989586621679630879"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectTypeOut"><span class="hs-identifier hs-var">HsVectTypeOut</span></a><span> </span><a name="local-6989586621679630880"><a href="#local-6989586621679630880"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679630881"><a href="#local-6989586621679630881"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679630882"><a href="#local-6989586621679630882"><span class="hs-identifier">rt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1401"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectTypeOut"><span class="hs-identifier hs-var">HsVectTypeOut</span></a><span> </span><a href="#local-6989586621679630880"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679630881"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679630882"><span class="hs-identifier hs-var">rt</span></a><span>
</span><a name="line-1402"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectTypeIn"><span class="hs-identifier hs-var">HsVectTypeIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectTypeIn&quot;</span><span>
</span><a name="line-1403"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-6989586621679630883"><a href="#local-6989586621679630883"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectClassOut"><span class="hs-identifier hs-var">HsVectClassOut</span></a><span> </span><a name="local-6989586621679630884"><a href="#local-6989586621679630884"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1404"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectClassOut"><span class="hs-identifier hs-var">HsVectClassOut</span></a><span> </span><a href="#local-6989586621679630884"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1405"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectClassIn"><span class="hs-identifier hs-var">HsVectClassIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectClassIn&quot;</span><span>
</span><a name="line-1406"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-6989586621679630885"><a href="#local-6989586621679630885"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectInstOut"><span class="hs-identifier hs-var">HsVectInstOut</span></a><span> </span><a name="local-6989586621679630886"><a href="#local-6989586621679630886"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1407"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectInstOut"><span class="hs-identifier hs-var">HsVectInstOut</span></a><span> </span><a href="#local-6989586621679630886"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1408"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectInstIn"><span class="hs-identifier hs-var">HsVectInstIn</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectInstIn&quot;</span><span>
</span><a name="line-1409"></a><span>
</span><a name="line-1410"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
              Constraints and evidence
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1417"></a><span>
</span><a name="line-1418"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-1419"></a><a name="zonkEvTerm"><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier">zonkEvTerm</span></a></a><span> </span><a name="local-6989586621679630887"><a href="#local-6989586621679630887"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><a name="local-6989586621679630888"><a href="#local-6989586621679630888"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isId</span><span> </span><span class="hs-identifier hs-var">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1420"></a><span>                                    </span><a href="TcHsSyn.html#zonkEvVarOcc"><span class="hs-identifier hs-var">zonkEvVarOcc</span></a><span> </span><a href="#local-6989586621679630887"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630888"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1421"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630889"><a href="#local-6989586621679630889"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a name="local-6989586621679630890"><a href="#local-6989586621679630890"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630891"><a href="#local-6989586621679630891"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-6989586621679630889"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630890"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1422"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a href="#local-6989586621679630891"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1423"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630892"><a href="#local-6989586621679630892"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCast"><span class="hs-identifier hs-var">EvCast</span></a><span> </span><a name="local-6989586621679630893"><a href="#local-6989586621679630893"><span class="hs-identifier">tm</span></a></a><span> </span><a name="local-6989586621679630894"><a href="#local-6989586621679630894"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630895"><a href="#local-6989586621679630895"><span class="hs-identifier">tm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630892"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630893"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-1424"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630896"><a href="#local-6989586621679630896"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-6989586621679630892"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630894"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1425"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkEvCast"><span class="hs-identifier hs-var">mkEvCast</span></a><span> </span><a href="#local-6989586621679630895"><span class="hs-identifier hs-var">tm'</span></a><span> </span><a href="#local-6989586621679630896"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1426"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TcEvidence.html#EvLit"><span class="hs-identifier hs-var">EvLit</span></a><span> </span><a name="local-6989586621679630897"><a href="#local-6989586621679630897"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvLit"><span class="hs-identifier hs-var">EvLit</span></a><span> </span><a href="#local-6989586621679630897"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630898"><a href="#local-6989586621679630898"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><a name="local-6989586621679630899"><a href="#local-6989586621679630899"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630900"><a href="#local-6989586621679630900"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1429"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630901"><a href="#local-6989586621679630901"><span class="hs-identifier">ev'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTypeable"><span class="hs-identifier hs-var">zonkEvTypeable</span></a><span> </span><a href="#local-6989586621679630898"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630900"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-1430"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630902"><a href="#local-6989586621679630902"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630898"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630899"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1431"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><a href="#local-6989586621679630902"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679630901"><span class="hs-identifier hs-var">ev'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1432"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630903"><a href="#local-6989586621679630903"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><a name="local-6989586621679630904"><a href="#local-6989586621679630904"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1433"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679630904"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1434"></a><span>      </span><a href="TcEvidence.html#EvCsEmpty"><span class="hs-identifier hs-var">EvCsEmpty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><a href="#local-6989586621679630904"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1435"></a><span>      </span><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier hs-var">EvCsPushCall</span></a><span> </span><a name="local-6989586621679630905"><a href="#local-6989586621679630905"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679630906"><a href="#local-6989586621679630906"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679630907"><a href="#local-6989586621679630907"><span class="hs-identifier">tm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630908"><a href="#local-6989586621679630908"><span class="hs-identifier">tm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630903"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630907"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-1436"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier hs-var">EvCsPushCall</span></a><span> </span><a href="#local-6989586621679630905"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679630906"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679630908"><span class="hs-identifier hs-var">tm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1437"></a><span>
</span><a name="line-1438"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630909"><a href="#local-6989586621679630909"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSuperClass"><span class="hs-identifier hs-var">EvSuperClass</span></a><span> </span><a name="local-6989586621679630910"><a href="#local-6989586621679630910"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679630911"><a href="#local-6989586621679630911"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630912"><a href="#local-6989586621679630912"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630909"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630910"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1439"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSuperClass"><span class="hs-identifier hs-var">EvSuperClass</span></a><span> </span><a href="#local-6989586621679630912"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-6989586621679630911"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1440"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630913"><a href="#local-6989586621679630913"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDFunApp"><span class="hs-identifier hs-var">EvDFunApp</span></a><span> </span><a name="local-6989586621679630914"><a href="#local-6989586621679630914"><span class="hs-identifier">df</span></a></a><span> </span><a name="local-6989586621679630915"><a href="#local-6989586621679630915"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679630916"><a href="#local-6989586621679630916"><span class="hs-identifier">tms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630917"><a href="#local-6989586621679630917"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span> </span><a href="#local-6989586621679630913"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630915"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1442"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630918"><a href="#local-6989586621679630918"><span class="hs-identifier">tms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630913"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630916"><span class="hs-identifier hs-var">tms</span></a><span>
</span><a name="line-1443"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDFunApp"><span class="hs-identifier hs-var">EvDFunApp</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-6989586621679630913"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630914"><span class="hs-identifier hs-var">df</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630917"><span class="hs-identifier hs-var">tys'</span></a><span> </span><a href="#local-6989586621679630918"><span class="hs-identifier hs-var">tms'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1444"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630919"><a href="#local-6989586621679630919"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDelayedError"><span class="hs-identifier hs-var">EvDelayedError</span></a><span> </span><a name="local-6989586621679630920"><a href="#local-6989586621679630920"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679630921"><a href="#local-6989586621679630921"><span class="hs-identifier">msg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630922"><a href="#local-6989586621679630922"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630919"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630920"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1446"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDelayedError"><span class="hs-identifier hs-var">EvDelayedError</span></a><span> </span><a href="#local-6989586621679630922"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679630921"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1447"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-6989586621679630923"><a href="#local-6989586621679630923"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSelector"><span class="hs-identifier hs-var">EvSelector</span></a><span> </span><a name="local-6989586621679630924"><a href="#local-6989586621679630924"><span class="hs-identifier">sel_id</span></a></a><span> </span><a name="local-6989586621679630925"><a href="#local-6989586621679630925"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679630926"><a href="#local-6989586621679630926"><span class="hs-identifier">tms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630927"><a href="#local-6989586621679630927"><span class="hs-identifier">sel_id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-6989586621679630923"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630924"><span class="hs-identifier hs-var">sel_id</span></a><span>
</span><a name="line-1449"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630928"><a href="#local-6989586621679630928"><span class="hs-identifier">tys'</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span> </span><a href="#local-6989586621679630923"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630925"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1450"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630929"><a href="#local-6989586621679630929"><span class="hs-identifier">tms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630923"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630926"><span class="hs-identifier hs-var">tms</span></a><span>
</span><a name="line-1451"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSelector"><span class="hs-identifier hs-var">EvSelector</span></a><span> </span><a href="#local-6989586621679630927"><span class="hs-identifier hs-var">sel_id'</span></a><span> </span><a href="#local-6989586621679630928"><span class="hs-identifier hs-var">tys'</span></a><span> </span><a href="#local-6989586621679630929"><span class="hs-identifier hs-var">tms'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1452"></a><span>
</span><a name="line-1453"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span>
</span><a name="line-1454"></a><a name="zonkEvTypeable"><a href="TcHsSyn.html#zonkEvTypeable"><span class="hs-identifier">zonkEvTypeable</span></a></a><span> </span><a name="local-6989586621679630930"><a href="#local-6989586621679630930"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><a name="local-6989586621679630931"><a href="#local-6989586621679630931"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621679630932"><a href="#local-6989586621679630932"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1455"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630933"><a href="#local-6989586621679630933"><span class="hs-identifier">e'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630930"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630932"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1456"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><a href="#local-6989586621679630931"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-6989586621679630933"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1457"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><a name="local-6989586621679630934"><a href="#local-6989586621679630934"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a name="local-6989586621679630935"><a href="#local-6989586621679630935"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679630936"><a href="#local-6989586621679630936"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630937"><a href="#local-6989586621679630937"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630934"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630935"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1459"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630938"><a href="#local-6989586621679630938"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630934"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630936"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1460"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a href="#local-6989586621679630937"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621679630938"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1461"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><a name="local-6989586621679630939"><a href="#local-6989586621679630939"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTrFun"><span class="hs-identifier hs-var">EvTypeableTrFun</span></a><span> </span><a name="local-6989586621679630940"><a href="#local-6989586621679630940"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679630941"><a href="#local-6989586621679630941"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1462"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630942"><a href="#local-6989586621679630942"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630939"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630940"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1463"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630943"><a href="#local-6989586621679630943"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630939"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630941"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1464"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTrFun"><span class="hs-identifier hs-var">EvTypeableTrFun</span></a><span> </span><a href="#local-6989586621679630942"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621679630943"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1465"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><a name="local-6989586621679630944"><a href="#local-6989586621679630944"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a name="local-6989586621679630945"><a href="#local-6989586621679630945"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1466"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630946"><a href="#local-6989586621679630946"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630944"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630945"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1467"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a href="#local-6989586621679630946"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1468"></a><span>
</span><a name="line-1469"></a><span class="hs-identifier">zonkTcEvBinds_s</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><a name="zonkTcEvBinds_s"><a href="TcHsSyn.html#zonkTcEvBinds_s"><span class="hs-identifier">zonkTcEvBinds_s</span></a></a><span> </span><a name="local-6989586621679630947"><a href="#local-6989586621679630947"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630948"><a href="#local-6989586621679630948"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630949"><a href="#local-6989586621679630949"><span class="hs-identifier">env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630950"><a href="#local-6989586621679630950"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier hs-var">zonk_tc_ev_binds</span></a><span> </span><a href="#local-6989586621679630947"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630948"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1471"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630949"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><a href="#local-6989586621679630950"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1472"></a><span>
</span><a name="line-1473"></a><span class="hs-identifier">zonkTcEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><a name="zonkTcEvBinds"><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier">zonkTcEvBinds</span></a></a><span> </span><a name="local-6989586621679630951"><a href="#local-6989586621679630951"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630952"><a href="#local-6989586621679630952"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679630953"><a href="#local-6989586621679630953"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630954"><a href="#local-6989586621679630954"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier hs-var">zonk_tc_ev_binds</span></a><span> </span><a href="#local-6989586621679630951"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630952"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1475"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630953"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a href="#local-6989586621679630954"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1476"></a><span>
</span><a name="line-1477"></a><span class="hs-identifier">zonk_tc_ev_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><a name="zonk_tc_ev_binds"><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier">zonk_tc_ev_binds</span></a></a><span> </span><a name="local-6989586621679630955"><a href="#local-6989586621679630955"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-var">TcEvBinds</span></a><span> </span><a name="local-6989586621679630956"><a href="#local-6989586621679630956"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkEvBindsVar"><span class="hs-identifier hs-var">zonkEvBindsVar</span></a><span> </span><a href="#local-6989586621679630955"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630956"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1479"></a><span class="hs-identifier">zonk_tc_ev_binds</span><span> </span><a name="local-6989586621679630957"><a href="#local-6989586621679630957"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a name="local-6989586621679630958"><a href="#local-6989586621679630958"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="#local-6989586621679630957"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630958"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-identifier">zonkEvBindsVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1482"></a><a name="zonkEvBindsVar"><a href="TcHsSyn.html#zonkEvBindsVar"><span class="hs-identifier">zonkEvBindsVar</span></a></a><span> </span><a name="local-6989586621679630959"><a href="#local-6989586621679630959"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-var">EvBindsVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ebv_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630960"><a href="#local-6989586621679630960"><span class="hs-identifier">ref</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1483"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630961"><a href="#local-6989586621679630961"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-6989586621679630960"><span class="hs-identifier hs-var">ref</span></a><span>
</span><a name="line-1484"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="#local-6989586621679630959"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#evBindMapBinds"><span class="hs-identifier hs-var">evBindMapBinds</span></a><span> </span><a href="#local-6989586621679630961"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1485"></a><span>
</span><a name="line-1486"></a><span class="hs-identifier">zonkEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1487"></a><a name="zonkEvBinds"><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier">zonkEvBinds</span></a></a><span> </span><a name="local-6989586621679630962"><a href="#local-6989586621679630962"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630963"><a href="#local-6989586621679630963"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1488"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkEvBinds&quot; #-}</span><span>
</span><a name="line-1489"></a><span>    </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679630968"><a href="#local-6989586621679630968"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1490"></a><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679630969"><a href="#local-6989586621679630969"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-6989586621679630962"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630964"><span class="hs-identifier hs-var">collect_ev_bndrs</span></a><span> </span><a href="#local-6989586621679630968"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1491"></a><span>         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630970"><a href="#local-6989586621679630970"><span class="hs-identifier">binds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Bag.html#mapBagM"><span class="hs-identifier hs-var">mapBagM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvBind"><span class="hs-identifier hs-var">zonkEvBind</span></a><span> </span><a href="#local-6989586621679630969"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630963"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1492"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630969"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679630970"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1493"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1494"></a><span>    </span><span class="hs-identifier">collect_ev_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1495"></a><span>    </span><a name="local-6989586621679630964"><a href="#local-6989586621679630964"><span class="hs-identifier">collect_ev_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="#local-6989586621679630965"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1496"></a><span>    </span><a name="local-6989586621679630965"><a href="#local-6989586621679630965"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630966"><a href="#local-6989586621679630966"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679630967"><a href="#local-6989586621679630967"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630966"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679630967"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1497"></a><span>
</span><a name="line-1498"></a><span class="hs-identifier">zonkEvBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-1499"></a><a name="zonkEvBind"><a href="TcHsSyn.html#zonkEvBind"><span class="hs-identifier">zonkEvBind</span></a></a><span> </span><a name="local-6989586621679630971"><a href="#local-6989586621679630971"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630972"><a href="#local-6989586621679630972"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630973"><a href="#local-6989586621679630973"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630974"><a href="#local-6989586621679630974"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1500"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630975"><a href="#local-6989586621679630975"><span class="hs-identifier">var'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkEvBndr&quot; #-}</span><span> </span><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier hs-var">zonkEvBndr</span></a><span> </span><a href="#local-6989586621679630971"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630973"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1501"></a><span>
</span><a name="line-1502"></a><span>         </span><span class="hs-comment">-- Optimise the common case of Refl coercions</span><span>
</span><a name="line-1503"></a><span>         </span><span class="hs-comment">-- See Note [Optimise coercion zonking]</span><span>
</span><a name="line-1504"></a><span>         </span><span class="hs-comment">-- This has a very big effect on some programs (eg Trac #5030)</span><span>
</span><a name="line-1505"></a><span>
</span><a name="line-1506"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679630980"><a href="#local-6989586621679630980"><span class="hs-identifier">term'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621679630975"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1507"></a><span>           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679630976"><a href="#local-6989586621679630976"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630977"><a href="#local-6989586621679630977"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679630978"><a href="#local-6989586621679630978"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679630977"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679630978"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1508"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcReflCo"><span class="hs-identifier hs-var">mkTcReflCo</span></a><span> </span><a href="#local-6989586621679630976"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679630977"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1509"></a><span>           </span><a name="local-6989586621679630979"><a href="#local-6989586621679630979"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-6989586621679630971"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630974"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-1510"></a><span>
</span><a name="line-1511"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679630972"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630975"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630980"><span class="hs-identifier hs-var">term'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1512"></a><span>
</span><a name="line-1513"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                         Zonking types
*                                                                      *
************************************************************************

Note [Zonking mutable unbound type or kind variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In zonkTypeZapping, we zonk mutable but unbound type or kind variables to an
arbitrary type. We know if they are unbound even though we don't carry an
environment, because at the binding site for a variable we bind the mutable
var to a fresh immutable one.  So the mutable store plays the role of an
environment.  If we come across a mutable variable that isn't so bound, it
must be completely free. We zonk the expected kind to make sure we don't get
some unbound meta variable as the kind.

Note that since we have kind polymorphism, zonk_unbound_tyvar will handle both
type and kind variables. Consider the following datatype:

  data Phantom a = Phantom Int

The type of Phantom is (forall (k : *). forall (a : k). Int). Both `a` and
`k` are unbound variables. We want to zonk this to
(forall (k : Any *). forall (a : Any (Any *)). Int).

Note [Optimise coercion zonking]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When optimising evidence binds we may come across situations where
a coercion looks like
      cv = ReflCo ty
or    cv1 = cv2
where the type 'ty' is big.  In such cases it is a waste of time to zonk both
  * The variable on the LHS
  * The coercion on the RHS
Rather, we can zonk the variable, and if its type is (ty ~ ty), we can just
use Refl on the right, ignoring the actual coercion on the RHS.

This can have a very big effect, because the constraint solver sometimes does go
to a lot of effort to prove Refl!  (Eg when solving  10+3 = 10+3; cf Trac #5030)

-}</span><span>
</span><a name="line-1555"></a><span>
</span><a name="line-1556"></a><span class="hs-identifier">zonkTyVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-1557"></a><a name="zonkTyVarOcc"><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier">zonkTyVarOcc</span></a></a><span> </span><a name="local-6989586621679630981"><a href="#local-6989586621679630981"><span class="hs-identifier">env</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-6989586621679630982"><a href="#local-6989586621679630982"><span class="hs-identifier">zonk_unbound_tyvar</span></a></a><span> </span><a name="local-6989586621679630983"><a href="#local-6989586621679630983"><span class="hs-identifier">tv_env</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679630984"><a href="#local-6989586621679630984"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1558"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1559"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1560"></a><span>         </span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679630985"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1561"></a><span>         </span><a href="TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679630985"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1562"></a><span>         </span><a href="TcType.html#FlatSkol"><span class="hs-identifier hs-var">FlatSkol</span></a><span> </span><a name="local-6989586621679630987"><a href="#local-6989586621679630987"><span class="hs-identifier">ty</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630981"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630987"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1563"></a><span>         </span><a href="TcType.html#MetaTv"><span class="hs-identifier hs-var">MetaTv</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mtv_ref</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679630988"><a href="#local-6989586621679630988"><span class="hs-identifier">ref</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1564"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630989"><a href="#local-6989586621679630989"><span class="hs-identifier">cts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-6989586621679630988"><span class="hs-identifier hs-var">ref</span></a><span>
</span><a name="line-1565"></a><span>                 </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679630989"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1566"></a><span>                      </span><a href="TcType.html#Flexi"><span class="hs-identifier hs-var">Flexi</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630990"><a href="#local-6989586621679630990"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkKind1&quot; #-}</span><span>
</span><a name="line-1567"></a><span>                                            </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630981"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1568"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679630982"><span class="hs-identifier hs-var">zonk_unbound_tyvar</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679630990"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1569"></a><span>                      </span><a href="TcType.html#Indirect"><span class="hs-identifier hs-var">Indirect</span></a><span> </span><a name="local-6989586621679630991"><a href="#local-6989586621679630991"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679630992"><a href="#local-6989586621679630992"><span class="hs-identifier">zty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630981"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679630991"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1570"></a><span>                                        </span><span class="hs-comment">-- Small optimisation: shortern-out indirect steps</span><span>
</span><a name="line-1571"></a><span>                                        </span><span class="hs-comment">-- so that the old type may be more easily collected.</span><span>
</span><a name="line-1572"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="IOEnv.html#writeMutVar"><span class="hs-identifier hs-var">writeMutVar</span></a><span> </span><a href="#local-6989586621679630988"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#Indirect"><span class="hs-identifier hs-var">Indirect</span></a><span> </span><a href="#local-6989586621679630992"><span class="hs-identifier hs-var">zty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1573"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679630992"><span class="hs-identifier hs-var">zty</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1574"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1575"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679630985"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1576"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1577"></a><span>    </span><a name="local-6989586621679630985"><a href="#local-6989586621679630985"><span class="hs-identifier">lookup_in_env</span></a></a><span>    </span><span class="hs-comment">-- Look up in the env just as we do for Ids</span><span>
</span><a name="line-1578"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679630983"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1579"></a><span>          </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Var.html#updateTyVarKindM"><span class="hs-identifier hs-var">updateTyVarKindM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630981"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630984"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1580"></a><span>          </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630986"><a href="#local-6989586621679630986"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621679630986"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span class="hs-identifier">zonkCoVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1583"></a><a name="zonkCoVarOcc"><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier">zonkCoVarOcc</span></a></a><span> </span><a name="local-6989586621679630993"><a href="#local-6989586621679630993"><span class="hs-identifier">env</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679630994"><a href="#local-6989586621679630994"><span class="hs-identifier">tyco_env</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679630995"><a href="#local-6989586621679630995"><span class="hs-identifier">cv</span></a></a><span>
</span><a name="line-1584"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679630996"><a href="#local-6989586621679630996"><span class="hs-identifier">cv'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679630994"><span class="hs-identifier hs-var">tyco_env</span></a><span> </span><a href="#local-6989586621679630995"><span class="hs-identifier hs-var">cv</span></a><span>  </span><span class="hs-comment">-- don't look in the knot-tied env</span><span>
</span><a name="line-1585"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span> </span><a href="#local-6989586621679630996"><span class="hs-identifier hs-var">cv'</span></a><span>
</span><a name="line-1586"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1587"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630993"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679630995"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1588"></a><span>
</span><a name="line-1589"></a><span class="hs-identifier">zonkCoHole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span>
</span><a name="line-1590"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>  </span><span class="hs-comment">-- these are all redundant with</span><span>
</span><a name="line-1591"></a><span>                                    </span><span class="hs-comment">-- the details in the hole,</span><span>
</span><a name="line-1592"></a><span>                                    </span><span class="hs-comment">-- unzonked</span><span>
</span><a name="line-1593"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1594"></a><a name="zonkCoHole"><a href="TcHsSyn.html#zonkCoHole"><span class="hs-identifier">zonkCoHole</span></a></a><span> </span><a name="local-6989586621679630997"><a href="#local-6989586621679630997"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679630998"><a href="#local-6989586621679630998"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679630999"><a href="#local-6989586621679630999"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679631000"><a href="#local-6989586621679631000"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679631001"><a href="#local-6989586621679631001"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1595"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679631002"><a href="#local-6989586621679631002"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#unpackCoercionHole_maybe"><span class="hs-identifier hs-var">unpackCoercionHole_maybe</span></a><span> </span><a href="#local-6989586621679630998"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-1596"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679631002"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1597"></a><span>           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679631003"><a href="#local-6989586621679631003"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679631004"><a href="#local-6989586621679631004"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-6989586621679630997"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679631003"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1598"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#checkCoercionHole"><span class="hs-identifier hs-var">checkCoercionHole</span></a><span> </span><a href="#local-6989586621679631004"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-6989586621679630998"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679630999"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679631000"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679631001"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1599"></a><span>
</span><a name="line-1600"></a><span>              </span><span class="hs-comment">-- This next case should happen only in the presence of</span><span>
</span><a name="line-1601"></a><span>              </span><span class="hs-comment">-- (undeferred) type errors. Originally, I put in a panic</span><span>
</span><a name="line-1602"></a><span>              </span><span class="hs-comment">-- here, but that caused too many uses of `failIfErrsM`.</span><span>
</span><a name="line-1603"></a><span>           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;Zonking unfilled coercion hole&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679630998"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-1604"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1605"></a><span>                           </span><a href="TcRnMonad.html#whenNoErrs"><span class="hs-identifier hs-var">whenNoErrs</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1606"></a><span>                           </span><span class="hs-identifier">MASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-1607"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;Type-correct unfilled coercion hole&quot;</span><span>
</span><a name="line-1608"></a><span>                                     </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1609"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679631005"><a href="#local-6989586621679631005"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630997"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679631000"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1610"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679631006"><a href="#local-6989586621679631006"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679630997"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679631001"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1611"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#mkHoleCo"><span class="hs-identifier hs-var">mkHoleCo</span></a><span> </span><a href="#local-6989586621679630998"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679630999"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679631005"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679631006"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1612"></a><span>
</span><a name="line-1613"></a><span class="hs-identifier">zonk_tycomapper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span>
</span><a name="line-1614"></a><a name="zonk_tycomapper"><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier">zonk_tycomapper</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span>
</span><a name="line-1615"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Establish type invariants</span><span>
</span><a name="line-1616"></a><span>                       </span><span class="hs-comment">-- See Note [Type-checking inside the knot] in TcHsType</span><span>
</span><a name="line-1617"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tyvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier hs-var">zonkTyVarOcc</span></a><span>
</span><a name="line-1618"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_covar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier hs-var">zonkCoVarOcc</span></a><span>
</span><a name="line-1619"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_hole</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkCoHole"><span class="hs-identifier hs-var">zonkCoHole</span></a><span>
</span><a name="line-1620"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679631007"><a href="#local-6989586621679631007"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679631008"><a href="#local-6989586621679631008"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679631009"><a href="#local-6989586621679631009"><span class="hs-identifier">_vis</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-6989586621679631007"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679631008"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1621"></a><span>
</span><a name="line-1622"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-1623"></a><span class="hs-identifier">zonkTcTypeToType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1624"></a><a name="zonkTcTypeToType"><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier">zonkTcTypeToType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier hs-var">zonk_tycomapper</span></a><span>
</span><a name="line-1625"></a><span>
</span><a name="line-1626"></a><span class="hs-identifier">zonkTcTypeToTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1627"></a><a name="zonkTcTypeToTypes"><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier">zonkTcTypeToTypes</span></a></a><span> </span><a name="local-6989586621679631010"><a href="#local-6989586621679631010"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679631011"><a href="#local-6989586621679631011"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-6989586621679631010"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679631011"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1628"></a><span>
</span><a name="line-1629"></a><span class="hs-identifier">zonkCoToCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1630"></a><a name="zonkCoToCo"><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier">zonkCoToCo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier hs-var">zonk_tycomapper</span></a><span>
</span><a name="line-1631"></a><span>
</span><a name="line-1632"></a><span class="hs-identifier">zonkSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1633"></a><span class="hs-comment">-- Zonk the type obtained from a user type signature</span><span>
</span><a name="line-1634"></a><span class="hs-comment">-- We want to turn any quantified (forall'd) variables into TyVars</span><span>
</span><a name="line-1635"></a><span class="hs-comment">-- but we may find some free TcTyVars, and we want to leave them</span><span>
</span><a name="line-1636"></a><span class="hs-comment">-- completely alone.  They may even have unification variables inside</span><span>
</span><a name="line-1637"></a><span class="hs-comment">-- e.g.  f (x::a) = ...(e :: a -&gt; a)....</span><span>
</span><a name="line-1638"></a><span class="hs-comment">-- The type sig for 'e' mentions a free 'a' which will be a</span><span>
</span><a name="line-1639"></a><span class="hs-comment">-- unification SigTv variable.</span><span>
</span><a name="line-1640"></a><a name="zonkSigType"><a href="TcHsSyn.html#zonkSigType"><span class="hs-identifier">zonkSigType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a><span> </span><a href="#local-6989586621679631012"><span class="hs-identifier hs-var">zonk_unbound_tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1641"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1642"></a><span>    </span><span class="hs-identifier">zonk_unbound_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-1643"></a><span>    </span><a name="local-6989586621679631012"><a href="#local-6989586621679631012"><span class="hs-identifier">zonk_unbound_tv</span></a></a><span> </span><a name="local-6989586621679631013"><a href="#local-6989586621679631013"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621679631013"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1644"></a><span>
</span><a name="line-1645"></a><span class="hs-identifier">zonkTvSkolemising</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-1646"></a><span class="hs-comment">-- This variant is used for the LHS of rules</span><span>
</span><a name="line-1647"></a><span class="hs-comment">-- See Note [Zonking the LHS of a RULE].</span><span>
</span><a name="line-1648"></a><a name="zonkTvSkolemising"><a href="TcHsSyn.html#zonkTvSkolemising"><span class="hs-identifier">zonkTvSkolemising</span></a></a><span> </span><a name="local-6989586621679631014"><a href="#local-6989586621679631014"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1649"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679631015"><a href="#local-6989586621679631015"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span> </span><a href="#local-6989586621679631014"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679631014"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1650"></a><span>                  </span><span class="hs-comment">-- NB: the kind of tv is already zonked</span><span>
</span><a name="line-1651"></a><span>             </span><a name="local-6989586621679631016"><a href="#local-6989586621679631016"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621679631015"><span class="hs-identifier hs-var">tv'</span></a><span>
</span><a name="line-1652"></a><span>                  </span><span class="hs-comment">-- Make a proper TyVar (remember we</span><span>
</span><a name="line-1653"></a><span>                  </span><span class="hs-comment">-- are now done with type checking)</span><span>
</span><a name="line-1654"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#writeMetaTyVar"><span class="hs-identifier hs-var">writeMetaTyVar</span></a><span> </span><a href="#local-6989586621679631014"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679631016"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1655"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679631016"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1656"></a><span>
</span><a name="line-1657"></a><span class="hs-identifier">zonkTypeZapping</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-1658"></a><span class="hs-comment">-- This variant is used for everything except the LHS of rules</span><span>
</span><a name="line-1659"></a><span class="hs-comment">-- It zaps unbound type variables to Any, except for RuntimeRep</span><span>
</span><a name="line-1660"></a><span class="hs-comment">-- vars which it zonks to LiftedRep</span><span>
</span><a name="line-1661"></a><span class="hs-comment">-- Works on both types and kinds</span><span>
</span><a name="line-1662"></a><a name="zonkTypeZapping"><a href="TcHsSyn.html#zonkTypeZapping"><span class="hs-identifier">zonkTypeZapping</span></a></a><span> </span><a name="local-6989586621679631017"><a href="#local-6989586621679631017"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1663"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679631018"><a href="#local-6989586621679631018"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isRuntimeRepVar"><span class="hs-identifier hs-var">isRuntimeRepVar</span></a><span> </span><a href="#local-6989586621679631017"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedRepTy"><span class="hs-identifier hs-var">liftedRepTy</span></a><span>
</span><a name="line-1664"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#anyTypeOfKind"><span class="hs-identifier hs-var">anyTypeOfKind</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679631017"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1665"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#writeMetaTyVar"><span class="hs-identifier hs-var">writeMetaTyVar</span></a><span> </span><a href="#local-6989586621679631017"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679631018"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1666"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679631018"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1667"></a><span>
</span><a name="line-1668"></a><span class="hs-comment">---------------------------------------</span><span>
</span><a name="line-1669"></a><span class="hs-comment">{- Note [Zonking the LHS of a RULE]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See also DsBinds Note [Free tyvars on rule LHS]

We need to gather the type variables mentioned on the LHS so we can
quantify over them.  Example:
  data T a = C

  foo :: T a -&gt; Int
  foo C = 1

  {-# RULES &quot;myrule&quot;  foo C = 1 #-}

After type checking the LHS becomes (foo alpha (C alpha)) and we do
not want to zap the unbound meta-tyvar 'alpha' to Any, because that
limits the applicability of the rule.  Instead, we want to quantify
over it!

We do this in two stages.

* During zonking, we skolemise the TcTyVar 'alpha' to TyVar 'a'.  We
  do this by using zonkTvSkolemising as the UnboundTyVarZonker in the
  ZonkEnv.  (This is in fact the whole reason that the ZonkEnv has a
  UnboundTyVarZonker.)

* In DsBinds, we quantify over it.  See DsBinds
  Note [Free tyvars on rule LHS]

Quantifying here is awkward because (a) the data type is big and (b)
finding the free type vars of an expression is necessarily monadic
operation. (consider /\a -&gt; f @ b, where b is side-effected to a)
-}</span><span>
</span><a name="line-1701"></a></pre></body></html>