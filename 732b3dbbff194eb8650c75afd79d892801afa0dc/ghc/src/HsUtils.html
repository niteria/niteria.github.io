<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow, 1992-2006


Here we collect a variety of helper functions that construct or
analyse HsSyn.  All these functions deal with generic HsSyn; functions
which deal with the instantiated versions are located elsewhere:

   Parameterised by     Module
   ----------------     -------------
   RdrName              parser/RdrHsSyn
   Name                 rename/RnHsSyn
   Id                   typecheck/TcHsSyn
-}</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-17"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-18"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-19"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HsUtils</span><span class="hs-special">(</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-comment">-- Terms</span><span>
</span><a name="line-23"></a><span>  </span><a href="HsUtils.html#mkHsPar"><span class="hs-identifier hs-var">mkHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsApp"><span class="hs-identifier hs-var">mkHsApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsAppType"><span class="hs-identifier hs-var">mkHsAppType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsAppTypeOut"><span class="hs-identifier hs-var">mkHsAppTypeOut</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier hs-var">unguardedGRHSs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsIf"><span class="hs-identifier hs-var">mkHsIf</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>  </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapCoR"><span class="hs-identifier hs-var">mkHsWrapCoR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsWrapCo"><span class="hs-identifier hs-var">mkLHsWrapCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier hs-var">mkHsDictLet</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsLams"><span class="hs-identifier hs-var">mkHsLams</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier hs-var">mkHsOpApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsComp"><span class="hs-identifier hs-var">mkHsComp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapPat"><span class="hs-identifier hs-var">mkHsWrapPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapPatCo"><span class="hs-identifier hs-var">mkHsWrapPatCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>  </span><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier hs-var">mkLHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier hs-var">mkHsCmdWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsCmdWrap"><span class="hs-identifier hs-var">mkLHsCmdWrap</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>  </span><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier hs-var">nlHsTyApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyApps"><span class="hs-identifier hs-var">nlHsTyApps</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsDataCon"><span class="hs-identifier hs-var">nlHsDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsSyntaxApps"><span class="hs-identifier hs-var">nlHsSyntaxApps</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><a href="HsUtils.html#nlHsDo"><span class="hs-identifier hs-var">nlHsDo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier hs-var">nlHsOpApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsLam"><span class="hs-identifier hs-var">nlHsLam</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlList"><span class="hs-identifier hs-var">nlList</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#missingTupArg"><span class="hs-identifier hs-var">missingTupArg</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>  </span><a href="HsUtils.html#typeToLHsType"><span class="hs-identifier hs-var">typeToLHsType</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-comment">-- * Constructing general big tuples</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-comment">-- $big_tuples</span><span>
</span><a name="line-40"></a><span>  </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- Bindings</span><span>
</span><a name="line-43"></a><span>  </span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkVarBind"><span class="hs-identifier hs-var">mkVarBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTopFunBind"><span class="hs-identifier hs-var">mkTopFunBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><a href="HsUtils.html#mkPatSynBind"><span class="hs-identifier hs-var">mkPatSynBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="HsUtils.html#isInfixFunBind"><span class="hs-identifier hs-var">isInfixFunBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-comment">-- Literals</span><span>
</span><a name="line-48"></a><span>  </span><a href="HsUtils.html#mkHsIntegral"><span class="hs-identifier hs-var">mkHsIntegral</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsFractional"><span class="hs-identifier hs-var">mkHsFractional</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsIsString"><span class="hs-identifier hs-var">mkHsIsString</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsStringPrimLit"><span class="hs-identifier hs-var">mkHsStringPrimLit</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-comment">-- Patterns</span><span>
</span><a name="line-51"></a><span>  </span><a href="HsUtils.html#mkNPat"><span class="hs-identifier hs-var">mkNPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkNPlusKPat"><span class="hs-identifier hs-var">mkNPlusKPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlLitPat"><span class="hs-identifier hs-var">nlLitPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConVarPatName"><span class="hs-identifier hs-var">nlConVarPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>  </span><a href="HsUtils.html#nlConPatName"><span class="hs-identifier hs-var">nlConPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlInfixConPat"><span class="hs-identifier hs-var">nlInfixConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier hs-var">nlWildConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>  </span><a href="HsUtils.html#nlWildPatName"><span class="hs-identifier hs-var">nlWildPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPatId"><span class="hs-identifier hs-var">nlWildPatId</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkParPat"><span class="hs-identifier hs-var">mkParPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="HsUtils.html#mkBigLHsVarTup"><span class="hs-identifier hs-var">mkBigLHsVarTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier hs-var">mkBigLHsTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsVarPatTup"><span class="hs-identifier hs-var">mkBigLHsVarPatTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier hs-var">mkBigLHsPatTup</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-comment">-- Types</span><span>
</span><a name="line-57"></a><span>  </span><a href="HsTypes.html#mkHsAppTy"><span class="hs-identifier hs-var">mkHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#mkHsAppTys"><span class="hs-identifier hs-var">mkHsAppTys</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#userHsTyVarBndrs"><span class="hs-identifier hs-var">userHsTyVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#userHsLTyVarBndrs"><span class="hs-identifier hs-var">userHsLTyVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>  </span><a href="HsUtils.html#mkLHsSigType"><span class="hs-identifier hs-var">mkLHsSigType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkClassOpSigs"><span class="hs-identifier hs-var">mkClassOpSigs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSigEnv"><span class="hs-identifier hs-var">mkHsSigEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>  </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier hs-var">nlHsFunTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsParTy"><span class="hs-identifier hs-var">nlHsParTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier hs-var">nlHsTyConApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-comment">-- Stmts</span><span>
</span><a name="line-62"></a><span>  </span><a href="HsUtils.html#mkTransformStmt"><span class="hs-identifier hs-var">mkTransformStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTransformByStmt"><span class="hs-identifier hs-var">mkTransformByStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBodyStmt"><span class="hs-identifier hs-var">mkBodyStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier hs-var">mkBindStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTcBindStmt"><span class="hs-identifier hs-var">mkTcBindStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>  </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>  </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkGroupUsingStmt"><span class="hs-identifier hs-var">mkGroupUsingStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkGroupByUsingStmt"><span class="hs-identifier hs-var">mkGroupByUsingStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>  </span><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier hs-var">emptyRecStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#emptyRecStmtName"><span class="hs-identifier hs-var">emptyRecStmtName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#emptyRecStmtId"><span class="hs-identifier hs-var">emptyRecStmtId</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkRecStmt"><span class="hs-identifier hs-var">mkRecStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>  </span><span class="hs-comment">-- Template Haskell</span><span>
</span><a name="line-68"></a><span>  </span><a href="HsUtils.html#mkHsSpliceTy"><span class="hs-identifier hs-var">mkHsSpliceTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSpliceE"><span class="hs-identifier hs-var">mkHsSpliceE</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSpliceTE"><span class="hs-identifier hs-var">mkHsSpliceTE</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier hs-var">mkUntypedSplice</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>  </span><a href="HsUtils.html#mkHsQuasiQuote"><span class="hs-identifier hs-var">mkHsQuasiQuote</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unqualQuasiQuote"><span class="hs-identifier hs-var">unqualQuasiQuote</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>  </span><span class="hs-comment">-- Flags</span><span>
</span><a name="line-72"></a><span>  </span><a href="HsUtils.html#noRebindableInfo"><span class="hs-identifier hs-var">noRebindableInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-comment">-- Collecting binders</span><span>
</span><a name="line-75"></a><span>  </span><a href="HsUtils.html#isUnliftedHsBind"><span class="hs-identifier hs-var">isUnliftedHsBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>  </span><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier hs-var">collectLocalBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier hs-var">collectHsValBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsBindListBinders"><span class="hs-identifier hs-var">collectHsBindListBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>  </span><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier hs-var">collectHsIdBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>  </span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier hs-var">collectHsBindBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectMethodBinders"><span class="hs-identifier hs-var">collectMethodBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>  </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier hs-var">collectPatsBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>  </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectStmtsBinders"><span class="hs-identifier hs-var">collectStmtsBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>  </span><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier hs-var">collectLStmtBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>  </span><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier hs-var">hsLTyClDeclBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier hs-var">hsTyClForeignBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>  </span><a href="HsUtils.html#hsPatSynSelectors"><span class="hs-identifier hs-var">hsPatSynSelectors</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#getPatSynBinds"><span class="hs-identifier hs-var">getPatSynBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>  </span><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier hs-var">hsForeignDeclsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsGroupBinders"><span class="hs-identifier hs-var">hsGroupBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>  </span><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier hs-var">hsDataDefnBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-comment">-- Collecting implicit binders</span><span>
</span><a name="line-90"></a><span>  </span><a href="HsUtils.html#lStmtsImplicits"><span class="hs-identifier hs-var">lStmtsImplicits</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier hs-var">hsValBindsImplicits</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span>
</span><a name="line-91"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="HsDecls.html"><span class="hs-identifier">HsDecls</span></a><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><a href="HsBinds.html"><span class="hs-identifier">HsBinds</span></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="HsExpr.html"><span class="hs-identifier">HsExpr</span></a><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><a href="HsPat.html"><span class="hs-identifier">HsPat</span></a><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="HsTypes.html"><span class="hs-identifier">HsTypes</span></a><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><a href="HsLit.html"><span class="hs-identifier">HsLit</span></a><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><a href="PlaceHolder.html"><span class="hs-identifier">PlaceHolder</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><a href="Constants.html"><span class="hs-identifier">Constants</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Either</span></a><span>
</span><a name="line-125"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span></a><span>
</span><a name="line-126"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Some useful helpers for constructing syntax
*                                                                      *
************************************************************************

These functions attempt to construct a not-completely-useless SrcSpan
from their components, compared with the nl* functions below which
just attach noSrcSpan to everything.
-}</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">mkHsPar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589403"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589403"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-141"></a><a name="mkHsPar"><a href="HsUtils.html#mkHsPar"><span class="hs-identifier">mkHsPar</span></a></a><span> </span><a name="local-6989586621679589404"><a href="#local-6989586621679589404"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589404"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="#local-6989586621679589404"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">mkSimpleMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#NameOrRdrName"><span class="hs-identifier hs-type">NameOrRdrName</span></a><span> </span><a href="#local-6989586621679589401"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589401"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589402"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589401"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621679589401"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589402"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589401"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><a name="mkSimpleMatch"><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier">mkSimpleMatch</span></a></a><span> </span><a name="local-6989586621679589405"><a href="#local-6989586621679589405"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679589406"><a href="#local-6989586621679589406"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679589407"><a href="#local-6989586621679589407"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-147"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589408"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-148"></a><span>    </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="#local-6989586621679589405"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679589406"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier hs-var">unguardedGRHSs</span></a><span> </span><a href="#local-6989586621679589407"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-6989586621679589408"><a href="#local-6989586621679589408"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679589406"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-151"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589407"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-152"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679589409"><a href="#local-6989586621679589409"><span class="hs-identifier">pat</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589409"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589407"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-identifier">unguardedGRHSs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589399"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589400"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="#local-6989586621679589400"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589399"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589400"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><a name="unguardedGRHSs"><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier">unguardedGRHSs</span></a></a><span> </span><a name="local-6989586621679589410"><a href="#local-6989586621679589410"><span class="hs-identifier">rhs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589411"><a href="#local-6989586621679589411"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span> </span><a href="#local-6989586621679589411"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589410"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">unguardedRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589397"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589398"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><a href="#local-6989586621679589398"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589397"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589398"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-159"></a><a name="unguardedRHS"><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier">unguardedRHS</span></a></a><span> </span><a name="local-6989586621679589412"><a href="#local-6989586621679589412"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589413"><a href="#local-6989586621679589413"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589412"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679589413"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-identifier">mkMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589395"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="BasicTypes.html#Origin"><span class="hs-identifier hs-type">Origin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621679589395"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589396"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589395"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="#local-6989586621679589395"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589396"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589395"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><a name="mkMatchGroup"><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier">mkMatchGroup</span></a></a><span> </span><a name="local-6989586621679589414"><a href="#local-6989586621679589414"><span class="hs-identifier">origin</span></a></a><span> </span><a name="local-6989586621679589415"><a href="#local-6989586621679589415"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier hs-var">mkLocatedList</span></a><span> </span><a href="#local-6989586621679589415"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-165"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-167"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589414"><span class="hs-identifier hs-var">origin</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">mkLocatedList</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589394"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589394"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-170"></a><a name="mkLocatedList"><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier">mkLocatedList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-171"></a><span class="hs-identifier">mkLocatedList</span><span> </span><a name="local-6989586621679589416"><a href="#local-6989586621679589416"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-6989586621679589416"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span> </span><a href="#local-6989586621679589416"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589416"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">mkHsApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589393"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589393"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589393"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-174"></a><a name="mkHsApp"><a href="HsUtils.html#mkHsApp"><span class="hs-identifier">mkHsApp</span></a></a><span> </span><a name="local-6989586621679589417"><a href="#local-6989586621679589417"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679589418"><a href="#local-6989586621679589418"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621679589417"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679589418"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-6989586621679589417"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679589418"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-identifier">mkHsAppType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589392"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="#local-6989586621679589392"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589392"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-177"></a><a name="mkHsAppType"><a href="HsUtils.html#mkHsAppType"><span class="hs-identifier">mkHsAppType</span></a></a><span> </span><a name="local-6989586621679589419"><a href="#local-6989586621679589419"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679589420"><a href="#local-6989586621679589420"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621679589419"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621679589420"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppType"><span class="hs-identifier hs-var">HsAppType</span></a><span> </span><a href="#local-6989586621679589419"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679589420"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-identifier">mkHsAppTypeOut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-180"></a><a name="mkHsAppTypeOut"><a href="HsUtils.html#mkHsAppTypeOut"><span class="hs-identifier">mkHsAppTypeOut</span></a></a><span> </span><a name="local-6989586621679589421"><a href="#local-6989586621679589421"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679589422"><a href="#local-6989586621679589422"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621679589421"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621679589422"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppTypeOut"><span class="hs-identifier hs-var">HsAppTypeOut</span></a><span> </span><a href="#local-6989586621679589421"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679589422"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-identifier">mkHsLam</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-183"></a><a name="mkHsLam"><a href="HsUtils.html#mkHsLam"><span class="hs-identifier">mkHsLam</span></a></a><span> </span><a name="local-6989586621679589423"><a href="#local-6989586621679589423"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679589424"><a href="#local-6989586621679589424"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsPar"><span class="hs-identifier hs-var">mkHsPar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589424"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="#local-6989586621679589425"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621679589425"><a href="#local-6989586621679589425"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span>
</span><a name="line-186"></a><span>                           </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><a href="HsExpr.html#LambdaExpr"><span class="hs-identifier hs-var">LambdaExpr</span></a><span> </span><a href="#local-6989586621679589423"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679589424"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">]</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">mkHsLams</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-189"></a><a name="mkHsLams"><a href="HsUtils.html#mkHsLams"><span class="hs-identifier">mkHsLams</span></a></a><span> </span><a name="local-6989586621679589426"><a href="#local-6989586621679589426"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-6989586621679589427"><a href="#local-6989586621679589427"><span class="hs-identifier">dicts</span></a></a><span> </span><a name="local-6989586621679589428"><a href="#local-6989586621679589428"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a><span> </span><a href="#local-6989586621679589426"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-190"></a><span>                                       </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="TcEvidence.html#mkWpLams"><span class="hs-identifier hs-var">mkWpLams</span></a><span> </span><a href="#local-6989586621679589427"><span class="hs-identifier hs-var">dicts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589428"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- |A simple case alternative with a single pattern, no binds, no guards;</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- pre-typechecking</span><span>
</span><a name="line-194"></a><span class="hs-identifier">mkHsCaseAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589390"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589391"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589390"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621679589390"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589391"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589390"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><a name="mkHsCaseAlt"><a href="HsUtils.html#mkHsCaseAlt"><span class="hs-identifier">mkHsCaseAlt</span></a></a><span> </span><a name="local-6989586621679589429"><a href="#local-6989586621679589429"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679589430"><a href="#local-6989586621679589430"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-196"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><a href="HsExpr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589429"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679589430"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-identifier">nlHsTyApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589389"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589389"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-199"></a><a name="nlHsTyApp"><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier">nlHsTyApp</span></a></a><span> </span><a name="local-6989586621679589431"><a href="#local-6989586621679589431"><span class="hs-identifier">fun_id</span></a></a><span> </span><a name="local-6989586621679589432"><a href="#local-6989586621679589432"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpTyApps"><span class="hs-identifier hs-var">mkWpTyApps</span></a><span> </span><a href="#local-6989586621679589432"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589431"><span class="hs-identifier hs-var">fun_id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-identifier">nlHsTyApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589388"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589388"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589388"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-202"></a><a name="nlHsTyApps"><a href="HsUtils.html#nlHsTyApps"><span class="hs-identifier">nlHsTyApps</span></a></a><span> </span><a name="local-6989586621679589433"><a href="#local-6989586621679589433"><span class="hs-identifier">fun_id</span></a></a><span> </span><a name="local-6989586621679589434"><a href="#local-6989586621679589434"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679589435"><a href="#local-6989586621679589435"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier hs-var">nlHsTyApp</span></a><span> </span><a href="#local-6989586621679589433"><span class="hs-identifier hs-var">fun_id</span></a><span> </span><a href="#local-6989586621679589434"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589435"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">--------- Adding parens ---------</span><span>
</span><a name="line-205"></a><span class="hs-identifier">mkLHsPar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589387"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589387"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- Wrap in parens if hsExprNeedsParens says it needs them</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- So   'f x'  becomes '(f x)', but '3' stays as '3'</span><span>
</span><a name="line-208"></a><a name="mkLHsPar"><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier">mkLHsPar</span></a></a><span> </span><a name="local-6989586621679589436"><a href="#local-6989586621679589436"><span class="hs-identifier">le</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589437"><a href="#local-6989586621679589437"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589438"><a href="#local-6989586621679589438"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#hsExprNeedsParens"><span class="hs-identifier hs-var">hsExprNeedsParens</span></a><span> </span><a href="#local-6989586621679589438"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589437"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="#local-6989586621679589436"><span class="hs-identifier hs-var">le</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589436"><span class="hs-identifier hs-var">le</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-identifier">mkParPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589386"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589386"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-212"></a><a name="mkParPat"><a href="HsUtils.html#mkParPat"><span class="hs-identifier">mkParPat</span></a></a><span> </span><a name="local-6989586621679589439"><a href="#local-6989586621679589439"><span class="hs-identifier">lp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589440"><a href="#local-6989586621679589440"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589441"><a href="#local-6989586621679589441"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsPat.html#hsPatNeedsParens"><span class="hs-identifier hs-var">hsPatNeedsParens</span></a><span> </span><a href="#local-6989586621679589441"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589440"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="#local-6989586621679589439"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589439"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-identifier">nlParPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589385"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589385"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-216"></a><a name="nlParPat"><a href="HsUtils.html#nlParPat"><span class="hs-identifier">nlParPat</span></a></a><span> </span><a name="local-6989586621679589442"><a href="#local-6989586621679589442"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="#local-6989586621679589442"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-------------------------------</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- These are the bits of syntax that contain rebindable names</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- See RnEnv.lookupSyntaxName</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-identifier">mkHsIntegral</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-223"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-224"></a><span class="hs-identifier">mkHsFractional</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#FractionalLit"><span class="hs-identifier hs-type">FractionalLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-225"></a><span class="hs-identifier">mkHsIsString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-226"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-227"></a><span class="hs-identifier">mkHsDo</span><span>         </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-228"></a><span class="hs-identifier">mkHsComp</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-229"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-identifier">mkNPat</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-232"></a><span class="hs-identifier">mkNPlusKPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">mkLastStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589382"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="#local-6989586621679589383"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589384"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589383"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589382"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="#local-6989586621679589383"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span class="hs-identifier">mkBodyStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589380"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589381"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589380"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span class="hs-identifier">mkBindStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589377"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589378"><span class="hs-identifier hs-type">idL</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589379"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="#local-6989586621679589377"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589378"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589377"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589379"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="#local-6989586621679589377"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span class="hs-identifier">mkTcBindStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589376"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589376"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-identifier">emptyRecStmt</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589374"><span class="hs-identifier hs-type">idL</span></a><span>  </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="#local-6989586621679589375"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-243"></a><span class="hs-identifier">emptyRecStmtName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>    </span><a href="#local-6989586621679589373"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-244"></a><span class="hs-identifier">emptyRecStmtId</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>   </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>      </span><a href="#local-6989586621679589372"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-245"></a><span class="hs-identifier">mkRecStmt</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="#local-6989586621679589370"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="#local-6989586621679589371"><span class="hs-identifier hs-type">bodyR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589370"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="#local-6989586621679589371"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><a name="mkHsIntegral"><a href="HsUtils.html#mkHsIntegral"><span class="hs-identifier">mkHsIntegral</span></a></a><span> </span><a name="local-6989586621679589443"><a href="#local-6989586621679589443"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679589444"><a href="#local-6989586621679589444"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span>   </span><a href="#local-6989586621679589443"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679589444"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="HsUtils.html#noRebindableInfo"><span class="hs-identifier hs-var">noRebindableInfo</span></a><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-249"></a><a name="mkHsFractional"><a href="HsUtils.html#mkHsFractional"><span class="hs-identifier">mkHsFractional</span></a></a><span>   </span><a name="local-6989586621679589445"><a href="#local-6989586621679589445"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span>     </span><a href="#local-6989586621679589445"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="HsUtils.html#noRebindableInfo"><span class="hs-identifier hs-var">noRebindableInfo</span></a><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-250"></a><a name="mkHsIsString"><a href="HsUtils.html#mkHsIsString"><span class="hs-identifier">mkHsIsString</span></a></a><span> </span><a name="local-6989586621679589446"><a href="#local-6989586621679589446"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679589447"><a href="#local-6989586621679589447"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span>   </span><a href="#local-6989586621679589446"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679589447"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="HsUtils.html#noRebindableInfo"><span class="hs-identifier hs-var">noRebindableInfo</span></a><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-identifier">noRebindableInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span>
</span><a name="line-253"></a><a name="noRebindableInfo"><a href="HsUtils.html#noRebindableInfo"><span class="hs-identifier">noRebindableInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-var">PlaceHolder</span></a><span> </span><span class="hs-comment">-- Just another placeholder;</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><a name="mkHsDo"><a href="HsUtils.html#mkHsDo"><span class="hs-identifier">mkHsDo</span></a></a><span> </span><a name="local-6989586621679589448"><a href="#local-6989586621679589448"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679589449"><a href="#local-6989586621679589449"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a href="#local-6989586621679589448"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier hs-var">mkLocatedList</span></a><span> </span><a href="#local-6989586621679589449"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-256"></a><a name="mkHsComp"><a href="HsUtils.html#mkHsComp"><span class="hs-identifier">mkHsComp</span></a></a><span> </span><a name="local-6989586621679589450"><a href="#local-6989586621679589450"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679589451"><a href="#local-6989586621679589451"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-6989586621679589452"><a href="#local-6989586621679589452"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span> </span><a href="#local-6989586621679589450"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589451"><span class="hs-identifier hs-var">stmts</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589453"><span class="hs-identifier hs-var">last_stmt</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-258"></a><span>    </span><a name="local-6989586621679589453"><a href="#local-6989586621679589453"><span class="hs-identifier">last_stmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589452"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span> </span><a href="#local-6989586621679589452"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-identifier">mkHsIf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589369"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589369"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589369"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589369"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-261"></a><a name="mkHsIf"><a href="HsUtils.html#mkHsIf"><span class="hs-identifier">mkHsIf</span></a></a><span> </span><a name="local-6989586621679589454"><a href="#local-6989586621679589454"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679589455"><a href="#local-6989586621679589455"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679589456"><a href="#local-6989586621679589456"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589454"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679589455"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679589456"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><a name="mkNPat"><a href="HsUtils.html#mkNPat"><span class="hs-identifier">mkNPat</span></a></a><span> </span><a name="local-6989586621679589457"><a href="#local-6989586621679589457"><span class="hs-identifier">lit</span></a></a><span> </span><a name="local-6989586621679589458"><a href="#local-6989586621679589458"><span class="hs-identifier">neg</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><a href="#local-6989586621679589457"><span class="hs-identifier hs-var">lit</span></a><span> </span><a href="#local-6989586621679589458"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-264"></a><a name="mkNPlusKPat"><a href="HsUtils.html#mkNPlusKPat"><span class="hs-identifier">mkNPlusKPat</span></a></a><span> </span><a name="local-6989586621679589459"><a href="#local-6989586621679589459"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679589460"><a href="#local-6989586621679589460"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><a href="#local-6989586621679589459"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679589460"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589460"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-identifier">mkTransformStmt</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589367"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="#local-6989586621679589368"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589367"><span class="hs-identifier hs-type">idR</span></a><span>
</span><a name="line-268"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589368"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589367"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589368"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span class="hs-identifier">mkTransformByStmt</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589365"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="#local-6989586621679589366"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589365"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589365"><span class="hs-identifier hs-type">idR</span></a><span>
</span><a name="line-271"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589366"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589365"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589366"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span class="hs-identifier">mkGroupUsingStmt</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589363"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="#local-6989586621679589364"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589363"><span class="hs-identifier hs-type">idR</span></a><span>
</span><a name="line-274"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589364"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589363"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589364"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span class="hs-identifier">mkGroupByUsingStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589361"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="#local-6989586621679589362"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589361"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589361"><span class="hs-identifier hs-type">idR</span></a><span>
</span><a name="line-277"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589362"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589361"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589362"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-identifier">emptyTransStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589359"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-type">PlaceHolder</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589360"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589359"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589359"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><a name="emptyTransStmt"><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier">emptyTransStmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;emptyTransStmt: form&quot;</span><span>
</span><a name="line-281"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-282"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-283"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-284"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind_arg_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-var">PlaceHolder</span></a><span>
</span><a name="line-285"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-286"></a><a name="mkTransformStmt"><a href="HsUtils.html#mkTransformStmt"><span class="hs-identifier">mkTransformStmt</span></a></a><span>    </span><a name="local-6989586621679589461"><a href="#local-6989586621679589461"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679589462"><a href="#local-6989586621679589462"><span class="hs-identifier">u</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#ThenForm"><span class="hs-identifier hs-var">ThenForm</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589461"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589462"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-287"></a><a name="mkTransformByStmt"><a href="HsUtils.html#mkTransformByStmt"><span class="hs-identifier">mkTransformByStmt</span></a></a><span>  </span><a name="local-6989586621679589463"><a href="#local-6989586621679589463"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679589464"><a href="#local-6989586621679589464"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679589465"><a href="#local-6989586621679589465"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#ThenForm"><span class="hs-identifier hs-var">ThenForm</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589463"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589464"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679589465"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-288"></a><a name="mkGroupUsingStmt"><a href="HsUtils.html#mkGroupUsingStmt"><span class="hs-identifier">mkGroupUsingStmt</span></a></a><span>   </span><a name="local-6989586621679589466"><a href="#local-6989586621679589466"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679589467"><a href="#local-6989586621679589467"><span class="hs-identifier">u</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GroupForm"><span class="hs-identifier hs-var">GroupForm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589466"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589467"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-289"></a><a name="mkGroupByUsingStmt"><a href="HsUtils.html#mkGroupByUsingStmt"><span class="hs-identifier">mkGroupByUsingStmt</span></a></a><span> </span><a name="local-6989586621679589468"><a href="#local-6989586621679589468"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679589469"><a href="#local-6989586621679589469"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679589470"><a href="#local-6989586621679589470"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GroupForm"><span class="hs-identifier hs-var">GroupForm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589468"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589470"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679589469"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><a name="mkLastStmt"><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier">mkLastStmt</span></a></a><span> </span><a name="local-6989586621679589471"><a href="#local-6989586621679589471"><span class="hs-identifier">body</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a href="#local-6989586621679589471"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-292"></a><a name="mkBodyStmt"><a href="HsUtils.html#mkBodyStmt"><span class="hs-identifier">mkBodyStmt</span></a></a><span> </span><a name="local-6989586621679589472"><a href="#local-6989586621679589472"><span class="hs-identifier">body</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a href="#local-6989586621679589472"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-293"></a><a name="mkBindStmt"><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier">mkBindStmt</span></a></a><span> </span><a name="local-6989586621679589473"><a href="#local-6989586621679589473"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679589474"><a href="#local-6989586621679589474"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="#local-6989586621679589473"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589474"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-var">PlaceHolder</span></a><span>
</span><a name="line-294"></a><a name="mkTcBindStmt"><a href="HsUtils.html#mkTcBindStmt"><span class="hs-identifier">mkTcBindStmt</span></a></a><span> </span><a name="local-6989586621679589475"><a href="#local-6989586621679589475"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679589476"><a href="#local-6989586621679589476"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="#local-6989586621679589475"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589476"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span>
</span><a name="line-295"></a><span>  </span><span class="hs-comment">-- don't use placeHolderTypeTc above, because that panics during zonking</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-identifier">emptyRecStmt'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679589356"><a href="#local-6989586621679589356"><span class="hs-identifier">idL</span></a></a><span> </span><a name="local-6989586621679589357"><a href="#local-6989586621679589357"><span class="hs-identifier">idR</span></a></a><span> </span><a name="local-6989586621679589358"><a href="#local-6989586621679589358"><span class="hs-identifier">body</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-298"></a><span>                       </span><a href="PlaceHolder.html#PostTc"><span class="hs-identifier hs-type">PostTc</span></a><span> </span><a href="#local-6989586621679589357"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589356"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589357"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="#local-6989586621679589358"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-299"></a><a name="emptyRecStmt%27"><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier">emptyRecStmt'</span></a></a><span> </span><a name="local-6989586621679589477"><a href="#local-6989586621679589477"><span class="hs-identifier">tyVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-300"></a><span>   </span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span>
</span><a name="line-301"></a><span>     </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-302"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-303"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-304"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-305"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589477"><span class="hs-identifier hs-var">tyVal</span></a><span>
</span><a name="line-306"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-307"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589477"><span class="hs-identifier hs-var">tyVal</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><a name="emptyRecStmt"><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier">emptyRecStmt</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-310"></a><a name="emptyRecStmtName"><a href="HsUtils.html#emptyRecStmtName"><span class="hs-identifier">emptyRecStmtName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-311"></a><a name="emptyRecStmtId"><a href="HsUtils.html#emptyRecStmtId"><span class="hs-identifier">emptyRecStmtId</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span> </span><span class="hs-comment">-- a panic might trigger during zonking</span><span>
</span><a name="line-312"></a><a name="mkRecStmt"><a href="HsUtils.html#mkRecStmt"><span class="hs-identifier">mkRecStmt</span></a></a><span> </span><a name="local-6989586621679589478"><a href="#local-6989586621679589478"><span class="hs-identifier">stmts</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier hs-var">emptyRecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589478"><span class="hs-identifier hs-var">stmts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-------------------------------</span><span>
</span><a name="line-315"></a><span class="hs-comment">--- A useful function for building @OpApps@.  The operator is always a</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- variable, and we don't know the fixity yet.</span><span>
</span><a name="line-317"></a><span class="hs-identifier">mkHsOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589355"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589355"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589355"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589355"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-318"></a><a name="mkHsOpApp"><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier">mkHsOpApp</span></a></a><span> </span><a name="local-6989586621679589479"><a href="#local-6989586621679589479"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679589480"><a href="#local-6989586621679589480"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679589481"><a href="#local-6989586621679589481"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621679589479"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589480"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span>                           </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;mkOpApp:fixity&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589481"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-identifier">unqualSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-322"></a><a name="unqualSplice"><a href="HsUtils.html#unqualSplice"><span class="hs-identifier">unqualSplice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;splice&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">mkUntypedSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsSplice"><span class="hs-identifier hs-type">HsSplice</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-325"></a><a name="mkUntypedSplice"><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier">mkUntypedSplice</span></a></a><span> </span><a name="local-6989586621679589482"><a href="#local-6989586621679589482"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621679589483"><a href="#local-6989586621679589483"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsUntypedSplice"><span class="hs-identifier hs-var">HsUntypedSplice</span></a><span> </span><a href="#local-6989586621679589482"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621679589483"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-identifier">mkHsSpliceE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-328"></a><a name="mkHsSpliceE"><a href="HsUtils.html#mkHsSpliceE"><span class="hs-identifier">mkHsSpliceE</span></a></a><span> </span><a name="local-6989586621679589484"><a href="#local-6989586621679589484"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621679589485"><a href="#local-6989586621679589485"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier hs-var">mkUntypedSplice</span></a><span> </span><a href="#local-6989586621679589484"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="#local-6989586621679589485"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-identifier">mkHsSpliceTE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-331"></a><a name="mkHsSpliceTE"><a href="HsUtils.html#mkHsSpliceTE"><span class="hs-identifier">mkHsSpliceTE</span></a></a><span> </span><a name="local-6989586621679589486"><a href="#local-6989586621679589486"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621679589487"><a href="#local-6989586621679589487"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTypedSplice"><span class="hs-identifier hs-var">HsTypedSplice</span></a><span> </span><a href="#local-6989586621679589486"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621679589487"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-identifier">mkHsSpliceTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-334"></a><a name="mkHsSpliceTy"><a href="HsUtils.html#mkHsSpliceTy"><span class="hs-identifier">mkHsSpliceTy</span></a></a><span> </span><a name="local-6989586621679589488"><a href="#local-6989586621679589488"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621679589489"><a href="#local-6989586621679589489"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-335"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsUntypedSplice"><span class="hs-identifier hs-var">HsUntypedSplice</span></a><span> </span><a href="#local-6989586621679589488"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621679589489"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="PlaceHolder.html#placeHolderKind"><span class="hs-identifier hs-var">placeHolderKind</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-identifier">mkHsQuasiQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsSplice"><span class="hs-identifier hs-type">HsSplice</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-338"></a><a name="mkHsQuasiQuote"><a href="HsUtils.html#mkHsQuasiQuote"><span class="hs-identifier">mkHsQuasiQuote</span></a></a><span> </span><a name="local-6989586621679589490"><a href="#local-6989586621679589490"><span class="hs-identifier">quoter</span></a></a><span> </span><a name="local-6989586621679589491"><a href="#local-6989586621679589491"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621679589492"><a href="#local-6989586621679589492"><span class="hs-identifier">quote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsQuasiQuote"><span class="hs-identifier hs-var">HsQuasiQuote</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621679589490"><span class="hs-identifier hs-var">quoter</span></a><span> </span><a href="#local-6989586621679589491"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621679589492"><span class="hs-identifier hs-var">quote</span></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">unqualQuasiQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-341"></a><a name="unqualQuasiQuote"><a href="HsUtils.html#unqualQuasiQuote"><span class="hs-identifier">unqualQuasiQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;quasiquote&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>                </span><span class="hs-comment">-- A name (uniquified later) to</span><span>
</span><a name="line-343"></a><span>                </span><span class="hs-comment">-- identify the quasi-quote</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-identifier">mkHsString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span>
</span><a name="line-346"></a><a name="mkHsString"><a href="HsUtils.html#mkHsString"><span class="hs-identifier">mkHsString</span></a></a><span> </span><a name="local-6989586621679589493"><a href="#local-6989586621679589493"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-6989586621679589493"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-identifier">mkHsStringPrimLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span>
</span><a name="line-349"></a><a name="mkHsStringPrimLit"><a href="HsUtils.html#mkHsStringPrimLit"><span class="hs-identifier">mkHsStringPrimLit</span></a></a><span> </span><a name="local-6989586621679589494"><a href="#local-6989586621679589494"><span class="hs-identifier">fs</span></a></a><span>
</span><a name="line-350"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#HsStringPrim"><span class="hs-identifier hs-var">HsStringPrim</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fastStringToByteString"><span class="hs-identifier hs-var">fastStringToByteString</span></a><span> </span><a href="#local-6989586621679589494"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-353"></a><span class="hs-identifier">userHsLTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589354"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="#local-6989586621679589354"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-354"></a><span class="hs-comment">-- Caller sets location</span><span>
</span><a name="line-355"></a><a name="userHsLTyVarBndrs"><a href="HsUtils.html#userHsLTyVarBndrs"><span class="hs-identifier">userHsLTyVarBndrs</span></a></a><span> </span><a name="local-6989586621679589495"><a href="#local-6989586621679589495"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589496"><a href="#local-6989586621679589496"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589495"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a href="#local-6989586621679589497"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679589497"><a href="#local-6989586621679589497"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589496"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-identifier">userHsTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589353"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="#local-6989586621679589353"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- Caller sets location</span><span>
</span><a name="line-359"></a><a name="userHsTyVarBndrs"><a href="HsUtils.html#userHsTyVarBndrs"><span class="hs-identifier">userHsTyVarBndrs</span></a></a><span> </span><a name="local-6989586621679589498"><a href="#local-6989586621679589498"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589499"><a href="#local-6989586621679589499"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589498"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589498"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589500"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679589500"><a href="#local-6989586621679589500"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589499"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Constructing syntax with no location info
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">nlHsVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589352"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589352"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-371"></a><a name="nlHsVar"><a href="HsUtils.html#nlHsVar"><span class="hs-identifier">nlHsVar</span></a></a><span> </span><a name="local-6989586621679589501"><a href="#local-6989586621679589501"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589501"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- NB: Only for LHsExpr **Id**</span><span>
</span><a name="line-374"></a><span class="hs-identifier">nlHsDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-375"></a><a name="nlHsDataCon"><a href="HsUtils.html#nlHsDataCon"><span class="hs-identifier">nlHsDataCon</span></a></a><span> </span><a name="local-6989586621679589502"><a href="#local-6989586621679589502"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsConLikeOut"><span class="hs-identifier hs-var">HsConLikeOut</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="#local-6989586621679589502"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-identifier">nlHsLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589351"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-378"></a><a name="nlHsLit"><a href="HsUtils.html#nlHsLit"><span class="hs-identifier">nlHsLit</span></a></a><span> </span><a name="local-6989586621679589503"><a href="#local-6989586621679589503"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="#local-6989586621679589503"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">nlVarPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589350"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589350"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-381"></a><a name="nlVarPat"><a href="HsUtils.html#nlVarPat"><span class="hs-identifier">nlVarPat</span></a></a><span> </span><a name="local-6989586621679589504"><a href="#local-6989586621679589504"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589504"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-identifier">nlLitPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589349"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-384"></a><a name="nlLitPat"><a href="HsUtils.html#nlLitPat"><span class="hs-identifier">nlLitPat</span></a></a><span> </span><a name="local-6989586621679589505"><a href="#local-6989586621679589505"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="#local-6989586621679589505"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span class="hs-identifier">nlHsApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589348"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589348"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589348"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-387"></a><a name="nlHsApp"><a href="HsUtils.html#nlHsApp"><span class="hs-identifier">nlHsApp</span></a></a><span> </span><a name="local-6989586621679589506"><a href="#local-6989586621679589506"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679589507"><a href="#local-6989586621679589507"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-6989586621679589506"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier hs-var">mkLHsPar</span></a><span> </span><a href="#local-6989586621679589507"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-identifier">nlHsSyntaxApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="#local-6989586621679589347"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589347"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589347"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-390"></a><a name="nlHsSyntaxApps"><a href="HsUtils.html#nlHsSyntaxApps"><span class="hs-identifier">nlHsSyntaxApps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589508"><a href="#local-6989586621679589508"><span class="hs-identifier">fun</span></a></a><span>
</span><a name="line-391"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589509"><a href="#local-6989586621679589509"><span class="hs-identifier">arg_wraps</span></a></a><span>
</span><a name="line-392"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589510"><a href="#local-6989586621679589510"><span class="hs-identifier">res_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589511"><a href="#local-6989586621679589511"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-393"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589509"><span class="hs-identifier hs-var">arg_wraps</span></a><span>   </span><span class="hs-comment">-- in the noSyntaxExpr case</span><span>
</span><a name="line-394"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isIdHsWrapper</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">res_wrap</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589508"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589511"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-398"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><a href="#local-6989586621679589510"><span class="hs-identifier hs-var">res_wrap</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589508"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Util.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a><span> </span><span class="hs-string">&quot;nlHsSyntaxApps&quot;</span><span>
</span><a name="line-399"></a><span>                                                     </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><a href="#local-6989586621679589509"><span class="hs-identifier hs-var">arg_wraps</span></a><span> </span><a href="#local-6989586621679589511"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-identifier">nlHsIntLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589346"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-402"></a><a name="nlHsIntLit"><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier">nlHsIntLit</span></a></a><span> </span><a name="local-6989586621679589512"><a href="#local-6989586621679589512"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621679589512"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span class="hs-identifier">nlHsApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589345"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589345"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589345"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-405"></a><a name="nlHsApps"><a href="HsUtils.html#nlHsApps"><span class="hs-identifier">nlHsApps</span></a></a><span> </span><a name="local-6989586621679589513"><a href="#local-6989586621679589513"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679589514"><a href="#local-6989586621679589514"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621679589513"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589514"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-identifier">nlHsVarApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589344"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589344"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589344"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-408"></a><a name="nlHsVarApps"><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier">nlHsVarApps</span></a></a><span> </span><a name="local-6989586621679589515"><a href="#local-6989586621679589515"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679589516"><a href="#local-6989586621679589516"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-6989586621679589517"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589515"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589516"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>                 </span><span class="hs-keyword">where</span><span>
</span><a name="line-410"></a><span>                   </span><a name="local-6989586621679589517"><a href="#local-6989586621679589517"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621679589518"><a href="#local-6989586621679589518"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679589519"><a href="#local-6989586621679589519"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589518"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589519"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-identifier">nlConVarPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-413"></a><a name="nlConVarPat"><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier">nlConVarPat</span></a></a><span> </span><a name="local-6989586621679589520"><a href="#local-6989586621679589520"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679589521"><a href="#local-6989586621679589521"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a><span> </span><a href="#local-6989586621679589520"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621679589521"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-identifier">nlConVarPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-416"></a><a name="nlConVarPatName"><a href="HsUtils.html#nlConVarPatName"><span class="hs-identifier">nlConVarPatName</span></a></a><span> </span><a name="local-6989586621679589522"><a href="#local-6989586621679589522"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679589523"><a href="#local-6989586621679589523"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConPatName"><span class="hs-identifier hs-var">nlConPatName</span></a><span> </span><a href="#local-6989586621679589522"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621679589523"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span class="hs-identifier">nlInfixConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589343"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589343"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589343"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589343"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-419"></a><a name="nlInfixConPat"><a href="HsUtils.html#nlInfixConPat"><span class="hs-identifier">nlInfixConPat</span></a></a><span> </span><a name="local-6989586621679589524"><a href="#local-6989586621679589524"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679589525"><a href="#local-6989586621679589525"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679589526"><a href="#local-6989586621679589526"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589524"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621679589525"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679589526"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-identifier">nlConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-422"></a><a name="nlConPat"><a href="HsUtils.html#nlConPat"><span class="hs-identifier">nlConPat</span></a></a><span> </span><a name="local-6989586621679589527"><a href="#local-6989586621679589527"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679589528"><a href="#local-6989586621679589528"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589527"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621679589528"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-identifier">nlConPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-425"></a><a name="nlConPatName"><a href="HsUtils.html#nlConPatName"><span class="hs-identifier">nlConPatName</span></a></a><span> </span><a name="local-6989586621679589529"><a href="#local-6989586621679589529"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679589530"><a href="#local-6989586621679589530"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589529"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621679589530"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-identifier">nlNullaryConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589342"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589342"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-428"></a><a name="nlNullaryConPat"><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier">nlNullaryConPat</span></a></a><span> </span><a name="local-6989586621679589531"><a href="#local-6989586621679589531"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589531"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-identifier">nlWildConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-431"></a><a name="nlWildConPat"><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier">nlWildConPat</span></a></a><span> </span><a name="local-6989586621679589532"><a href="#local-6989586621679589532"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621679589532"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-432"></a><span>                         </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#nOfThem"><span class="hs-identifier hs-var">nOfThem</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-6989586621679589532"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>                                             </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-identifier">nlWildPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-436"></a><a name="nlWildPat"><a href="HsUtils.html#nlWildPat"><span class="hs-identifier">nlWildPat</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Pre-typechecking</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-identifier">nlWildPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-439"></a><a name="nlWildPatName"><a href="HsUtils.html#nlWildPatName"><span class="hs-identifier">nlWildPatName</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Pre-typechecking</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-identifier">nlWildPatId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-442"></a><a name="nlWildPatId"><a href="HsUtils.html#nlWildPatId"><span class="hs-identifier">nlWildPatId</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="PlaceHolder.html#placeHolderTypeTc"><span class="hs-identifier hs-var">placeHolderTypeTc</span></a><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Post-typechecking</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-identifier">nlHsDo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-445"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-446"></a><a name="nlHsDo"><a href="HsUtils.html#nlHsDo"><span class="hs-identifier">nlHsDo</span></a></a><span> </span><a name="local-6989586621679589533"><a href="#local-6989586621679589533"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679589534"><a href="#local-6989586621679589534"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span> </span><a href="#local-6989586621679589533"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679589534"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span class="hs-identifier">nlHsOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589341"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589341"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589341"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589341"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-449"></a><a name="nlHsOpApp"><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier">nlHsOpApp</span></a></a><span> </span><a name="local-6989586621679589535"><a href="#local-6989586621679589535"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679589536"><a href="#local-6989586621679589536"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679589537"><a href="#local-6989586621679589537"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier hs-var">mkHsOpApp</span></a><span> </span><a href="#local-6989586621679589535"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679589536"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679589537"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-identifier">nlHsLam</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-452"></a><span class="hs-identifier">nlHsPar</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589340"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589340"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-453"></a><span class="hs-identifier">nlHsIf</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589339"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589339"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589339"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589339"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-454"></a><span class="hs-identifier">nlHsCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-455"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-456"></a><span class="hs-identifier">nlList</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><a name="nlHsLam"><a href="HsUtils.html#nlHsLam"><span class="hs-identifier">nlHsLam</span></a></a><span> </span><a name="local-6989586621679589538"><a href="#local-6989586621679589538"><span class="hs-identifier">match</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589538"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-459"></a><a name="nlHsPar"><a href="HsUtils.html#nlHsPar"><span class="hs-identifier">nlHsPar</span></a></a><span> </span><a name="local-6989586621679589539"><a href="#local-6989586621679589539"><span class="hs-identifier">e</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="#local-6989586621679589539"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-comment">-- Note [Rebindable nlHsIf]</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- nlHsIf should generate if-expressions which are NOT subject to</span><span>
</span><a name="line-463"></a><span class="hs-comment">-- RebindableSyntax, so the first field of HsIf is Nothing. (#12080)</span><span>
</span><a name="line-464"></a><a name="nlHsIf"><a href="HsUtils.html#nlHsIf"><span class="hs-identifier">nlHsIf</span></a></a><span> </span><a name="local-6989586621679589540"><a href="#local-6989586621679589540"><span class="hs-identifier">cond</span></a></a><span> </span><a name="local-6989586621679589541"><a href="#local-6989586621679589541"><span class="hs-identifier">true</span></a></a><span> </span><a name="local-6989586621679589542"><a href="#local-6989586621679589542"><span class="hs-identifier">false</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621679589540"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679589541"><span class="hs-identifier hs-var">true</span></a><span> </span><a href="#local-6989586621679589542"><span class="hs-identifier hs-var">false</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><a name="nlHsCase"><a href="HsUtils.html#nlHsCase"><span class="hs-identifier">nlHsCase</span></a></a><span> </span><a name="local-6989586621679589543"><a href="#local-6989586621679589543"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679589544"><a href="#local-6989586621679589544"><span class="hs-identifier">matches</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a href="#local-6989586621679589543"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><a href="#local-6989586621679589544"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-467"></a><a name="nlList"><a href="HsUtils.html#nlList"><span class="hs-identifier">nlList</span></a></a><span> </span><a name="local-6989586621679589545"><a href="#local-6989586621679589545"><span class="hs-identifier">exprs</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621679589545"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-identifier">nlHsAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589338"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589338"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589338"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-470"></a><span class="hs-identifier">nlHsTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589337"><span class="hs-identifier hs-type">name</span></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589337"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-471"></a><span class="hs-identifier">nlHsFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589336"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589336"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589336"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-472"></a><span class="hs-identifier">nlHsParTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589335"><span class="hs-identifier hs-type">name</span></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589335"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><a name="nlHsAppTy"><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier">nlHsAppTy</span></a></a><span> </span><a name="local-6989586621679589546"><a href="#local-6989586621679589546"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679589547"><a href="#local-6989586621679589547"><span class="hs-identifier">t</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a href="#local-6989586621679589546"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679589547"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><a name="nlHsTyVar"><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier">nlHsTyVar</span></a></a><span> </span><a name="local-6989586621679589548"><a href="#local-6989586621679589548"><span class="hs-identifier">x</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="HsTypes.html#NotPromoted"><span class="hs-identifier hs-var">NotPromoted</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621679589548"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-476"></a><a name="nlHsFunTy"><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier">nlHsFunTy</span></a></a><span> </span><a name="local-6989586621679589549"><a href="#local-6989586621679589549"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679589550"><a href="#local-6989586621679589550"><span class="hs-identifier">b</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="#local-6989586621679589549"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679589550"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="nlHsParTy"><a href="HsUtils.html#nlHsParTy"><span class="hs-identifier">nlHsParTy</span></a></a><span> </span><a name="local-6989586621679589551"><a href="#local-6989586621679589551"><span class="hs-identifier">t</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a href="#local-6989586621679589551"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-identifier">nlHsTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589334"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589334"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="#local-6989586621679589334"><span class="hs-identifier hs-type">name</span></a><span>
</span><a name="line-480"></a><a name="nlHsTyConApp"><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier">nlHsTyConApp</span></a></a><span> </span><a name="local-6989586621679589552"><a href="#local-6989586621679589552"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621679589553"><a href="#local-6989586621679589553"><span class="hs-identifier">tys</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><a href="#local-6989586621679589552"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589553"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">{-
Tuples.  All these functions are *pre-typechecker* because they lack
types on the tuple.
-}</span><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span class="hs-identifier">mkLHsTupleExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589333"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589333"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-488"></a><span class="hs-comment">-- Makes a pre-typechecker boxed tuple, deals with 1 case</span><span>
</span><a name="line-489"></a><a name="mkLHsTupleExpr"><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier">mkLHsTupleExpr</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679589554"><a href="#local-6989586621679589554"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589554"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-490"></a><span class="hs-identifier">mkLHsTupleExpr</span><span> </span><a name="local-6989586621679589555"><a href="#local-6989586621679589555"><span class="hs-identifier">es</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589555"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-identifier">mkLHsVarTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589332"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589332"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-493"></a><a name="mkLHsVarTuple"><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier">mkLHsVarTuple</span></a></a><span> </span><a name="local-6989586621679589556"><a href="#local-6989586621679589556"><span class="hs-identifier">ids</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621679589556"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-identifier">nlTuplePat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589331"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589331"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-496"></a><a name="nlTuplePat"><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier">nlTuplePat</span></a></a><span> </span><a name="local-6989586621679589557"><a href="#local-6989586621679589557"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679589558"><a href="#local-6989586621679589558"><span class="hs-identifier">box</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="#local-6989586621679589557"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679589558"><span class="hs-identifier hs-var">box</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span class="hs-identifier">missingTupArg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsTupArg"><span class="hs-identifier hs-type">HsTupArg</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-499"></a><a name="missingTupArg"><a href="HsUtils.html#missingTupArg"><span class="hs-identifier">missingTupArg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589330"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589330"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-502"></a><a name="mkLHsPatTup"><a href="HsUtils.html#mkLHsPatTup"><span class="hs-identifier">mkLHsPatTup</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-503"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679589559"><a href="#local-6989586621679589559"><span class="hs-identifier">lpat</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589559"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-504"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><a name="local-6989586621679589560"><a href="#local-6989586621679589560"><span class="hs-identifier">lpats</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-6989586621679589560"><span class="hs-identifier hs-var">lpats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="#local-6989586621679589560"><span class="hs-identifier hs-var">lpats</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-comment">-- The Big equivalents for the source tuple expressions</span><span>
</span><a name="line-507"></a><span class="hs-identifier">mkBigLHsVarTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589329"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589329"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-508"></a><a name="mkBigLHsVarTup"><a href="HsUtils.html#mkBigLHsVarTup"><span class="hs-identifier">mkBigLHsVarTup</span></a></a><span> </span><a name="local-6989586621679589561"><a href="#local-6989586621679589561"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier hs-var">mkBigLHsTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621679589561"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">mkBigLHsTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589328"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589328"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-511"></a><a name="mkBigLHsTup"><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier">mkBigLHsTup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-comment">-- The Big equivalents for the source tuple patterns</span><span>
</span><a name="line-514"></a><span class="hs-identifier">mkBigLHsVarPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589327"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589327"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-515"></a><a name="mkBigLHsVarPatTup"><a href="HsUtils.html#mkBigLHsVarPatTup"><span class="hs-identifier">mkBigLHsVarPatTup</span></a></a><span> </span><a name="local-6989586621679589562"><a href="#local-6989586621679589562"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier hs-var">mkBigLHsPatTup</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621679589562"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span class="hs-identifier">mkBigLHsPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589326"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589326"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-518"></a><a name="mkBigLHsPatTup"><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier">mkBigLHsPatTup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="HsUtils.html#mkLHsPatTup"><span class="hs-identifier hs-var">mkLHsPatTup</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- $big_tuples</span><span>
</span><a name="line-521"></a><span class="hs-comment">-- #big_tuples#</span><span>
</span><a name="line-522"></a><span class="hs-comment">--</span><span>
</span><a name="line-523"></a><span class="hs-comment">-- GHCs built in tuples can only go up to 'mAX_TUPLE_SIZE' in arity, but</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- we might concievably want to build such a massive tuple as part of the</span><span>
</span><a name="line-525"></a><span class="hs-comment">-- output of a desugaring stage (notably that for list comprehensions).</span><span>
</span><a name="line-526"></a><span class="hs-comment">--</span><span>
</span><a name="line-527"></a><span class="hs-comment">-- We call tuples above this size \&quot;big tuples\&quot;, and emulate them by</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- creating and pattern matching on &gt;nested&lt; tuples that are expressible</span><span>
</span><a name="line-529"></a><span class="hs-comment">-- by GHC.</span><span>
</span><a name="line-530"></a><span class="hs-comment">--</span><span>
</span><a name="line-531"></a><span class="hs-comment">-- Nesting policy: it's better to have a 2-tuple of 10-tuples (3 objects)</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- than a 10-tuple of 2-tuples (11 objects), so we want the leaves of any</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- construction to be big.</span><span>
</span><a name="line-534"></a><span class="hs-comment">--</span><span>
</span><a name="line-535"></a><span class="hs-comment">-- If you just use the 'mkBigCoreTup', 'mkBigCoreVarTupTy', 'mkTupleSelector'</span><span>
</span><a name="line-536"></a><span class="hs-comment">-- and 'mkTupleCase' functions to do all your work with tuples you should be</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- fine, and not have to worry about the arity limitation at all.</span><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-comment">-- | Lifts a \&quot;small\&quot; constructor into a \&quot;big\&quot; constructor by recursive decompositon</span><span>
</span><a name="line-540"></a><span class="hs-identifier">mkChunkified</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679589325"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589325"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^ \&quot;Small\&quot; constructor function, of maximum input arity 'mAX_TUPLE_SIZE'</span><span>
</span><a name="line-541"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589325"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ Possible \&quot;big\&quot; list of things to construct from</span><span>
</span><a name="line-542"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589325"><span class="hs-identifier hs-type">a</span></a><span>               </span><span class="hs-comment">-- ^ Constructed thing made possible by recursive decomposition</span><span>
</span><a name="line-543"></a><a name="mkChunkified"><a href="HsUtils.html#mkChunkified"><span class="hs-identifier">mkChunkified</span></a></a><span> </span><a name="local-6989586621679589563"><a href="#local-6989586621679589563"><span class="hs-identifier">small_tuple</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589565"><span class="hs-identifier hs-var">mk_big_tuple</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-545"></a><span>        </span><span class="hs-comment">-- Each sub-list is short enough to fit in a tuple</span><span>
</span><a name="line-546"></a><span>    </span><a name="local-6989586621679589565"><a href="#local-6989586621679589565"><span class="hs-identifier">mk_big_tuple</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">as</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589563"><span class="hs-identifier hs-var">small_tuple</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-547"></a><span>    </span><span class="hs-identifier">mk_big_tuple</span><span> </span><a name="local-6989586621679589567"><a href="#local-6989586621679589567"><span class="hs-identifier">as_s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589565"><span class="hs-identifier hs-var">mk_big_tuple</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589563"><span class="hs-identifier hs-var">small_tuple</span></a><span> </span><a href="#local-6989586621679589567"><span class="hs-identifier hs-var">as_s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-identifier">chunkify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679589324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-550"></a><span class="hs-comment">-- ^ Split a list into lists that are small enough to have a corresponding</span><span>
</span><a name="line-551"></a><span class="hs-comment">-- tuple arity. The sub-lists of the result all have length &lt;= 'mAX_TUPLE_SIZE'</span><span>
</span><a name="line-552"></a><span class="hs-comment">-- But there may be more than 'mAX_TUPLE_SIZE' sub-lists</span><span>
</span><a name="line-553"></a><a name="chunkify"><a href="HsUtils.html#chunkify"><span class="hs-identifier">chunkify</span></a></a><span> </span><a name="local-6989586621679589568"><a href="#local-6989586621679589568"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-554"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679589569"><span class="hs-identifier hs-var">n_xs</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589568"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-555"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589570"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679589568"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-556"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-557"></a><span>    </span><a name="local-6989586621679589569"><a href="#local-6989586621679589569"><span class="hs-identifier">n_xs</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679589568"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-558"></a><span>    </span><a name="local-6989586621679589570"><a href="#local-6989586621679589570"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-559"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679589571"><a href="#local-6989586621679589571"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><a href="#local-6989586621679589571"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589570"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><a href="#local-6989586621679589571"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        LHsSigType and LHsSigWcType
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-567"></a><span>
</span><a name="line-568"></a><span class="hs-identifier">mkLHsSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-569"></a><a name="mkLHsSigType"><a href="HsUtils.html#mkLHsSigType"><span class="hs-identifier">mkLHsSigType</span></a></a><span> </span><a name="local-6989586621679589572"><a href="#local-6989586621679589572"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span> </span><a href="#local-6989586621679589572"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-identifier">mkLHsSigWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-572"></a><a name="mkLHsSigWcType"><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier">mkLHsSigWcType</span></a></a><span> </span><a name="local-6989586621679589573"><a href="#local-6989586621679589573"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsWildCardBndrs"><span class="hs-identifier hs-var">mkHsWildCardBndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span> </span><a href="#local-6989586621679589573"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-identifier">mkHsSigEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679589323"><a href="#local-6989586621679589323"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-576"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="#local-6989586621679589323"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-577"></a><a name="mkHsSigEnv"><a href="HsUtils.html#mkHsSigEnv"><span class="hs-identifier">mkHsSigEnv</span></a></a><span> </span><a name="local-6989586621679589574"><a href="#local-6989586621679589574"><span class="hs-identifier">get_info</span></a></a><span> </span><a name="local-6989586621679589575"><a href="#local-6989586621679589575"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-578"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a><span>          </span><span class="hs-special">(</span><a href="#local-6989586621679589579"><span class="hs-identifier hs-var">mk_pairs</span></a><span> </span><a href="#local-6989586621679589577"><span class="hs-identifier hs-var">ordinary_sigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>   </span><span class="hs-special">`</span><a href="NameEnv.html#extendNameEnvList"><span class="hs-identifier hs-var">extendNameEnvList</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589579"><span class="hs-identifier hs-var">mk_pairs</span></a><span> </span><a href="#local-6989586621679589576"><span class="hs-identifier hs-var">gen_dm_sigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>   </span><span class="hs-comment">-- The subtlety is this: in a class decl with a</span><span>
</span><a name="line-581"></a><span>   </span><span class="hs-comment">-- default-method signature as well as a method signature</span><span>
</span><a name="line-582"></a><span>   </span><span class="hs-comment">-- we want the latter to win (Trac #12533)</span><span>
</span><a name="line-583"></a><span>   </span><span class="hs-comment">--    class C x where</span><span>
</span><a name="line-584"></a><span>   </span><span class="hs-comment">--       op :: forall a . x a -&gt; x a</span><span>
</span><a name="line-585"></a><span>   </span><span class="hs-comment">--       default op :: forall b . x b -&gt; x b</span><span>
</span><a name="line-586"></a><span>   </span><span class="hs-comment">--       op x = ...(e :: b -&gt; b)...</span><span>
</span><a name="line-587"></a><span>   </span><span class="hs-comment">-- The scoped type variables of the 'default op', namely 'b',</span><span>
</span><a name="line-588"></a><span>   </span><span class="hs-comment">-- scope over the code for op.   The 'forall a' does not!</span><span>
</span><a name="line-589"></a><span>   </span><span class="hs-comment">-- This applies both in the renamer and typechecker, both</span><span>
</span><a name="line-590"></a><span>   </span><span class="hs-comment">-- of which use this function</span><span>
</span><a name="line-591"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-592"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679589576"><a href="#local-6989586621679589576"><span class="hs-identifier">gen_dm_sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589577"><a href="#local-6989586621679589577"><span class="hs-identifier">ordinary_sigs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-6989586621679589578"><span class="hs-identifier hs-var">is_gen_dm_sig</span></a><span> </span><a href="#local-6989586621679589575"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-593"></a><span>    </span><a name="local-6989586621679589578"><a href="#local-6989586621679589578"><span class="hs-identifier">is_gen_dm_sig</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-594"></a><span>    </span><span class="hs-identifier">is_gen_dm_sig</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span>    </span><span class="hs-identifier">mk_pairs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-597"></a><span>    </span><a name="local-6989586621679589579"><a href="#local-6989586621679589579"><span class="hs-identifier">mk_pairs</span></a></a><span> </span><a name="local-6989586621679589580"><a href="#local-6989586621679589580"><span class="hs-identifier">sigs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589583"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><a href="#local-6989586621679589582"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679589581"><a href="#local-6989586621679589581"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><a name="local-6989586621679589582"><a href="#local-6989586621679589582"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589574"><span class="hs-identifier hs-var">get_info</span></a><span> </span><a href="#local-6989586621679589580"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-598"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589583"><a href="#local-6989586621679589583"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589581"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-identifier">mkClassOpSigs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-601"></a><span class="hs-comment">-- Convert TypeSig to ClassOpSig</span><span>
</span><a name="line-602"></a><span class="hs-comment">-- The former is what is parsed, but the latter is</span><span>
</span><a name="line-603"></a><span class="hs-comment">-- what we need in class/instance declarations</span><span>
</span><a name="line-604"></a><a name="mkClassOpSigs"><a href="HsUtils.html#mkClassOpSigs"><span class="hs-identifier">mkClassOpSigs</span></a></a><span> </span><a name="local-6989586621679589584"><a href="#local-6989586621679589584"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-605"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589585"><span class="hs-identifier hs-var">fiddle</span></a><span> </span><a href="#local-6989586621679589584"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-606"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-607"></a><span>    </span><a name="local-6989586621679589585"><a href="#local-6989586621679589585"><span class="hs-identifier">fiddle</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589586"><a href="#local-6989586621679589586"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><a name="local-6989586621679589587"><a href="#local-6989586621679589587"><span class="hs-identifier">nms</span></a></a><span> </span><a name="local-6989586621679589588"><a href="#local-6989586621679589588"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589586"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679589587"><span class="hs-identifier hs-var">nms</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#dropWildCards"><span class="hs-identifier hs-var">dropWildCards</span></a><span> </span><a href="#local-6989586621679589588"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>    </span><span class="hs-identifier">fiddle</span><span> </span><a name="local-6989586621679589589"><a href="#local-6989586621679589589"><span class="hs-identifier">sig</span></a></a><span>                      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589589"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-identifier">typeToLHsType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-611"></a><span class="hs-comment">-- ^ Converting a Type to an HsType RdrName</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- This is needed to implement GeneralizedNewtypeDeriving.</span><span>
</span><a name="line-613"></a><span class="hs-comment">--</span><span>
</span><a name="line-614"></a><span class="hs-comment">-- Note that we use 'getRdrName' extensively, which</span><span>
</span><a name="line-615"></a><span class="hs-comment">-- generates Exact RdrNames rather than strings.</span><span>
</span><a name="line-616"></a><a name="typeToLHsType"><a href="HsUtils.html#typeToLHsType"><span class="hs-identifier">typeToLHsType</span></a></a><span> </span><a name="local-6989586621679589590"><a href="#local-6989586621679589590"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-617"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589590"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-618"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-619"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-620"></a><span>    </span><a name="local-6989586621679589591"><a href="#local-6989586621679589591"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679589593"><a href="#local-6989586621679589593"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679589594"><a href="#local-6989586621679589594"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-6989586621679589594"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-622"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589595"><a href="#local-6989586621679589595"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589596"><a href="#local-6989586621679589596"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitPhiTy"><span class="hs-identifier hs-var">tcSplitPhiTy</span></a><span> </span><a href="#local-6989586621679589593"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-623"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589595"><span class="hs-identifier hs-var">theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589596"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679589597"><a href="#local-6989586621679589597"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679589598"><a href="#local-6989586621679589598"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier hs-var">nlHsFunTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589597"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589598"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679589599"><a href="#local-6989586621679589599"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589600"><a href="#local-6989586621679589600"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589601"><a href="#local-6989586621679589601"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitForAllTys"><span class="hs-identifier hs-var">tcSplitForAllTys</span></a><span> </span><a href="#local-6989586621679589599"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-628"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589592"><span class="hs-identifier hs-var">go_tv</span></a><span> </span><a href="#local-6989586621679589600"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-629"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589601"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679589602"><a href="#local-6989586621679589602"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621679589602"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-631"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679589603"><a href="#local-6989586621679589603"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679589604"><a href="#local-6989586621679589604"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589603"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589604"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-6989586621679589605"><a href="#local-6989586621679589605"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsNumTy"><span class="hs-identifier hs-var">HsNumTy</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621679589605"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-6989586621679589606"><a href="#local-6989586621679589606"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsStrTy"><span class="hs-identifier hs-var">HsStrTy</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621679589606"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679589607"><a href="#local-6989586621679589607"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679589608"><a href="#local-6989586621679589608"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier hs-var">nlHsTyConApp</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621679589607"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589609"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-636"></a><span>         </span><a name="local-6989586621679589609"><a href="#local-6989586621679589609"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span> </span><a href="#local-6989586621679589607"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679589608"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-637"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679589610"><a href="#local-6989586621679589610"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589610"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-638"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679589611"><a href="#local-6989586621679589611"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;toLHsSigWcType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679589611"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span>         </span><span class="hs-comment">-- Source-language types have _invisible_ kind arguments,</span><span>
</span><a name="line-641"></a><span>         </span><span class="hs-comment">-- so we must remove them here (Trac #8563)</span><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span>    </span><span class="hs-identifier">go_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-644"></a><span>    </span><a name="local-6989586621679589592"><a href="#local-6989586621679589592"><span class="hs-identifier">go_tv</span></a></a><span> </span><a name="local-6989586621679589612"><a href="#local-6989586621679589612"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621679589612"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>                                   </span><span class="hs-special">(</span><a href="#local-6989586621679589591"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679589612"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
    --------- HsWrappers: type args, dict args, casts ---------
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-identifier">mkLHsWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589322"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589322"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-655"></a><a name="mkLHsWrap"><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier">mkLHsWrap</span></a></a><span> </span><a name="local-6989586621679589613"><a href="#local-6989586621679589613"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589614"><a href="#local-6989586621679589614"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589615"><a href="#local-6989586621679589615"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589614"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><a href="#local-6989586621679589613"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621679589615"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-identifier">mkHsWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589321"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589321"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-658"></a><a name="mkHsWrap"><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier">mkHsWrap</span></a></a><span> </span><a name="local-6989586621679589616"><a href="#local-6989586621679589616"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621679589617"><a href="#local-6989586621679589617"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621679589616"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589617"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-659"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a href="#local-6989586621679589616"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621679589617"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-660"></a><span>
</span><a name="line-661"></a><span class="hs-identifier">mkHsWrapCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>   </span><span class="hs-comment">-- A Nominal coercion  a ~N b</span><span>
</span><a name="line-662"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589320"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589320"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-663"></a><a name="mkHsWrapCo"><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier">mkHsWrapCo</span></a></a><span> </span><a name="local-6989586621679589618"><a href="#local-6989586621679589618"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679589619"><a href="#local-6989586621679589619"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier hs-var">mkWpCastN</span></a><span> </span><a href="#local-6989586621679589618"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589619"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-identifier">mkHsWrapCoR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>   </span><span class="hs-comment">-- A Representational coercion  a ~R b</span><span>
</span><a name="line-666"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589319"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621679589319"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-667"></a><a name="mkHsWrapCoR"><a href="HsUtils.html#mkHsWrapCoR"><span class="hs-identifier">mkHsWrapCoR</span></a></a><span> </span><a name="local-6989586621679589620"><a href="#local-6989586621679589620"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679589621"><a href="#local-6989586621679589621"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastR"><span class="hs-identifier hs-var">mkWpCastR</span></a><span> </span><a href="#local-6989586621679589620"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589621"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-identifier">mkLHsWrapCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589318"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589318"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-670"></a><a name="mkLHsWrapCo"><a href="HsUtils.html#mkLHsWrapCo"><span class="hs-identifier">mkLHsWrapCo</span></a></a><span> </span><a name="local-6989586621679589622"><a href="#local-6989586621679589622"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589623"><a href="#local-6989586621679589623"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589624"><a href="#local-6989586621679589624"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589623"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a><span> </span><a href="#local-6989586621679589622"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-6989586621679589624"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-identifier">mkHsCmdWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="#local-6989586621679589317"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="#local-6989586621679589317"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-673"></a><a name="mkHsCmdWrap"><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier">mkHsCmdWrap</span></a></a><span> </span><a name="local-6989586621679589625"><a href="#local-6989586621679589625"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679589626"><a href="#local-6989586621679589626"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621679589625"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589626"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-674"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a href="#local-6989586621679589625"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679589626"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-identifier">mkLHsCmdWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="#local-6989586621679589316"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="#local-6989586621679589316"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-677"></a><a name="mkLHsCmdWrap"><a href="HsUtils.html#mkLHsCmdWrap"><span class="hs-identifier">mkLHsCmdWrap</span></a></a><span> </span><a name="local-6989586621679589627"><a href="#local-6989586621679589627"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589628"><a href="#local-6989586621679589628"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589629"><a href="#local-6989586621679589629"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589628"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier hs-var">mkHsCmdWrap</span></a><span> </span><a href="#local-6989586621679589627"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679589629"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-identifier">mkHsWrapPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621679589315"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621679589315"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-680"></a><a name="mkHsWrapPat"><a href="HsUtils.html#mkHsWrapPat"><span class="hs-identifier">mkHsWrapPat</span></a></a><span> </span><a name="local-6989586621679589630"><a href="#local-6989586621679589630"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621679589631"><a href="#local-6989586621679589631"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679589632"><a href="#local-6989586621679589632"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621679589630"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589631"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-681"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a href="#local-6989586621679589630"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621679589631"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679589632"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">mkHsWrapPatCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621679589314"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621679589314"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-684"></a><a name="mkHsWrapPatCo"><a href="HsUtils.html#mkHsWrapPatCo"><span class="hs-identifier">mkHsWrapPatCo</span></a></a><span> </span><a name="local-6989586621679589633"><a href="#local-6989586621679589633"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679589634"><a href="#local-6989586621679589634"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679589635"><a href="#local-6989586621679589635"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span> </span><a href="#local-6989586621679589633"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589634"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-685"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier hs-var">mkWpCastN</span></a><span> </span><a href="#local-6989586621679589633"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589634"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589635"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-identifier">mkHsDictLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-688"></a><a name="mkHsDictLet"><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier">mkHsDictLet</span></a></a><span> </span><a name="local-6989586621679589636"><a href="#local-6989586621679589636"><span class="hs-identifier">ev_binds</span></a></a><span> </span><a name="local-6989586621679589637"><a href="#local-6989586621679589637"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a><span> </span><a href="#local-6989586621679589636"><span class="hs-identifier hs-var">ev_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589637"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">{-
l
************************************************************************
*                                                                      *
                Bindings; with a location at the top
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-698"></a><span>
</span><a name="line-699"></a><span class="hs-identifier">mkFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-700"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-701"></a><span class="hs-comment">-- Not infix, with place holders for coercion and free vars</span><span>
</span><a name="line-702"></a><a name="mkFunBind"><a href="HsUtils.html#mkFunBind"><span class="hs-identifier">mkFunBind</span></a></a><span> </span><a name="local-6989586621679589638"><a href="#local-6989586621679589638"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679589639"><a href="#local-6989586621679589639"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589638"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-703"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><a href="#local-6989586621679589639"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-704"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-705"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bind_fvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#placeHolderNames"><span class="hs-identifier hs-var">placeHolderNames</span></a><span>
</span><a name="line-706"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-707"></a><span>
</span><a name="line-708"></a><span class="hs-identifier">mkTopFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Origin"><span class="hs-identifier hs-type">Origin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-709"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- In Name-land, with empty bind_fvs</span><span>
</span><a name="line-711"></a><a name="mkTopFunBind"><a href="HsUtils.html#mkTopFunBind"><span class="hs-identifier">mkTopFunBind</span></a></a><span> </span><a name="local-6989586621679589640"><a href="#local-6989586621679589640"><span class="hs-identifier">origin</span></a></a><span> </span><a name="local-6989586621679589641"><a href="#local-6989586621679589641"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679589642"><a href="#local-6989586621679589642"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589641"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-712"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="#local-6989586621679589640"><span class="hs-identifier hs-var">origin</span></a><span> </span><a href="#local-6989586621679589642"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-713"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-714"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bind_fvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><span class="hs-comment">-- NB: closed</span><span>
</span><a name="line-715"></a><span>                                                              </span><span class="hs-comment">--     binding</span><span>
</span><a name="line-716"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-identifier">mkHsVarBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-719"></a><a name="mkHsVarBind"><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier">mkHsVarBind</span></a></a><span> </span><a name="local-6989586621679589643"><a href="#local-6989586621679589643"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589644"><a href="#local-6989586621679589644"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621679589645"><a href="#local-6989586621679589645"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-6989586621679589643"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589644"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679589645"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-identifier">mkVarBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679589313"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589313"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="#local-6989586621679589313"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-722"></a><a name="mkVarBind"><a href="HsUtils.html#mkVarBind"><span class="hs-identifier">mkVarBind</span></a></a><span> </span><a name="local-6989586621679589646"><a href="#local-6989586621679589646"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621679589647"><a href="#local-6989586621679589647"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621679589647"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-723"></a><span>                    </span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589646"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589647"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-724"></a><span>
</span><a name="line-725"></a><span class="hs-identifier">mkPatSynBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-727"></a><a name="mkPatSynBind"><a href="HsUtils.html#mkPatSynBind"><span class="hs-identifier">mkPatSynBind</span></a></a><span> </span><a name="local-6989586621679589648"><a href="#local-6989586621679589648"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679589649"><a href="#local-6989586621679589649"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621679589650"><a href="#local-6989586621679589650"><span class="hs-identifier">lpat</span></a></a><span> </span><a name="local-6989586621679589651"><a href="#local-6989586621679589651"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a href="#local-6989586621679589652"><span class="hs-identifier hs-var">psb</span></a><span>
</span><a name="line-728"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-729"></a><span>    </span><a name="local-6989586621679589652"><a href="#local-6989586621679589652"><span class="hs-identifier">psb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589648"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-730"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589649"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-731"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589650"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-732"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589651"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-733"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_fvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#placeHolderNames"><span class="hs-identifier hs-var">placeHolderNames</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-comment">-- |If any of the matches in the 'FunBind' are infix, the 'FunBind' is</span><span>
</span><a name="line-736"></a><span class="hs-comment">-- considered infix.</span><span>
</span><a name="line-737"></a><span class="hs-identifier">isInfixFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621679589311"><span class="hs-identifier hs-type">id1</span></a><span> </span><a href="#local-6989586621679589312"><span class="hs-identifier hs-type">id2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-738"></a><a name="isInfixFunBind"><a href="HsUtils.html#isInfixFunBind"><span class="hs-identifier">isInfixFunBind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><a name="local-6989586621679589653"><a href="#local-6989586621679589653"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#isInfixMatch"><span class="hs-identifier hs-var">isInfixMatch</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589653"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-740"></a><span class="hs-identifier">isInfixFunBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-741"></a><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span class="hs-comment">------------</span><span>
</span><a name="line-744"></a><span class="hs-identifier">mk_easy_FunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-745"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-746"></a><a name="mk_easy_FunBind"><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier">mk_easy_FunBind</span></a></a><span> </span><a name="local-6989586621679589654"><a href="#local-6989586621679589654"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679589655"><a href="#local-6989586621679589655"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679589656"><a href="#local-6989586621679589656"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679589657"><a href="#local-6989586621679589657"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589654"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589654"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589655"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>              </span><span class="hs-special">[</span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589654"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589655"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589656"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679589657"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-749"></a><span>                       </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><span class="hs-comment">------------</span><span>
</span><a name="line-752"></a><span class="hs-identifier">mkMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#NameOrRdrName"><span class="hs-identifier hs-type">NameOrRdrName</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-753"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621679589310"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-754"></a><a name="mkMatch"><a href="HsUtils.html#mkMatch"><span class="hs-identifier">mkMatch</span></a></a><span> </span><a name="local-6989586621679589658"><a href="#local-6989586621679589658"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679589659"><a href="#local-6989586621679589659"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679589660"><a href="#local-6989586621679589660"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679589661"><a href="#local-6989586621679589661"><span class="hs-identifier">lbinds</span></a></a><span>
</span><a name="line-755"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="#local-6989586621679589658"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589662"><span class="hs-identifier hs-var">paren</span></a><span> </span><a href="#local-6989586621679589659"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-756"></a><span>                 </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="#local-6989586621679589660"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589661"><span class="hs-identifier hs-var">lbinds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-758"></a><span>    </span><a name="local-6989586621679589662"><a href="#local-6989586621679589662"><span class="hs-identifier">paren</span></a></a><span> </span><a name="local-6989586621679589663"><a href="#local-6989586621679589663"><span class="hs-identifier">lp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589664"><a href="#local-6989586621679589664"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679589665"><a href="#local-6989586621679589665"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsPat.html#hsPatNeedsParens"><span class="hs-identifier hs-var">hsPatNeedsParens</span></a><span> </span><a href="#local-6989586621679589665"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589664"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="#local-6989586621679589663"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">)</span><span>
</span><a name="line-759"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589663"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-760"></a><span>
</span><a name="line-761"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Collecting binders
*                                                                      *
************************************************************************

Get all the binders in some HsBindGroups, IN THE ORDER OF APPEARANCE. eg.

...
where
  (x, y) = ...
  f i j  = ...
  [a, b] = ...

it should return [x, y, f, a, b] (remember, order important).

Note [Collect binders only after renaming]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
These functions should only be used on HsSyn *after* the renamer,
to return a [Name] or [Id].  Before renaming the record punning
and wild-card mechanism makes it hard to know what is bound.
So these functions should not be applied to (HsSyn RdrName)

Note [Unlifted id check in isHsUnliftedBind]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose there is a binding with the type (Num a =&gt; (# a, a #)). Is this a
strict binding that should be disallowed at the top level? At first glance,
no, because it's a function. But consider how this is desugared via
AbsBinds:

  -- x :: Num a =&gt; (# a, a #)
  x = (# 3, 4 #)

becomes

  x = \ $dictNum -&gt;
      let x_mono = (# fromInteger $dictNum 3, fromInteger $dictNum 4 #) in
      x_mono

Note that the inner let is strict. And thus if we have a bunch of mutually
recursive bindings of this form, we could end up in trouble. This was shown
up in #9140.

But if there is a type signature on x, everything changes because of the
desugaring used by AbsBindsSig:

  x :: Num a =&gt; (# a, a #)
  x = (# 3, 4 #)

becomes

  x = \ $dictNum -&gt; (# fromInteger $dictNum 3, fromInteger $dictNum 4 #)

No strictness anymore! The bottom line here is that, for inferred types, we
care about the strictness of the type after the =&gt;. For checked types
(AbsBindsSig), we care about the overall strictness.

This matters. If we don't separate out the AbsBindsSig case, then GHC runs into
a problem when compiling

  undefined :: forall (r :: RuntimeRep) (a :: TYPE r). HasCallStack =&gt; a

Looking only after the =&gt;, we cannot tell if this is strict or not. (GHC panics
if you try.) Looking at the whole type, on the other hand, tells you that this
is a lifted function type, with no trouble at all.

-}</span><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span class="hs-comment">----------------- Bindings --------------------------</span><span>
</span><a name="line-831"></a><span>
</span><a name="line-832"></a><span class="hs-comment">-- | Should we treat this as an unlifted bind? This will be true for any</span><span>
</span><a name="line-833"></a><span class="hs-comment">-- bind that binds an unlifted variable, but we must be careful around</span><span>
</span><a name="line-834"></a><span class="hs-comment">-- AbsBinds. See Note [Unlifted id check in isUnliftedHsBind]. For usage</span><span>
</span><a name="line-835"></a><span class="hs-comment">-- information, see Note [Strict binds check] is DsBinds.</span><span>
</span><a name="line-836"></a><span class="hs-identifier">isUnliftedHsBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- works only over typechecked binds</span><span>
</span><a name="line-837"></a><a name="isUnliftedHsBind"><a href="HsUtils.html#isUnliftedHsBind"><span class="hs-identifier">isUnliftedHsBind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_sig_export</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589666"><a href="#local-6989586621679589666"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621679589666"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span class="hs-identifier">isUnliftedHsBind</span><span> </span><a name="local-6989586621679589667"><a href="#local-6989586621679589667"><span class="hs-identifier">bind</span></a></a><span>
</span><a name="line-840"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="#local-6989586621679589668"><span class="hs-identifier hs-var">is_unlifted_id</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier hs-var">collectHsBindBinders</span></a><span> </span><a href="#local-6989586621679589667"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-842"></a><span>    </span><a name="local-6989586621679589668"><a href="#local-6989586621679589668"><span class="hs-identifier">is_unlifted_id</span></a></a><span> </span><a name="local-6989586621679589669"><a href="#local-6989586621679589669"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-843"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var">tcSplitSigmaTy</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621679589669"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-844"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679589670"><a href="#local-6989586621679589670"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-6989586621679589670"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-845"></a><span>          </span><span class="hs-comment">-- For the is_unlifted check, we need to look inside polymorphism</span><span>
</span><a name="line-846"></a><span>          </span><span class="hs-comment">-- and overloading.  E.g.  x = (# 1, True #)</span><span>
</span><a name="line-847"></a><span>          </span><span class="hs-comment">-- would get type forall a. Num a =&gt; (# a, Bool #)</span><span>
</span><a name="line-848"></a><span>          </span><span class="hs-comment">-- and we want to reject that.  See Trac #9140</span><span>
</span><a name="line-849"></a><span>
</span><a name="line-850"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsLocalBindsLR"><span class="hs-identifier hs-type">HsLocalBindsLR</span></a><span> </span><a href="#local-6989586621679589308"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589309"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589308"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-851"></a><a name="collectLocalBinders"><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier">collectLocalBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><a name="local-6989586621679589671"><a href="#local-6989586621679589671"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier hs-var">collectHsIdBinders</span></a><span> </span><a href="#local-6989586621679589671"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-852"></a><span>                                         </span><span class="hs-comment">-- No pattern synonyms here</span><span>
</span><a name="line-853"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-854"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-identifier">collectHsIdBinders</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">collectHsValBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><a href="#local-6989586621679589306"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589307"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589306"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-857"></a><span class="hs-comment">-- Collect Id binders only, or Ids + pattern synonyms, respectively</span><span>
</span><a name="line-858"></a><a name="collectHsIdBinders"><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier">collectHsIdBinders</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier hs-var">collect_hs_val_binders</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-859"></a><a name="collectHsValBinders"><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier">collectHsValBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier hs-var">collect_hs_val_binders</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-860"></a><span>
</span><a name="line-861"></a><span class="hs-identifier">collectHsBindBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621679589304"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589305"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589304"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- Collect both Ids and pattern-synonym binders</span><span>
</span><a name="line-863"></a><a name="collectHsBindBinders"><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier">collectHsBindBinders</span></a></a><span> </span><a name="local-6989586621679589672"><a href="#local-6989586621679589672"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679589672"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-864"></a><span>
</span><a name="line-865"></a><span class="hs-identifier">collectHsBindsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="#local-6989586621679589302"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589303"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589302"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-866"></a><a name="collectHsBindsBinders"><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier">collectHsBindsBinders</span></a></a><span> </span><a name="local-6989586621679589673"><a href="#local-6989586621679589673"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679589673"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span class="hs-identifier">collectHsBindListBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LHsBindLR"><span class="hs-identifier hs-type">LHsBindLR</span></a><span> </span><a href="#local-6989586621679589300"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589301"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589300"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-869"></a><span class="hs-comment">-- Same as collectHsBindsBinders, but works over a list of bindings</span><span>
</span><a name="line-870"></a><a name="collectHsBindListBinders"><a href="HsUtils.html#collectHsBindListBinders"><span class="hs-identifier">collectHsBindListBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span class="hs-identifier">collect_hs_val_binders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><a href="#local-6989586621679589298"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589299"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589298"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-873"></a><a name="collect_hs_val_binders"><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier">collect_hs_val_binders</span></a></a><span> </span><a name="local-6989586621679589674"><a href="#local-6989586621679589674"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsIn"><span class="hs-identifier hs-var">ValBindsIn</span></a><span>  </span><a name="local-6989586621679589675"><a href="#local-6989586621679589675"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span>     </span><a href="#local-6989586621679589674"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679589675"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-874"></a><span class="hs-identifier">collect_hs_val_binders</span><span> </span><a name="local-6989586621679589676"><a href="#local-6989586621679589676"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a name="local-6989586621679589677"><a href="#local-6989586621679589677"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_out_binds"><span class="hs-identifier hs-var">collect_out_binds</span></a><span> </span><a href="#local-6989586621679589676"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679589677"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span class="hs-identifier">collect_out_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="#local-6989586621679589297"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589297"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-877"></a><a name="collect_out_binds"><a href="HsUtils.html#collect_out_binds"><span class="hs-identifier">collect_out_binds</span></a></a><span> </span><a name="local-6989586621679589678"><a href="#local-6989586621679589678"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span> </span><a href="#local-6989586621679589678"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-identifier">collect_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="#local-6989586621679589295"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589296"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589295"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589295"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-880"></a><span class="hs-comment">-- Collect Ids, or Ids + pattern synonyms, depending on boolean flag</span><span>
</span><a name="line-881"></a><a name="collect_binds"><a href="HsUtils.html#collect_binds"><span class="hs-identifier">collect_binds</span></a></a><span> </span><a name="local-6989586621679589679"><a href="#local-6989586621679589679"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679589680"><a href="#local-6989586621679589680"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621679589681"><a href="#local-6989586621679589681"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><a href="#local-6989586621679589679"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589681"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679589680"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-882"></a><span>
</span><a name="line-883"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621679589293"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589294"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589293"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589293"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-884"></a><a name="collect_bind"><a href="HsUtils.html#collect_bind"><span class="hs-identifier">collect_bind</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589682"><a href="#local-6989586621679589682"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><a name="local-6989586621679589683"><a href="#local-6989586621679589683"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589682"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679589683"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-885"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589684"><a href="#local-6989586621679589684"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><a name="local-6989586621679589685"><a href="#local-6989586621679589685"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589684"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589685"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-886"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589686"><a href="#local-6989586621679589686"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><a name="local-6989586621679589687"><a href="#local-6989586621679589687"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589686"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589687"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-887"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589688"><a href="#local-6989586621679589688"><span class="hs-identifier">dbinds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589689"><a href="#local-6989586621679589689"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">abe_poly</span><span> </span><a href="#local-6989586621679589688"><span class="hs-identifier hs-var">dbinds</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589689"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-888"></a><span>        </span><span class="hs-comment">-- I don't think we want the binders from the abe_binds</span><span>
</span><a name="line-889"></a><span>        </span><span class="hs-comment">-- The only time we collect binders from a typechecked</span><span>
</span><a name="line-890"></a><span>        </span><span class="hs-comment">-- binding (hence see AbsBinds) is in zonking in TcHsSyn</span><span>
</span><a name="line-891"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_sig_export</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589690"><a href="#local-6989586621679589690"><span class="hs-identifier">poly</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589691"><a href="#local-6989586621679589691"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589690"><span class="hs-identifier hs-var">poly</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589691"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-892"></a><span class="hs-identifier">collect_bind</span><span> </span><a name="local-6989586621679589692"><a href="#local-6989586621679589692"><span class="hs-identifier">omitPatSyn</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589693"><a href="#local-6989586621679589693"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589694"><a href="#local-6989586621679589694"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-893"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679589692"><span class="hs-identifier hs-var">omitPatSyn</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589694"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-894"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589693"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589694"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-895"></a><span>
</span><a name="line-896"></a><span class="hs-identifier">collectMethodBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><a href="#local-6989586621679589292"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-897"></a><span class="hs-comment">-- Used exclusively for the bindings of an instance decl which are all FunBinds</span><span>
</span><a name="line-898"></a><a name="collectMethodBinders"><a href="HsUtils.html#collectMethodBinders"><span class="hs-identifier">collectMethodBinders</span></a></a><span> </span><a name="local-6989586621679589695"><a href="#local-6989586621679589695"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589696"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679589695"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-899"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-900"></a><span>    </span><a name="local-6989586621679589696"><a href="#local-6989586621679589696"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589697"><a href="#local-6989586621679589697"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589698"><a href="#local-6989586621679589698"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589697"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589698"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-901"></a><span>    </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">_</span><span>                        </span><a name="local-6989586621679589699"><a href="#local-6989586621679589699"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589699"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-902"></a><span>       </span><span class="hs-comment">-- Someone else complains about non-FunBinds</span><span>
</span><a name="line-903"></a><span>
</span><a name="line-904"></a><span class="hs-comment">----------------- Statements --------------------------</span><span>
</span><a name="line-905"></a><span class="hs-identifier">collectLStmtsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="#local-6989586621679589289"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589290"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="#local-6989586621679589291"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589289"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-906"></a><a name="collectLStmtsBinders"><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier">collectLStmtsBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier hs-var">collectLStmtBinders</span></a><span>
</span><a name="line-907"></a><span>
</span><a name="line-908"></a><span class="hs-identifier">collectStmtsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589286"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589287"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="#local-6989586621679589288"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589286"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-909"></a><a name="collectStmtsBinders"><a href="HsUtils.html#collectStmtsBinders"><span class="hs-identifier">collectStmtsBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span>
</span><a name="line-910"></a><span>
</span><a name="line-911"></a><span class="hs-identifier">collectLStmtBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="#local-6989586621679589283"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589284"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="#local-6989586621679589285"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589283"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-912"></a><a name="collectLStmtBinders"><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier">collectLStmtBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="#local-6989586621679589280"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621679589281"><span class="hs-identifier hs-type">idR</span></a><span> </span><a href="#local-6989586621679589282"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589280"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>  </span><span class="hs-comment">-- Id Binders for a Stmt... [but what about pattern-sig type vars]?</span><span>
</span><a name="line-916"></a><a name="collectStmtBinders"><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier">collectStmtBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-6989586621679589700"><a href="#local-6989586621679589700"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span> </span><a href="#local-6989586621679589700"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-917"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589701"><a href="#local-6989586621679589701"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier hs-var">collectLocalBinders</span></a><span> </span><a href="#local-6989586621679589701"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-918"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-919"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-920"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a name="local-6989586621679589702"><a href="#local-6989586621679589702"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span>
</span><a name="line-921"></a><span>                                      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589704"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a name="local-6989586621679589703"><a href="#local-6989586621679589703"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589702"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589704"><a href="#local-6989586621679589704"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589703"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-922"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589705"><a href="#local-6989586621679589705"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span> </span><a href="#local-6989586621679589705"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-923"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589706"><a href="#local-6989586621679589706"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span> </span><a href="#local-6989586621679589706"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-924"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-925"></a><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-comment">----------------- Patterns --------------------------</span><span>
</span><a name="line-928"></a><span class="hs-identifier">collectPatBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589279"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589279"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-929"></a><a name="collectPatBinders"><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier">collectPatBinders</span></a></a><span> </span><a name="local-6989586621679589707"><a href="#local-6989586621679589707"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589707"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-930"></a><span>
</span><a name="line-931"></a><span class="hs-identifier">collectPatsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589278"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589278"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-932"></a><a name="collectPatsBinders"><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier">collectPatsBinders</span></a></a><span> </span><a name="local-6989586621679589708"><a href="#local-6989586621679589708"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679589708"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-935"></a><span class="hs-identifier">collect_lpat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621679589277"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589277"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589277"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-936"></a><a name="collect_lpat"><a href="HsUtils.html#collect_lpat"><span class="hs-identifier">collect_lpat</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589709"><a href="#local-6989586621679589709"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679589710"><a href="#local-6989586621679589710"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-937"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589711"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589709"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-938"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-939"></a><span>    </span><a name="local-6989586621679589711"><a href="#local-6989586621679589711"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589712"><a href="#local-6989586621679589712"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589712"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-940"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-941"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-6989586621679589713"><a href="#local-6989586621679589713"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589713"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-942"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-6989586621679589714"><a href="#local-6989586621679589714"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589714"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-943"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589715"><a href="#local-6989586621679589715"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679589716"><a href="#local-6989586621679589716"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589715"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589716"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-944"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589717"><a href="#local-6989586621679589717"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589717"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-945"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span>  </span><a name="local-6989586621679589718"><a href="#local-6989586621679589718"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589718"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621679589719"><a href="#local-6989586621679589719"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679589719"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-948"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-6989586621679589720"><a href="#local-6989586621679589720"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679589720"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-949"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-6989586621679589721"><a href="#local-6989586621679589721"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679589721"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-950"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><a name="local-6989586621679589722"><a href="#local-6989586621679589722"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589722"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-951"></a><span>
</span><a name="line-952"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589723"><a href="#local-6989586621679589723"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsConPatArgs"><span class="hs-identifier hs-var">hsConPatArgs</span></a><span> </span><a href="#local-6989586621679589723"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_args</span><span class="hs-glyph">=</span><a name="local-6989586621679589724"><a href="#local-6989586621679589724"><span class="hs-identifier">ps</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsConPatArgs"><span class="hs-identifier hs-var">hsConPatArgs</span></a><span> </span><a href="#local-6989586621679589724"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>        </span><span class="hs-comment">-- See Note [Dictionary binders in ConPatOut]</span><span>
</span><a name="line-955"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-956"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-957"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589725"><a href="#local-6989586621679589725"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589725"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-958"></a><span>
</span><a name="line-959"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatIn"><span class="hs-identifier hs-var">SigPatIn</span></a><span> </span><a name="local-6989586621679589726"><a href="#local-6989586621679589726"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589726"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-960"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-6989586621679589727"><a href="#local-6989586621679589727"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621679589727"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-961"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589710"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-962"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589728"><a href="#local-6989586621679589728"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589711"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589728"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-963"></a><span>
</span><a name="line-964"></a><span class="hs-comment">{-
Note [Dictionary binders in ConPatOut] See also same Note in DsArrows
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Do *not* gather (a) dictionary and (b) dictionary bindings as binders
of a ConPatOut pattern.  For most calls it doesn't matter, because
it's pre-typechecker and there are no ConPatOuts.  But it does matter
more in the desugarer; for example, DsUtils.mkSelectorBinds uses
collectPatBinders.  In a lazy pattern, for example f ~(C x y) = ...,
we want to generate bindings for x,y but not for dictionaries bound by
C.  (The type checker ensures they would not be used.)

Desugaring of arrow case expressions needs these bindings (see DsArrows
and arrowcase1), but SPJ (Jan 2007) says it's safer for it to use its
own pat-binder-collector:

Here's the problem.  Consider

data T a where
   C :: Num a =&gt; a -&gt; Int -&gt; T a

f ~(C (n+1) m) = (n,m)

Here, the pattern (C (n+1)) binds a hidden dictionary (d::Num a),
and *also* uses that dictionary to match the (n+1) pattern.  Yet, the
variables bound by the lazy pattern are n,m, *not* the dictionary d.
So in mkSelectorBinds in DsUtils, we want just m,n as the variables bound.
-}</span><span>
</span><a name="line-991"></a><span>
</span><a name="line-992"></a><span class="hs-identifier">hsGroupBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-993"></a><a name="hsGroupBinders"><a href="HsUtils.html#hsGroupBinders"><span class="hs-identifier">hsGroupBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsGroup"><span class="hs-identifier hs-var">HsGroup</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hs_valds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589729"><a href="#local-6989586621679589729"><span class="hs-identifier">val_decls</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_tyclds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589730"><a href="#local-6989586621679589730"><span class="hs-identifier">tycl_decls</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-994"></a><span>                          </span><span class="hs-identifier">hs_fords</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589731"><a href="#local-6989586621679589731"><span class="hs-identifier">foreign_decls</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-995"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier hs-var">collectHsValBinders</span></a><span> </span><a href="#local-6989586621679589729"><span class="hs-identifier hs-var">val_decls</span></a><span>
</span><a name="line-996"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier hs-var">hsTyClForeignBinders</span></a><span> </span><a href="#local-6989586621679589730"><span class="hs-identifier hs-var">tycl_decls</span></a><span> </span><a href="#local-6989586621679589731"><span class="hs-identifier hs-var">foreign_decls</span></a><span>
</span><a name="line-997"></a><span>
</span><a name="line-998"></a><span class="hs-identifier">hsTyClForeignBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-999"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1000"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1001"></a><span class="hs-comment">-- We need to look at instance declarations too,</span><span>
</span><a name="line-1002"></a><span class="hs-comment">-- because their associated types may bind data constructors</span><span>
</span><a name="line-1003"></a><a name="hsTyClForeignBinders"><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier">hsTyClForeignBinders</span></a></a><span> </span><a name="local-6989586621679589732"><a href="#local-6989586621679589732"><span class="hs-identifier">tycl_decls</span></a></a><span> </span><a name="local-6989586621679589733"><a href="#local-6989586621679589733"><span class="hs-identifier">foreign_decls</span></a></a><span>
</span><a name="line-1004"></a><span>  </span><span class="hs-glyph">=</span><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier hs-var">hsForeignDeclsBinders</span></a><span> </span><a href="#local-6989586621679589733"><span class="hs-identifier hs-var">foreign_decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1005"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589734"><span class="hs-identifier hs-var">getSelectorNames</span></a><span>
</span><a name="line-1006"></a><span>         </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier hs-var">hsLTyClDeclBinders</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">group_tyclds</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589732"><span class="hs-identifier hs-var">tycl_decls</span></a><span>
</span><a name="line-1007"></a><span>         </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span>
</span><a name="line-1008"></a><span>         </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="HsUtils.html#hsLInstDeclBinders"><span class="hs-identifier hs-var">hsLInstDeclBinders</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">group_instds</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589732"><span class="hs-identifier hs-var">tycl_decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1009"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1010"></a><span>    </span><span class="hs-identifier">getSelectorNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1011"></a><span>    </span><a name="local-6989586621679589734"><a href="#local-6989586621679589734"><span class="hs-identifier">getSelectorNames</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679589735"><a href="#local-6989586621679589735"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589736"><a href="#local-6989586621679589736"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589735"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">selectorFieldOcc</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589736"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1012"></a><span>
</span><a name="line-1013"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1014"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyClDecl"><span class="hs-identifier hs-type">TyClDecl</span></a><span> </span><a href="#local-6989586621679589276"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589276"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589276"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1015"></a><span class="hs-comment">-- ^ Returns all the /binding/ names of the decl.  The first one is</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span class="hs-comment">-- guaranteed to be the name of the decl. The first component</span><span>
</span><a name="line-1018"></a><span class="hs-comment">-- represents all binding names except record fields; the second</span><span>
</span><a name="line-1019"></a><span class="hs-comment">-- represents field occurrences. For record fields mentioned in</span><span>
</span><a name="line-1020"></a><span class="hs-comment">-- multiple constructors, the SrcLoc will be from the first occurrence.</span><span>
</span><a name="line-1021"></a><span class="hs-comment">--</span><span>
</span><a name="line-1022"></a><span class="hs-comment">-- Each returned (Located name) has a SrcSpan for the /whole/ declaration.</span><span>
</span><a name="line-1023"></a><span class="hs-comment">-- See Note [SrcSpan for binders]</span><span>
</span><a name="line-1024"></a><span>
</span><a name="line-1025"></a><a name="hsLTyClDeclBinders"><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier">hsLTyClDeclBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589737"><a href="#local-6989586621679589737"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamDecl"><span class="hs-identifier hs-var">FamDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#FamilyDecl"><span class="hs-identifier hs-var">FamilyDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589738"><a href="#local-6989586621679589738"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589737"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589738"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1027"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589739"><a href="#local-6989586621679589739"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SynDecl"><span class="hs-identifier hs-var">SynDecl</span></a><span>     </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589740"><a href="#local-6989586621679589740"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589739"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589740"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1028"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589741"><a href="#local-6989586621679589741"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClassDecl"><span class="hs-identifier hs-var">ClassDecl</span></a><span>   </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589742"><a href="#local-6989586621679589742"><span class="hs-identifier">cls_name</span></a></a><span>
</span><a name="line-1029"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdSigs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589743"><a href="#local-6989586621679589743"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589744"><a href="#local-6989586621679589744"><span class="hs-identifier">ats</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1030"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589741"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589742"><span class="hs-identifier hs-var">cls_name</span></a><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-1031"></a><span>     </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589745"><span class="hs-identifier hs-var">fam_loc</span></a><span> </span><a href="#local-6989586621679589746"><span class="hs-identifier hs-var">fam_name</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589745"><a href="#local-6989586621679589745"><span class="hs-identifier">fam_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamilyDecl"><span class="hs-identifier hs-var">FamilyDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589746"><a href="#local-6989586621679589746"><span class="hs-identifier">fam_name</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589744"><span class="hs-identifier hs-var">ats</span></a><span> </span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-1032"></a><span>     </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589747"><span class="hs-identifier hs-var">mem_loc</span></a><span> </span><a href="#local-6989586621679589749"><span class="hs-identifier hs-var">mem_name</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589747"><a href="#local-6989586621679589747"><span class="hs-identifier">mem_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679589748"><a href="#local-6989586621679589748"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589743"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589749"><a href="#local-6989586621679589749"><span class="hs-identifier">mem_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589748"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1033"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589750"><a href="#local-6989586621679589750"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataDecl"><span class="hs-identifier hs-var">DataDecl</span></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589751"><a href="#local-6989586621679589751"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589752"><a href="#local-6989586621679589752"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1035"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589753"><a href="#local-6989586621679589753"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589754"><a href="#local-6989586621679589754"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589750"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679589751"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679589753"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589754"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier hs-var">hsDataDefnBinders</span></a><span> </span><a href="#local-6989586621679589752"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1036"></a><span>
</span><a name="line-1037"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1038"></a><span class="hs-identifier">hsForeignDeclsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="#local-6989586621679589275"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589275"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1039"></a><span class="hs-comment">-- See Note [SrcSpan for binders]</span><span>
</span><a name="line-1040"></a><a name="hsForeignDeclsBinders"><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier">hsForeignDeclsBinders</span></a></a><span> </span><a name="local-6989586621679589755"><a href="#local-6989586621679589755"><span class="hs-identifier">foreign_decls</span></a></a><span>
</span><a name="line-1041"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589756"><span class="hs-identifier hs-var">decl_loc</span></a><span> </span><a href="#local-6989586621679589757"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1042"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589756"><a href="#local-6989586621679589756"><span class="hs-identifier">decl_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589757"><a href="#local-6989586621679589757"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589755"><span class="hs-identifier hs-var">foreign_decls</span></a><span class="hs-special">]</span><span>
</span><a name="line-1043"></a><span>
</span><a name="line-1044"></a><span>
</span><a name="line-1045"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1046"></a><span class="hs-identifier">hsPatSynSelectors</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a><span> </span><a href="#local-6989586621679589274"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589274"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1047"></a><span class="hs-comment">-- Collects record pattern-synonym selectors only; the pattern synonym</span><span>
</span><a name="line-1048"></a><span class="hs-comment">-- names are collected by collectHsValBinders.</span><span>
</span><a name="line-1049"></a><a name="hsPatSynSelectors"><a href="HsUtils.html#hsPatSynSelectors"><span class="hs-identifier">hsPatSynSelectors</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsIn"><span class="hs-identifier hs-var">ValBindsIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsPatSynSelectors&quot;</span><span>
</span><a name="line-1050"></a><span class="hs-identifier">hsPatSynSelectors</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a name="local-6989586621679589758"><a href="#local-6989586621679589758"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1051"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="HsUtils.html#addPatSynSelector"><span class="hs-identifier hs-var">addPatSynSelector</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="#local-6989586621679589758"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span class="hs-identifier">addPatSynSelector</span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="#local-6989586621679589273"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589273"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589273"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1054"></a><a name="addPatSynSelector"><a href="HsUtils.html#addPatSynSelector"><span class="hs-identifier">addPatSynSelector</span></a></a><span> </span><a name="local-6989586621679589759"><a href="#local-6989586621679589759"><span class="hs-identifier">bind</span></a></a><span> </span><a name="local-6989586621679589760"><a href="#local-6989586621679589760"><span class="hs-identifier">sels</span></a></a><span>
</span><a name="line-1055"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#RecordPatSyn"><span class="hs-identifier hs-var">RecordPatSyn</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589759"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">recordPatSynSelectorId</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589760"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1057"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589760"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1058"></a><span>
</span><a name="line-1059"></a><span class="hs-identifier">getPatSynBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="#local-6989586621679589272"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="#local-6989586621679589272"><span class="hs-identifier hs-type">id</span></a><span> </span><a href="#local-6989586621679589272"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1060"></a><a name="getPatSynBinds"><a href="HsUtils.html#getPatSynBinds"><span class="hs-identifier">getPatSynBinds</span></a></a><span> </span><a name="local-6989586621679589762"><a href="#local-6989586621679589762"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1061"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679589764"><span class="hs-identifier hs-var">psb</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679589763"><a href="#local-6989586621679589763"><span class="hs-identifier">lbinds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589762"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1062"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a name="local-6989586621679589764"><a href="#local-6989586621679589764"><span class="hs-identifier">psb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="#local-6989586621679589763"><span class="hs-identifier hs-var">lbinds</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1065"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a><span> </span><a href="#local-6989586621679589271"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589271"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589271"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1066"></a><a name="hsLInstDeclBinders"><a href="HsUtils.html#hsLInstDeclBinders"><span class="hs-identifier">hsLInstDeclBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClsInstD"><span class="hs-identifier hs-var">ClsInstD</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#ClsInstDecl"><span class="hs-identifier hs-var">ClsInstDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589765"><a href="#local-6989586621679589765"><span class="hs-identifier">dfis</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1067"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589765"><span class="hs-identifier hs-var">dfis</span></a><span>
</span><a name="line-1068"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstD"><span class="hs-identifier hs-var">DataFamInstD</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589766"><a href="#local-6989586621679589766"><span class="hs-identifier">fi</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1069"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span> </span><a href="#local-6989586621679589766"><span class="hs-identifier hs-var">fi</span></a><span>
</span><a name="line-1070"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstD"><span class="hs-identifier hs-var">TyFamInstD</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1073"></a><span class="hs-comment">-- the SrcLoc returned are for the whole declarations, not just the names</span><span>
</span><a name="line-1074"></a><span class="hs-identifier">hsDataFamInstBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a><span> </span><a href="#local-6989586621679589270"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589270"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589270"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1075"></a><a name="hsDataFamInstBinders"><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier">hsDataFamInstBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-var">DataFamInstDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_defn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589767"><a href="#local-6989586621679589767"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier hs-var">hsDataDefnBinders</span></a><span> </span><a href="#local-6989586621679589767"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1077"></a><span>  </span><span class="hs-comment">-- There can't be repeated symbols because only data instances have binders</span><span>
</span><a name="line-1078"></a><span>
</span><a name="line-1079"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1080"></a><span class="hs-comment">-- the SrcLoc returned are for the whole declarations, not just the names</span><span>
</span><a name="line-1081"></a><span class="hs-identifier">hsDataDefnBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a><span> </span><a href="#local-6989586621679589269"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589269"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589269"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1082"></a><a name="hsDataDefnBinders"><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier">hsDataDefnBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-var">HsDataDefn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589768"><a href="#local-6989586621679589768"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1083"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsConDeclsBinders"><span class="hs-identifier hs-var">hsConDeclsBinders</span></a><span> </span><a href="#local-6989586621679589768"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1084"></a><span>  </span><span class="hs-comment">-- See Note [Binders in family instances]</span><span>
</span><a name="line-1085"></a><span>
</span><a name="line-1086"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1087"></a><span class="hs-identifier">hsConDeclsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="#local-6989586621679589268"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589268"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589268"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><span>  </span><span class="hs-comment">-- See hsLTyClDeclBinders for what this does</span><span>
</span><a name="line-1089"></a><span>  </span><span class="hs-comment">-- The function is boringly complicated because of the records</span><span>
</span><a name="line-1090"></a><span>  </span><span class="hs-comment">-- And since we only have equality, we have to be a little careful</span><span>
</span><a name="line-1091"></a><a name="hsConDeclsBinders"><a href="HsUtils.html#hsConDeclsBinders"><span class="hs-identifier">hsConDeclsBinders</span></a></a><span> </span><a name="local-6989586621679589769"><a href="#local-6989586621679589769"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589770"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679589769"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1092"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589771"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589771"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1093"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="#local-6989586621679589771"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621679589771"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621679589771"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1094"></a><span>        </span><a name="local-6989586621679589770"><a href="#local-6989586621679589770"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1095"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679589772"><a href="#local-6989586621679589772"><span class="hs-identifier">remSeen</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679589773"><a href="#local-6989586621679589773"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679589774"><a href="#local-6989586621679589774"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1096"></a><span>          </span><span class="hs-comment">-- don't re-mangle the location of field names, because we don't</span><span>
</span><a name="line-1097"></a><span>          </span><span class="hs-comment">-- have a record of the full location of the field declaration anyway</span><span>
</span><a name="line-1098"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679589773"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1099"></a><span>             </span><span class="hs-comment">-- remove only the first occurrence of any seen field in order to</span><span>
</span><a name="line-1100"></a><span>             </span><span class="hs-comment">-- avoid circumventing detection of duplicate fields (#9156)</span><span>
</span><a name="line-1101"></a><span>             </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589775"><a href="#local-6989586621679589775"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclGADT"><span class="hs-identifier hs-var">ConDeclGADT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_names</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589776"><a href="#local-6989586621679589776"><span class="hs-identifier">names</span></a></a><span>
</span><a name="line-1102"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589777"><a href="#local-6989586621679589777"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1103"></a><span>               </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679589780"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1104"></a><span>                 </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span>
</span><a name="line-1105"></a><span>                      </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span>
</span><a name="line-1106"></a><span>                            </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppPrefix"><span class="hs-identifier hs-var">HsAppPrefix</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621679589788"><a href="#local-6989586621679589788"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589789"><a href="#local-6989586621679589789"><span class="hs-identifier">_res_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1107"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589781"><span class="hs-identifier hs-var">record_gadt</span></a><span> </span><a href="#local-6989586621679589788"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1108"></a><span>                 </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621679589790"><a href="#local-6989586621679589790"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679589791"><a href="#local-6989586621679589791"><span class="hs-identifier">_res_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589781"><span class="hs-identifier hs-var">record_gadt</span></a><span> </span><a href="#local-6989586621679589790"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><span>                 </span><a name="local-6989586621679589792"><a href="#local-6989586621679589792"><span class="hs-identifier">_other</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589775"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589776"><span class="hs-identifier hs-var">names</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589793"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589794"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1112"></a><span>                            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589793"><a href="#local-6989586621679589793"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589794"><a href="#local-6989586621679589794"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589770"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><a href="#local-6989586621679589774"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1113"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1114"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679589778"><a href="#local-6989586621679589778"><span class="hs-identifier">_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589779"><a href="#local-6989586621679589779"><span class="hs-identifier">_cxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589780"><a href="#local-6989586621679589780"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#splitLHsSigmaTy"><span class="hs-identifier hs-var">splitLHsSigmaTy</span></a><span> </span><a href="#local-6989586621679589777"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-1115"></a><span>                 </span><a name="local-6989586621679589781"><a href="#local-6989586621679589781"><span class="hs-identifier">record_gadt</span></a></a><span> </span><a name="local-6989586621679589782"><a href="#local-6989586621679589782"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589775"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589776"><span class="hs-identifier hs-var">names</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589785"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589783"><span class="hs-identifier hs-var">r'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589786"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><span>                   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679589783"><a href="#local-6989586621679589783"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_names</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589782"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><span>                         </span><a name="local-6989586621679589784"><a href="#local-6989586621679589784"><span class="hs-identifier">remSeen'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span>
</span><a name="line-1118"></a><span>                                        </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span>
</span><a name="line-1119"></a><span>                                              </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">rdrNameFieldOcc</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589787"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1120"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679589787"><a href="#local-6989586621679589787"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589783"><span class="hs-identifier hs-var">r'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1121"></a><span>                         </span><span class="hs-special">(</span><a name="local-6989586621679589785"><a href="#local-6989586621679589785"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589786"><a href="#local-6989586621679589786"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589770"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589784"><span class="hs-identifier hs-var">remSeen'</span></a><span> </span><a href="#local-6989586621679589774"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span>             </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589795"><a href="#local-6989586621679589795"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589796"><a href="#local-6989586621679589796"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-1124"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-6989586621679589797"><a href="#local-6989586621679589797"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1125"></a><span>               </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589795"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589796"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589800"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589798"><span class="hs-identifier hs-var">r'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589801"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1126"></a><span>                  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679589798"><a href="#local-6989586621679589798"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_names</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1127"></a><span>                                                </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589797"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1128"></a><span>                        </span><a name="local-6989586621679589799"><a href="#local-6989586621679589799"><span class="hs-identifier">remSeen'</span></a></a><span>
</span><a name="line-1129"></a><span>                          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span>
</span><a name="line-1130"></a><span>                               </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span>
</span><a name="line-1131"></a><span>                                   </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">rdrNameFieldOcc</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589802"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679589802"><a href="#local-6989586621679589802"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589798"><span class="hs-identifier hs-var">r'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1132"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679589800"><a href="#local-6989586621679589800"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589801"><a href="#local-6989586621679589801"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589770"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589799"><span class="hs-identifier hs-var">remSeen'</span></a><span> </span><a href="#local-6989586621679589774"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1133"></a><span>             </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621679589803"><a href="#local-6989586621679589803"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589804"><a href="#local-6989586621679589804"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1134"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621679589803"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589804"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679589805"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679589806"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><span>                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589805"><a href="#local-6989586621679589805"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589806"><a href="#local-6989586621679589806"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589770"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679589772"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><a href="#local-6989586621679589774"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1136"></a><span>
</span><a name="line-1137"></a><span class="hs-comment">{-

Note [SrcSpan for binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~
When extracting the (Located RdrNme) for a binder, at least for the
main name (the TyCon of a type declaration etc), we want to give it
the @SrcSpan@ of the whole /declaration/, not just the name itself
(which is how it appears in the syntax tree).  This SrcSpan (for the
entire declaration) is used as the SrcSpan for the Name that is
finally produced, and hence for error messages.  (See Trac #8607.)

Note [Binders in family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a type or data family instance declaration, the type
constructor is an *occurrence* not a binding site
    type instance T Int = Int -&gt; Int   -- No binders
    data instance S Bool = S1 | S2     -- Binders are S1,S2


************************************************************************
*                                                                      *
        Collecting binders the user did not write
*                                                                      *
************************************************************************

The job of this family of functions is to run through binding sites and find the set of all Names
that were defined &quot;implicitly&quot;, without being explicitly written by the user.

The main purpose is to find names introduced by record wildcards so that we can avoid
warning the user when they don't use those names (#4404)
-}</span><span>
</span><a name="line-1168"></a><span>
</span><a name="line-1169"></a><span class="hs-identifier">lStmtsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679589266"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589267"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589266"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1170"></a><a name="lStmtsImplicits"><a href="HsUtils.html#lStmtsImplicits"><span class="hs-identifier">lStmtsImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589807"><span class="hs-identifier hs-var">hs_lstmts</span></a><span>
</span><a name="line-1171"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1172"></a><span>    </span><span class="hs-identifier">hs_lstmts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679589810"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589811"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589810"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1173"></a><span>    </span><a name="local-6989586621679589807"><a href="#local-6989586621679589807"><span class="hs-identifier">hs_lstmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679589814"><a href="#local-6989586621679589814"><span class="hs-identifier">stmt</span></a></a><span> </span><a name="local-6989586621679589815"><a href="#local-6989586621679589815"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589808"><span class="hs-identifier hs-var">hs_stmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589814"><span class="hs-identifier hs-var">stmt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679589815"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679589812"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589813"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621679589812"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1176"></a><span>    </span><a name="local-6989586621679589808"><a href="#local-6989586621679589808"><span class="hs-identifier">hs_stmt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-6989586621679589816"><a href="#local-6989586621679589816"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621679589816"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1177"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><a name="local-6989586621679589817"><a href="#local-6989586621679589817"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#unionNameSets"><span class="hs-identifier hs-var">unionNameSets</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679589818"><span class="hs-identifier hs-var">do_arg</span></a><span> </span><a href="#local-6989586621679589817"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679589818"><a href="#local-6989586621679589818"><span class="hs-identifier">do_arg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a name="local-6989586621679589819"><a href="#local-6989586621679589819"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621679589819"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1179"></a><span>            </span><span class="hs-identifier">do_arg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a name="local-6989586621679589820"><a href="#local-6989586621679589820"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589807"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621679589820"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1180"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><a name="local-6989586621679589821"><a href="#local-6989586621679589821"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589809"><span class="hs-identifier hs-var">hs_local_binds</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589821"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1182"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1183"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a name="local-6989586621679589822"><a href="#local-6989586621679589822"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589807"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679589824"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a name="local-6989586621679589823"><a href="#local-6989586621679589823"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589822"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589824"><a href="#local-6989586621679589824"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679589823"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-1184"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589825"><a href="#local-6989586621679589825"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589807"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621679589825"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1185"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589826"><a href="#local-6989586621679589826"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589807"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621679589826"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1186"></a><span>
</span><a name="line-1187"></a><span>    </span><a name="local-6989586621679589809"><a href="#local-6989586621679589809"><span class="hs-identifier">hs_local_binds</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><a name="local-6989586621679589827"><a href="#local-6989586621679589827"><span class="hs-identifier">val_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier hs-var">hsValBindsImplicits</span></a><span> </span><a href="#local-6989586621679589827"><span class="hs-identifier hs-var">val_binds</span></a><span>
</span><a name="line-1188"></a><span>    </span><span class="hs-identifier">hs_local_binds</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1189"></a><span>    </span><span class="hs-identifier">hs_local_binds</span><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1190"></a><span>
</span><a name="line-1191"></a><span class="hs-identifier">hsValBindsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679589265"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1192"></a><a name="hsValBindsImplicits"><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier">hsValBindsImplicits</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a name="local-6989586621679589828"><a href="#local-6989586621679589828"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1193"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier hs-var">lhsBindsImplicits</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><a href="#local-6989586621679589828"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1194"></a><span class="hs-identifier">hsValBindsImplicits</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsIn"><span class="hs-identifier hs-var">ValBindsIn</span></a><span> </span><a name="local-6989586621679589829"><a href="#local-6989586621679589829"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1195"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier hs-var">lhsBindsImplicits</span></a><span> </span><a href="#local-6989586621679589829"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-identifier">lhsBindsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679589264"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1198"></a><a name="lhsBindsImplicits"><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier">lhsBindsImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldBag"><span class="hs-identifier hs-var">foldBag</span></a><span> </span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589830"><span class="hs-identifier hs-var">lhs_bind</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1199"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1200"></a><span>    </span><a name="local-6989586621679589830"><a href="#local-6989586621679589830"><span class="hs-identifier">lhs_bind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679589831"><a href="#local-6989586621679589831"><span class="hs-identifier">lpat</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621679589831"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-1201"></a><span>    </span><span class="hs-identifier">lhs_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1202"></a><span>
</span><a name="line-1203"></a><span class="hs-identifier">lPatImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1204"></a><a name="lPatImplicits"><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier">lPatImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span>
</span><a name="line-1205"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1206"></a><span>    </span><a name="local-6989586621679589832"><a href="#local-6989586621679589832"><span class="hs-identifier">hs_lpat</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589836"><a href="#local-6989586621679589836"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589834"><span class="hs-identifier hs-var">hs_pat</span></a><span> </span><a href="#local-6989586621679589836"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1207"></a><span>
</span><a name="line-1208"></a><span>    </span><a name="local-6989586621679589833"><a href="#local-6989586621679589833"><span class="hs-identifier">hs_lpats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679589837"><a href="#local-6989586621679589837"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679589838"><a href="#local-6989586621679589838"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589837"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679589838"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1209"></a><span>
</span><a name="line-1210"></a><span>    </span><a name="local-6989586621679589834"><a href="#local-6989586621679589834"><span class="hs-identifier">hs_pat</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-6989586621679589839"><a href="#local-6989586621679589839"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589839"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1211"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-6989586621679589840"><a href="#local-6989586621679589840"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589840"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1212"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589841"><a href="#local-6989586621679589841"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589841"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1213"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589842"><a href="#local-6989586621679589842"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589842"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1214"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span>  </span><a name="local-6989586621679589843"><a href="#local-6989586621679589843"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589843"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1215"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621679589844"><a href="#local-6989586621679589844"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589833"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621679589844"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1216"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-6989586621679589845"><a href="#local-6989586621679589845"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589833"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621679589845"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1217"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-6989586621679589846"><a href="#local-6989586621679589846"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589833"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621679589846"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1218"></a><span>
</span><a name="line-1219"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatIn"><span class="hs-identifier hs-var">SigPatIn</span></a><span> </span><a name="local-6989586621679589847"><a href="#local-6989586621679589847"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589847"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1220"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-6989586621679589848"><a href="#local-6989586621679589848"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589848"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1221"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589849"><a href="#local-6989586621679589849"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589834"><span class="hs-identifier hs-var">hs_pat</span></a><span> </span><a href="#local-6989586621679589849"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1222"></a><span>
</span><a name="line-1223"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679589850"><a href="#local-6989586621679589850"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589835"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621679589850"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_args</span><span class="hs-glyph">=</span><a name="local-6989586621679589851"><a href="#local-6989586621679589851"><span class="hs-identifier">ps</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589835"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621679589851"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1225"></a><span>
</span><a name="line-1226"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span>    </span><a name="local-6989586621679589835"><a href="#local-6989586621679589835"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-6989586621679589852"><a href="#local-6989586621679589852"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589833"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621679589852"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1229"></a><span>    </span><span class="hs-identifier">details</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-6989586621679589853"><a href="#local-6989586621679589853"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589833"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621679589854"><span class="hs-identifier hs-var">explicit</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier hs-var">collectPatsBinders</span></a><span> </span><a href="#local-6989586621679589855"><span class="hs-identifier hs-var">implicit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1230"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589854"><a href="#local-6989586621679589854"><span class="hs-identifier">explicit</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589855"><a href="#local-6989586621679589855"><span class="hs-identifier">implicit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#partitionEithers"><span class="hs-identifier hs-var">partitionEithers</span></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679589859"><span class="hs-identifier hs-var">pat_explicit</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-6989586621679589858"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-6989586621679589858"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1231"></a><span>                                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679589856"><a href="#local-6989586621679589856"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679589857"><a href="#local-6989586621679589857"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><a href="#local-6989586621679589853"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1232"></a><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679589858"><a href="#local-6989586621679589858"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span>
</span><a name="line-1233"></a><span>                                                                     </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621679589857"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1234"></a><span>                                                          </span><a name="local-6989586621679589859"><a href="#local-6989586621679589859"><span class="hs-identifier">pat_explicit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679589856"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&lt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rec_dotdot</span><span> </span><a href="#local-6989586621679589853"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1235"></a><span>    </span><span class="hs-identifier">details</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621679589860"><a href="#local-6989586621679589860"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679589861"><a href="#local-6989586621679589861"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589860"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679589832"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621679589861"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1236"></a></pre></body></html>