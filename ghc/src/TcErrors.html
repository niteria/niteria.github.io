<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcErrors</span><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span>       </span><a href="TcErrors.html#reportUnsolved"><span class="hs-identifier hs-var">reportUnsolved</span></a><span class="hs-special">,</span><span> </span><a href="TcErrors.html#reportAllUnsolved"><span class="hs-identifier hs-var">reportAllUnsolved</span></a><span class="hs-special">,</span><span> </span><a href="TcErrors.html#warnAllUnsolved"><span class="hs-identifier hs-var">warnAllUnsolved</span></a><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>       </span><a href="TcErrors.html#warnDefaulting"><span class="hs-identifier hs-var">warnDefaulting</span></a><span class="hs-special">,</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span>       </span><a href="TcErrors.html#solverDepthErrorTcS"><span class="hs-identifier hs-var">solverDepthErrorTcS</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnTypes.html"><span class="hs-identifier">TcRnTypes</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="TcMType.html"><span class="hs-identifier">TcMType</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="RnEnv.html"><span class="hs-identifier">RnEnv</span></a><span class="hs-special">(</span><span> </span><a href="RnEnv.html#unknownNameSuggestions"><span class="hs-identifier hs-var">unknownNameSuggestions</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Kind.html"><span class="hs-identifier">Kind</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Unify.html"><span class="hs-identifier">Unify</span></a><span>            </span><span class="hs-special">(</span><span> </span><a href="Unify.html#tcMatchTys"><span class="hs-identifier hs-var">tcMatchTys</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="FamInst.html"><span class="hs-identifier">FamInst</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="FamInstEnv.html"><span class="hs-identifier">FamInstEnv</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="FamInstEnv.html#flattenTys"><span class="hs-identifier hs-var">flattenTys</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Inst.html"><span class="hs-identifier">Inst</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="InstEnv.html"><span class="hs-identifier">InstEnv</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="HsExpr.html"><span class="hs-identifier">HsExpr</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="HsExpr.html#UnboundVar"><span class="hs-identifier hs-type">UnboundVar</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="HsBinds.html"><span class="hs-identifier">HsBinds</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span>
</span><a name="line-34"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#greSrcSpan"><span class="hs-identifier hs-var">greSrcSpan</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="PrelNames.html#typeableClassName"><span class="hs-identifier hs-var">typeableClassName</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#ptrRepLiftedDataConKey"><span class="hs-identifier hs-var">ptrRepLiftedDataConKey</span></a><span>
</span><a name="line-36"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="PrelNames.html#ptrRepUnliftedDataConKey"><span class="hs-identifier hs-var">ptrRepUnliftedDataConKey</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span class="hs-special">,</span><span> </span><a href="ErrUtils.html#errDoc"><span class="hs-identifier hs-var">errDoc</span></a><span class="hs-special">,</span><span> </span><a href="ErrUtils.html#pprLocErrMsg"><span class="hs-identifier hs-var">pprLocErrMsg</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="StaticFlags.html"><span class="hs-identifier">StaticFlags</span></a><span>      </span><span class="hs-special">(</span><span> </span><a href="StaticFlags.html#opt_PprStyle_Debug"><span class="hs-identifier hs-var">opt_PprStyle_Debug</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="ListSetOps.html#equivClasses"><span class="hs-identifier hs-var">equivClasses</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../containers-0.5.7.1/src/%{MODULE/./-}.html#%{NAME}/Data.Set.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Semigroup</span><span>
</span><a name="line-63"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\section{Errors and contexts}
*                                                                      *
************************************************************************

ToDo: for these error messages, should we note the location as coming
from the insts, or just whatever seems to be around in the monad just
now?

Note [Deferring coercion errors to runtime]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
While developing, sometimes it is desirable to allow compilation to succeed even
if there are type errors in the code. Consider the following case:

  module Main where

  a :: Int
  a = 'a'

  main = print &quot;b&quot;

Even though `a` is ill-typed, it is not used in the end, so if all that we're
interested in is `main` it is handy to be able to ignore the problems in `a`.

Since we treat type equalities as evidence, this is relatively simple. Whenever
we run into a type mismatch in TcUnify, we normally just emit an error. But it
is always safe to defer the mismatch to the main constraint solver. If we do
that, `a` will get transformed into

  co :: Int ~ Char
  co = ...

  a :: Int
  a = 'a' `cast` co

The constraint solver would realize that `co` is an insoluble constraint, and
emit an error with `reportUnsolved`. But we can also replace the right-hand side
of `co` with `error &quot;Deferred type error: Int ~ Char&quot;`. This allows the program
to compile, and it will run fine unless we evaluate `a`. This is what
`deferErrorsToRuntime` does.

It does this by keeping track of which errors correspond to which coercion
in TcErrors. TcErrors.reportTidyWanteds does not print the errors
and does not fail if -fdefer-type-errors is on, so that we can continue
compilation. The errors are turned into warnings in `reportUnsolved`.
-}</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | Report unsolved goals as errors or warnings. We may also turn some into</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- deferred run-time errors if `-fdefer-type-errors` is on.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">reportUnsolved</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="reportUnsolved"><a href="TcErrors.html#reportUnsolved"><span class="hs-identifier">reportUnsolved</span></a></a><span> </span><a name="local-1628045096"><a href="#local-1628045096"><span class="hs-identifier">wanted</span></a></a><span>
</span><a name="line-119"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045097"><a href="#local-1628045097"><span class="hs-identifier">binds_var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newTcEvBinds"><span class="hs-identifier hs-var">newTcEvBinds</span></a><span>
</span><a name="line-120"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045098"><a href="#local-1628045098"><span class="hs-identifier">defer_errors</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#goptM"><span class="hs-identifier hs-var">goptM</span></a><span> </span><a href="DynFlags.html#Opt_DeferTypeErrors"><span class="hs-identifier hs-var">Opt_DeferTypeErrors</span></a><span>
</span><a name="line-121"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045099"><a href="#local-1628045099"><span class="hs-identifier">warn_errors</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnDeferredTypeErrors"><span class="hs-identifier hs-var">Opt_WarnDeferredTypeErrors</span></a><span> </span><span class="hs-comment">-- implement #10283</span><span>
</span><a name="line-122"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045100"><a href="#local-1628045100"><span class="hs-identifier">type_errors</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045098"><span class="hs-identifier hs-var">defer_errors</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#TypeError"><span class="hs-identifier hs-var">TypeError</span></a><span>
</span><a name="line-123"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045099"><span class="hs-identifier hs-var">warn_errors</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#TypeWarn"><span class="hs-identifier hs-var">TypeWarn</span></a><span>
</span><a name="line-124"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#TypeDefer"><span class="hs-identifier hs-var">TypeDefer</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045101"><a href="#local-1628045101"><span class="hs-identifier">defer_holes</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#goptM"><span class="hs-identifier hs-var">goptM</span></a><span> </span><a href="DynFlags.html#Opt_DeferTypedHoles"><span class="hs-identifier hs-var">Opt_DeferTypedHoles</span></a><span>
</span><a name="line-127"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045102"><a href="#local-1628045102"><span class="hs-identifier">warn_holes</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnTypedHoles"><span class="hs-identifier hs-var">Opt_WarnTypedHoles</span></a><span>
</span><a name="line-128"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045103"><a href="#local-1628045103"><span class="hs-identifier">expr_holes</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045101"><span class="hs-identifier hs-var">defer_holes</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span>
</span><a name="line-129"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045102"><span class="hs-identifier hs-var">warn_holes</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span>
</span><a name="line-130"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleDefer"><span class="hs-identifier hs-var">HoleDefer</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045104"><a href="#local-1628045104"><span class="hs-identifier">partial_sigs</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#PartialTypeSignatures"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">PartialTypeSignatures</span></a><span>
</span><a name="line-133"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045105"><a href="#local-1628045105"><span class="hs-identifier">warn_partial_sigs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnPartialTypeSignatures"><span class="hs-identifier hs-var">Opt_WarnPartialTypeSignatures</span></a><span>
</span><a name="line-134"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045106"><a href="#local-1628045106"><span class="hs-identifier">type_holes</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045104"><span class="hs-identifier hs-var">partial_sigs</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span>
</span><a name="line-135"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045105"><span class="hs-identifier hs-var">warn_partial_sigs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span>
</span><a name="line-136"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#HoleDefer"><span class="hs-identifier hs-var">HoleDefer</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#report_unsolved"><span class="hs-identifier hs-var">report_unsolved</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628045097"><span class="hs-identifier hs-var">binds_var</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-1628045100"><span class="hs-identifier hs-var">type_errors</span></a><span> </span><a href="#local-1628045103"><span class="hs-identifier hs-var">expr_holes</span></a><span> </span><a href="#local-1628045106"><span class="hs-identifier hs-var">type_holes</span></a><span> </span><a href="#local-1628045096"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-139"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#getTcEvBinds"><span class="hs-identifier hs-var">getTcEvBinds</span></a><span> </span><a href="#local-1628045097"><span class="hs-identifier hs-var">binds_var</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- | Report *all* unsolved goals as errors, even if -fdefer-type-errors is on</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- However, do not make any evidence bindings, because we don't</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- have any convenient place to put them.</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- See Note [Deferring coercion errors to runtime]</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- Used by solveEqualities for kind equalities</span><span>
</span><a name="line-146"></a><span class="hs-comment">--      (see Note [Fail fast on kind errors] in TcSimplify]</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- and for simplifyDefault.</span><span>
</span><a name="line-148"></a><span class="hs-identifier">reportAllUnsolved</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><a name="reportAllUnsolved"><a href="TcErrors.html#reportAllUnsolved"><span class="hs-identifier">reportAllUnsolved</span></a></a><span> </span><a name="local-1628045107"><a href="#local-1628045107"><span class="hs-identifier">wanted</span></a></a><span>
</span><a name="line-150"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#report_unsolved"><span class="hs-identifier hs-var">report_unsolved</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="TcErrors.html#TypeError"><span class="hs-identifier hs-var">TypeError</span></a><span> </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><a href="#local-1628045107"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Report all unsolved goals as warnings (but without deferring any errors to</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- run-time). See Note [Safe Haskell Overlapping Instances Implementation] in</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- TcSimplify</span><span>
</span><a name="line-155"></a><span class="hs-identifier">warnAllUnsolved</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><a name="warnAllUnsolved"><a href="TcErrors.html#warnAllUnsolved"><span class="hs-identifier">warnAllUnsolved</span></a></a><span> </span><a name="local-1628045108"><a href="#local-1628045108"><span class="hs-identifier">wanted</span></a></a><span>
</span><a name="line-157"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#report_unsolved"><span class="hs-identifier hs-var">report_unsolved</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="TcErrors.html#TypeWarn"><span class="hs-identifier hs-var">TypeWarn</span></a><span> </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span> </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span> </span><a href="#local-1628045108"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | Report unsolved goals as errors or warnings.</span><span>
</span><a name="line-160"></a><span class="hs-identifier">report_unsolved</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span>  </span><span class="hs-comment">-- cec_binds</span><span>
</span><a name="line-161"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>              </span><span class="hs-comment">-- Errors as warnings</span><span>
</span><a name="line-162"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#TypeErrorChoice"><span class="hs-identifier hs-type">TypeErrorChoice</span></a><span>   </span><span class="hs-comment">-- Deferred type errors</span><span>
</span><a name="line-163"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#HoleChoice"><span class="hs-identifier hs-type">HoleChoice</span></a><span>        </span><span class="hs-comment">-- Expression holes</span><span>
</span><a name="line-164"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#HoleChoice"><span class="hs-identifier hs-type">HoleChoice</span></a><span>        </span><span class="hs-comment">-- Type holes</span><span>
</span><a name="line-165"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><a name="report_unsolved"><a href="TcErrors.html#report_unsolved"><span class="hs-identifier">report_unsolved</span></a></a><span> </span><a name="local-1628045109"><a href="#local-1628045109"><span class="hs-identifier">mb_binds_var</span></a></a><span> </span><a name="local-1628045110"><a href="#local-1628045110"><span class="hs-identifier">err_as_warn</span></a></a><span> </span><a name="local-1628045111"><a href="#local-1628045111"><span class="hs-identifier">type_errors</span></a></a><span> </span><a name="local-1628045112"><a href="#local-1628045112"><span class="hs-identifier">expr_holes</span></a></a><span> </span><a name="local-1628045113"><a href="#local-1628045113"><span class="hs-identifier">type_holes</span></a></a><span> </span><a name="local-1628045114"><a href="#local-1628045114"><span class="hs-identifier">wanted</span></a></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#isEmptyWC"><span class="hs-identifier hs-var">isEmptyWC</span></a><span> </span><a href="#local-1628045114"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-170"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;reportUnsolved (before zonking and tidying)&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045114"><span class="hs-identifier hs-var">wanted</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045115"><a href="#local-1628045115"><span class="hs-identifier">wanted</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkWC"><span class="hs-identifier hs-var">zonkWC</span></a><span> </span><a href="#local-1628045114"><span class="hs-identifier hs-var">wanted</span></a><span>   </span><span class="hs-comment">-- Zonk to reveal all information</span><span>
</span><a name="line-173"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045116"><a href="#local-1628045116"><span class="hs-identifier">env0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#tcInitTidyEnv"><span class="hs-identifier hs-var">tcInitTidyEnv</span></a><span>
</span><a name="line-174"></a><span>            </span><span class="hs-comment">-- If we are deferring we are going to need /all/ evidence around,</span><span>
</span><a name="line-175"></a><span>            </span><span class="hs-comment">-- including the evidence produced by unflattening (zonkWC)</span><span>
</span><a name="line-176"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045117"><a href="#local-1628045117"><span class="hs-identifier">tidy_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a><span> </span><a href="#local-1628045116"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628045118"><span class="hs-identifier hs-var">free_tvs</span></a><span>
</span><a name="line-177"></a><span>             </span><a name="local-1628045118"><a href="#local-1628045118"><span class="hs-identifier">free_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfWC"><span class="hs-identifier hs-var">tyCoVarsOfWC</span></a><span> </span><a href="#local-1628045115"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;reportUnsolved (after zonking and tidying):&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-180"></a><span>         </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TyCoRep.html#pprTvBndrs"><span class="hs-identifier hs-var">pprTvBndrs</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="#local-1628045118"><span class="hs-identifier hs-var">free_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045115"><span class="hs-identifier hs-var">wanted</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045119"><a href="#local-1628045119"><span class="hs-identifier">warn_redundant</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnRedundantConstraints"><span class="hs-identifier hs-var">Opt_WarnRedundantConstraints</span></a><span>
</span><a name="line-184"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045120"><a href="#local-1628045120"><span class="hs-identifier">err_ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#CEC"><span class="hs-identifier hs-var">CEC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_encl</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_tidy</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045117"><span class="hs-identifier hs-var">tidy_env</span></a><span>
</span><a name="line-186"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_defer_type_errors</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045111"><span class="hs-identifier hs-var">type_errors</span></a><span>
</span><a name="line-187"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_errors_as_warns</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045110"><span class="hs-identifier hs-var">err_as_warn</span></a><span>
</span><a name="line-188"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_expr_holes</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045112"><span class="hs-identifier hs-var">expr_holes</span></a><span>
</span><a name="line-189"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_type_holes</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045113"><span class="hs-identifier hs-var">type_holes</span></a><span>
</span><a name="line-190"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-comment">-- See Note [Suppressing error messages]</span><span>
</span><a name="line-191"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_warn_redundant</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045119"><span class="hs-identifier hs-var">warn_redundant</span></a><span>
</span><a name="line-192"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_binds</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045109"><span class="hs-identifier hs-var">mb_binds_var</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045121"><a href="#local-1628045121"><span class="hs-identifier">tc_lvl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getTcLevel"><span class="hs-identifier hs-var">getTcLevel</span></a><span>
</span><a name="line-195"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#reportWanteds"><span class="hs-identifier hs-var">reportWanteds</span></a><span> </span><a href="#local-1628045120"><span class="hs-identifier hs-var">err_ctxt</span></a><span> </span><a href="#local-1628045121"><span class="hs-identifier hs-var">tc_lvl</span></a><span> </span><a href="#local-1628045115"><span class="hs-identifier hs-var">wanted</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">--------------------------------------------</span><span>
</span><a name="line-198"></a><span class="hs-comment">--      Internal functions</span><span>
</span><a name="line-199"></a><span class="hs-comment">--------------------------------------------</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- | An error Report collects messages categorised by their importance.</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- See Note [Error report] for details.</span><span>
</span><a name="line-203"></a><span class="hs-keyword">data</span><span> </span><a name="Report"><a href="TcErrors.html#Report"><span class="hs-identifier">Report</span></a></a><span>
</span><a name="line-204"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Report"><a href="TcErrors.html#Report"><span class="hs-identifier">Report</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="report_important"><a href="TcErrors.html#report_important"><span class="hs-identifier">report_important</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span>           </span><span class="hs-special">,</span><span> </span><a name="report_relevant_bindings"><a href="TcErrors.html#report_relevant_bindings"><span class="hs-identifier">report_relevant_bindings</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span>
</span><a name="line-206"></a><span>           </span><span class="hs-special">}</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">{- Note [Error report]
The idea is that error msgs are divided into three parts: the main msg, the
context block (\&quot;In the second argument of ...\&quot;), and the relevant bindings
block, which are displayed in that order, with a mark to divide them.  The
idea is that the main msg ('report_important') varies depending on the error
in question, but context and relevant bindings are always the same, which
should simplify visual parsing.

The context is added when the the Report is passed off to 'mkErrorReport'.
Unfortunately, unlike the context, the relevant bindings are added in
multiple places so they have to be in the Report.
-}</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710</span><span>
</span><a name="line-222"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-223"></a><span>    </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><a name="local-1628045960"><a href="#local-1628045960"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-1628045961"><a href="#local-1628045961"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-805306881"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><a name="local-1628045962"><a href="#local-1628045962"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-1628045963"><a href="#local-1628045963"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045960"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045962"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628045961"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045963"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-805306882"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-228"></a><span>    </span><a name="local-805306883"><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><a name="local-1628045956"><a href="#local-1628045956"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-1628045957"><a href="#local-1628045957"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><a name="local-1628045958"><a href="#local-1628045958"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-1628045959"><a href="#local-1628045959"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045956"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045958"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628045957"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045959"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | Put a doc into the important msgs block.</span><span>
</span><a name="line-231"></a><span class="hs-identifier">important</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span>
</span><a name="line-232"></a><a name="important"><a href="TcErrors.html#important"><span class="hs-identifier">important</span></a></a><span> </span><a name="local-1628045122"><a href="#local-1628045122"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">report_important</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628045122"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">-- | Put a doc into the relevant bindings block.</span><span>
</span><a name="line-235"></a><span class="hs-identifier">relevant_bindings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span>
</span><a name="line-236"></a><a name="relevant_bindings"><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier">relevant_bindings</span></a></a><span> </span><a name="local-1628045123"><a href="#local-1628045123"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">report_relevant_bindings</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628045123"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-keyword">data</span><span> </span><a name="TypeErrorChoice"><a href="TcErrors.html#TypeErrorChoice"><span class="hs-identifier">TypeErrorChoice</span></a></a><span>   </span><span class="hs-comment">-- What to do for type errors found by the type checker</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TypeError"><a href="TcErrors.html#TypeError"><span class="hs-identifier">TypeError</span></a></a><span>     </span><span class="hs-comment">-- A type error aborts compilation with an error message</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeWarn"><a href="TcErrors.html#TypeWarn"><span class="hs-identifier">TypeWarn</span></a></a><span>      </span><span class="hs-comment">-- A type error is deferred to runtime, plus a compile-time warning</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeDefer"><a href="TcErrors.html#TypeDefer"><span class="hs-identifier">TypeDefer</span></a></a><span>     </span><span class="hs-comment">-- A type error is deferred to runtime; no error or warning at compile time</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-keyword">data</span><span> </span><a name="HoleChoice"><a href="TcErrors.html#HoleChoice"><span class="hs-identifier">HoleChoice</span></a></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="HoleError"><a href="TcErrors.html#HoleError"><span class="hs-identifier">HoleError</span></a></a><span>     </span><span class="hs-comment">-- A hole is a compile-time error</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HoleWarn"><a href="TcErrors.html#HoleWarn"><span class="hs-identifier">HoleWarn</span></a></a><span>      </span><span class="hs-comment">-- Defer to runtime, emit a compile-time warning</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HoleDefer"><a href="TcErrors.html#HoleDefer"><span class="hs-identifier">HoleDefer</span></a></a><span>     </span><span class="hs-comment">-- Defer to runtime, no warning</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-keyword">data</span><span> </span><a name="ReportErrCtxt"><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier">ReportErrCtxt</span></a></a><span>
</span><a name="line-249"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="CEC"><a href="TcErrors.html#CEC"><span class="hs-identifier">CEC</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="cec_encl"><a href="TcErrors.html#cec_encl"><span class="hs-identifier">cec_encl</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Enclosing implications</span><span>
</span><a name="line-250"></a><span>                                       </span><span class="hs-comment">--   (innermost first)</span><span>
</span><a name="line-251"></a><span>                                       </span><span class="hs-comment">-- ic_skols and givens are tidied, rest are not</span><span>
</span><a name="line-252"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_tidy"><a href="TcErrors.html#cec_tidy"><span class="hs-identifier">cec_tidy</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_binds"><a href="TcErrors.html#cec_binds"><span class="hs-identifier">cec_binds</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span>
</span><a name="line-255"></a><span>                         </span><span class="hs-comment">-- Nothing &lt;=&gt; Report all errors, including holes</span><span>
</span><a name="line-256"></a><span>                         </span><span class="hs-comment">--             Do not add any evidence bindings, because</span><span>
</span><a name="line-257"></a><span>                         </span><span class="hs-comment">--             we have no convenient place to put them</span><span>
</span><a name="line-258"></a><span>                         </span><span class="hs-comment">--             See TcErrors.reportAllUnsolved</span><span>
</span><a name="line-259"></a><span>                         </span><span class="hs-comment">-- Just ev &lt;=&gt; make some errors (depending on cec_defer)</span><span>
</span><a name="line-260"></a><span>                         </span><span class="hs-comment">--             into warnings, and emit evidence bindings</span><span>
</span><a name="line-261"></a><span>                         </span><span class="hs-comment">--             into 'ev' for unsolved constraints</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_errors_as_warns"><a href="TcErrors.html#cec_errors_as_warns"><span class="hs-identifier">cec_errors_as_warns</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>   </span><span class="hs-comment">-- Turn all errors into warnings</span><span>
</span><a name="line-264"></a><span>                                          </span><span class="hs-comment">-- (except for Holes, which are</span><span>
</span><a name="line-265"></a><span>                                          </span><span class="hs-comment">-- controlled by cec_type_holes and</span><span>
</span><a name="line-266"></a><span>                                          </span><span class="hs-comment">-- cec_expr_holes)</span><span>
</span><a name="line-267"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_defer_type_errors"><a href="TcErrors.html#cec_defer_type_errors"><span class="hs-identifier">cec_defer_type_errors</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#TypeErrorChoice"><span class="hs-identifier hs-type">TypeErrorChoice</span></a><span> </span><span class="hs-comment">-- Defer type errors until runtime</span><span>
</span><a name="line-268"></a><span>                                                     </span><span class="hs-comment">-- Irrelevant if cec_binds = Nothing</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_expr_holes"><a href="TcErrors.html#cec_expr_holes"><span class="hs-identifier">cec_expr_holes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#HoleChoice"><span class="hs-identifier hs-type">HoleChoice</span></a><span>  </span><span class="hs-comment">-- Holes in expressions</span><span>
</span><a name="line-271"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_type_holes"><a href="TcErrors.html#cec_type_holes"><span class="hs-identifier">cec_type_holes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#HoleChoice"><span class="hs-identifier hs-type">HoleChoice</span></a><span>  </span><span class="hs-comment">-- Holes in types</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_warn_redundant"><a href="TcErrors.html#cec_warn_redundant"><span class="hs-identifier">cec_warn_redundant</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- True &lt;=&gt; -Wredundant-constraints</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>          </span><span class="hs-special">,</span><span> </span><a name="cec_suppress"><a href="TcErrors.html#cec_suppress"><span class="hs-identifier">cec_suppress</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- True &lt;=&gt; More important errors have occurred,</span><span>
</span><a name="line-276"></a><span>                                    </span><span class="hs-comment">--          so create bindings if need be, but</span><span>
</span><a name="line-277"></a><span>                                    </span><span class="hs-comment">--          don't issue any more errors/warnings</span><span>
</span><a name="line-278"></a><span>                                    </span><span class="hs-comment">-- See Note [Suppressing error messages]</span><span>
</span><a name="line-279"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-comment">{-
Note [Suppressing error messages]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The cec_suppress flag says &quot;don't report any errors&quot;.  Instead, just create
evidence bindings (as usual).  It's used when more important errors have occurred.

Specifically (see reportWanteds)
  * If there are insoluble Givens, then we are in unreachable code and all bets
    are off.  So don't report any further errors.
  * If there are any insolubles (eg Int~Bool), here or in a nested implication,
    then suppress errors from the simple constraints here.  Sometimes the
    simple-constraint errors are a knock-on effect of the insolubles.
-}</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-identifier">reportImplic</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-296"></a><a name="reportImplic"><a href="TcErrors.html#reportImplic"><span class="hs-identifier">reportImplic</span></a></a><span> </span><a name="local-1628045124"><a href="#local-1628045124"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045125"><a href="#local-1628045125"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045126"><a href="#local-1628045126"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045127"><a href="#local-1628045127"><span class="hs-identifier">given</span></a></a><span>
</span><a name="line-297"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_wanted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045128"><a href="#local-1628045128"><span class="hs-identifier">wanted</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045129"><a href="#local-1628045129"><span class="hs-identifier">m_evb</span></a></a><span>
</span><a name="line-298"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_status</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045130"><a href="#local-1628045130"><span class="hs-identifier">status</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045131"><a href="#local-1628045131"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-299"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045132"><a href="#local-1628045132"><span class="hs-identifier">tcl_env</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_tclvl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045133"><a href="#local-1628045133"><span class="hs-identifier">tc_lvl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#BracketSkol"><span class="hs-identifier hs-var">BracketSkol</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045131"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-301"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045134"><span class="hs-identifier hs-var">insoluble</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- For Template Haskell brackets report only</span><span>
</span><a name="line-303"></a><span>                     </span><span class="hs-comment">-- definite errors. The whole thing will be re-checked</span><span>
</span><a name="line-304"></a><span>                     </span><span class="hs-comment">-- later when we plug it in, and meanwhile there may</span><span>
</span><a name="line-305"></a><span>                     </span><span class="hs-comment">-- certainly be un-satisfied constraints</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-308"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcErrors.html#reportWanteds"><span class="hs-identifier hs-var">reportWanteds</span></a><span> </span><a href="#local-1628045139"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><a href="#local-1628045133"><span class="hs-identifier hs-var">tc_lvl</span></a><span> </span><a href="#local-1628045128"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-309"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;reportImplic&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045125"><span class="hs-identifier hs-var">implic</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_warn_redundant</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-311"></a><span>         </span><a href="TcErrors.html#warnRedundantConstraints"><span class="hs-identifier hs-var">warnRedundantConstraints</span></a><span> </span><a href="#local-1628045139"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><a href="#local-1628045132"><span class="hs-identifier hs-var">tcl_env</span></a><span> </span><a href="#local-1628045137"><span class="hs-identifier hs-var">info'</span></a><span> </span><a href="#local-1628045140"><span class="hs-identifier hs-var">dead_givens</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-313"></a><span>    </span><a name="local-1628045134"><a href="#local-1628045134"><span class="hs-identifier">insoluble</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isInsolubleStatus"><span class="hs-identifier hs-var">isInsolubleStatus</span></a><span> </span><a href="#local-1628045130"><span class="hs-identifier hs-var">status</span></a><span>
</span><a name="line-314"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045135"><a href="#local-1628045135"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045136"><a href="#local-1628045136"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span> </span><a href="TyCoRep.html#tidyTyCoVarBndr"><span class="hs-identifier hs-var">tidyTyCoVarBndr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_tidy</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045126"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-315"></a><span>    </span><a name="local-1628045137"><a href="#local-1628045137"><span class="hs-identifier">info'</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TcMType.html#tidySkolemInfo"><span class="hs-identifier hs-var">tidySkolemInfo</span></a><span> </span><a href="#local-1628045135"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628045131"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-316"></a><span>    </span><a name="local-1628045138"><a href="#local-1628045138"><span class="hs-identifier">implic'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045125"><span class="hs-identifier hs-var">implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045136"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-317"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcMType.html#tidyEvVar"><span class="hs-identifier hs-var">tidyEvVar</span></a><span> </span><a href="#local-1628045135"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045127"><span class="hs-identifier hs-var">given</span></a><span>
</span><a name="line-318"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045137"><span class="hs-identifier hs-var">info'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-319"></a><span>    </span><a name="local-1628045139"><a href="#local-1628045139"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_tidy</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045135"><span class="hs-identifier hs-var">env1</span></a><span>
</span><a name="line-320"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_encl</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045138"><span class="hs-identifier hs-var">implic'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045134"><span class="hs-identifier hs-var">insoluble</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-323"></a><span>                      </span><span class="hs-comment">-- Suppress inessential errors if there</span><span>
</span><a name="line-324"></a><span>                      </span><span class="hs-comment">-- are are insolubles anywhere in the</span><span>
</span><a name="line-325"></a><span>                      </span><span class="hs-comment">-- tree rooted here, or we've come across</span><span>
</span><a name="line-326"></a><span>                      </span><span class="hs-comment">-- a suppress-worthy constraint higher up (Trac #11541)</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cec_binds</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cec_binds</span><span> </span><a href="#local-1628045124"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><a href="#local-1628045129"><span class="hs-identifier hs-var">m_evb</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-329"></a><span>                      </span><span class="hs-comment">-- If cec_binds ctxt is Nothing, that means</span><span>
</span><a name="line-330"></a><span>                      </span><span class="hs-comment">-- we're reporting *all* errors. Don't change</span><span>
</span><a name="line-331"></a><span>                      </span><span class="hs-comment">-- that behavior just because we're going into</span><span>
</span><a name="line-332"></a><span>                      </span><span class="hs-comment">-- an implication.</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span>    </span><a name="local-1628045140"><a href="#local-1628045140"><span class="hs-identifier">dead_givens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045130"><span class="hs-identifier hs-var">status</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-335"></a><span>                    </span><a href="TcRnTypes.html#IC_Solved"><span class="hs-identifier hs-var">IC_Solved</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ics_dead</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045141"><a href="#local-1628045141"><span class="hs-identifier">dead</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045141"><span class="hs-identifier hs-var">dead</span></a><span>
</span><a name="line-336"></a><span>                    </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-identifier">warnRedundantConstraints</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-339"></a><a name="warnRedundantConstraints"><a href="TcErrors.html#warnRedundantConstraints"><span class="hs-identifier">warnRedundantConstraints</span></a></a><span> </span><a name="local-1628045142"><a href="#local-1628045142"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045143"><a href="#local-1628045143"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628045144"><a href="#local-1628045144"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-1628045145"><a href="#local-1628045145"><span class="hs-identifier">ev_vars</span></a></a><span>
</span><a name="line-340"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045147"><span class="hs-identifier hs-var">redundant_evs</span></a><span>
</span><a name="line-341"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045144"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-344"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a><span> </span><a href="#local-1628045143"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-comment">-- We want to add &quot;In the type signature for f&quot;</span><span>
</span><a name="line-345"></a><span>                    </span><span class="hs-comment">-- to the error context, which is a bit tiresome</span><span>
</span><a name="line-346"></a><span>   </span><a href="TcRnMonad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045144"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-347"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045150"><a href="#local-1628045150"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-348"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-1628045151"><a href="#local-1628045151"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a><span> </span><a href="#local-1628045142"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045150"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045146"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span>
</span><a name="line-349"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnRedundantConstraints"><span class="hs-identifier hs-var">Opt_WarnRedundantConstraints</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045151"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- But for InstSkol there already *is* a surrounding</span><span>
</span><a name="line-352"></a><span>              </span><span class="hs-comment">-- &quot;In the instance declaration for Eq [a]&quot; context</span><span>
</span><a name="line-353"></a><span>              </span><span class="hs-comment">-- and we don't want to say it twice. Seems a bit ad-hoc</span><span>
</span><a name="line-354"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045152"><a href="#local-1628045152"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a><span> </span><a href="#local-1628045142"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045143"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045146"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnRedundantConstraints"><span class="hs-identifier hs-var">Opt_WarnRedundantConstraints</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045152"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-356"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-357"></a><span>   </span><a name="local-1628045146"><a href="#local-1628045146"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Redundant constraint&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045147"><span class="hs-identifier hs-var">redundant_evs</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span>
</span><a name="line-358"></a><span>         </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcRnTypes.html#pprEvVarTheta"><span class="hs-identifier hs-var">pprEvVarTheta</span></a><span> </span><a href="#local-1628045147"><span class="hs-identifier hs-var">redundant_evs</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span>   </span><a name="local-1628045147"><a href="#local-1628045147"><span class="hs-identifier">redundant_evs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045144"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- See Note [Redundant constraints in instance decls]</span><span>
</span><a name="line-361"></a><span>                     </span><a href="TcRnTypes.html#InstSkol"><span class="hs-identifier hs-var">InstSkol</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-1628045148"><span class="hs-identifier hs-var">improving</span></a><span> </span><a href="#local-1628045145"><span class="hs-identifier hs-var">ev_vars</span></a><span>
</span><a name="line-362"></a><span>                     </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045145"><span class="hs-identifier hs-var">ev_vars</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span>   </span><a name="local-1628045148"><a href="#local-1628045148"><span class="hs-identifier">improving</span></a></a><span> </span><a name="local-1628045149"><a href="#local-1628045149"><span class="hs-identifier">ev_var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="TcType.html#isImprovementPred"><span class="hs-identifier hs-var">isImprovementPred</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-365"></a><span>                      </span><a href="TcType.html#transSuperClasses"><span class="hs-identifier hs-var">transSuperClasses</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628045149"><span class="hs-identifier hs-var">ev_var</span></a><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-comment">{- Note [Redundant constraints in instance decls]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For instance declarations, we don't report unused givens if
they can give rise to improvement.  Example (Trac #10100):
    class Add a b ab | a b -&gt; ab, a ab -&gt; b
    instance Add Zero b b
    instance Add a b ab =&gt; Add (Succ a) b (Succ ab)
The context (Add a b ab) for the instance is clearly unused in terms
of evidence, since the dictionary has no feilds.  But it is still
needed!  With the context, a wanted constraint
   Add (Succ Zero) beta (Succ Zero)
we will reduce to (Add Zero beta Zero), and thence we get beta := Zero.
But without the context we won't find beta := Zero.

This only matters in instance declarations..
-}</span><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span class="hs-identifier">reportWanteds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-385"></a><a name="reportWanteds"><a href="TcErrors.html#reportWanteds"><span class="hs-identifier">reportWanteds</span></a></a><span> </span><a name="local-1628045153"><a href="#local-1628045153"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045154"><a href="#local-1628045154"><span class="hs-identifier">tc_lvl</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#WC"><span class="hs-identifier hs-var">WC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">wc_simple</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045155"><a href="#local-1628045155"><span class="hs-identifier">simples</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_insol</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045156"><a href="#local-1628045156"><span class="hs-identifier">insols</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">wc_impl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045157"><a href="#local-1628045157"><span class="hs-identifier">implics</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;reportWanteds&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Simples =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045155"><span class="hs-identifier hs-var">simples</span></a><span>
</span><a name="line-387"></a><span>                                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Suppress =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045153"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045185"><a href="#local-1628045185"><span class="hs-identifier">tidy_cts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a><span> </span><span class="hs-special">(</span><a href="TcMType.html#tidyCt"><span class="hs-identifier hs-var">tidyCt</span></a><span> </span><a href="#local-1628045158"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628045156"><span class="hs-identifier hs-var">insols</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045155"><span class="hs-identifier hs-var">simples</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span>         </span><span class="hs-comment">-- First deal with things that are utterly wrong</span><span>
</span><a name="line-391"></a><span>         </span><span class="hs-comment">-- Like Int ~ Bool (incl nullary TyCons)</span><span>
</span><a name="line-392"></a><span>         </span><span class="hs-comment">-- or  Int ~ t a   (AppTy on one side)</span><span>
</span><a name="line-393"></a><span>         </span><span class="hs-comment">-- These ones are not suppressed by the incoming context</span><span>
</span><a name="line-394"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045186"><a href="#local-1628045186"><span class="hs-identifier">ctxt_for_insols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045153"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-395"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628045187"><a href="#local-1628045187"><span class="hs-identifier">ctxt1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045188"><a href="#local-1628045188"><span class="hs-identifier">cts1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#tryReporters"><span class="hs-identifier hs-var">tryReporters</span></a><span> </span><a href="#local-1628045186"><span class="hs-identifier hs-var">ctxt_for_insols</span></a><span> </span><a href="#local-1628045159"><span class="hs-identifier hs-var">report1</span></a><span> </span><a href="#local-1628045185"><span class="hs-identifier hs-var">tidy_cts</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>         </span><span class="hs-comment">-- Now all the other constraints.  We suppress errors here if</span><span>
</span><a name="line-398"></a><span>         </span><span class="hs-comment">-- any of the first batch failed, or if the enclosing context</span><span>
</span><a name="line-399"></a><span>         </span><span class="hs-comment">-- says to suppress</span><span>
</span><a name="line-400"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045189"><a href="#local-1628045189"><span class="hs-identifier">ctxt2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045153"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045153"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045187"><span class="hs-identifier hs-var">ctxt1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-401"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628045190"><a href="#local-1628045190"><span class="hs-identifier">leftovers</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#tryReporters"><span class="hs-identifier hs-var">tryReporters</span></a><span> </span><a href="#local-1628045189"><span class="hs-identifier hs-var">ctxt2</span></a><span> </span><a href="#local-1628045160"><span class="hs-identifier hs-var">report2</span></a><span> </span><a href="#local-1628045188"><span class="hs-identifier hs-var">cts1</span></a><span>
</span><a name="line-402"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">MASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">leftovers</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">leftovers</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span>            </span><span class="hs-comment">-- All the Derived ones have been filtered out of simples</span><span>
</span><a name="line-405"></a><span>            </span><span class="hs-comment">-- by the constraint solver. This is ok; we don't want</span><span>
</span><a name="line-406"></a><span>            </span><span class="hs-comment">-- to report unsolved Derived goals as errors</span><span>
</span><a name="line-407"></a><span>            </span><span class="hs-comment">-- See Note [Do not report derived but soluble errors]</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="Bag.html#mapBagM_"><span class="hs-identifier hs-var">mapBagM_</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#reportImplic"><span class="hs-identifier hs-var">reportImplic</span></a><span> </span><a href="#local-1628045189"><span class="hs-identifier hs-var">ctxt2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045157"><span class="hs-identifier hs-var">implics</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-410"></a><span>            </span><span class="hs-comment">-- NB ctxt1: don't suppress inner insolubles if there's only a</span><span>
</span><a name="line-411"></a><span>            </span><span class="hs-comment">-- wanted insoluble here; but do suppress inner insolubles</span><span>
</span><a name="line-412"></a><span>            </span><span class="hs-comment">-- if there's a *given* insoluble here (= inaccessible code)</span><span>
</span><a name="line-413"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-414"></a><span>    </span><a name="local-1628045158"><a href="#local-1628045158"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cec_tidy</span><span> </span><a href="#local-1628045153"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span>    </span><span class="hs-comment">-- report1: ones that should *not* be suppresed by</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-comment">--          an insoluble somewhere else in the tree</span><span>
</span><a name="line-418"></a><span>    </span><span class="hs-comment">-- It's crucial that anything that is considered insoluble</span><span>
</span><a name="line-419"></a><span>    </span><span class="hs-comment">-- (see TcRnTypes.trulyInsoluble) is caught here, otherwise</span><span>
</span><a name="line-420"></a><span>    </span><span class="hs-comment">-- we might suppress its error message, and proceed on past</span><span>
</span><a name="line-421"></a><span>    </span><span class="hs-comment">-- type checking to get a Lint error later</span><span>
</span><a name="line-422"></a><span>    </span><a name="local-1628045159"><a href="#local-1628045159"><span class="hs-identifier">report1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;custom_error&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-1628045168"><span class="hs-identifier hs-var">is_user_type_error</span></a><span class="hs-special">,</span><span>
</span><a name="line-423"></a><span>                                                  </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkUserTypeErrorReporter"><span class="hs-identifier hs-var">mkUserTypeErrorReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;insoluble1&quot;</span><span class="hs-special">,</span><span>   </span><a href="#local-1628045161"><span class="hs-identifier hs-var">is_given_eq</span></a><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;insoluble2&quot;</span><span class="hs-special">,</span><span>   </span><a href="#local-1628045162"><span class="hs-identifier hs-var">utterly_wrong</span></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;skolem eq1&quot;</span><span class="hs-special">,</span><span>   </span><a href="#local-1628045163"><span class="hs-identifier hs-var">very_wrong</span></a><span class="hs-special">,</span><span>      </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;skolem eq2&quot;</span><span class="hs-special">,</span><span>   </span><a href="#local-1628045164"><span class="hs-identifier hs-var">skolem_eq</span></a><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;non-tv eq&quot;</span><span class="hs-special">,</span><span>    </span><a href="#local-1628045165"><span class="hs-identifier hs-var">non_tv_eq</span></a><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Out of scope&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-1628045166"><span class="hs-identifier hs-var">is_out_of_scope</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><a href="TcErrors.html#mkHoleReporter"><span class="hs-identifier hs-var">mkHoleReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Holes&quot;</span><span class="hs-special">,</span><span>        </span><a href="#local-1628045167"><span class="hs-identifier hs-var">is_hole</span></a><span class="hs-special">,</span><span>         </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkHoleReporter"><span class="hs-identifier hs-var">mkHoleReporter</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>                  </span><span class="hs-comment">-- The only remaining equalities are alpha ~ ty,</span><span>
</span><a name="line-433"></a><span>                  </span><span class="hs-comment">-- where alpha is untouchable; and representational equalities</span><span>
</span><a name="line-434"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Other eqs&quot;</span><span class="hs-special">,</span><span>    </span><a href="#local-1628045169"><span class="hs-identifier hs-var">is_equality</span></a><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span>    </span><span class="hs-comment">-- report2: we suppress these if there are insolubles elsewhere in the tree</span><span>
</span><a name="line-437"></a><span>    </span><a name="local-1628045160"><a href="#local-1628045160"><span class="hs-identifier">report2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Implicit params&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-1628045171"><span class="hs-identifier hs-var">is_ip</span></a><span class="hs-special">,</span><span>           </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkIPErr"><span class="hs-identifier hs-var">mkIPErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Irreds&quot;</span><span class="hs-special">,</span><span>          </span><a href="#local-1628045172"><span class="hs-identifier hs-var">is_irred</span></a><span class="hs-special">,</span><span>        </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkIrredErr"><span class="hs-identifier hs-var">mkIrredErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Dicts&quot;</span><span class="hs-special">,</span><span>           </span><a href="#local-1628045170"><span class="hs-identifier hs-var">is_dict</span></a><span class="hs-special">,</span><span>         </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a><span> </span><a href="TcErrors.html#mkDictErr"><span class="hs-identifier hs-var">mkDictErr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span>    </span><span class="hs-comment">-- rigid_nom_eq, rigid_nom_tv_eq,</span><span>
</span><a name="line-442"></a><span>    </span><span class="hs-identifier">is_hole</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_dict</span><span class="hs-special">,</span><span>
</span><a name="line-443"></a><span>      </span><span class="hs-identifier">is_equality</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_ip</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_irred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><span>    </span><a name="local-1628045161"><a href="#local-1628045161"><span class="hs-identifier">is_given_eq</span></a></a><span> </span><a name="local-1628045173"><a href="#local-1628045173"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045174"><a href="#local-1628045174"><span class="hs-identifier">pred</span></a></a><span>
</span><a name="line-446"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045174"><span class="hs-identifier hs-var">pred</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#arisesFromGivens"><span class="hs-identifier hs-var">arisesFromGivens</span></a><span> </span><a href="#local-1628045173"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-447"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-448"></a><span>       </span><span class="hs-comment">-- I think all given residuals are equalities</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span>    </span><span class="hs-comment">-- Things like (Int ~N Bool)</span><span>
</span><a name="line-451"></a><span>    </span><a name="local-1628045162"><a href="#local-1628045162"><span class="hs-identifier">utterly_wrong</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a name="local-1628045175"><a href="#local-1628045175"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045176"><a href="#local-1628045176"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a><span> </span><a href="#local-1628045175"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a><span> </span><a href="#local-1628045176"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-452"></a><span>    </span><span class="hs-identifier">utterly_wrong</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span>    </span><span class="hs-comment">-- Things like (a ~N Int)</span><span>
</span><a name="line-455"></a><span>    </span><a name="local-1628045163"><a href="#local-1628045163"><span class="hs-identifier">very_wrong</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a name="local-1628045177"><a href="#local-1628045177"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045178"><a href="#local-1628045178"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#isSkolemTy"><span class="hs-identifier hs-var">isSkolemTy</span></a><span> </span><a href="#local-1628045154"><span class="hs-identifier hs-var">tc_lvl</span></a><span> </span><a href="#local-1628045177"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a><span> </span><a href="#local-1628045178"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-456"></a><span>    </span><span class="hs-identifier">very_wrong</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span>    </span><span class="hs-comment">-- Things like (a ~N b) or (a  ~N  F Bool)</span><span>
</span><a name="line-459"></a><span>    </span><a name="local-1628045164"><a href="#local-1628045164"><span class="hs-identifier">skolem_eq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a name="local-1628045179"><a href="#local-1628045179"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#isSkolemTy"><span class="hs-identifier hs-var">isSkolemTy</span></a><span> </span><a href="#local-1628045154"><span class="hs-identifier hs-var">tc_lvl</span></a><span> </span><a href="#local-1628045179"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-460"></a><span>    </span><span class="hs-identifier">skolem_eq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span>    </span><span class="hs-comment">-- Things like (F a  ~N  Int)</span><span>
</span><a name="line-463"></a><span>    </span><a name="local-1628045165"><a href="#local-1628045165"><span class="hs-identifier">non_tv_eq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a name="local-1628045180"><a href="#local-1628045180"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span> </span><a href="#local-1628045180"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>    </span><span class="hs-identifier">non_tv_eq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">--    rigid_nom_eq _ pred = isRigidEqPred tc_lvl pred</span><span>
</span><a name="line-467"></a><span class="hs-comment">--</span><span>
</span><a name="line-468"></a><span class="hs-comment">--    rigid_nom_tv_eq _ pred</span><span>
</span><a name="line-469"></a><span class="hs-comment">--      | EqPred _ ty1 _ &lt;- pred = isRigidEqPred tc_lvl pred &amp;&amp; isTyVarTy ty1</span><span>
</span><a name="line-470"></a><span class="hs-comment">--      | otherwise              = False</span><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span>    </span><a name="local-1628045166"><a href="#local-1628045166"><span class="hs-identifier">is_out_of_scope</span></a></a><span> </span><a name="local-1628045181"><a href="#local-1628045181"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isOutOfScopeCt"><span class="hs-identifier hs-var">isOutOfScopeCt</span></a><span> </span><a href="#local-1628045181"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-473"></a><span>    </span><a name="local-1628045167"><a href="#local-1628045167"><span class="hs-identifier">is_hole</span></a></a><span>         </span><a name="local-1628045182"><a href="#local-1628045182"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isHoleCt"><span class="hs-identifier hs-var">isHoleCt</span></a><span> </span><a href="#local-1628045182"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span>    </span><a name="local-1628045168"><a href="#local-1628045168"><span class="hs-identifier">is_user_type_error</span></a></a><span> </span><a name="local-1628045183"><a href="#local-1628045183"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#isUserTypeErrorCt"><span class="hs-identifier hs-var">isUserTypeErrorCt</span></a><span> </span><a href="#local-1628045183"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span>    </span><a name="local-1628045169"><a href="#local-1628045169"><span class="hs-identifier">is_equality</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-identifier">is_equality</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span>    </span><a name="local-1628045170"><a href="#local-1628045170"><span class="hs-identifier">is_dict</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#ClassPred"><span class="hs-identifier hs-var">ClassPred</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-481"></a><span>    </span><span class="hs-identifier">is_dict</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span>    </span><a name="local-1628045171"><a href="#local-1628045171"><span class="hs-identifier">is_ip</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#ClassPred"><span class="hs-identifier hs-var">ClassPred</span></a><span> </span><a name="local-1628045184"><a href="#local-1628045184"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a><span> </span><a href="#local-1628045184"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-484"></a><span>    </span><span class="hs-identifier">is_ip</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span>    </span><a name="local-1628045172"><a href="#local-1628045172"><span class="hs-identifier">is_irred</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Type.html#IrredPred"><span class="hs-identifier hs-var">IrredPred</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-487"></a><span>    </span><span class="hs-identifier">is_irred</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-491"></a><span class="hs-identifier">isSkolemTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- The type is a skolem tyvar</span><span>
</span><a name="line-493"></a><a name="isSkolemTy"><a href="TcErrors.html#isSkolemTy"><span class="hs-identifier">isSkolemTy</span></a></a><span> </span><a name="local-1628045191"><a href="#local-1628045191"><span class="hs-identifier">tc_lvl</span></a></a><span> </span><a name="local-1628045192"><a href="#local-1628045192"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-494"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045193"><a href="#local-1628045193"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1628045192"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-495"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a><span> </span><a href="#local-1628045193"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="TcType.html#isSigTyVar"><span class="hs-identifier hs-var">isSigTyVar</span></a><span> </span><a href="#local-1628045193"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var">isTouchableMetaTyVar</span></a><span> </span><a href="#local-1628045191"><span class="hs-identifier hs-var">tc_lvl</span></a><span> </span><a href="#local-1628045193"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>     </span><span class="hs-comment">-- The last case is for touchable SigTvs</span><span>
</span><a name="line-498"></a><span>     </span><span class="hs-comment">-- we postpone untouchables to a latter test (too obscure)</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-501"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-identifier">isTyFun_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-504"></a><a name="isTyFun_maybe"><a href="TcErrors.html#isTyFun_maybe"><span class="hs-identifier">isTyFun_maybe</span></a></a><span> </span><a name="local-1628045194"><a href="#local-1628045194"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045194"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-505"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045195"><a href="#local-1628045195"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a><span> </span><a href="#local-1628045195"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628045195"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-506"></a><span>                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span class="hs-comment">--------------------------------------------</span><span>
</span><a name="line-509"></a><span class="hs-comment">--      Reporters</span><span>
</span><a name="line-510"></a><span class="hs-comment">--------------------------------------------</span><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-keyword">type</span><span> </span><a name="Reporter"><a href="TcErrors.html#Reporter"><span class="hs-identifier">Reporter</span></a></a><span>
</span><a name="line-513"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span class="hs-keyword">type</span><span> </span><a name="ReporterSpec"><a href="TcErrors.html#ReporterSpec"><span class="hs-identifier">ReporterSpec</span></a></a><span>
</span><a name="line-515"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>                     </span><span class="hs-comment">-- Name</span><span>
</span><a name="line-516"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>     </span><span class="hs-comment">-- Pick these ones</span><span>
</span><a name="line-517"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                       </span><span class="hs-comment">-- True &lt;=&gt; suppress subsequent reporters</span><span>
</span><a name="line-518"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- The reporter itself</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-identifier">mkSkolReporter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a><span>
</span><a name="line-521"></a><span class="hs-comment">-- Suppress duplicates with either the same LHS, or same location</span><span>
</span><a name="line-522"></a><a name="mkSkolReporter"><a href="TcErrors.html#mkSkolReporter"><span class="hs-identifier">mkSkolReporter</span></a></a><span> </span><a name="local-1628045196"><a href="#local-1628045196"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045197"><a href="#local-1628045197"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-523"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#reportGroup"><span class="hs-identifier hs-var">reportGroup</span></a><span> </span><a href="TcErrors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a><span> </span><a href="#local-1628045196"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628045198"><span class="hs-identifier hs-var">group</span></a><span> </span><a href="#local-1628045197"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-525"></a><span>     </span><a name="local-1628045198"><a href="#local-1628045198"><span class="hs-identifier">group</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>     </span><span class="hs-identifier">group</span><span> </span><span class="hs-special">(</span><a name="local-1628045200"><a href="#local-1628045200"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">:</span><a name="local-1628045201"><a href="#local-1628045201"><span class="hs-identifier">cts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045200"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628045202"><span class="hs-identifier hs-var">yeses</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628045198"><span class="hs-identifier hs-var">group</span></a><span> </span><a href="#local-1628045203"><span class="hs-identifier hs-var">noes</span></a><span>
</span><a name="line-527"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-528"></a><span>          </span><span class="hs-special">(</span><a name="local-1628045202"><a href="#local-1628045202"><span class="hs-identifier">yeses</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045203"><a href="#local-1628045203"><span class="hs-identifier">noes</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045199"><span class="hs-identifier hs-var">group_with</span></a><span> </span><a href="#local-1628045200"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045201"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span>     </span><a name="local-1628045199"><a href="#local-1628045199"><span class="hs-identifier">group_with</span></a></a><span> </span><a name="local-1628045204"><a href="#local-1628045204"><span class="hs-identifier">ct1</span></a></a><span> </span><a name="local-1628045205"><a href="#local-1628045205"><span class="hs-identifier">ct2</span></a></a><span>
</span><a name="line-531"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#cmp_loc"><span class="hs-identifier hs-var">cmp_loc</span></a><span>      </span><a href="#local-1628045204"><span class="hs-identifier hs-var">ct1</span></a><span> </span><a href="#local-1628045205"><span class="hs-identifier hs-var">ct2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-532"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#cmp_lhs_type"><span class="hs-identifier hs-var">cmp_lhs_type</span></a><span> </span><a href="#local-1628045204"><span class="hs-identifier hs-var">ct1</span></a><span> </span><a href="#local-1628045205"><span class="hs-identifier hs-var">ct2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-533"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-identifier">mkHoleReporter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a><span>
</span><a name="line-536"></a><span class="hs-comment">-- Reports errors one at a time</span><span>
</span><a name="line-537"></a><a name="mkHoleReporter"><a href="TcErrors.html#mkHoleReporter"><span class="hs-identifier">mkHoleReporter</span></a></a><span> </span><a name="local-1628045206"><a href="#local-1628045206"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-538"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045207"><a href="#local-1628045207"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-539"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045208"><a href="#local-1628045208"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#mkHoleError"><span class="hs-identifier hs-var">mkHoleError</span></a><span> </span><a href="#local-1628045206"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045207"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-540"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#maybeReportHoleError"><span class="hs-identifier hs-var">maybeReportHoleError</span></a><span> </span><a href="#local-1628045206"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045207"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045208"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-541"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#maybeAddDeferredHoleBinding"><span class="hs-identifier hs-var">maybeAddDeferredHoleBinding</span></a><span> </span><a href="#local-1628045206"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045208"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="#local-1628045207"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-identifier">mkUserTypeErrorReporter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a><span>
</span><a name="line-544"></a><a name="mkUserTypeErrorReporter"><a href="TcErrors.html#mkUserTypeErrorReporter"><span class="hs-identifier">mkUserTypeErrorReporter</span></a></a><span> </span><a name="local-1628045209"><a href="#local-1628045209"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-545"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045210"><a href="#local-1628045210"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#maybeReportError"><span class="hs-identifier hs-var">maybeReportError</span></a><span> </span><a href="#local-1628045209"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="TcErrors.html#mkUserTypeError"><span class="hs-identifier hs-var">mkUserTypeError</span></a><span> </span><a href="#local-1628045209"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045210"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-identifier">mkUserTypeError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-548"></a><a name="mkUserTypeError"><a href="TcErrors.html#mkUserTypeError"><span class="hs-identifier">mkUserTypeError</span></a></a><span> </span><a name="local-1628045211"><a href="#local-1628045211"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045212"><a href="#local-1628045212"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045211"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045212"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-549"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span>
</span><a name="line-550"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span>
</span><a name="line-551"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#getUserTypeErrorMsg"><span class="hs-identifier hs-var">getUserTypeErrorMsg</span></a><span> </span><a href="#local-1628045212"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-552"></a><span>                            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045213"><a href="#local-1628045213"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045213"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-553"></a><span>                            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;mkUserTypeError&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045212"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span>
</span><a name="line-556"></a><span class="hs-identifier">mkGroupReporter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>                             </span><span class="hs-comment">-- Make error message for a group</span><span>
</span><a name="line-558"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a><span>  </span><span class="hs-comment">-- Deal with lots of constraints</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- Group together errors from same location,</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- and report only the first (to avoid a cascade)</span><span>
</span><a name="line-561"></a><a name="mkGroupReporter"><a href="TcErrors.html#mkGroupReporter"><span class="hs-identifier">mkGroupReporter</span></a></a><span> </span><a name="local-1628045214"><a href="#local-1628045214"><span class="hs-identifier">mk_err</span></a></a><span> </span><a name="local-1628045215"><a href="#local-1628045215"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045216"><a href="#local-1628045216"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-562"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#reportGroup"><span class="hs-identifier hs-var">reportGroup</span></a><span> </span><a href="#local-1628045214"><span class="hs-identifier hs-var">mk_err</span></a><span> </span><a href="#local-1628045215"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="ListSetOps.html#equivClasses"><span class="hs-identifier hs-var">equivClasses</span></a><span> </span><a href="TcErrors.html#cmp_loc"><span class="hs-identifier hs-var">cmp_loc</span></a><span> </span><a href="#local-1628045216"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">cmp_lhs_type</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-566"></a><a name="cmp_lhs_type"><a href="TcErrors.html#cmp_lhs_type"><span class="hs-identifier">cmp_lhs_type</span></a></a><span> </span><a name="local-1628045217"><a href="#local-1628045217"><span class="hs-identifier">ct1</span></a></a><span> </span><a name="local-1628045218"><a href="#local-1628045218"><span class="hs-identifier">ct2</span></a></a><span>
</span><a name="line-567"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045217"><span class="hs-identifier hs-var">ct1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045218"><span class="hs-identifier hs-var">ct2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-568"></a><span>       </span><span class="hs-special">(</span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a name="local-1628045219"><a href="#local-1628045219"><span class="hs-identifier">eq_rel1</span></a></a><span> </span><a name="local-1628045220"><a href="#local-1628045220"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a name="local-1628045221"><a href="#local-1628045221"><span class="hs-identifier">eq_rel2</span></a></a><span> </span><a name="local-1628045222"><a href="#local-1628045222"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-569"></a><span>         </span><span class="hs-special">(</span><a href="#local-1628045219"><span class="hs-identifier hs-var">eq_rel1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-1628045221"><span class="hs-identifier hs-var">eq_rel2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Util.html#thenCmp"><span class="hs-identifier hs-var">thenCmp</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-1628045220"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#cmpType"><span class="hs-identifier hs-var">cmpType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045222"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;mkSkolReporter&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045217"><span class="hs-identifier hs-var">ct1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045218"><span class="hs-identifier hs-var">ct2</span></a><span class="hs-special">)</span><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-identifier">cmp_loc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-573"></a><a name="cmp_loc"><a href="TcErrors.html#cmp_loc"><span class="hs-identifier">cmp_loc</span></a></a><span> </span><a name="local-1628045223"><a href="#local-1628045223"><span class="hs-identifier">ct1</span></a></a><span> </span><a name="local-1628045224"><a href="#local-1628045224"><span class="hs-identifier">ct2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocSpan"><span class="hs-identifier hs-var">ctLocSpan</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045223"><span class="hs-identifier hs-var">ct1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="TcRnTypes.html#ctLocSpan"><span class="hs-identifier hs-var">ctLocSpan</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045224"><span class="hs-identifier hs-var">ct2</span></a><span class="hs-special">)</span><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span class="hs-identifier">reportGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span>
</span><a name="line-576"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><a name="reportGroup"><a href="TcErrors.html#reportGroup"><span class="hs-identifier">reportGroup</span></a></a><span> </span><a name="local-1628045225"><a href="#local-1628045225"><span class="hs-identifier">mk_err</span></a></a><span> </span><a name="local-1628045226"><a href="#local-1628045226"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045227"><a href="#local-1628045227"><span class="hs-identifier">cts</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-578"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-1628045228"><span class="hs-identifier hs-var">isMonadFailInstanceMissing</span></a><span> </span><a href="#local-1628045227"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-579"></a><span>        </span><span class="hs-comment">-- Only warn about missing MonadFail constraint when</span><span>
</span><a name="line-580"></a><span>        </span><span class="hs-comment">-- there are no other missing contstraints!</span><span>
</span><a name="line-581"></a><span>        </span><span class="hs-special">(</span><a name="local-1628045232"><a href="#local-1628045232"><span class="hs-identifier">monadFailCts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-582"></a><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045233"><a href="#local-1628045233"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045225"><span class="hs-identifier hs-var">mk_err</span></a><span> </span><a href="#local-1628045226"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045232"><span class="hs-identifier hs-var">monadFailCts</span></a><span>
</span><a name="line-583"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnMissingMonadFailInstances"><span class="hs-identifier hs-var">Opt_WarnMissingMonadFailInstances</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045233"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-584"></a><span>
</span><a name="line-585"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628045234"><a href="#local-1628045234"><span class="hs-identifier">cts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045235"><a href="#local-1628045235"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045225"><span class="hs-identifier hs-var">mk_err</span></a><span> </span><a href="#local-1628045226"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045234"><span class="hs-identifier hs-var">cts'</span></a><span>
</span><a name="line-586"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#maybeReportError"><span class="hs-identifier hs-var">maybeReportError</span></a><span> </span><a href="#local-1628045226"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045235"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-587"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#maybeAddDeferredBinding"><span class="hs-identifier hs-var">maybeAddDeferredBinding</span></a><span> </span><a href="#local-1628045226"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045235"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045234"><span class="hs-identifier hs-var">cts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-588"></a><span>                                </span><span class="hs-comment">-- Add deferred bindings for all</span><span>
</span><a name="line-589"></a><span>                                </span><span class="hs-comment">-- But see Note [Always warn with -fdefer-type-errors]</span><span>
</span><a name="line-590"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-591"></a><span>    </span><a name="local-1628045228"><a href="#local-1628045228"><span class="hs-identifier">isMonadFailInstanceMissing</span></a></a><span> </span><a name="local-1628045229"><a href="#local-1628045229"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-592"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045229"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-593"></a><span>            </span><a href="TcRnTypes.html#FailablePattern"><span class="hs-identifier hs-var">FailablePattern</span></a><span> </span><a name="local-1628045230"><a href="#local-1628045230"><span class="hs-identifier">_pat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-594"></a><span>            </span><a name="local-1628045231"><a href="#local-1628045231"><span class="hs-identifier">_otherwise</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-identifier">maybeReportHoleError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-597"></a><a name="maybeReportHoleError"><a href="TcErrors.html#maybeReportHoleError"><span class="hs-identifier">maybeReportHoleError</span></a></a><span> </span><a name="local-1628045236"><a href="#local-1628045236"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045237"><a href="#local-1628045237"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045238"><a href="#local-1628045238"><span class="hs-identifier">err</span></a></a><span>
</span><a name="line-598"></a><span>  </span><span class="hs-comment">-- When -XPartialTypeSignatures is on, warnings (instead of errors) are</span><span>
</span><a name="line-599"></a><span>  </span><span class="hs-comment">-- generated for holes in partial type signatures.</span><span>
</span><a name="line-600"></a><span>  </span><span class="hs-comment">-- Unless -fwarn_partial_type_signatures is not on,</span><span>
</span><a name="line-601"></a><span>  </span><span class="hs-comment">-- in which case the messages are discarded.</span><span>
</span><a name="line-602"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#isTypeHoleCt"><span class="hs-identifier hs-var">isTypeHoleCt</span></a><span> </span><a href="#local-1628045237"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-603"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- For partial type signatures, generate warnings only, and do that</span><span>
</span><a name="line-604"></a><span>    </span><span class="hs-comment">-- only if -fwarn_partial_type_signatures is on</span><span>
</span><a name="line-605"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cec_type_holes</span><span> </span><a href="#local-1628045236"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-606"></a><span>       </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportError"><span class="hs-identifier hs-var">reportError</span></a><span> </span><a href="#local-1628045238"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-607"></a><span>       </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnPartialTypeSignatures"><span class="hs-identifier hs-var">Opt_WarnPartialTypeSignatures</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045238"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-608"></a><span>       </span><a href="TcErrors.html#HoleDefer"><span class="hs-identifier hs-var">HoleDefer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span>  </span><span class="hs-comment">-- Otherwise this is a typed hole in an expression</span><span>
</span><a name="line-611"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-612"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- If deferring, report a warning only if -Wtyped-holds is on</span><span>
</span><a name="line-613"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cec_expr_holes</span><span> </span><a href="#local-1628045236"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-614"></a><span>       </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportError"><span class="hs-identifier hs-var">reportError</span></a><span> </span><a href="#local-1628045238"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-615"></a><span>       </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnTypedHoles"><span class="hs-identifier hs-var">Opt_WarnTypedHoles</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045238"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-616"></a><span>       </span><a href="TcErrors.html#HoleDefer"><span class="hs-identifier hs-var">HoleDefer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span>
</span><a name="line-618"></a><span class="hs-identifier">maybeReportError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span class="hs-comment">-- Report the error and/or make a deferred binding for it</span><span>
</span><a name="line-620"></a><a name="maybeReportError"><a href="TcErrors.html#maybeReportError"><span class="hs-identifier">maybeReportError</span></a></a><span> </span><a name="local-1628045239"><a href="#local-1628045239"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045240"><a href="#local-1628045240"><span class="hs-identifier">err</span></a></a><span>
</span><a name="line-621"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045239"><span class="hs-identifier hs-var">ctxt</span></a><span>    </span><span class="hs-comment">-- Some worse error has occurred;</span><span>
</span><a name="line-622"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- so suppress this error/warning</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">cec_errors_as_warns</span><span> </span><a href="#local-1628045239"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-625"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><a href="#local-1628045240"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-628"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cec_defer_type_errors</span><span> </span><a href="#local-1628045239"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-629"></a><span>      </span><a href="TcErrors.html#TypeDefer"><span class="hs-identifier hs-var">TypeDefer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>      </span><a href="TcErrors.html#TypeWarn"><span class="hs-identifier hs-var">TypeWarn</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportWarning"><span class="hs-identifier hs-var">reportWarning</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnDeferredTypeErrors"><span class="hs-identifier hs-var">Opt_WarnDeferredTypeErrors</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045240"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-631"></a><span>      </span><a href="TcErrors.html#TypeError"><span class="hs-identifier hs-var">TypeError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#reportError"><span class="hs-identifier hs-var">reportError</span></a><span> </span><a href="#local-1628045240"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-632"></a><span>
</span><a name="line-633"></a><span class="hs-identifier">addDeferredBinding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span class="hs-comment">-- See Note [Deferring coercion errors to runtime]</span><span>
</span><a name="line-635"></a><a name="addDeferredBinding"><a href="TcErrors.html#addDeferredBinding"><span class="hs-identifier">addDeferredBinding</span></a></a><span> </span><a name="local-1628045241"><a href="#local-1628045241"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045242"><a href="#local-1628045242"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1628045243"><a href="#local-1628045243"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-636"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#CtWanted"><span class="hs-identifier hs-var">CtWanted</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctev_pred</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045244"><a href="#local-1628045244"><span class="hs-identifier">pred</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctev_dest</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045245"><a href="#local-1628045245"><span class="hs-identifier">dest</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1628045243"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-637"></a><span>    </span><span class="hs-comment">-- Only add deferred bindings for Wanted constraints</span><span>
</span><a name="line-638"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045246"><a href="#local-1628045246"><span class="hs-identifier">ev_binds_var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cec_binds</span><span> </span><a href="#local-1628045241"><span class="hs-identifier hs-var">ctxt</span></a><span>  </span><span class="hs-comment">-- We have somewhere to put the bindings</span><span>
</span><a name="line-639"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045247"><a href="#local-1628045247"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-640"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045248"><a href="#local-1628045248"><span class="hs-identifier">err_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ErrUtils.html#pprLocErrMsg"><span class="hs-identifier hs-var">pprLocErrMsg</span></a><span> </span><a href="#local-1628045242"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-641"></a><span>             </span><a name="local-1628045249"><a href="#local-1628045249"><span class="hs-identifier">err_fs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a><span> </span><a href="#local-1628045247"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-642"></a><span>                       </span><a href="#local-1628045248"><span class="hs-identifier hs-var">err_msg</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(deferred type error)&quot;</span><span>
</span><a name="line-643"></a><span>             </span><a name="local-1628045250"><a href="#local-1628045250"><span class="hs-identifier">err_tm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvDelayedError"><span class="hs-identifier hs-var">EvDelayedError</span></a><span> </span><a href="#local-1628045244"><span class="hs-identifier hs-var">pred</span></a><span> </span><a href="#local-1628045249"><span class="hs-identifier hs-var">err_fs</span></a><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045245"><span class="hs-identifier hs-var">dest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-646"></a><span>           </span><a href="TcRnTypes.html#EvVarDest"><span class="hs-identifier hs-var">EvVarDest</span></a><span> </span><a name="local-1628045251"><a href="#local-1628045251"><span class="hs-identifier">evar</span></a></a><span>
</span><a name="line-647"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#addTcEvBind"><span class="hs-identifier hs-var">addTcEvBind</span></a><span> </span><a href="#local-1628045246"><span class="hs-identifier hs-var">ev_binds_var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcEvidence.html#mkWantedEvBind"><span class="hs-identifier hs-var">mkWantedEvBind</span></a><span> </span><a href="#local-1628045251"><span class="hs-identifier hs-var">evar</span></a><span> </span><a href="#local-1628045250"><span class="hs-identifier hs-var">err_tm</span></a><span>
</span><a name="line-648"></a><span>           </span><a href="TcRnTypes.html#HoleDest"><span class="hs-identifier hs-var">HoleDest</span></a><span> </span><a name="local-1628045252"><a href="#local-1628045252"><span class="hs-identifier">hole</span></a></a><span>
</span><a name="line-649"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [Deferred errors for coercion holes]</span><span>
</span><a name="line-650"></a><span>                     </span><a name="local-1628045253"><a href="#local-1628045253"><span class="hs-identifier">evar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#newEvVar"><span class="hs-identifier hs-var">newEvVar</span></a><span> </span><a href="#local-1628045244"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-651"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#addTcEvBind"><span class="hs-identifier hs-var">addTcEvBind</span></a><span> </span><a href="#local-1628045246"><span class="hs-identifier hs-var">ev_binds_var</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcEvidence.html#mkWantedEvBind"><span class="hs-identifier hs-var">mkWantedEvBind</span></a><span> </span><a href="#local-1628045253"><span class="hs-identifier hs-var">evar</span></a><span> </span><a href="#local-1628045250"><span class="hs-identifier hs-var">err_tm</span></a><span>
</span><a name="line-652"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#fillCoercionHole"><span class="hs-identifier hs-var">fillCoercionHole</span></a><span> </span><a href="#local-1628045252"><span class="hs-identifier hs-var">hole</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcCoVarCo"><span class="hs-identifier hs-var">mkTcCoVarCo</span></a><span> </span><a href="#local-1628045253"><span class="hs-identifier hs-var">evar</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-comment">-- Do not set any evidence for Given/Derived</span><span>
</span><a name="line-655"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-identifier">maybeAddDeferredHoleBinding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-658"></a><a name="maybeAddDeferredHoleBinding"><a href="TcErrors.html#maybeAddDeferredHoleBinding"><span class="hs-identifier">maybeAddDeferredHoleBinding</span></a></a><span> </span><a name="local-1628045254"><a href="#local-1628045254"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045255"><a href="#local-1628045255"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1628045256"><a href="#local-1628045256"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-659"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#isExprHoleCt"><span class="hs-identifier hs-var">isExprHoleCt</span></a><span> </span><a href="#local-1628045256"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-660"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cec_expr_holes</span><span> </span><a href="#local-1628045254"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-661"></a><span>        </span><a href="TcErrors.html#HoleDefer"><span class="hs-identifier hs-var">HoleDefer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-662"></a><span>        </span><a href="TcErrors.html#HoleWarn"><span class="hs-identifier hs-var">HoleWarn</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-663"></a><span>        </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-664"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addDeferredBinding"><span class="hs-identifier hs-var">addDeferredBinding</span></a><span> </span><a href="#local-1628045254"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045255"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="#local-1628045256"><span class="hs-identifier hs-var">ct</span></a><span>  </span><span class="hs-comment">-- Only add bindings for holes in expressions</span><span>
</span><a name="line-665"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                       </span><span class="hs-comment">-- not for holes in partial type signatures</span><span>
</span><a name="line-666"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>
</span><a name="line-668"></a><span class="hs-identifier">maybeAddDeferredBinding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-669"></a><a name="maybeAddDeferredBinding"><a href="TcErrors.html#maybeAddDeferredBinding"><span class="hs-identifier">maybeAddDeferredBinding</span></a></a><span> </span><a name="local-1628045257"><a href="#local-1628045257"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045258"><a href="#local-1628045258"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1628045259"><a href="#local-1628045259"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cec_defer_type_errors</span><span> </span><a href="#local-1628045257"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-671"></a><span>        </span><a href="TcErrors.html#TypeDefer"><span class="hs-identifier hs-var">TypeDefer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045260"><span class="hs-identifier hs-var">deferred</span></a><span>
</span><a name="line-672"></a><span>        </span><a href="TcErrors.html#TypeWarn"><span class="hs-identifier hs-var">TypeWarn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045260"><span class="hs-identifier hs-var">deferred</span></a><span>
</span><a name="line-673"></a><span>        </span><a href="TcErrors.html#TypeError"><span class="hs-identifier hs-var">TypeError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-675"></a><span>    </span><a name="local-1628045260"><a href="#local-1628045260"><span class="hs-identifier">deferred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addDeferredBinding"><span class="hs-identifier hs-var">addDeferredBinding</span></a><span> </span><a href="#local-1628045257"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045258"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="#local-1628045259"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-identifier">tryReporters</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#ReporterSpec"><span class="hs-identifier hs-type">ReporterSpec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span class="hs-comment">-- Use the first reporter in the list whose predicate says True</span><span>
</span><a name="line-679"></a><a name="tryReporters"><a href="TcErrors.html#tryReporters"><span class="hs-identifier">tryReporters</span></a></a><span> </span><a name="local-1628045261"><a href="#local-1628045261"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045262"><a href="#local-1628045262"><span class="hs-identifier">reporters</span></a></a><span> </span><a name="local-1628045263"><a href="#local-1628045263"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-680"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tryReporters {&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045263"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-681"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628045273"><a href="#local-1628045273"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045274"><a href="#local-1628045274"><span class="hs-identifier">cts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045264"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045261"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045262"><span class="hs-identifier hs-var">reporters</span></a><span> </span><a href="#local-1628045263"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-682"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tryReporters }&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045274"><span class="hs-identifier hs-var">cts'</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045273"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045274"><span class="hs-identifier hs-var">cts'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-684"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-685"></a><span>    </span><a name="local-1628045264"><a href="#local-1628045264"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1628045265"><a href="#local-1628045265"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628045266"><a href="#local-1628045266"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-686"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045265"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045266"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045267"><a href="#local-1628045267"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045268"><a href="#local-1628045268"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628045269"><a href="#local-1628045269"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045270"><a href="#local-1628045270"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-689"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045271"><a href="#local-1628045271"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045272"><a href="#local-1628045272"><span class="hs-identifier">cts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#tryReporter"><span class="hs-identifier hs-var">tryReporter</span></a><span> </span><a href="#local-1628045267"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045268"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628045270"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-690"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="#local-1628045264"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045271"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><a href="#local-1628045269"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="#local-1628045272"><span class="hs-identifier hs-var">cts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-691"></a><span>                </span><span class="hs-comment">-- Carry on with the rest, because we must make</span><span>
</span><a name="line-692"></a><span>                </span><span class="hs-comment">-- deferred bindings for them if we have -fdefer-type-errors</span><span>
</span><a name="line-693"></a><span>                </span><span class="hs-comment">-- But suppress their error messages</span><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-identifier">tryReporter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#ReporterSpec"><span class="hs-identifier hs-type">ReporterSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-696"></a><a name="tryReporter"><a href="TcErrors.html#tryReporter"><span class="hs-identifier">tryReporter</span></a></a><span> </span><a name="local-1628045275"><a href="#local-1628045275"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045276"><a href="#local-1628045276"><span class="hs-identifier">str</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045277"><a href="#local-1628045277"><span class="hs-identifier">keep_me</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-1628045278"><a href="#local-1628045278"><span class="hs-identifier">suppress_after</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045279"><a href="#local-1628045279"><span class="hs-identifier">reporter</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045280"><a href="#local-1628045280"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-697"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045281"><span class="hs-identifier hs-var">yeses</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045275"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045280"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tryReporter:&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628045276"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045281"><span class="hs-identifier hs-var">yeses</span></a><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>                    </span><span class="hs-special">;</span><span> </span><a href="#local-1628045279"><span class="hs-identifier hs-var">reporter</span></a><span> </span><a href="#local-1628045275"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045281"><span class="hs-identifier hs-var">yeses</span></a><span>
</span><a name="line-700"></a><span>                    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045284"><a href="#local-1628045284"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045275"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045278"><span class="hs-identifier hs-var">suppress_after</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">cec_suppress</span><span> </span><a href="#local-1628045275"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-701"></a><span>                    </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045284"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045282"><span class="hs-identifier hs-var">nos</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-702"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-703"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045281"><a href="#local-1628045281"><span class="hs-identifier">yeses</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045282"><a href="#local-1628045282"><span class="hs-identifier">nos</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628045283"><a href="#local-1628045283"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045277"><span class="hs-identifier hs-var">keep_me</span></a><span> </span><a href="#local-1628045283"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045283"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628045280"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-identifier">pprArising</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-707"></a><span class="hs-comment">-- Used for the main, top-level error message</span><span>
</span><a name="line-708"></a><span class="hs-comment">-- We've done special processing for TypeEq, KindEq, Given</span><span>
</span><a name="line-709"></a><a name="pprArising"><a href="TcErrors.html#pprArising"><span class="hs-identifier">pprArising</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-710"></a><span class="hs-identifier">pprArising</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-711"></a><span class="hs-identifier">pprArising</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#GivenOrigin"><span class="hs-identifier hs-var">GivenOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-712"></a><span class="hs-identifier">pprArising</span><span> </span><a name="local-1628045285"><a href="#local-1628045285"><span class="hs-identifier">orig</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span> </span><a href="#local-1628045285"><span class="hs-identifier hs-var">orig</span></a><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-comment">-- Add the &quot;arising from...&quot; part to a message about bunch of dicts</span><span>
</span><a name="line-715"></a><span class="hs-identifier">addArising</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-716"></a><a name="addArising"><a href="TcErrors.html#addArising"><span class="hs-identifier">addArising</span></a></a><span> </span><a name="local-1628045286"><a href="#local-1628045286"><span class="hs-identifier">orig</span></a></a><span> </span><a name="local-1628045287"><a href="#local-1628045287"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-1628045287"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pprArising"><span class="hs-identifier hs-var">pprArising</span></a><span> </span><a href="#local-1628045286"><span class="hs-identifier hs-var">orig</span></a><span class="hs-special">)</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-identifier">pprWithArising</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span class="hs-comment">-- Print something like</span><span>
</span><a name="line-720"></a><span class="hs-comment">--    (Eq a) arising from a use of x at y</span><span>
</span><a name="line-721"></a><span class="hs-comment">--    (Show a) arising from a use of p at q</span><span>
</span><a name="line-722"></a><span class="hs-comment">-- Also return a location for the error message</span><span>
</span><a name="line-723"></a><span class="hs-comment">-- Works for Wanted/Derived only</span><span>
</span><a name="line-724"></a><a name="pprWithArising"><a href="TcErrors.html#pprWithArising"><span class="hs-identifier">pprWithArising</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-725"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;pprWithArising&quot;</span><span>
</span><a name="line-726"></a><span class="hs-identifier">pprWithArising</span><span> </span><span class="hs-special">(</span><a name="local-1628045288"><a href="#local-1628045288"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">:</span><a name="local-1628045289"><a href="#local-1628045289"><span class="hs-identifier">cts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045289"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-728"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045290"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1628045290"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>                     </span><span class="hs-special">(</span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045288"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-731"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045290"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628045291"><span class="hs-identifier hs-var">ppr_one</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045288"><span class="hs-identifier hs-var">ct</span></a><span class="hs-glyph">:</span><a href="#local-1628045289"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-732"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-733"></a><span>    </span><a name="local-1628045290"><a href="#local-1628045290"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045288"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-734"></a><span>    </span><a name="local-1628045291"><a href="#local-1628045291"><span class="hs-identifier">ppr_one</span></a></a><span> </span><a name="local-1628045292"><a href="#local-1628045292"><span class="hs-identifier">ct'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045292"><span class="hs-identifier hs-var">ct'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-735"></a><span>                     </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprCtLoc"><span class="hs-identifier hs-var">pprCtLoc</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045292"><span class="hs-identifier hs-var">ct'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span>
</span><a name="line-737"></a><span class="hs-identifier">mkErrorMsgFromCt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-738"></a><a name="mkErrorMsgFromCt"><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier">mkErrorMsgFromCt</span></a></a><span> </span><a name="local-1628045293"><a href="#local-1628045293"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045294"><a href="#local-1628045294"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045295"><a href="#local-1628045295"><span class="hs-identifier">report</span></a></a><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a><span> </span><a href="#local-1628045293"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045294"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628045295"><span class="hs-identifier hs-var">report</span></a><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span class="hs-identifier">mkErrorReport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-742"></a><a name="mkErrorReport"><a href="TcErrors.html#mkErrorReport"><span class="hs-identifier">mkErrorReport</span></a></a><span> </span><a name="local-1628045296"><a href="#local-1628045296"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045297"><a href="#local-1628045297"><span class="hs-identifier">tcl_env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#Report"><span class="hs-identifier hs-var">Report</span></a><span> </span><a name="local-1628045298"><a href="#local-1628045298"><span class="hs-identifier">important</span></a></a><span> </span><a name="local-1628045299"><a href="#local-1628045299"><span class="hs-identifier">relevant_bindings</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-743"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045300"><a href="#local-1628045300"><span class="hs-identifier">context</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#mkErrInfo"><span class="hs-identifier hs-var">mkErrInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_tidy</span><span> </span><a href="#local-1628045296"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_ctxt</span><span> </span><a href="#local-1628045297"><span class="hs-identifier hs-var">tcl_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#mkErrDocAt"><span class="hs-identifier hs-var">mkErrDocAt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-var">RealSrcSpan</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045297"><span class="hs-identifier hs-var">tcl_env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-745"></a><span>            </span><span class="hs-special">(</span><a href="ErrUtils.html#errDoc"><span class="hs-identifier hs-var">errDoc</span></a><span> </span><a href="#local-1628045298"><span class="hs-identifier hs-var">important</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045300"><span class="hs-identifier hs-var">context</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628045299"><span class="hs-identifier hs-var">relevant_bindings</span></a><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span class="hs-keyword">type</span><span> </span><a name="UserGiven"><a href="TcErrors.html#UserGiven"><span class="hs-identifier">UserGiven</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span>
</span><a name="line-749"></a><span>
</span><a name="line-750"></a><span class="hs-identifier">getUserGivens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span>
</span><a name="line-751"></a><span class="hs-comment">-- One item for each enclosing implication</span><span>
</span><a name="line-752"></a><a name="getUserGivens"><a href="TcErrors.html#getUserGivens"><span class="hs-identifier">getUserGivens</span></a></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#CEC"><span class="hs-identifier hs-var">CEC</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cec_encl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045301"><a href="#local-1628045301"><span class="hs-identifier">implics</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#getUserGivensFromImplics"><span class="hs-identifier hs-var">getUserGivensFromImplics</span></a><span> </span><a href="#local-1628045301"><span class="hs-identifier hs-var">implics</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span class="hs-identifier">getUserGivensFromImplics</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span>
</span><a name="line-755"></a><a name="getUserGivensFromImplics"><a href="TcErrors.html#getUserGivensFromImplics"><span class="hs-identifier">getUserGivensFromImplics</span></a></a><span> </span><a name="local-1628045302"><a href="#local-1628045302"><span class="hs-identifier">implics</span></a></a><span>
</span><a name="line-756"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">ic_given</span><span class="hs-special">)</span><span> </span><a href="#local-1628045302"><span class="hs-identifier hs-var">implics</span></a><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-comment">{-
Note [Always warn with -fdefer-type-errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When -fdefer-type-errors is on we warn about *all* type errors, even
if cec_suppress is on.  This can lead to a lot more warnings than you
would get errors without -fdefer-type-errors, but if we suppress any of
them you might get a runtime error that wasn't warned about at compile
time.

This is an easy design choice to change; just flip the order of the
first two equations for maybeReportError

To be consistent, we should also report multiple warnings from a single
location in mkGroupReporter, when -fdefer-type-errors is on.  But that
is perhaps a bit *over*-consistent! Again, an easy choice to change.

With #10283, you can now opt out of deferred type error warnings.

Note [Deferred errors for coercion holes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we need to defer a type error where the destination for the evidence
is a coercion hole. We can't just put the error in the hole, because we can't
make an erroneous coercion. (Remember that coercions are erased for runtime.)
Instead, we invent a new EvVar, bind it to an error and then make a coercion
from that EvVar, filling the hole with that coercion. Because coercions'
types are unlifted, the error is guaranteed to be hit before we get to the
coercion.

Note [Do not report derived but soluble errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The wc_simples include Derived constraints that have not been solved, but are
not insoluble (in that case they'd be in wc_insols).  We do not want to report
these as errors:

* Superclass constraints. If we have an unsolved [W] Ord a, we'll also have
  an unsolved [D] Eq a, and we do not want to report that; it's just noise.

* Functional dependencies.  For givens, consider
      class C a b | a -&gt; b
      data T a where
         MkT :: C a d =&gt; [d] -&gt; T a
      f :: C a b =&gt; T a -&gt; F Int
      f (MkT xs) = length xs
  Then we get a [D] b~d.  But there *is* a legitimate call to
  f, namely   f (MkT [True]) :: T Bool, in which b=d.  So we should
  not reject the program.

  For wanteds, something similar
      data T a where
        MkT :: C Int b =&gt; a -&gt; b -&gt; T a
      g :: C Int c =&gt; c -&gt; ()
      f :: T a -&gt; ()
      f (MkT x y) = g x
  Here we get [G] C Int b, [W] C Int a, hence [D] a~b.
  But again f (MkT True True) is a legitimate call.

(We leave the Deriveds in wc_simple until reportErrors, so that we don't lose
derived superclasses between iterations of the solver.)

For functional dependencies, here is a real example,
stripped off from libraries/utf8-string/Codec/Binary/UTF8/Generic.hs

  class C a b | a -&gt; b
  g :: C a b =&gt; a -&gt; b -&gt; ()
  f :: C a b =&gt; a -&gt; b -&gt; ()
  f xa xb =
      let loop = g xa
      in loop xb

We will first try to infer a type for loop, and we will succeed:
    C a b' =&gt; b' -&gt; ()
Subsequently, we will type check (loop xb) and all is good. But,
recall that we have to solve a final implication constraint:
    C a b =&gt; (C a b' =&gt; .... cts from body of loop .... ))
And now we have a problem as we will generate an equality b ~ b' and fail to
solve it.


************************************************************************
*                                                                      *
                Irreducible predicate errors
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-842"></a><span>
</span><a name="line-843"></a><span class="hs-identifier">mkIrredErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-844"></a><a name="mkIrredErr"><a href="TcErrors.html#mkIrredErr"><span class="hs-identifier">mkIrredErr</span></a></a><span> </span><a name="local-1628045303"><a href="#local-1628045303"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045304"><a href="#local-1628045304"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-845"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045306"><a href="#local-1628045306"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045307"><a href="#local-1628045307"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045308"><a href="#local-1628045308"><span class="hs-identifier">ct1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045303"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045305"><span class="hs-identifier hs-var">ct1</span></a><span>
</span><a name="line-846"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045309"><a href="#local-1628045309"><span class="hs-identifier">orig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045308"><span class="hs-identifier hs-var">ct1</span></a><span>
</span><a name="line-847"></a><span>             </span><a name="local-1628045310"><a href="#local-1628045310"><span class="hs-identifier">msg</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#couldNotDeduce"><span class="hs-identifier hs-var">couldNotDeduce</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a><span> </span><a href="#local-1628045306"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045304"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045309"><span class="hs-identifier hs-var">orig</span></a><span class="hs-special">)</span><span>
</span><a name="line-848"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045306"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045308"><span class="hs-identifier hs-var">ct1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-849"></a><span>            </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045310"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="#local-1628045307"><span class="hs-identifier hs-var">binds_msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-850"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-851"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045305"><a href="#local-1628045305"><span class="hs-identifier">ct1</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045304"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-854"></a><span class="hs-identifier">mkHoleError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-855"></a><a name="mkHoleError"><a href="TcErrors.html#mkHoleError"><span class="hs-identifier">mkHoleError</span></a></a><span> </span><a name="local-1628045311"><a href="#local-1628045311"><span class="hs-identifier">_ctxt</span></a></a><span> </span><a name="local-1628045312"><a href="#local-1628045312"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ExprHole"><span class="hs-identifier hs-var">ExprHole</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OutOfScope"><span class="hs-identifier hs-var">OutOfScope</span></a><span> </span><a name="local-1628045313"><a href="#local-1628045313"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1628045314"><a href="#local-1628045314"><span class="hs-identifier">rdr_env0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>  </span><span class="hs-comment">-- Out-of-scope variables, like 'a', where 'a' isn't bound; suggest possible</span><span>
</span><a name="line-857"></a><span>  </span><span class="hs-comment">-- in-scope variables in the message, and note inaccessible exact matches</span><span>
</span><a name="line-858"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045341"><a href="#local-1628045341"><span class="hs-identifier">dflags</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-859"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045342"><a href="#local-1628045342"><span class="hs-identifier">imp_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getImports"><span class="hs-identifier hs-var">getImports</span></a><span>
</span><a name="line-860"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045343"><a href="#local-1628045343"><span class="hs-identifier">suggs_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unknownNameSuggestions"><span class="hs-identifier hs-var">unknownNameSuggestions</span></a><span> </span><a href="#local-1628045341"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045314"><span class="hs-identifier hs-var">rdr_env0</span></a><span>
</span><a name="line-861"></a><span>                                                </span><span class="hs-special">(</span><span class="hs-identifier">tcl_rdr</span><span> </span><a href="#local-1628045317"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045342"><span class="hs-identifier hs-var">imp_info</span></a><span> </span><a href="#local-1628045315"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-862"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045344"><a href="#local-1628045344"><span class="hs-identifier">rdr_env</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-863"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045345"><a href="#local-1628045345"><span class="hs-identifier">splice_locs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getTopLevelSpliceLocs"><span class="hs-identifier hs-var">getTopLevelSpliceLocs</span></a><span>
</span><a name="line-864"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045346"><a href="#local-1628045346"><span class="hs-identifier">match_msgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045323"><span class="hs-identifier hs-var">mk_match_msgs</span></a><span> </span><a href="#local-1628045344"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-1628045345"><span class="hs-identifier hs-var">splice_locs</span></a><span>
</span><a name="line-865"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#mkErrDocAt"><span class="hs-identifier hs-var">mkErrDocAt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-var">RealSrcSpan</span></a><span> </span><a href="#local-1628045318"><span class="hs-identifier hs-var">err_loc</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-866"></a><span>                    </span><a href="ErrUtils.html#errDoc"><span class="hs-identifier hs-var">errDoc</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045321"><span class="hs-identifier hs-var">out_of_scope_msg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-1628045346"><span class="hs-identifier hs-var">match_msgs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045343"><span class="hs-identifier hs-var">suggs_msg</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-869"></a><span>    </span><a name="local-1628045315"><a href="#local-1628045315"><span class="hs-identifier">rdr</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-870"></a><span>    </span><a name="local-1628045316"><a href="#local-1628045316"><span class="hs-identifier">ct_loc</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045312"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-871"></a><span>    </span><a name="local-1628045317"><a href="#local-1628045317"><span class="hs-identifier">lcl_env</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a><span> </span><a href="#local-1628045316"><span class="hs-identifier hs-var">ct_loc</span></a><span>
</span><a name="line-872"></a><span>    </span><a name="local-1628045318"><a href="#local-1628045318"><span class="hs-identifier">err_loc</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045317"><span class="hs-identifier hs-var">lcl_env</span></a><span>
</span><a name="line-873"></a><span>    </span><a name="local-1628045319"><a href="#local-1628045319"><span class="hs-identifier">hole_ty</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1628045312"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-874"></a><span>    </span><a name="local-1628045320"><a href="#local-1628045320"><span class="hs-identifier">boring_type</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span> </span><a href="#local-1628045319"><span class="hs-identifier hs-var">hole_ty</span></a><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span>    </span><a name="local-1628045321"><a href="#local-1628045321"><span class="hs-identifier">out_of_scope_msg</span></a></a><span> </span><span class="hs-comment">-- Print v :: ty only if the type has structure</span><span>
</span><a name="line-877"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045320"><span class="hs-identifier hs-var">boring_type</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-1628045322"><span class="hs-identifier hs-var">herald</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-1628045322"><span class="hs-identifier hs-var">herald</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pp_with_type"><span class="hs-identifier hs-var">pp_with_type</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1628045319"><span class="hs-identifier hs-var">hole_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-879"></a><span>
</span><a name="line-880"></a><span>    </span><a name="local-1628045322"><a href="#local-1628045322"><span class="hs-identifier">herald</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data constructor not in scope:&quot;</span><span>
</span><a name="line-881"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable not in scope:&quot;</span><span>
</span><a name="line-882"></a><span>
</span><a name="line-883"></a><span>    </span><span class="hs-comment">-- Indicate if the out-of-scope variable exactly (and unambiguously) matches</span><span>
</span><a name="line-884"></a><span>    </span><span class="hs-comment">-- a top-level binding in a later inter-splice group; see Note [OutOfScope</span><span>
</span><a name="line-885"></a><span>    </span><span class="hs-comment">-- exact matches]</span><span>
</span><a name="line-886"></a><span>    </span><a name="local-1628045323"><a href="#local-1628045323"><span class="hs-identifier">mk_match_msgs</span></a></a><span> </span><a name="local-1628045325"><a href="#local-1628045325"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-1628045326"><a href="#local-1628045326"><span class="hs-identifier">splice_locs</span></a></a><span>
</span><a name="line-887"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045327"><a href="#local-1628045327"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><a href="#local-1628045325"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045327"><span class="hs-identifier hs-var">gres</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-889"></a><span>             </span><span class="hs-special">[</span><a name="local-1628045328"><a href="#local-1628045328"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-890"></a><span>               </span><span class="hs-glyph">|</span><span>  </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-var">RealSrcSpan</span></a><span> </span><a name="local-1628045329"><a href="#local-1628045329"><span class="hs-identifier">bind_loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#greSrcSpan"><span class="hs-identifier hs-var">greSrcSpan</span></a><span> </span><a href="#local-1628045328"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-891"></a><span>                  </span><span class="hs-comment">-- Find splice between the unbound variable and the match; use</span><span>
</span><a name="line-892"></a><span>                  </span><span class="hs-comment">-- lookupLE, not lookupLT, since match could be in the splice</span><span>
</span><a name="line-893"></a><span>               </span><span class="hs-special">,</span><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045330"><a href="#local-1628045330"><span class="hs-identifier">th_loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../containers-0.5.7.1/src/%{MODULE/./-}.html#%{NAME}/Data.Set.Base.html#lookupLE"><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookupLE</span></a><span> </span><a href="#local-1628045329"><span class="hs-identifier hs-var">bind_loc</span></a><span> </span><a href="#local-1628045326"><span class="hs-identifier hs-var">splice_locs</span></a><span>
</span><a name="line-894"></a><span>               </span><span class="hs-special">,</span><span>  </span><a href="#local-1628045318"><span class="hs-identifier hs-var">err_loc</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1628045330"><span class="hs-identifier hs-var">th_loc</span></a><span>
</span><a name="line-895"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628045324"><span class="hs-identifier hs-var">mk_bind_scope_msg</span></a><span> </span><a href="#local-1628045329"><span class="hs-identifier hs-var">bind_loc</span></a><span> </span><a href="#local-1628045330"><span class="hs-identifier hs-var">th_loc</span></a><span class="hs-special">]</span><span>
</span><a name="line-896"></a><span>             </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-897"></a><span>
</span><a name="line-898"></a><span>    </span><a name="local-1628045324"><a href="#local-1628045324"><span class="hs-identifier">mk_bind_scope_msg</span></a></a><span> </span><a name="local-1628045331"><a href="#local-1628045331"><span class="hs-identifier">bind_loc</span></a></a><span> </span><a name="local-1628045332"><a href="#local-1628045332"><span class="hs-identifier">th_loc</span></a></a><span>
</span><a name="line-899"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045340"><span class="hs-identifier hs-var">is_th_bind</span></a><span>
</span><a name="line-900"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;splice on&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045334"><span class="hs-identifier hs-var">th_rng</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-901"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not in scope before line&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628045338"><span class="hs-identifier hs-var">th_start_ln</span></a><span class="hs-special">)</span><span>
</span><a name="line-902"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-903"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045313"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045333"><span class="hs-identifier hs-var">bind_rng</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not in scope&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-904"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;before the splice on&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045334"><span class="hs-identifier hs-var">th_rng</span></a><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-906"></a><span>        </span><a name="local-1628045333"><a href="#local-1628045333"><span class="hs-identifier">bind_rng</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;line&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628045337"><span class="hs-identifier hs-var">bind_ln</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>        </span><a name="local-1628045334"><a href="#local-1628045334"><span class="hs-identifier">th_rng</span></a></a><span>
</span><a name="line-908"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045338"><span class="hs-identifier hs-var">th_start_ln</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628045339"><span class="hs-identifier hs-var">th_end_ln</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045335"><span class="hs-identifier hs-var">single</span></a><span>
</span><a name="line-909"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045336"><span class="hs-identifier hs-var">multi</span></a><span>
</span><a name="line-910"></a><span>        </span><a name="local-1628045335"><a href="#local-1628045335"><span class="hs-identifier">single</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;line&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628045338"><span class="hs-identifier hs-var">th_start_ln</span></a><span>
</span><a name="line-911"></a><span>        </span><a name="local-1628045336"><a href="#local-1628045336"><span class="hs-identifier">multi</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628045338"><span class="hs-identifier hs-var">th_start_ln</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628045339"><span class="hs-identifier hs-var">th_end_ln</span></a><span>
</span><a name="line-912"></a><span>        </span><a name="local-1628045337"><a href="#local-1628045337"><span class="hs-identifier">bind_ln</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a><span> </span><a href="#local-1628045331"><span class="hs-identifier hs-var">bind_loc</span></a><span>
</span><a name="line-913"></a><span>        </span><a name="local-1628045338"><a href="#local-1628045338"><span class="hs-identifier">th_start_ln</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a><span> </span><a href="#local-1628045332"><span class="hs-identifier hs-var">th_loc</span></a><span>
</span><a name="line-914"></a><span>        </span><a name="local-1628045339"><a href="#local-1628045339"><span class="hs-identifier">th_end_ln</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#srcSpanEndLine"><span class="hs-identifier hs-var">srcSpanEndLine</span></a><span>   </span><a href="#local-1628045332"><span class="hs-identifier hs-var">th_loc</span></a><span>
</span><a name="line-915"></a><span>        </span><a name="local-1628045340"><a href="#local-1628045340"><span class="hs-identifier">is_th_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045332"><span class="hs-identifier hs-var">th_loc</span></a><span> </span><span class="hs-special">`</span><a href="SrcLoc.html#containsSpan"><span class="hs-identifier hs-var">containsSpan</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045331"><span class="hs-identifier hs-var">bind_loc</span></a><span>
</span><a name="line-916"></a><span>
</span><a name="line-917"></a><span class="hs-identifier">mkHoleError</span><span> </span><a name="local-1628045347"><a href="#local-1628045347"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045348"><a href="#local-1628045348"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcRnTypes.html#CHoleCan"><span class="hs-identifier hs-var">CHoleCan</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cc_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045349"><a href="#local-1628045349"><span class="hs-identifier">hole</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>  </span><span class="hs-comment">-- Explicit holes, like &quot;_&quot; or &quot;_f&quot;</span><span>
</span><a name="line-919"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045361"><a href="#local-1628045361"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045362"><a href="#local-1628045362"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045363"><a href="#local-1628045363"><span class="hs-identifier">ct</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-1628045347"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045348"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-920"></a><span>               </span><span class="hs-comment">-- The 'False' means &quot;don't filter the bindings&quot;; see Trac #8191</span><span>
</span><a name="line-921"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045361"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045363"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-922"></a><span>            </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045353"><span class="hs-identifier hs-var">hole_msg</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="#local-1628045362"><span class="hs-identifier hs-var">binds_msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-923"></a><span>
</span><a name="line-924"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-925"></a><span>    </span><a name="local-1628045350"><a href="#local-1628045350"><span class="hs-identifier">occ</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#holeOcc"><span class="hs-identifier hs-var">holeOcc</span></a><span> </span><a href="#local-1628045349"><span class="hs-identifier hs-var">hole</span></a><span>
</span><a name="line-926"></a><span>    </span><a name="local-1628045351"><a href="#local-1628045351"><span class="hs-identifier">hole_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1628045348"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-927"></a><span>    </span><a name="local-1628045352"><a href="#local-1628045352"><span class="hs-identifier">tyvars</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a><span> </span><a href="#local-1628045351"><span class="hs-identifier hs-var">hole_ty</span></a><span>
</span><a name="line-928"></a><span>
</span><a name="line-929"></a><span>    </span><a name="local-1628045353"><a href="#local-1628045353"><span class="hs-identifier">hole_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045349"><span class="hs-identifier hs-var">hole</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-930"></a><span>      </span><a href="TcRnTypes.html#ExprHole"><span class="hs-identifier hs-var">ExprHole</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found hole:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>                               </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pp_with_type"><span class="hs-identifier hs-var">pp_with_type</span></a><span> </span><a href="#local-1628045350"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1628045351"><span class="hs-identifier hs-var">hole_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-932"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="#local-1628045354"><span class="hs-identifier hs-var">tyvars_msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045356"><span class="hs-identifier hs-var">expr_hole_hint</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-933"></a><span>      </span><a href="TcRnTypes.html#TypeHole"><span class="hs-identifier hs-var">TypeHole</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found type wildcard&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-934"></a><span>                                  </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045350"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><span>                               </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;standing for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-936"></a><span>                                  </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><a href="#local-1628045351"><span class="hs-identifier hs-var">hole_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-937"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="#local-1628045354"><span class="hs-identifier hs-var">tyvars_msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045355"><span class="hs-identifier hs-var">type_hole_hint</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-938"></a><span>
</span><a name="line-939"></a><span>    </span><a name="local-1628045354"><a href="#local-1628045354"><span class="hs-identifier">tyvars_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045352"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-940"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Where:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628045357"><span class="hs-identifier hs-var">loc_msg</span></a><span> </span><a href="#local-1628045352"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span>
</span><a name="line-942"></a><span>    </span><a name="local-1628045355"><a href="#local-1628045355"><span class="hs-identifier">type_hole_hint</span></a></a><span>
</span><a name="line-943"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="TcErrors.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cec_type_holes</span><span> </span><a href="#local-1628045347"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-944"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;To use the inferred type, enable PartialTypeSignatures&quot;</span><span>
</span><a name="line-945"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-946"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-947"></a><span>
</span><a name="line-948"></a><span>    </span><a name="local-1628045356"><a href="#local-1628045356"><span class="hs-identifier">expr_hole_hint</span></a></a><span>                       </span><span class="hs-comment">-- Give hint for, say,   f x = _x</span><span>
</span><a name="line-949"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="FastString.html#lengthFS"><span class="hs-identifier hs-var">lengthFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-1628045350"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-comment">-- Don't give this hint for plain &quot;_&quot;</span><span>
</span><a name="line-950"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Or perhaps&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045350"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is mis-spelled, or not in scope&quot;</span><span>
</span><a name="line-952"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-953"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-954"></a><span>
</span><a name="line-955"></a><span>    </span><a name="local-1628045357"><a href="#local-1628045357"><span class="hs-identifier">loc_msg</span></a></a><span> </span><a name="local-1628045358"><a href="#local-1628045358"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-956"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628045358"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-957"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a><span> </span><a href="#local-1628045358"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-958"></a><span>          </span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#pprSkol"><span class="hs-identifier hs-var">pprSkol</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045347"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045358"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-959"></a><span>          </span><a href="TcType.html#MetaTv"><span class="hs-identifier hs-var">MetaTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045358"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is an ambiguous type variable&quot;</span><span>
</span><a name="line-960"></a><span>          </span><a name="local-1628045359"><a href="#local-1628045359"><span class="hs-identifier">det</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a><span> </span><a href="#local-1628045359"><span class="hs-identifier hs-var">det</span></a><span>
</span><a name="line-961"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-962"></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045360"><a href="#local-1628045360"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-963"></a><span>         </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintExplicitCoercions"><span class="hs-identifier hs-var">Opt_PrintExplicitCoercions</span></a><span> </span><a href="#local-1628045360"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-964"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045358"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is a coercion variable&quot;</span><span>
</span><a name="line-965"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-identifier">mkHoleError</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628045364"><a href="#local-1628045364"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;mkHoleError&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045364"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-968"></a><span>
</span><a name="line-969"></a><span class="hs-identifier">pp_with_type</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-970"></a><a name="pp_with_type"><a href="TcErrors.html#pp_with_type"><span class="hs-identifier">pp_with_type</span></a></a><span> </span><a name="local-1628045365"><a href="#local-1628045365"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1628045366"><a href="#local-1628045366"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier hs-var">pprPrefixOcc</span></a><span> </span><a href="#local-1628045365"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><a href="#local-1628045366"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-973"></a><span class="hs-identifier">mkIPErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-974"></a><a name="mkIPErr"><a href="TcErrors.html#mkIPErr"><span class="hs-identifier">mkIPErr</span></a></a><span> </span><a name="local-1628045367"><a href="#local-1628045367"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045368"><a href="#local-1628045368"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-975"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045370"><a href="#local-1628045370"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045371"><a href="#local-1628045371"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045372"><a href="#local-1628045372"><span class="hs-identifier">ct1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045367"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045369"><span class="hs-identifier hs-var">ct1</span></a><span>
</span><a name="line-976"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045373"><a href="#local-1628045373"><span class="hs-identifier">orig</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045372"><span class="hs-identifier hs-var">ct1</span></a><span>
</span><a name="line-977"></a><span>             </span><a name="local-1628045374"><a href="#local-1628045374"><span class="hs-identifier">preds</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045368"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-978"></a><span>             </span><a name="local-1628045375"><a href="#local-1628045375"><span class="hs-identifier">givens</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a><span> </span><a href="#local-1628045370"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-979"></a><span>             </span><a name="local-1628045376"><a href="#local-1628045376"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045375"><span class="hs-identifier hs-var">givens</span></a><span>
</span><a name="line-980"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045373"><span class="hs-identifier hs-var">orig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-981"></a><span>                   </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unbound implicit parameter&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045368"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-982"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span> </span><a href="#local-1628045374"><span class="hs-identifier hs-var">preds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-983"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-984"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#couldNotDeduce"><span class="hs-identifier hs-var">couldNotDeduce</span></a><span> </span><a href="#local-1628045375"><span class="hs-identifier hs-var">givens</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045374"><span class="hs-identifier hs-var">preds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045373"><span class="hs-identifier hs-var">orig</span></a><span class="hs-special">)</span><span>
</span><a name="line-985"></a><span>
</span><a name="line-986"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045370"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045372"><span class="hs-identifier hs-var">ct1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-987"></a><span>            </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045376"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="#local-1628045371"><span class="hs-identifier hs-var">binds_msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-988"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-989"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045369"><a href="#local-1628045369"><span class="hs-identifier">ct1</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045368"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-990"></a><span>
</span><a name="line-991"></a><span class="hs-comment">{-
Note [OutOfScope exact matches]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When constructing an out-of-scope error message, we not only generate a list of
possible in-scope alternatives but also search for an exact, unambiguous match
in a later inter-splice group.  If we find such a match, we report its presence
(and indirectly, its scope) in the message.  For example, if a module A contains
the following declarations,

   foo :: Int
   foo = x

   $(return [])  -- Empty top-level splice

   x :: Int
   x = 23

we will issue an error similar to

   A.hs:6:7: error:
       &#8226; Variable not in scope: x :: Int
       &#8226; &#8216;x&#8217; (line 11) is not in scope before the splice on line 8

By providing information about the match, we hope to clarify why declaring a
variable after a top-level splice but using it before the splice generates an
out-of-scope error (a situation which is often confusing to Haskell newcomers).

Note that if we find multiple exact matches to the out-of-scope variable
(hereafter referred to as x), we report nothing.  Such matches can only be
duplicate record fields, as the presence of any other duplicate top-level
declarations would have already halted compilation.  But if these record fields
are declared in a later inter-splice group, then so too are their corresponding
types.  Thus, these types must not occur in the inter-splice group containing x
(any unknown types would have already been reported), and so the matches to the
record fields are most likely coincidental.

One oddity of the exact match portion of the error message is that we specify
where the match to x is NOT in scope.  Why not simply state where the match IS
in scope?  It most cases, this would be just as easy and perhaps a little
clearer for the user.  But now consider the following example:

    {-# LANGUAGE TemplateHaskell #-}

    module A where

    import Language.Haskell.TH
    import Language.Haskell.TH.Syntax

    foo = x

    $(do -------------------------------------------------
        ds &lt;- [d| ok1 = x
                |]
        addTopDecls ds
        return [])

    bar = $(do
            ds &lt;- [d| x = 23
                      ok2 = x
                    |]
            addTopDecls ds
            litE $ stringL &quot;hello&quot;)

    $(return []) -----------------------------------------

    ok3 = x

Here, x is out-of-scope in the declaration of foo, and so we report

    A.hs:8:7: error:
        &#8226; Variable not in scope: x
        &#8226; &#8216;x&#8217; (line 16) is not in scope before the splice on lines 10-14

If we instead reported where x IS in scope, we would have to state that it is in
scope after the second top-level splice as well as among all the top-level
declarations added by both calls to addTopDecls.  But doing so would not only
add complexity to the code but also overwhelm the user with unneeded
information.

The logic which determines where x is not in scope is straightforward: it simply
finds the last top-level splice which occurs after x but before (or at) the
match to x (assuming such a splice exists).  In most cases, the check that the
splice occurs after x acts only as a sanity check.  For example, when the match
to x is a non-TH top-level declaration and a splice S occurs before the match,
then x must precede S; otherwise, it would be in scope.  But when dealing with
addTopDecls, this check serves a practical purpose.  Consider the following
declarations:

    $(do
        ds &lt;- [d| ok = x
                  x = 23
                |]
        addTopDecls ds
        return [])

    foo = x

In this case, x is not in scope in the declaration for foo.  Since x occurs
AFTER the splice containing the match, the logic does not find any splices after
x but before or at its match, and so we report nothing about x's scope.  If we
had not checked whether x occurs before the splice, we would have instead
reported that x is not in scope before the splice.  While correct, such an error
message is more likely to confuse than to enlighten.
-}</span><span>
</span><a name="line-1095"></a><span>
</span><a name="line-1096"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Equality errors
*                                                                      *
************************************************************************

Note [Inaccessible code]
~~~~~~~~~~~~~~~~~~~~~~~~
Consider
   data T a where
     T1 :: T a
     T2 :: T Bool

   f :: (a ~ Int) =&gt; T a -&gt; Int
   f T1 = 3
   f T2 = 4   -- Unreachable code

Here the second equation is unreachable. The original constraint
(a~Int) from the signature gets rewritten by the pattern-match to
(Bool~Int), so the danger is that we report the error as coming from
the *signature* (Trac #7293).  So, for Given errors we replace the
env (and hence src-loc) on its CtLoc with that from the immediately
enclosing implication.

Note [Error messages for untouchables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider (Trac #9109)
  data G a where { GBool :: G Bool }
  foo x = case x of GBool -&gt; True

Here we can't solve (t ~ Bool), where t is the untouchable result
meta-var 't', because of the (a ~ Bool) from the pattern match.
So we infer the type
   f :: forall a t. G a -&gt; t
making the meta-var 't' into a skolem.  So when we come to report
the unsolved (t ~ Bool), t won't look like an untouchable meta-var
any more.  So we don't assert that it is.
-}</span><span>
</span><a name="line-1135"></a><span>
</span><a name="line-1136"></a><span class="hs-identifier">mkEqErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1137"></a><span class="hs-comment">-- Don't have multiple equality errors from the same location</span><span>
</span><a name="line-1138"></a><span class="hs-comment">-- E.g.   (Int,Bool) ~ (Bool,Int)   one error will do!</span><span>
</span><a name="line-1139"></a><a name="mkEqErr"><a href="TcErrors.html#mkEqErr"><span class="hs-identifier">mkEqErr</span></a></a><span> </span><a name="local-1628045377"><a href="#local-1628045377"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045378"><a href="#local-1628045378"><span class="hs-identifier">ct</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkEqErr1"><span class="hs-identifier hs-var">mkEqErr1</span></a><span> </span><a href="#local-1628045377"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045378"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1140"></a><span class="hs-identifier">mkEqErr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkEqErr&quot;</span><span>
</span><a name="line-1141"></a><span>
</span><a name="line-1142"></a><span class="hs-identifier">mkEqErr1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1143"></a><a name="mkEqErr1"><a href="TcErrors.html#mkEqErr1"><span class="hs-identifier">mkEqErr1</span></a></a><span> </span><a name="local-1628045379"><a href="#local-1628045379"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045380"><a href="#local-1628045380"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1144"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#arisesFromGivens"><span class="hs-identifier hs-var">arisesFromGivens</span></a><span> </span><a href="#local-1628045380"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1145"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045402"><a href="#local-1628045402"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045403"><a href="#local-1628045403"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045404"><a href="#local-1628045404"><span class="hs-identifier">ct</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045379"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045380"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1146"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045405"><a href="#local-1628045405"><span class="hs-identifier">given_loc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045406"><a href="#local-1628045406"><span class="hs-identifier">given_msg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045383"><span class="hs-identifier hs-var">mk_given</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045404"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045402"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045407"><a href="#local-1628045407"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1148"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045408"><a href="#local-1628045408"><span class="hs-identifier">report</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045406"><span class="hs-identifier hs-var">given_msg</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="#local-1628045403"><span class="hs-identifier hs-var">binds_msg</span></a><span>
</span><a name="line-1149"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkEqErr_help"><span class="hs-identifier hs-var">mkEqErr_help</span></a><span> </span><a href="#local-1628045407"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045402"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045408"><span class="hs-identifier hs-var">report</span></a><span>
</span><a name="line-1150"></a><span>                      </span><span class="hs-special">(</span><a href="TcRnTypes.html#setCtLoc"><span class="hs-identifier hs-var">setCtLoc</span></a><span> </span><a href="#local-1628045404"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045405"><span class="hs-identifier hs-var">given_loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Note [Inaccessible code]</span><span>
</span><a name="line-1151"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-1628045381"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045382"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-comment">-- Wanted or derived</span><span>
</span><a name="line-1154"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045409"><a href="#local-1628045409"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045410"><a href="#local-1628045410"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045411"><a href="#local-1628045411"><span class="hs-identifier">ct</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045379"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045380"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1155"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045412"><a href="#local-1628045412"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-1156"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045413"><a href="#local-1628045413"><span class="hs-identifier">fam_envs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="FamInst.html#tcGetFamInstEnvs"><span class="hs-identifier hs-var">tcGetFamInstEnvs</span></a><span>
</span><a name="line-1157"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045414"><a href="#local-1628045414"><span class="hs-identifier">exp_syns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#goptM"><span class="hs-identifier hs-var">goptM</span></a><span> </span><a href="DynFlags.html#Opt_PrintExpandedSynonyms"><span class="hs-identifier hs-var">Opt_PrintExpandedSynonyms</span></a><span>
</span><a name="line-1158"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045415"><a href="#local-1628045415"><span class="hs-identifier">keep_going</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045416"><a href="#local-1628045416"><span class="hs-identifier">is_oriented</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045417"><a href="#local-1628045417"><span class="hs-identifier">wanted_msg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1159"></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045384"><span class="hs-identifier hs-var">mk_wanted_extra</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045414"><span class="hs-identifier hs-var">exp_syns</span></a><span>
</span><a name="line-1160"></a><span>             </span><a name="local-1628045418"><a href="#local-1628045418"><span class="hs-identifier">coercible_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier hs-var">ctEqRel</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1161"></a><span>               </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1162"></a><span>               </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#mkCoercibleExplanation"><span class="hs-identifier hs-var">mkCoercibleExplanation</span></a><span> </span><a href="#local-1628045412"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-1628045413"><span class="hs-identifier hs-var">fam_envs</span></a><span> </span><a href="#local-1628045381"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045382"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1163"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045419"><a href="#local-1628045419"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1164"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;mkEqErr1&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1165"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045420"><a href="#local-1628045420"><span class="hs-identifier">report</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><span class="hs-special">[</span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045417"><span class="hs-identifier hs-var">wanted_msg</span></a><span class="hs-special">,</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045418"><span class="hs-identifier hs-var">coercible_msg</span></a><span class="hs-special">,</span><span>
</span><a name="line-1166"></a><span>                               </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="#local-1628045410"><span class="hs-identifier hs-var">binds_msg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1167"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045415"><span class="hs-identifier hs-var">keep_going</span></a><span>
</span><a name="line-1168"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="TcErrors.html#mkEqErr_help"><span class="hs-identifier hs-var">mkEqErr_help</span></a><span> </span><a href="#local-1628045419"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045409"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045420"><span class="hs-identifier hs-var">report</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045416"><span class="hs-identifier hs-var">is_oriented</span></a><span> </span><a href="#local-1628045381"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045382"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1169"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045409"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045411"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045420"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1170"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1171"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045381"><a href="#local-1628045381"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045382"><a href="#local-1628045382"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getEqPredTys"><span class="hs-identifier hs-var">getEqPredTys</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045380"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>
</span><a name="line-1173"></a><span>    </span><span class="hs-identifier">mk_given</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>    </span><span class="hs-comment">-- For given constraints we overwrite the env (and hence src-loc)</span><span>
</span><a name="line-1175"></a><span>    </span><span class="hs-comment">-- with one from the implication.  See Note [Inaccessible code]</span><span>
</span><a name="line-1176"></a><span>    </span><a name="local-1628045383"><a href="#local-1628045383"><span class="hs-identifier">mk_given</span></a></a><span> </span><a name="local-1628045385"><a href="#local-1628045385"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045385"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1177"></a><span>    </span><span class="hs-identifier">mk_given</span><span> </span><a name="local-1628045386"><a href="#local-1628045386"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045387"><a href="#local-1628045387"><span class="hs-identifier">implic</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#setCtLocEnv"><span class="hs-identifier hs-var">setCtLocEnv</span></a><span> </span><a href="#local-1628045386"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_env</span><span> </span><a href="#local-1628045387"><span class="hs-identifier hs-var">implic</span></a><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Inaccessible code in&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1179"></a><span>                                     </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_info</span><span> </span><a href="#local-1628045387"><span class="hs-identifier hs-var">implic</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1180"></a><span>
</span><a name="line-1181"></a><span>       </span><span class="hs-comment">-- If the types in the error message are the same as the types</span><span>
</span><a name="line-1182"></a><span>       </span><span class="hs-comment">-- we are unifying, don't add the extra expected/actual message</span><span>
</span><a name="line-1183"></a><span>    </span><span class="hs-identifier">mk_wanted_extra</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1184"></a><span>    </span><a name="local-1628045384"><a href="#local-1628045384"><span class="hs-identifier">mk_wanted_extra</span></a></a><span> </span><a name="local-1628045388"><a href="#local-1628045388"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628045389"><a href="#local-1628045389"><span class="hs-identifier">expandSyns</span></a></a><span>
</span><a name="line-1185"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1628045388"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1186"></a><span>          </span><a name="local-1628045390"><a href="#local-1628045390"><span class="hs-identifier">orig</span></a></a><span class="hs-glyph">@</span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#mkExpectedActualMsg"><span class="hs-identifier hs-var">mkExpectedActualMsg</span></a><span> </span><a href="#local-1628045381"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045382"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-1628045390"><span class="hs-identifier hs-var">orig</span></a><span>
</span><a name="line-1187"></a><span>                                                      </span><a href="#local-1628045391"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-1628045389"><span class="hs-identifier hs-var">expandSyns</span></a><span>
</span><a name="line-1188"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-1189"></a><span>              </span><a name="local-1628045391"><a href="#local-1628045391"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a><span> </span><a href="#local-1628045388"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1190"></a><span>
</span><a name="line-1191"></a><span>          </span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><a name="local-1628045392"><a href="#local-1628045392"><span class="hs-identifier">cty1</span></a></a><span> </span><a name="local-1628045393"><a href="#local-1628045393"><span class="hs-identifier">mb_cty2</span></a></a><span> </span><a name="local-1628045394"><a href="#local-1628045394"><span class="hs-identifier">sub_o</span></a></a><span> </span><a name="local-1628045395"><a href="#local-1628045395"><span class="hs-identifier">sub_t_or_k</span></a></a><span>
</span><a name="line-1192"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045397"><span class="hs-identifier hs-var">msg1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045398"><span class="hs-identifier hs-var">msg2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1193"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-1194"></a><span>              </span><a name="local-1628045396"><a href="#local-1628045396"><span class="hs-identifier">sub_what</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045395"><span class="hs-identifier hs-var">sub_t_or_k</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kinds&quot;</span><span>
</span><a name="line-1195"></a><span>                                            </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;types&quot;</span><span>
</span><a name="line-1196"></a><span>              </span><a name="local-1628045397"><a href="#local-1628045397"><span class="hs-identifier">msg1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045399"><a href="#local-1628045399"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1197"></a><span>                     </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045393"><span class="hs-identifier hs-var">mb_cty2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1198"></a><span>                       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045400"><a href="#local-1628045400"><span class="hs-identifier">cty2</span></a></a><span>
</span><a name="line-1199"></a><span>                         </span><span class="hs-glyph">|</span><span>  </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintExplicitCoercions"><span class="hs-identifier hs-var">Opt_PrintExplicitCoercions</span></a><span> </span><a href="#local-1628045399"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1200"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-1628045392"><span class="hs-identifier hs-var">cty1</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045400"><span class="hs-identifier hs-var">cty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1201"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;When matching&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045396"><span class="hs-identifier hs-var">sub_what</span></a><span class="hs-special">)</span><span>
</span><a name="line-1202"></a><span>                               </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045392"><span class="hs-identifier hs-var">cty1</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1203"></a><span>                                         </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628045392"><span class="hs-identifier hs-var">cty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1204"></a><span>                                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045400"><span class="hs-identifier hs-var">cty2</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1205"></a><span>                                         </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628045400"><span class="hs-identifier hs-var">cty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1206"></a><span>                       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;When matching the kind of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045392"><span class="hs-identifier hs-var">cty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>              </span><a name="local-1628045398"><a href="#local-1628045398"><span class="hs-identifier">msg2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045394"><span class="hs-identifier hs-var">sub_o</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1208"></a><span>                       </span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-1209"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045401"><a href="#local-1628045401"><span class="hs-identifier">cty2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045393"><span class="hs-identifier hs-var">mb_cty2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1210"></a><span>                         </span><a href="Util.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#mkExpectedActualMsg"><span class="hs-identifier hs-var">mkExpectedActualMsg</span></a><span> </span><a href="#local-1628045392"><span class="hs-identifier hs-var">cty1</span></a><span> </span><a href="#local-1628045401"><span class="hs-identifier hs-var">cty2</span></a><span> </span><a href="#local-1628045394"><span class="hs-identifier hs-var">sub_o</span></a><span> </span><a href="#local-1628045395"><span class="hs-identifier hs-var">sub_t_or_k</span></a><span>
</span><a name="line-1211"></a><span>                                                     </span><a href="#local-1628045389"><span class="hs-identifier hs-var">expandSyns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><span>                       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1213"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1214"></a><span>
</span><a name="line-1215"></a><span class="hs-comment">-- | This function tries to reconstruct why a &quot;Coercible ty1 ty2&quot; constraint</span><span>
</span><a name="line-1216"></a><span class="hs-comment">-- is left over.</span><span>
</span><a name="line-1217"></a><span class="hs-identifier">mkCoercibleExplanation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span>
</span><a name="line-1218"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1219"></a><a name="mkCoercibleExplanation"><a href="TcErrors.html#mkCoercibleExplanation"><span class="hs-identifier">mkCoercibleExplanation</span></a></a><span> </span><a name="local-1628045421"><a href="#local-1628045421"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-1628045422"><a href="#local-1628045422"><span class="hs-identifier">fam_envs</span></a></a><span> </span><a name="local-1628045423"><a href="#local-1628045423"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045424"><a href="#local-1628045424"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1220"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045434"><a href="#local-1628045434"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045435"><a href="#local-1628045435"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045423"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1221"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628045436"><a href="#local-1628045436"><span class="hs-identifier">rep_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="FamInst.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a><span> </span><a href="#local-1628045422"><span class="hs-identifier hs-var">fam_envs</span></a><span> </span><a href="#local-1628045434"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1628045435"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1222"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045437"><a href="#local-1628045437"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045425"><span class="hs-identifier hs-var">coercible_msg_for_tycon</span></a><span> </span><a href="#local-1628045436"><span class="hs-identifier hs-var">rep_tc</span></a><span>
</span><a name="line-1223"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045437"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1224"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045438"><a href="#local-1628045438"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045439"><a href="#local-1628045439"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628045424"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1225"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628045440"><a href="#local-1628045440"><span class="hs-identifier">rep_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="FamInst.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a><span> </span><a href="#local-1628045422"><span class="hs-identifier hs-var">fam_envs</span></a><span> </span><a href="#local-1628045438"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1628045439"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1226"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045441"><a href="#local-1628045441"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045425"><span class="hs-identifier hs-var">coercible_msg_for_tycon</span></a><span> </span><a href="#local-1628045440"><span class="hs-identifier hs-var">rep_tc</span></a><span>
</span><a name="line-1227"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045441"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045442"><a href="#local-1628045442"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a><span> </span><a href="#local-1628045423"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1229"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045443"><a href="#local-1628045443"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a><span> </span><a href="#local-1628045424"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1230"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045442"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045443"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-1231"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045426"><span class="hs-identifier hs-var">has_unknown_roles</span></a><span> </span><a href="#local-1628045442"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-1232"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB: We cannot know what roles the parameters to&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1233"></a><span>          </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045442"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;have;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1234"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;we must assume that the role is nominal&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1236"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1237"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1238"></a><span>    </span><a name="local-1628045425"><a href="#local-1628045425"><span class="hs-identifier">coercible_msg_for_tycon</span></a></a><span> </span><a name="local-1628045427"><a href="#local-1628045427"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1239"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isAbstractTyCon"><span class="hs-identifier hs-var">isAbstractTyCon</span></a><span> </span><a href="#local-1628045427"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1240"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB: The type constructor&quot;</span><span>
</span><a name="line-1241"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#pprSourceTyCon"><span class="hs-identifier hs-var">pprSourceTyCon</span></a><span> </span><a href="#local-1628045427"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1242"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is abstract&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1243"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a><span> </span><a href="#local-1628045427"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1244"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1628045428"><a href="#local-1628045428"><span class="hs-identifier">data_con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628045427"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1245"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045429"><a href="#local-1628045429"><span class="hs-identifier">dc_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1628045428"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1246"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a><span> </span><a href="#local-1628045421"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-1628045429"><span class="hs-identifier hs-var">dc_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1247"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The data constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045429"><span class="hs-identifier hs-var">dc_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>                    </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;of newtype&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#pprSourceTyCon"><span class="hs-identifier hs-var">pprSourceTyCon</span></a><span> </span><a href="#local-1628045427"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1249"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not in scope&quot;</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1251"></a><span>
</span><a name="line-1252"></a><span>    </span><a name="local-1628045426"><a href="#local-1628045426"><span class="hs-identifier">has_unknown_roles</span></a></a><span> </span><a name="local-1628045430"><a href="#local-1628045430"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1253"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045431"><a href="#local-1628045431"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045432"><a href="#local-1628045432"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045430"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1254"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045432"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1628045431"><span class="hs-identifier hs-var">tc</span></a><span>  </span><span class="hs-comment">-- oversaturated tycon</span><span>
</span><a name="line-1255"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045433"><a href="#local-1628045433"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a><span> </span><a href="#local-1628045430"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1256"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045426"><span class="hs-identifier hs-var">has_unknown_roles</span></a><span> </span><a href="#local-1628045433"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1257"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span> </span><a href="#local-1628045430"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1258"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1259"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1260"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1261"></a><span>
</span><a name="line-1262"></a><span class="hs-comment">{-
-- | Make a listing of role signatures for all the parameterised tycons
-- used in the provided types


-- SLPJ Jun 15: I could not convince myself that these hints were really
-- useful.  Maybe they are, but I think we need more work to make them
-- actually helpful.
mkRoleSigs :: Type -&gt; Type -&gt; SDoc
mkRoleSigs ty1 ty2
  = ppUnless (null role_sigs) $
    hang (text &quot;Relevant role signatures:&quot;)
       2 (vcat role_sigs)
  where
    tcs = nameEnvElts $ tyConsOfType ty1 `plusNameEnv` tyConsOfType ty2
    role_sigs = mapMaybe ppr_role_sig tcs

    ppr_role_sig tc
      | null roles  -- if there are no parameters, don't bother printing
      = Nothing
      | isBuiltInSyntax (tyConName tc)  -- don't print roles for (-&gt;), etc.
      = Nothing
      | otherwise
      = Just $ hsep $ [text &quot;type role&quot;, ppr tc] ++ map ppr roles
      where
        roles = tyConRoles tc
-}</span><span>
</span><a name="line-1289"></a><span>
</span><a name="line-1290"></a><span class="hs-identifier">mkEqErr_help</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span>
</span><a name="line-1291"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1292"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span>   </span><span class="hs-comment">-- Nothing &lt;=&gt; not sure</span><span>
</span><a name="line-1293"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1294"></a><a name="mkEqErr_help"><a href="TcErrors.html#mkEqErr_help"><span class="hs-identifier">mkEqErr_help</span></a></a><span> </span><a name="local-1628045444"><a href="#local-1628045444"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628045445"><a href="#local-1628045445"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045446"><a href="#local-1628045446"><span class="hs-identifier">report</span></a></a><span> </span><a name="local-1628045447"><a href="#local-1628045447"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045448"><a href="#local-1628045448"><span class="hs-identifier">oriented</span></a></a><span> </span><a name="local-1628045449"><a href="#local-1628045449"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045450"><a href="#local-1628045450"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1295"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045452"><a href="#local-1628045452"><span class="hs-identifier">tv1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045449"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkTyVarEqErr"><span class="hs-identifier hs-var">mkTyVarEqErr</span></a><span> </span><a href="#local-1628045444"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045445"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045446"><span class="hs-identifier hs-var">report</span></a><span> </span><a href="#local-1628045447"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045448"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045452"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045450"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1296"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045453"><a href="#local-1628045453"><span class="hs-identifier">tv2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045450"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkTyVarEqErr"><span class="hs-identifier hs-var">mkTyVarEqErr</span></a><span> </span><a href="#local-1628045444"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045445"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045446"><span class="hs-identifier hs-var">report</span></a><span> </span><a href="#local-1628045447"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045451"><span class="hs-identifier hs-var">swapped</span></a><span>  </span><a href="#local-1628045453"><span class="hs-identifier hs-var">tv2</span></a><span> </span><a href="#local-1628045449"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1297"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                        </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#reportEqErr"><span class="hs-identifier hs-var">reportEqErr</span></a><span> </span><a href="#local-1628045445"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045446"><span class="hs-identifier hs-var">report</span></a><span> </span><a href="#local-1628045447"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045448"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045449"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045450"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1298"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1299"></a><span>    </span><a name="local-1628045451"><a href="#local-1628045451"><span class="hs-identifier">swapped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="BasicTypes.html#flipSwap"><span class="hs-identifier hs-var">flipSwap</span></a><span> </span><a href="#local-1628045448"><span class="hs-identifier hs-var">oriented</span></a><span>
</span><a name="line-1300"></a><span>
</span><a name="line-1301"></a><span class="hs-identifier">reportEqErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span>
</span><a name="line-1302"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1303"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span>   </span><span class="hs-comment">-- Nothing &lt;=&gt; not sure</span><span>
</span><a name="line-1304"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1305"></a><a name="reportEqErr"><a href="TcErrors.html#reportEqErr"><span class="hs-identifier">reportEqErr</span></a></a><span> </span><a name="local-1628045454"><a href="#local-1628045454"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045455"><a href="#local-1628045455"><span class="hs-identifier">report</span></a></a><span> </span><a name="local-1628045456"><a href="#local-1628045456"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045457"><a href="#local-1628045457"><span class="hs-identifier">oriented</span></a></a><span> </span><a name="local-1628045458"><a href="#local-1628045458"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045459"><a href="#local-1628045459"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1306"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045454"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045456"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045460"><span class="hs-identifier hs-var">misMatch</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045455"><span class="hs-identifier hs-var">report</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045461"><span class="hs-identifier hs-var">eqInfo</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1307"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1628045460"><a href="#local-1628045460"><span class="hs-identifier">misMatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#misMatchOrCND"><span class="hs-identifier hs-var">misMatchOrCND</span></a><span> </span><a href="#local-1628045454"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045456"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045457"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045458"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045459"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1308"></a><span>        </span><a name="local-1628045461"><a href="#local-1628045461"><span class="hs-identifier">eqInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#mkEqInfoMsg"><span class="hs-identifier hs-var">mkEqInfoMsg</span></a><span> </span><a href="#local-1628045456"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045458"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045459"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1309"></a><span>
</span><a name="line-1310"></a><span class="hs-identifier">mkTyVarEqErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#Report"><span class="hs-identifier hs-type">Report</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1311"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1312"></a><span class="hs-comment">-- tv1 and ty2 are already tidied</span><span>
</span><a name="line-1313"></a><a name="mkTyVarEqErr"><a href="TcErrors.html#mkTyVarEqErr"><span class="hs-identifier">mkTyVarEqErr</span></a></a><span> </span><a name="local-1628045462"><a href="#local-1628045462"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628045463"><a href="#local-1628045463"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045464"><a href="#local-1628045464"><span class="hs-identifier">report</span></a></a><span> </span><a name="local-1628045465"><a href="#local-1628045465"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045466"><a href="#local-1628045466"><span class="hs-identifier">oriented</span></a></a><span> </span><a name="local-1628045467"><a href="#local-1628045467"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-1628045468"><a href="#local-1628045468"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1314"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcErrors.html#isUserSkolem"><span class="hs-identifier hs-var">isUserSkolem</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span>   </span><span class="hs-comment">-- ty2 won't be a meta-tyvar, or else the thing would</span><span>
</span><a name="line-1315"></a><span>                            </span><span class="hs-comment">-- be oriented the other way round;</span><span>
</span><a name="line-1316"></a><span>                            </span><span class="hs-comment">-- see TcCanonical.canEqTyVarTyVar</span><span>
</span><a name="line-1317"></a><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="TcType.html#isSigTyVar"><span class="hs-identifier hs-var">isSigTyVar</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1318"></a><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier hs-var">ctEqRel</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TcType.html#isTyVarUnderDatatype"><span class="hs-identifier hs-var">isTyVarUnderDatatype</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>     </span><span class="hs-comment">-- the cases below don't really apply to ReprEq (except occurs check)</span><span>
</span><a name="line-1320"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span>
</span><a name="line-1321"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#misMatchOrCND"><span class="hs-identifier hs-var">misMatchOrCND</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045466"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1322"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#extraTyVarInfo"><span class="hs-identifier hs-var">extraTyVarInfo</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1323"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span>
</span><a name="line-1324"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span>  </span><span class="hs-comment">-- So tv is a meta tyvar (or started that way before we</span><span>
</span><a name="line-1327"></a><span>  </span><span class="hs-comment">-- generalised it).  So presumably it is an *untouchable*</span><span>
</span><a name="line-1328"></a><span>  </span><span class="hs-comment">-- meta tyvar or a SigTv, else it'd have been unified</span><span>
</span><a name="line-1329"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#OC_Occurs"><span class="hs-identifier hs-var">OC_Occurs</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045469"><span class="hs-identifier hs-var">occ_check_expand</span></a><span>
</span><a name="line-1330"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier hs-var">ctEqRel</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="TcType.html#isTyVarUnderDatatype"><span class="hs-identifier hs-var">isTyVarUnderDatatype</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1331"></a><span>         </span><span class="hs-comment">-- See Note [Occurs check error] in TcCanonical</span><span>
</span><a name="line-1332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045472"><a href="#local-1628045472"><span class="hs-identifier">occCheckMsg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1333"></a><span>                           </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Occurs check: cannot construct the infinite&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045471"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><span>                              </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'~'</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1335"></a><span>             </span><a name="local-1628045473"><a href="#local-1628045473"><span class="hs-identifier">extra2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#mkEqInfoMsg"><span class="hs-identifier hs-var">mkEqInfoMsg</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1336"></a><span>
</span><a name="line-1337"></a><span>             </span><a name="local-1628045474"><a href="#local-1628045474"><span class="hs-identifier">interesting_tyvars</span></a></a><span>
</span><a name="line-1338"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="VarSet.html#isEmptyVarSet"><span class="hs-identifier hs-var">isEmptyVarSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1339"></a><span>                 </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1340"></a><span>                 </span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1341"></a><span>                 </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1342"></a><span>             </span><a name="local-1628045475"><a href="#local-1628045475"><span class="hs-identifier">extra3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1343"></a><span>                      </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045474"><span class="hs-identifier hs-var">interesting_tyvars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1344"></a><span>                      </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type variable kinds:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1345"></a><span>                      </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045476"><span class="hs-identifier hs-var">tyvar_binding</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tidyTyVarOcc"><span class="hs-identifier hs-var">tidyTyVarOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_tidy</span><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1346"></a><span>                                </span><a href="#local-1628045474"><span class="hs-identifier hs-var">interesting_tyvars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><span>
</span><a name="line-1348"></a><span>             </span><a name="local-1628045476"><a href="#local-1628045476"><span class="hs-identifier">tyvar_binding</span></a></a><span> </span><a name="local-1628045477"><a href="#local-1628045477"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045477"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628045477"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045472"><span class="hs-identifier hs-var">occCheckMsg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045473"><span class="hs-identifier hs-var">extra2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045475"><span class="hs-identifier hs-var">extra3</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1350"></a><span>
</span><a name="line-1351"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#OC_Forall"><span class="hs-identifier hs-var">OC_Forall</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045469"><span class="hs-identifier hs-var">occ_check_expand</span></a><span>
</span><a name="line-1352"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045478"><a href="#local-1628045478"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Cannot instantiate unification variable&quot;</span><span>
</span><a name="line-1353"></a><span>                          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1354"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;with a&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045471"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;involving foralls:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1355"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;GHC doesn't yet support impredicative polymorphism&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1356"></a><span>       </span><span class="hs-comment">-- Unlike the other reports, this discards the old 'report_important'</span><span>
</span><a name="line-1357"></a><span>       </span><span class="hs-comment">-- instead of augmenting it.  This is because the details are not likely</span><span>
</span><a name="line-1358"></a><span>       </span><span class="hs-comment">-- to be helpful since this is just an unimplemented feature.</span><span>
</span><a name="line-1359"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">report_important</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628045478"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1360"></a><span>
</span><a name="line-1361"></a><span>  </span><span class="hs-comment">-- If the immediately-enclosing implication has 'tv' a skolem, and</span><span>
</span><a name="line-1362"></a><span>  </span><span class="hs-comment">-- we know by now its an InferSkol kind of skolem, then presumably</span><span>
</span><a name="line-1363"></a><span>  </span><span class="hs-comment">-- it started life as a SigTv, else it'd have been unified, given</span><span>
</span><a name="line-1364"></a><span>  </span><span class="hs-comment">-- that there's no occurs-check or forall problem</span><span>
</span><a name="line-1365"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045479"><a href="#local-1628045479"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1366"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045480"><a href="#local-1628045480"><span class="hs-identifier">skols</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045479"><span class="hs-identifier hs-var">implic</span></a><span>
</span><a name="line-1367"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045480"><span class="hs-identifier hs-var">skols</span></a><span>
</span><a name="line-1368"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span>
</span><a name="line-1369"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier hs-var">misMatchMsg</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045466"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1370"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#extraTyVarInfo"><span class="hs-identifier hs-var">extraTyVarInfo</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1371"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span>
</span><a name="line-1372"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1373"></a><span>
</span><a name="line-1374"></a><span>  </span><span class="hs-comment">-- Check for skolem escape</span><span>
</span><a name="line-1375"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045481"><a href="#local-1628045481"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span>   </span><span class="hs-comment">-- Get the innermost context</span><span>
</span><a name="line-1376"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045482"><a href="#local-1628045482"><span class="hs-identifier">env</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045483"><a href="#local-1628045483"><span class="hs-identifier">skols</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045484"><a href="#local-1628045484"><span class="hs-identifier">skol_info</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045481"><span class="hs-identifier hs-var">implic</span></a><span>
</span><a name="line-1377"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045485"><a href="#local-1628045485"><span class="hs-identifier">esc_skols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628045483"><span class="hs-identifier hs-var">skols</span></a><span>
</span><a name="line-1378"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045485"><span class="hs-identifier hs-var">esc_skols</span></a><span class="hs-special">)</span><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045486"><a href="#local-1628045486"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier hs-var">misMatchMsg</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045466"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1380"></a><span>             </span><a name="local-1628045487"><a href="#local-1628045487"><span class="hs-identifier">esc_doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;because&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045471"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variable&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045485"><span class="hs-identifier hs-var">esc_skols</span></a><span>
</span><a name="line-1381"></a><span>                             </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628045485"><span class="hs-identifier hs-var">esc_skols</span></a><span>
</span><a name="line-1382"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;would escape&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1383"></a><span>                             </span><span class="hs-keyword">if</span><span> </span><a href="Util.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a><span> </span><a href="#local-1628045485"><span class="hs-identifier hs-var">esc_skols</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;its scope&quot;</span><span>
</span><a name="line-1384"></a><span>                                                      </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;their scope&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1385"></a><span>             </span><a name="local-1628045488"><a href="#local-1628045488"><span class="hs-identifier">tv_extra</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1386"></a><span>                        </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628045487"><span class="hs-identifier hs-var">esc_doc</span></a><span>
</span><a name="line-1387"></a><span>                             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Util.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a><span> </span><a href="#local-1628045485"><span class="hs-identifier hs-var">esc_skols</span></a><span>
</span><a name="line-1388"></a><span>                                      </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;This (rigid, skolem)&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1389"></a><span>                                           </span><a href="#local-1628045471"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variable is&quot;</span><span>
</span><a name="line-1390"></a><span>                                      </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;These (rigid, skolem)&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1391"></a><span>                                           </span><a href="#local-1628045471"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variables are&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1392"></a><span>                               </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound by&quot;</span><span>
</span><a name="line-1393"></a><span>                             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045484"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-1394"></a><span>                             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045482"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1395"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628045486"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045488"><span class="hs-identifier hs-var">tv_extra</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1396"></a><span>
</span><a name="line-1397"></a><span>  </span><span class="hs-comment">-- Nastiest case: attempt to unify an untouchable variable</span><span>
</span><a name="line-1398"></a><span>  </span><span class="hs-comment">-- See Note [Error messages for untouchables]</span><span>
</span><a name="line-1399"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045489"><a href="#local-1628045489"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span>   </span><span class="hs-comment">-- Get the innermost context</span><span>
</span><a name="line-1400"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045490"><a href="#local-1628045490"><span class="hs-identifier">env</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045491"><a href="#local-1628045491"><span class="hs-identifier">given</span></a></a><span>
</span><a name="line-1401"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_tclvl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045492"><a href="#local-1628045492"><span class="hs-identifier">lvl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045493"><a href="#local-1628045493"><span class="hs-identifier">skol_info</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045489"><span class="hs-identifier hs-var">implic</span></a><span>
</span><a name="line-1402"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTcTyVar</span><span> </span><span class="hs-identifier">tv1</span><span> </span><a href="Var.html#isTcTyVar"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isTouchableMetaTyVar</span><span> </span><a href="TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var">lvl</span></a><span> </span><a href="TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1403"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tv1</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Error messages for untouchables]</span><span>
</span><a name="line-1404"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045494"><a href="#local-1628045494"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier hs-var">misMatchMsg</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045466"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1405"></a><span>             </span><a name="local-1628045495"><a href="#local-1628045495"><span class="hs-identifier">tclvl_extra</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1406"></a><span>                  </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1407"></a><span>                  </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is untouchable&quot;</span><span>
</span><a name="line-1408"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;inside the constraints:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcRnTypes.html#pprEvVarTheta"><span class="hs-identifier hs-var">pprEvVarTheta</span></a><span> </span><a href="#local-1628045491"><span class="hs-identifier hs-var">given</span></a><span>
</span><a name="line-1409"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound by&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045493"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-1410"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045490"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1411"></a><span>             </span><a name="local-1628045496"><a href="#local-1628045496"><span class="hs-identifier">tv_extra</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#extraTyVarInfo"><span class="hs-identifier hs-var">extraTyVarInfo</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1412"></a><span>             </span><a name="local-1628045497"><a href="#local-1628045497"><span class="hs-identifier">add_sig</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcErrors.html#suggestAddSig"><span class="hs-identifier hs-var">suggestAddSig</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045470"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1413"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span>
</span><a name="line-1414"></a><span>            </span><span class="hs-special">[</span><a href="#local-1628045494"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045495"><span class="hs-identifier hs-var">tclvl_extra</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045496"><span class="hs-identifier hs-var">tv_extra</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045497"><span class="hs-identifier hs-var">add_sig</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1415"></a><span>
</span><a name="line-1416"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1417"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#reportEqErr"><span class="hs-identifier hs-var">reportEqErr</span></a><span> </span><a href="#local-1628045463"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045464"><span class="hs-identifier hs-var">report</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045466"><span class="hs-identifier hs-var">oriented</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1418"></a><span>        </span><span class="hs-comment">-- This *can* happen (Trac #6123, and test T2627b)</span><span>
</span><a name="line-1419"></a><span>        </span><span class="hs-comment">-- Consider an ambiguous top-level constraint (a ~ F a)</span><span>
</span><a name="line-1420"></a><span>        </span><span class="hs-comment">-- Not an occurs check, because F is a type function.</span><span>
</span><a name="line-1421"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1422"></a><span>    </span><a name="local-1628045469"><a href="#local-1628045469"><span class="hs-identifier">occ_check_expand</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#occurCheckExpand"><span class="hs-identifier hs-var">occurCheckExpand</span></a><span> </span><a href="#local-1628045462"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045468"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1423"></a><span>    </span><a name="local-1628045470"><a href="#local-1628045470"><span class="hs-identifier">ty1</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628045467"><span class="hs-identifier hs-var">tv1</span></a><span>
</span><a name="line-1424"></a><span>
</span><a name="line-1425"></a><span>    </span><a name="local-1628045471"><a href="#local-1628045471"><span class="hs-identifier">what</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045465"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1426"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1427"></a><span>      </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1428"></a><span>
</span><a name="line-1429"></a><span class="hs-identifier">mkEqInfoMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1430"></a><span class="hs-comment">-- Report (a) ambiguity if either side is a type function application</span><span>
</span><a name="line-1431"></a><span class="hs-comment">--            e.g. F a0 ~ Int</span><span>
</span><a name="line-1432"></a><span class="hs-comment">--        (b) warning about injectivity if both sides are the same</span><span>
</span><a name="line-1433"></a><span class="hs-comment">--            type function application   F a ~ F b</span><span>
</span><a name="line-1434"></a><span class="hs-comment">--            See Note [Non-injective type functions]</span><span>
</span><a name="line-1435"></a><span class="hs-comment">--        (c) warning about -fprint-explicit-kinds if that might be helpful</span><span>
</span><a name="line-1436"></a><a name="mkEqInfoMsg"><a href="TcErrors.html#mkEqInfoMsg"><span class="hs-identifier">mkEqInfoMsg</span></a></a><span> </span><a name="local-1628045498"><a href="#local-1628045498"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045499"><a href="#local-1628045499"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045500"><a href="#local-1628045500"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1437"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045507"><span class="hs-identifier hs-var">tyfun_msg</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045503"><span class="hs-identifier hs-var">ambig_msg</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045506"><span class="hs-identifier hs-var">invis_msg</span></a><span>
</span><a name="line-1438"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1439"></a><span>    </span><a name="local-1628045501"><a href="#local-1628045501"><span class="hs-identifier">mb_fun1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#isTyFun_maybe"><span class="hs-identifier hs-var">isTyFun_maybe</span></a><span> </span><a href="#local-1628045499"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1440"></a><span>    </span><a name="local-1628045502"><a href="#local-1628045502"><span class="hs-identifier">mb_fun2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#isTyFun_maybe"><span class="hs-identifier hs-var">isTyFun_maybe</span></a><span> </span><a href="#local-1628045500"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span>    </span><a name="local-1628045503"><a href="#local-1628045503"><span class="hs-identifier">ambig_msg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-1628045501"><span class="hs-identifier hs-var">mb_fun1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-1628045502"><span class="hs-identifier hs-var">mb_fun2</span></a><span>
</span><a name="line-1443"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#mkAmbigMsg"><span class="hs-identifier hs-var">mkAmbigMsg</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-1628045498"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1445"></a><span>
</span><a name="line-1446"></a><span>    </span><span class="hs-comment">-- better to check the exp/act types in the CtOrigin than the actual</span><span>
</span><a name="line-1447"></a><span>    </span><span class="hs-comment">-- mismatched types for suggestion about -fprint-explicit-kinds</span><span>
</span><a name="line-1448"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045504"><a href="#local-1628045504"><span class="hs-identifier">act_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045505"><a href="#local-1628045505"><span class="hs-identifier">exp_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045498"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1449"></a><span>      </span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">uo_actual</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045508"><a href="#local-1628045508"><span class="hs-identifier">act</span></a></a><span>
</span><a name="line-1450"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">uo_expected</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#Check"><span class="hs-identifier hs-var">Check</span></a><span> </span><a name="local-1628045509"><a href="#local-1628045509"><span class="hs-identifier">exp</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628045508"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045509"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><span>      </span><span class="hs-identifier">_</span><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628045499"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045500"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span>
</span><a name="line-1453"></a><span>    </span><a name="local-1628045506"><a href="#local-1628045506"><span class="hs-identifier">invis_msg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045510"><a href="#local-1628045510"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcEqTypeVis"><span class="hs-identifier hs-var">tcEqTypeVis</span></a><span> </span><a href="#local-1628045504"><span class="hs-identifier hs-var">act_ty</span></a><span> </span><a href="#local-1628045505"><span class="hs-identifier hs-var">exp_ty</span></a><span>
</span><a name="line-1454"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="#local-1628045510"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="TyCoRep.html#Visible"><span class="hs-identifier hs-var">Visible</span></a><span>
</span><a name="line-1455"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045511"><a href="#local-1628045511"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1456"></a><span>                </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintExplicitKinds"><span class="hs-identifier hs-var">Opt_PrintExplicitKinds</span></a><span> </span><a href="#local-1628045511"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1457"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1458"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use -fprint-explicit-kinds to see the kind arguments&quot;</span><span>
</span><a name="line-1459"></a><span>
</span><a name="line-1460"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1461"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span>    </span><a name="local-1628045507"><a href="#local-1628045507"><span class="hs-identifier">tyfun_msg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045512"><a href="#local-1628045512"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045501"><span class="hs-identifier hs-var">mb_fun1</span></a><span>
</span><a name="line-1464"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045513"><a href="#local-1628045513"><span class="hs-identifier">tc2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045502"><span class="hs-identifier hs-var">mb_fun2</span></a><span>
</span><a name="line-1465"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="#local-1628045512"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628045513"><span class="hs-identifier hs-var">tc2</span></a><span>
</span><a name="line-1466"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045512"><span class="hs-identifier hs-var">tc1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1467"></a><span>                </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is a type function, and may not be injective&quot;</span><span>
</span><a name="line-1468"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1469"></a><span>
</span><a name="line-1470"></a><span class="hs-identifier">isUserSkolem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1471"></a><span class="hs-comment">-- See Note [Reporting occurs-check errors]</span><span>
</span><a name="line-1472"></a><a name="isUserSkolem"><a href="TcErrors.html#isUserSkolem"><span class="hs-identifier">isUserSkolem</span></a></a><span> </span><a name="local-1628045514"><a href="#local-1628045514"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045515"><a href="#local-1628045515"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1473"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a><span> </span><a href="#local-1628045515"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="#local-1628045516"><span class="hs-identifier hs-var">is_user_skol_tv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045514"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1475"></a><span>    </span><a name="local-1628045516"><a href="#local-1628045516"><span class="hs-identifier">is_user_skol_tv</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045518"><a href="#local-1628045518"><span class="hs-identifier">sks</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045519"><a href="#local-1628045519"><span class="hs-identifier">skol_info</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1476"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045515"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045518"><span class="hs-identifier hs-var">sks</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045517"><span class="hs-identifier hs-var">is_user_skol_info</span></a><span> </span><a href="#local-1628045519"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-1477"></a><span>
</span><a name="line-1478"></a><span>    </span><a name="local-1628045517"><a href="#local-1628045517"><span class="hs-identifier">is_user_skol_info</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#InferSkol"><span class="hs-identifier hs-var">InferSkol</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1479"></a><span>    </span><span class="hs-identifier">is_user_skol_info</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-identifier">misMatchOrCND</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-1482"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1483"></a><span class="hs-comment">-- If oriented then ty1 is actual, ty2 is expected</span><span>
</span><a name="line-1484"></a><a name="misMatchOrCND"><a href="TcErrors.html#misMatchOrCND"><span class="hs-identifier">misMatchOrCND</span></a></a><span> </span><a name="local-1628045520"><a href="#local-1628045520"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045521"><a href="#local-1628045521"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045522"><a href="#local-1628045522"><span class="hs-identifier">oriented</span></a></a><span> </span><a name="local-1628045523"><a href="#local-1628045523"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045524"><a href="#local-1628045524"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1485"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045528"><span class="hs-identifier hs-var">givens</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1486"></a><span>    </span><span class="hs-special">(</span><a href="TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a><span> </span><a href="#local-1628045523"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a><span> </span><a href="#local-1628045524"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1487"></a><span>    </span><a href="TcRnTypes.html#isGivenCt"><span class="hs-identifier hs-var">isGivenCt</span></a><span> </span><a href="#local-1628045521"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1488"></a><span>       </span><span class="hs-comment">-- If the equality is unconditionally insoluble</span><span>
</span><a name="line-1489"></a><span>       </span><span class="hs-comment">-- or there is no context, don't report the context</span><span>
</span><a name="line-1490"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier hs-var">misMatchMsg</span></a><span> </span><a href="#local-1628045521"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045522"><span class="hs-identifier hs-var">oriented</span></a><span> </span><a href="#local-1628045523"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045524"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1491"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1492"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#couldNotDeduce"><span class="hs-identifier hs-var">couldNotDeduce</span></a><span> </span><a href="#local-1628045528"><span class="hs-identifier hs-var">givens</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1628045526"><span class="hs-identifier hs-var">eq_pred</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1628045527"><span class="hs-identifier hs-var">orig</span></a><span class="hs-special">)</span><span>
</span><a name="line-1493"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1494"></a><span>    </span><a name="local-1628045525"><a href="#local-1628045525"><span class="hs-identifier">ev</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1628045521"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1495"></a><span>    </span><a name="local-1628045526"><a href="#local-1628045526"><span class="hs-identifier">eq_pred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvPred"><span class="hs-identifier hs-var">ctEvPred</span></a><span> </span><a href="#local-1628045525"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-1496"></a><span>    </span><a name="local-1628045527"><a href="#local-1628045527"><span class="hs-identifier">orig</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvOrigin"><span class="hs-identifier hs-var">ctEvOrigin</span></a><span> </span><a href="#local-1628045525"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-1497"></a><span>    </span><a name="local-1628045528"><a href="#local-1628045528"><span class="hs-identifier">givens</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628045529"><span class="hs-identifier hs-var">given</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628045529"><a href="#local-1628045529"><span class="hs-identifier">given</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a><span> </span><a href="#local-1628045520"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_no_eqs</span><span> </span><a href="#local-1628045529"><span class="hs-identifier hs-var">given</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1498"></a><span>              </span><span class="hs-comment">-- Keep only UserGivens that have some equalities</span><span>
</span><a name="line-1499"></a><span>
</span><a name="line-1500"></a><span class="hs-identifier">couldNotDeduce</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1501"></a><a name="couldNotDeduce"><a href="TcErrors.html#couldNotDeduce"><span class="hs-identifier">couldNotDeduce</span></a></a><span> </span><a name="local-1628045530"><a href="#local-1628045530"><span class="hs-identifier">givens</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045531"><a href="#local-1628045531"><span class="hs-identifier">wanteds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045532"><a href="#local-1628045532"><span class="hs-identifier">orig</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045532"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Could not deduce:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span> </span><a href="#local-1628045531"><span class="hs-identifier hs-var">wanteds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1503"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pp_givens"><span class="hs-identifier hs-var">pp_givens</span></a><span> </span><a href="#local-1628045530"><span class="hs-identifier hs-var">givens</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1504"></a><span>
</span><a name="line-1505"></a><span class="hs-identifier">pp_givens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span>
</span><a name="line-1506"></a><a name="pp_givens"><a href="TcErrors.html#pp_givens"><span class="hs-identifier">pp_givens</span></a></a><span> </span><a name="local-1628045533"><a href="#local-1628045533"><span class="hs-identifier">givens</span></a></a><span>
</span><a name="line-1507"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045533"><span class="hs-identifier hs-var">givens</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1508"></a><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1509"></a><span>         </span><span class="hs-special">(</span><a name="local-1628045539"><a href="#local-1628045539"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-1628045540"><a href="#local-1628045540"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><a href="#local-1628045534"><span class="hs-identifier hs-var">ppr_given</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from the context:&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628045539"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1510"></a><span>                 </span><span class="hs-glyph">:</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045534"><span class="hs-identifier hs-var">ppr_given</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;or from:&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628045540"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-1511"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1512"></a><span>       </span><a name="local-1628045534"><a href="#local-1628045534"><span class="hs-identifier">ppr_given</span></a></a><span> </span><a name="local-1628045535"><a href="#local-1628045535"><span class="hs-identifier">herald</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045536"><a href="#local-1628045536"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045537"><a href="#local-1628045537"><span class="hs-identifier">skol_info</span></a></a><span>
</span><a name="line-1513"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045538"><a href="#local-1628045538"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1514"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045535"><span class="hs-identifier hs-var">herald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcRnTypes.html#pprEvVarTheta"><span class="hs-identifier hs-var">pprEvVarTheta</span></a><span> </span><a href="#local-1628045536"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1515"></a><span>                </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound by&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045537"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-1516"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045538"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1517"></a><span>
</span><a name="line-1518"></a><span class="hs-identifier">extraTyVarInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1519"></a><span class="hs-comment">-- Add on extra info about skolem constants</span><span>
</span><a name="line-1520"></a><span class="hs-comment">-- NB: The types themselves are already tidied</span><span>
</span><a name="line-1521"></a><a name="extraTyVarInfo"><a href="TcErrors.html#extraTyVarInfo"><span class="hs-identifier">extraTyVarInfo</span></a></a><span> </span><a name="local-1628045541"><a href="#local-1628045541"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045542"><a href="#local-1628045542"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-1628045543"><a href="#local-1628045543"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1522"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTcTyVar</span><span> </span><span class="hs-identifier">tv1</span><span class="hs-special">,</span><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1523"></a><span>    </span><a href="#local-1628045546"><span class="hs-identifier hs-var">tv_extra</span></a><span> </span><a href="#local-1628045542"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045545"><span class="hs-identifier hs-var">ty_extra</span></a><span> </span><a href="#local-1628045543"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1524"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1525"></a><span>    </span><a name="local-1628045544"><a href="#local-1628045544"><span class="hs-identifier">implics</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045541"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1526"></a><span>    </span><a name="local-1628045545"><a href="#local-1628045545"><span class="hs-identifier">ty_extra</span></a></a><span> </span><a name="local-1628045547"><a href="#local-1628045547"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045547"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1527"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045548"><a href="#local-1628045548"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045546"><span class="hs-identifier hs-var">tv_extra</span></a><span> </span><a href="#local-1628045548"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1528"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1529"></a><span>
</span><a name="line-1530"></a><span>    </span><a name="local-1628045546"><a href="#local-1628045546"><span class="hs-identifier">tv_extra</span></a></a><span> </span><a name="local-1628045549"><a href="#local-1628045549"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1531"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045550"><a href="#local-1628045550"><span class="hs-identifier">pp_tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045549"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1532"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a><span> </span><a href="#local-1628045549"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1533"></a><span>          </span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#pprSkol"><span class="hs-identifier hs-var">pprSkol</span></a><span> </span><a href="#local-1628045544"><span class="hs-identifier hs-var">implics</span></a><span> </span><a href="#local-1628045549"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1534"></a><span>          </span><a href="TcType.html#FlatSkol"><span class="hs-identifier hs-var">FlatSkol</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045550"><span class="hs-identifier hs-var">pp_tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is a flattening type variable&quot;</span><span>
</span><a name="line-1535"></a><span>          </span><a href="TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045550"><span class="hs-identifier hs-var">pp_tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is an interactive-debugger skolem&quot;</span><span>
</span><a name="line-1536"></a><span>          </span><a href="TcType.html#MetaTv"><span class="hs-identifier hs-var">MetaTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1537"></a><span>
</span><a name="line-1538"></a><span class="hs-identifier">suggestAddSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1539"></a><span class="hs-comment">-- See Note [Suggest adding a type signature]</span><span>
</span><a name="line-1540"></a><a name="suggestAddSig"><a href="TcErrors.html#suggestAddSig"><span class="hs-identifier">suggestAddSig</span></a></a><span> </span><a name="local-1628045551"><a href="#local-1628045551"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045552"><a href="#local-1628045552"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045553"><a href="#local-1628045553"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1541"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045554"><span class="hs-identifier hs-var">inferred_bndrs</span></a><span>
</span><a name="line-1542"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1543"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-1628045559"><a href="#local-1628045559"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045554"><span class="hs-identifier hs-var">inferred_bndrs</span></a><span>
</span><a name="line-1544"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Possible fix: add a type signature for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045559"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1545"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1546"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Possible fix: add type signatures for some or all of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045554"><span class="hs-identifier hs-var">inferred_bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1547"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1548"></a><span>    </span><a name="local-1628045554"><a href="#local-1628045554"><span class="hs-identifier">inferred_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045555"><span class="hs-identifier hs-var">get_inf</span></a><span> </span><a href="#local-1628045552"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045555"><span class="hs-identifier hs-var">get_inf</span></a><span> </span><a href="#local-1628045553"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1549"></a><span>    </span><a name="local-1628045555"><a href="#local-1628045555"><span class="hs-identifier">get_inf</span></a></a><span> </span><a name="local-1628045556"><a href="#local-1628045556"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045557"><a href="#local-1628045557"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045556"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1550"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a><span> </span><a href="#local-1628045557"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1551"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#InferSkol"><span class="hs-identifier hs-var">InferSkol</span></a><span> </span><a name="local-1628045558"><a href="#local-1628045558"><span class="hs-identifier">prs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#getSkolemInfo"><span class="hs-identifier hs-var">getSkolemInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_encl</span><span> </span><a href="#local-1628045551"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045557"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1552"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="#local-1628045558"><span class="hs-identifier hs-var">prs</span></a><span>
</span><a name="line-1553"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1554"></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1555"></a><span>
</span><a name="line-1556"></a><span class="hs-comment">--------------------</span><span>
</span><a name="line-1557"></a><span class="hs-identifier">misMatchMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1558"></a><span class="hs-comment">-- Types are already tidy</span><span>
</span><a name="line-1559"></a><span class="hs-comment">-- If oriented then ty1 is actual, ty2 is expected</span><span>
</span><a name="line-1560"></a><a name="misMatchMsg"><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier">misMatchMsg</span></a></a><span> </span><a name="local-1628045560"><a href="#local-1628045560"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045561"><a href="#local-1628045561"><span class="hs-identifier">oriented</span></a></a><span> </span><a name="local-1628045562"><a href="#local-1628045562"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045563"><a href="#local-1628045563"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1561"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="BasicTypes.html#NotSwapped"><span class="hs-identifier hs-var">NotSwapped</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045561"><span class="hs-identifier hs-var">oriented</span></a><span>
</span><a name="line-1562"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#misMatchMsg"><span class="hs-identifier hs-var">misMatchMsg</span></a><span> </span><a href="#local-1628045560"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="BasicTypes.html#IsSwapped"><span class="hs-identifier hs-var">IsSwapped</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045563"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-1628045562"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1563"></a><span>
</span><a name="line-1564"></a><span>  </span><span class="hs-comment">-- These next two cases are when we're about to report, e.g., that</span><span>
</span><a name="line-1565"></a><span>  </span><span class="hs-comment">-- 'PtrRepLifted doesn't match 'VoidRep. Much better just to say</span><span>
</span><a name="line-1566"></a><span>  </span><span class="hs-comment">-- lifted vs. unlifted</span><span>
</span><a name="line-1567"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045576"><a href="#local-1628045576"><span class="hs-identifier">tc1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628045562"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1568"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045576"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepLiftedDataConKey"><span class="hs-identifier hs-var">ptrRepLiftedDataConKey</span></a><span>
</span><a name="line-1569"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045573"><span class="hs-identifier hs-var">lifted_vs_unlifted</span></a><span>
</span><a name="line-1570"></a><span>
</span><a name="line-1571"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045577"><a href="#local-1628045577"><span class="hs-identifier">tc2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628045563"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1572"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045577"><span class="hs-identifier hs-var">tc2</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepLiftedDataConKey"><span class="hs-identifier hs-var">ptrRepLiftedDataConKey</span></a><span>
</span><a name="line-1573"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045573"><span class="hs-identifier hs-var">lifted_vs_unlifted</span></a><span>
</span><a name="line-1574"></a><span>
</span><a name="line-1575"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045578"><a href="#local-1628045578"><span class="hs-identifier">tc1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628045562"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1576"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045579"><a href="#local-1628045579"><span class="hs-identifier">tc2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628045563"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1577"></a><span>  </span><span class="hs-special">,</span><span>    </span><span class="hs-special">(</span><a href="#local-1628045578"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepLiftedDataConKey"><span class="hs-identifier hs-var">ptrRepLiftedDataConKey</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045579"><span class="hs-identifier hs-var">tc2</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepUnliftedDataConKey"><span class="hs-identifier hs-var">ptrRepUnliftedDataConKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-1578"></a><span>    </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-1628045578"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepUnliftedDataConKey"><span class="hs-identifier hs-var">ptrRepUnliftedDataConKey</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045579"><span class="hs-identifier hs-var">tc2</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ptrRepLiftedDataConKey"><span class="hs-identifier hs-var">ptrRepLiftedDataConKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-1579"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045573"><span class="hs-identifier hs-var">lifted_vs_unlifted</span></a><span>
</span><a name="line-1580"></a><span>
</span><a name="line-1581"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- So now we have Nothing or (Just IsSwapped)</span><span>
</span><a name="line-1582"></a><span>               </span><span class="hs-comment">-- For some reason we treat Nothing like IsSwapped</span><span>
</span><a name="line-1583"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045569"><span class="hs-identifier hs-var">orig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1584"></a><span>    </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628045564"><span class="hs-identifier hs-var">herald1</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045562"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1585"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><a href="#local-1628045566"><span class="hs-identifier hs-var">padding</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1586"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628045565"><span class="hs-identifier hs-var">herald2</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045563"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1587"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TcErrors.html#sameOccExtra"><span class="hs-identifier hs-var">sameOccExtra</span></a><span> </span><a href="#local-1628045563"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-1628045562"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1588"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1589"></a><span>    </span><a name="local-1628045564"><a href="#local-1628045564"><span class="hs-identifier">herald1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045571"><span class="hs-identifier hs-var">conc</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Couldn't match&quot;</span><span>
</span><a name="line-1590"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045567"><span class="hs-identifier hs-var">is_repr</span></a><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;representation of&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1591"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045568"><span class="hs-identifier hs-var">is_oriented</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;expected&quot;</span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1592"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="#local-1628045570"><span class="hs-identifier hs-var">what</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1593"></a><span>    </span><a name="local-1628045565"><a href="#local-1628045565"><span class="hs-identifier">herald2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045571"><span class="hs-identifier hs-var">conc</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;with&quot;</span><span>
</span><a name="line-1594"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045567"><span class="hs-identifier hs-var">is_repr</span></a><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;that of&quot;</span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1595"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045568"><span class="hs-identifier hs-var">is_oriented</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;actual &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045570"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1596"></a><span>    </span><a name="local-1628045566"><a href="#local-1628045566"><span class="hs-identifier">padding</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045564"><span class="hs-identifier hs-var">herald1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045565"><span class="hs-identifier hs-var">herald2</span></a><span>
</span><a name="line-1597"></a><span>
</span><a name="line-1598"></a><span>    </span><a name="local-1628045567"><a href="#local-1628045567"><span class="hs-identifier">is_repr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctEqRel"><span class="hs-identifier hs-var">ctEqRel</span></a><span> </span><a href="#local-1628045560"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1599"></a><span>    </span><a name="local-1628045568"><a href="#local-1628045568"><span class="hs-identifier">is_oriented</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-1628045561"><span class="hs-identifier hs-var">oriented</span></a><span>
</span><a name="line-1600"></a><span>
</span><a name="line-1601"></a><span>    </span><a name="local-1628045569"><a href="#local-1628045569"><span class="hs-identifier">orig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045560"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1602"></a><span>    </span><a name="local-1628045570"><a href="#local-1628045570"><span class="hs-identifier">what</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a><span> </span><a href="#local-1628045560"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1603"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1604"></a><span>      </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span>    </span><span class="hs-identifier">conc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1607"></a><span>    </span><a name="local-1628045571"><a href="#local-1628045571"><span class="hs-identifier">conc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span> </span><a href="#local-1628045572"><span class="hs-identifier hs-var">add_space</span></a><span>
</span><a name="line-1608"></a><span>
</span><a name="line-1609"></a><span>    </span><span class="hs-identifier">add_space</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1610"></a><span>    </span><a name="local-1628045572"><a href="#local-1628045572"><span class="hs-identifier">add_space</span></a></a><span> </span><a name="local-1628045574"><a href="#local-1628045574"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-1628045575"><a href="#local-1628045575"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045574"><span class="hs-identifier hs-var">s1</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045575"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-1611"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045575"><span class="hs-identifier hs-var">s2</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045574"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-1612"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045574"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">(</span><span class="hs-char">' '</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628045575"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1613"></a><span>
</span><a name="line-1614"></a><span>    </span><a name="local-1628045573"><a href="#local-1628045573"><span class="hs-identifier">lifted_vs_unlifted</span></a></a><span>
</span><a name="line-1615"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045569"><span class="hs-identifier hs-var">orig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1616"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Couldn't match a lifted type with an unlifted type&quot;</span><span>
</span><a name="line-1617"></a><span>
</span><a name="line-1618"></a><span class="hs-identifier">mkExpectedActualMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1619"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#SwapFlag"><span class="hs-identifier hs-type">SwapFlag</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1620"></a><span class="hs-comment">-- NotSwapped means (actual, expected), IsSwapped is the reverse</span><span>
</span><a name="line-1621"></a><span class="hs-comment">-- First return val is whether or not to print a herald above this msg</span><span>
</span><a name="line-1622"></a><a name="mkExpectedActualMsg"><a href="TcErrors.html#mkExpectedActualMsg"><span class="hs-identifier">mkExpectedActualMsg</span></a></a><span> </span><a name="local-1628045580"><a href="#local-1628045580"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045581"><a href="#local-1628045581"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">uo_actual</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045582"><a href="#local-1628045582"><span class="hs-identifier">act</span></a></a><span>
</span><a name="line-1623"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">uo_expected</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#Check"><span class="hs-identifier hs-var">Check</span></a><span> </span><a name="local-1628045583"><a href="#local-1628045583"><span class="hs-identifier">exp</span></a></a><span>
</span><a name="line-1624"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">uo_thing</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045584"><a href="#local-1628045584"><span class="hs-identifier">maybe_thing</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1625"></a><span>                    </span><a name="local-1628045585"><a href="#local-1628045585"><span class="hs-identifier">m_level</span></a></a><span> </span><a name="local-1628045586"><a href="#local-1628045586"><span class="hs-identifier">printExpanded</span></a></a><span>
</span><a name="line-1626"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045587"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045588"><span class="hs-identifier hs-var">occurs_check_error</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isUnliftedTypeKind"><span class="hs-identifier hs-var">isUnliftedTypeKind</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045592"><span class="hs-identifier hs-var">msg2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1628"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isUnliftedTypeKind"><span class="hs-identifier hs-var">isUnliftedTypeKind</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045593"><span class="hs-identifier hs-var">msg3</span></a><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-1630"></a><span>                                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045594"><span class="hs-identifier hs-var">msg4</span></a><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045621"><a href="#local-1628045621"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045596"><span class="hs-identifier hs-var">num_args_msg</span></a><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045621"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045590"><span class="hs-identifier hs-var">msg1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1632"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045587"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045622"><a href="#local-1628045622"><span class="hs-identifier">th</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045584"><span class="hs-identifier hs-var">maybe_thing</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045595"><span class="hs-identifier hs-var">msg5</span></a><span> </span><a href="#local-1628045622"><span class="hs-identifier hs-var">th</span></a><span class="hs-special">)</span><span>
</span><a name="line-1633"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045580"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045581"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="BasicTypes.html#NotSwapped"><span class="hs-identifier hs-var">NotSwapped</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1634"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045580"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045581"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="BasicTypes.html#IsSwapped"><span class="hs-identifier hs-var">IsSwapped</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1635"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045590"><span class="hs-identifier hs-var">msg1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1637"></a><span>    </span><a name="local-1628045587"><a href="#local-1628045587"><span class="hs-identifier">level</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045585"><span class="hs-identifier hs-var">m_level</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span>    </span><a name="local-1628045588"><a href="#local-1628045588"><span class="hs-identifier">occurs_check_error</span></a></a><span>
</span><a name="line-1640"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045603"><a href="#local-1628045603"><span class="hs-identifier">act_tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-1641"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1628045603"><span class="hs-identifier hs-var">act_tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-1642"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1643"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045604"><a href="#local-1628045604"><span class="hs-identifier">exp_tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcGetTyVar_maybe"><span class="hs-identifier hs-var">tcGetTyVar_maybe</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-1644"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1628045604"><span class="hs-identifier hs-var">exp_tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-1645"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1646"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1647"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span>    </span><a name="local-1628045589"><a href="#local-1628045589"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045587"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1650"></a><span>      </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1651"></a><span>      </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1652"></a><span>
</span><a name="line-1653"></a><span>    </span><a name="local-1628045590"><a href="#local-1628045590"><span class="hs-identifier">msg1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045587"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1654"></a><span>      </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span>
</span><a name="line-1655"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045605"><a href="#local-1628045605"><span class="hs-identifier">th</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045584"><span class="hs-identifier hs-var">maybe_thing</span></a><span>
</span><a name="line-1656"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045595"><span class="hs-identifier hs-var">msg5</span></a><span> </span><a href="#local-1628045605"><span class="hs-identifier hs-var">th</span></a><span>
</span><a name="line-1657"></a><span>
</span><a name="line-1658"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-1659"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045589"><span class="hs-identifier hs-var">sort</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-1660"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;  Actual&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045589"><span class="hs-identifier hs-var">sort</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-1661"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045586"><span class="hs-identifier hs-var">printExpanded</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628045600"><span class="hs-identifier hs-var">expandedTys</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1662"></a><span>
</span><a name="line-1663"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1664"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1665"></a><span>
</span><a name="line-1666"></a><span>    </span><a name="local-1628045591"><a href="#local-1628045591"><span class="hs-identifier">thing_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045584"><span class="hs-identifier hs-var">maybe_thing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1667"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045606"><a href="#local-1628045606"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045606"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is&quot;</span><span>
</span><a name="line-1668"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-1628045607"><a href="#local-1628045607"><span class="hs-identifier">vowel</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;got a&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span>
</span><a name="line-1669"></a><span>                                          </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045607"><span class="hs-identifier hs-var">vowel</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'n'</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1670"></a><span>    </span><a name="local-1628045592"><a href="#local-1628045592"><span class="hs-identifier">msg2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expecting a lifted type, but&quot;</span><span>
</span><a name="line-1671"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="#local-1628045591"><span class="hs-identifier hs-var">thing_msg</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;unlifted&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1672"></a><span>    </span><a name="local-1628045593"><a href="#local-1628045593"><span class="hs-identifier">msg3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expecting an unlifted type, but&quot;</span><span>
</span><a name="line-1673"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="#local-1628045591"><span class="hs-identifier hs-var">thing_msg</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lifted&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1674"></a><span>    </span><a name="local-1628045594"><a href="#local-1628045594"><span class="hs-identifier">msg4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045597"><span class="hs-identifier hs-var">maybe_num_args_msg</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1675"></a><span>           </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected a type, but&quot;</span><span>
</span><a name="line-1676"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;found something with kind&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1677"></a><span>                       </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628045608"><a href="#local-1628045608"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045608"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;has kind&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1678"></a><span>                       </span><a href="#local-1628045584"><span class="hs-identifier hs-var">maybe_thing</span></a><span>
</span><a name="line-1679"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1680"></a><span>
</span><a name="line-1681"></a><span>    </span><a name="local-1628045595"><a href="#local-1628045595"><span class="hs-identifier">msg5</span></a></a><span> </span><a name="local-1628045609"><a href="#local-1628045609"><span class="hs-identifier">th</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045610"><span class="hs-identifier hs-var">kind_desc</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span class="hs-special">)</span><span>
</span><a name="line-1682"></a><span>                 </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;but&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045609"><span class="hs-identifier hs-var">th</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;has kind&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1683"></a><span>                    </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1684"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1685"></a><span>        </span><a name="local-1628045610"><a href="#local-1628045610"><span class="hs-identifier">kind_desc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a constraint&quot;</span><span>
</span><a name="line-1686"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-1687"></a><span>
</span><a name="line-1688"></a><span>    </span><a name="local-1628045596"><a href="#local-1628045596"><span class="hs-identifier">num_args_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045587"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1689"></a><span>      </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1690"></a><span>      </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span>
</span><a name="line-1691"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045611"><a href="#local-1628045611"><span class="hs-identifier">n_act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045598"><span class="hs-identifier hs-var">count_args</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-1692"></a><span>               </span><a name="local-1628045612"><a href="#local-1628045612"><span class="hs-identifier">n_exp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045598"><span class="hs-identifier hs-var">count_args</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1693"></a><span>           </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045611"><span class="hs-identifier hs-var">n_act</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1628045612"><span class="hs-identifier hs-var">n_exp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1694"></a><span>             </span><a name="local-1628045613"><a href="#local-1628045613"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1695"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045615"><a href="#local-1628045615"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045584"><span class="hs-identifier hs-var">maybe_thing</span></a><span>
</span><a name="line-1696"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcRnTypes.html#errorThingNumArgs_maybe"><span class="hs-identifier hs-var">errorThingNumArgs_maybe</span></a><span> </span><a href="#local-1628045615"><span class="hs-identifier hs-var">thing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1697"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1698"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045616"><a href="#local-1628045616"><span class="hs-identifier">num_act_args</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045616"><span class="hs-identifier hs-var">num_act_args</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-glyph">-</span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1699"></a><span>                     </span><span class="hs-comment">-- don't report to strip off args that aren't there</span><span>
</span><a name="line-1700"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expecting&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakN"><span class="hs-identifier hs-var">speakN</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#abs"><span class="hs-identifier hs-var">abs</span></a><span> </span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1701"></a><span>                         </span><a href="#local-1628045614"><span class="hs-identifier hs-var">more_or_fewer</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045599"><span class="hs-identifier hs-var">plural_n</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#abs"><span class="hs-identifier hs-var">abs</span></a><span> </span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;argument&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1702"></a><span>                                       </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045615"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1703"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1704"></a><span>                 </span><a name="local-1628045614"><a href="#local-1628045614"><span class="hs-identifier">more_or_fewer</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045613"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;fewer&quot;</span><span>
</span><a name="line-1705"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;more&quot;</span><span>
</span><a name="line-1706"></a><span>             </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1707"></a><span>
</span><a name="line-1708"></a><span>
</span><a name="line-1709"></a><span>    </span><a name="local-1628045597"><a href="#local-1628045597"><span class="hs-identifier">maybe_num_args_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045596"><span class="hs-identifier hs-var">num_args_msg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1710"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1711"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045617"><a href="#local-1628045617"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045617"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1712"></a><span>
</span><a name="line-1713"></a><span>    </span><a name="local-1628045598"><a href="#local-1628045598"><span class="hs-identifier">count_args</span></a></a><span> </span><a name="local-1628045618"><a href="#local-1628045618"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#count"><span class="hs-identifier hs-var">count</span></a><span> </span><a href="TyCoRep.html#isVisibleBinder"><span class="hs-identifier hs-var">isVisibleBinder</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span> </span><a href="#local-1628045618"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1714"></a><span>
</span><a name="line-1715"></a><span>    </span><a name="local-1628045599"><a href="#local-1628045599"><span class="hs-identifier">plural_n</span></a></a><span> </span><span class="hs-number">1</span><span> </span><a name="local-1628045619"><a href="#local-1628045619"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045619"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-1716"></a><span>    </span><span class="hs-identifier">plural_n</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628045620"><a href="#local-1628045620"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045620"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'s'</span><span>
</span><a name="line-1717"></a><span>
</span><a name="line-1718"></a><span>    </span><a name="local-1628045600"><a href="#local-1628045600"><span class="hs-identifier">expandedTys</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1719"></a><span>      </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045601"><span class="hs-identifier hs-var">expTy1</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045602"><span class="hs-identifier hs-var">expTy2</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-1720"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type synonyms expanded:&quot;</span><span>
</span><a name="line-1721"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expected type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045601"><span class="hs-identifier hs-var">expTy1</span></a><span>
</span><a name="line-1722"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;  Actual type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045602"><span class="hs-identifier hs-var">expTy2</span></a><span>
</span><a name="line-1723"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1724"></a><span>
</span><a name="line-1725"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045601"><a href="#local-1628045601"><span class="hs-identifier">expTy1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045602"><a href="#local-1628045602"><span class="hs-identifier">expTy2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#expandSynonymsToMatch"><span class="hs-identifier hs-var">expandSynonymsToMatch</span></a><span> </span><a href="#local-1628045583"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-1628045582"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-1726"></a><span>
</span><a name="line-1727"></a><span class="hs-identifier">mkExpectedActualMsg</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkExpectedAcutalMsg&quot;</span><span>
</span><a name="line-1728"></a><span>
</span><a name="line-1729"></a><span class="hs-comment">{-
Note [Expanding type synonyms to make types similar]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In type error messages, if -fprint-expanded-types is used, we want to expand
type synonyms to make expected and found types as similar as possible, but we
shouldn't expand types too much to make type messages even more verbose and
harder to understand. The whole point here is to make the difference in expected
and found types clearer.

`expandSynonymsToMatch` does this, it takes two types, and expands type synonyms
only as much as necessary. It should work like this:

Given two types t1 and t2:

  * If they're already same, it shouldn't expand any type synonyms and
    just return.

  * If they're in form `C1 t1_1 .. t1_n` and `C2 t2_1 .. t2_m` (C1 and C2 are
    type constructors), it should expand C1 and C2 if they're different type
    synonyms. Then it should continue doing same thing on expanded types. If C1
    and C2 are same, then we should apply same procedure to arguments of C1
    and argument of C2 to make them as similar as possible.

    Most important thing here is to keep number of synonym expansions at
    minimum. For example, if t1 is `T (T3, T5, Int)` and t2 is
    `T (T5, T3, Bool)` where T5 = T4, T4 = T3, ..., T1 = X, we should return
    `T (T3, T3, Int)` and `T (T3, T3, Bool)`.

In the implementation, we just search in all possible solutions for a solution
that does minimum amount of expansions. This leads to a complex algorithm: If
we have two synonyms like X_m = X_{m-1} = .. X and Y_n = Y_{n-1} = .. Y, where
X and Y are rigid types, we expand m * n times. But in practice it's not a
problem because deeply nested synonyms with no intervening rigid type
constructors are vanishingly rare.

-}</span><span>
</span><a name="line-1766"></a><span>
</span><a name="line-1767"></a><span class="hs-comment">-- | Expand type synonyms in given types only enough to make them as equal as</span><span>
</span><a name="line-1768"></a><span class="hs-comment">-- possible. Returned types are the same in terms of used type synonyms.</span><span>
</span><a name="line-1769"></a><span class="hs-comment">--</span><span>
</span><a name="line-1770"></a><span class="hs-comment">-- To expand all synonyms, see 'Type.expandTypeSynonyms'.</span><span>
</span><a name="line-1771"></a><span class="hs-identifier">expandSynonymsToMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1772"></a><a name="expandSynonymsToMatch"><a href="TcErrors.html#expandSynonymsToMatch"><span class="hs-identifier">expandSynonymsToMatch</span></a></a><span> </span><a name="local-1628045623"><a href="#local-1628045623"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045624"><a href="#local-1628045624"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045625"><span class="hs-identifier hs-var">ty1_ret</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045626"><span class="hs-identifier hs-var">ty2_ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1774"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628045625"><a href="#local-1628045625"><span class="hs-identifier">ty1_ret</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045626"><a href="#local-1628045626"><span class="hs-identifier">ty2_ret</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1628045623"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045624"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1775"></a><span>
</span><a name="line-1776"></a><span>    </span><span class="hs-comment">-- | Returns (number of synonym expansions done to make types similar,</span><span>
</span><a name="line-1777"></a><span>    </span><span class="hs-comment">--            type synonym expanded version of first type,</span><span>
</span><a name="line-1778"></a><span>    </span><span class="hs-comment">--            type synonym expanded version of second type)</span><span>
</span><a name="line-1779"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1780"></a><span>    </span><span class="hs-comment">-- Int argument is number of synonym expansions done so far.</span><span>
</span><a name="line-1781"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1782"></a><span>    </span><a name="local-1628045627"><a href="#local-1628045627"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1628045628"><a href="#local-1628045628"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045629"><a href="#local-1628045629"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628045630"><a href="#local-1628045630"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1783"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045629"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#pickyEqType"><span class="hs-identifier hs-var">pickyEqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045630"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1784"></a><span>        </span><span class="hs-comment">-- Types are same, nothing to do</span><span>
</span><a name="line-1785"></a><span>        </span><span class="hs-special">(</span><a href="#local-1628045628"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045629"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045630"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1786"></a><span>
</span><a name="line-1787"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045631"><a href="#local-1628045631"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045632"><a href="#local-1628045632"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1628045633"><a href="#local-1628045633"><span class="hs-identifier">tc1</span></a></a><span> </span><a name="local-1628045634"><a href="#local-1628045634"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045635"><a href="#local-1628045635"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1628045636"><a href="#local-1628045636"><span class="hs-identifier">tc2</span></a></a><span> </span><a name="local-1628045637"><a href="#local-1628045637"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1788"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045633"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628045636"><span class="hs-identifier hs-var">tc2</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1789"></a><span>        </span><span class="hs-comment">-- Type constructors are same. They may be synonyms, but we don't</span><span>
</span><a name="line-1790"></a><span>        </span><span class="hs-comment">-- expand further.</span><span>
</span><a name="line-1791"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045638"><a href="#local-1628045638"><span class="hs-identifier">exps'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045639"><a href="#local-1628045639"><span class="hs-identifier">tys1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045640"><a href="#local-1628045640"><span class="hs-identifier">tys2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip3"><span class="hs-identifier hs-var">unzip3</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-1628045634"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-1628045637"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-1792"></a><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a><span> </span><a href="#local-1628045638"><span class="hs-identifier hs-var">exps'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1628045633"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-1628045639"><span class="hs-identifier hs-var">tys1'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1628045636"><span class="hs-identifier hs-var">tc2</span></a><span> </span><a href="#local-1628045640"><span class="hs-identifier hs-var">tys2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1793"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1794"></a><span>        </span><span class="hs-comment">-- Try to expand type constructors</span><span>
</span><a name="line-1795"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628045632"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628045635"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1796"></a><span>          </span><span class="hs-comment">-- When only one of the constructors is a synonym, we just</span><span>
</span><a name="line-1797"></a><span>          </span><span class="hs-comment">-- expand it and continue search</span><span>
</span><a name="line-1798"></a><span>          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045641"><a href="#local-1628045641"><span class="hs-identifier">t1'</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1799"></a><span>            </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045641"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-1628045635"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1800"></a><span>          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045642"><a href="#local-1628045642"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1801"></a><span>            </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045632"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628045642"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-1802"></a><span>          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045643"><a href="#local-1628045643"><span class="hs-identifier">t1'</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045644"><a href="#local-1628045644"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1803"></a><span>            </span><span class="hs-comment">-- Both constructors are synonyms, but they may be synonyms of</span><span>
</span><a name="line-1804"></a><span>            </span><span class="hs-comment">-- each other. We just search for minimally expanded solution.</span><span>
</span><a name="line-1805"></a><span>            </span><span class="hs-comment">-- See Note [Expanding type synonyms to make types similar].</span><span>
</span><a name="line-1806"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045645"><a href="#local-1628045645"><span class="hs-identifier">sol1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1628045646"><a href="#local-1628045646"><span class="hs-identifier">exp1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045643"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-1628045635"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1807"></a><span>                </span><a name="local-1628045647"><a href="#local-1628045647"><span class="hs-identifier">sol2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1628045648"><a href="#local-1628045648"><span class="hs-identifier">exp2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045632"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628045644"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-1808"></a><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045646"><span class="hs-identifier hs-var">exp1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1628045648"><span class="hs-identifier hs-var">exp2</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628045645"><span class="hs-identifier hs-var">sol1</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-1628045647"><span class="hs-identifier hs-var">sol2</span></a><span>
</span><a name="line-1809"></a><span>          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1810"></a><span>            </span><span class="hs-comment">-- None of the constructors are synonyms, nothing to do</span><span>
</span><a name="line-1811"></a><span>            </span><span class="hs-special">(</span><a href="#local-1628045631"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045632"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045635"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1812"></a><span>
</span><a name="line-1813"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045649"><a href="#local-1628045649"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045650"><a href="#local-1628045650"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><a name="local-1628045651"><a href="#local-1628045651"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1814"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045652"><a href="#local-1628045652"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628045650"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045649"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045652"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-1628045651"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1815"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045649"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045650"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045651"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1816"></a><span>
</span><a name="line-1817"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045653"><a href="#local-1628045653"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045654"><a href="#local-1628045654"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628045655"><a href="#local-1628045655"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-1818"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045656"><a href="#local-1628045656"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628045655"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045653"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1628045654"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628045656"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-1819"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045653"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045654"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045655"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1820"></a><span>
</span><a name="line-1821"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045657"><a href="#local-1628045657"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1628045658"><a href="#local-1628045658"><span class="hs-identifier">t1_1</span></a></a><span> </span><a name="local-1628045659"><a href="#local-1628045659"><span class="hs-identifier">t1_2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1628045660"><a href="#local-1628045660"><span class="hs-identifier">t2_1</span></a></a><span> </span><a name="local-1628045661"><a href="#local-1628045661"><span class="hs-identifier">t2_2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1822"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045662"><a href="#local-1628045662"><span class="hs-identifier">exps1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045663"><a href="#local-1628045663"><span class="hs-identifier">t1_1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045664"><a href="#local-1628045664"><span class="hs-identifier">t2_1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1628045658"><span class="hs-identifier hs-var">t1_1</span></a><span> </span><a href="#local-1628045660"><span class="hs-identifier hs-var">t2_1</span></a><span>
</span><a name="line-1823"></a><span>          </span><span class="hs-special">(</span><a name="local-1628045665"><a href="#local-1628045665"><span class="hs-identifier">exps2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045666"><a href="#local-1628045666"><span class="hs-identifier">t1_2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045667"><a href="#local-1628045667"><span class="hs-identifier">t2_2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1628045659"><span class="hs-identifier hs-var">t1_2</span></a><span> </span><a href="#local-1628045661"><span class="hs-identifier hs-var">t2_2</span></a><span>
</span><a name="line-1824"></a><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1628045657"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1628045662"><span class="hs-identifier hs-var">exps1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1628045665"><span class="hs-identifier hs-var">exps2</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><a href="#local-1628045663"><span class="hs-identifier hs-var">t1_1'</span></a><span> </span><a href="#local-1628045666"><span class="hs-identifier hs-var">t1_2'</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><a href="#local-1628045664"><span class="hs-identifier hs-var">t2_1'</span></a><span> </span><a href="#local-1628045667"><span class="hs-identifier hs-var">t2_2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1825"></a><span>
</span><a name="line-1826"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045668"><a href="#local-1628045668"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628045669"><a href="#local-1628045669"><span class="hs-identifier">t1_1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045670"><a href="#local-1628045670"><span class="hs-identifier">t1_2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628045671"><a href="#local-1628045671"><span class="hs-identifier">t2_1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045672"><a href="#local-1628045672"><span class="hs-identifier">t2_2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1827"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045673"><a href="#local-1628045673"><span class="hs-identifier">exps1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045674"><a href="#local-1628045674"><span class="hs-identifier">t1_1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045675"><a href="#local-1628045675"><span class="hs-identifier">t2_1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1628045669"><span class="hs-identifier hs-var">t1_1</span></a><span> </span><a href="#local-1628045671"><span class="hs-identifier hs-var">t2_1</span></a><span>
</span><a name="line-1828"></a><span>          </span><span class="hs-special">(</span><a name="local-1628045676"><a href="#local-1628045676"><span class="hs-identifier">exps2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045677"><a href="#local-1628045677"><span class="hs-identifier">t1_2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045678"><a href="#local-1628045678"><span class="hs-identifier">t2_2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1628045670"><span class="hs-identifier hs-var">t1_2</span></a><span> </span><a href="#local-1628045672"><span class="hs-identifier hs-var">t2_2</span></a><span>
</span><a name="line-1829"></a><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1628045668"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1628045673"><span class="hs-identifier hs-var">exps1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1628045676"><span class="hs-identifier hs-var">exps2</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="#local-1628045674"><span class="hs-identifier hs-var">t1_1'</span></a><span> </span><a href="#local-1628045677"><span class="hs-identifier hs-var">t1_2'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="#local-1628045675"><span class="hs-identifier hs-var">t2_1'</span></a><span> </span><a href="#local-1628045678"><span class="hs-identifier hs-var">t2_2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1830"></a><span>
</span><a name="line-1831"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045679"><a href="#local-1628045679"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628045680"><a href="#local-1628045680"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-1628045681"><a href="#local-1628045681"><span class="hs-identifier">vis1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045682"><a href="#local-1628045682"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628045683"><a href="#local-1628045683"><span class="hs-identifier">tv2</span></a></a><span> </span><a name="local-1628045684"><a href="#local-1628045684"><span class="hs-identifier">vis2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045685"><a href="#local-1628045685"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1832"></a><span>      </span><span class="hs-comment">-- NOTE: We may have a bug here, but we just can't reproduce it easily.</span><span>
</span><a name="line-1833"></a><span>      </span><span class="hs-comment">-- See D1016 comments for details and our attempts at producing a test</span><span>
</span><a name="line-1834"></a><span>      </span><span class="hs-comment">-- case. Short version: We probably need RnEnv2 to really get this right.</span><span>
</span><a name="line-1835"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045686"><a href="#local-1628045686"><span class="hs-identifier">exps1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045687"><a href="#local-1628045687"><span class="hs-identifier">t1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045688"><a href="#local-1628045688"><span class="hs-identifier">t2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045679"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="#local-1628045682"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628045685"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1836"></a><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1628045686"><span class="hs-identifier hs-var">exps1</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1628045680"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1628045681"><span class="hs-identifier hs-var">vis1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045687"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1628045683"><span class="hs-identifier hs-var">tv2</span></a><span> </span><a href="#local-1628045684"><span class="hs-identifier hs-var">vis2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045688"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1837"></a><span>
</span><a name="line-1838"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045689"><a href="#local-1628045689"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1628045690"><a href="#local-1628045690"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1628045691"><a href="#local-1628045691"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045689"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="#local-1628045690"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045691"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1839"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045692"><a href="#local-1628045692"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045693"><a href="#local-1628045693"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1628045694"><a href="#local-1628045694"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045627"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045692"><span class="hs-identifier hs-var">exps</span></a><span> </span><a href="#local-1628045693"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1628045694"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1840"></a><span>
</span><a name="line-1841"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045695"><a href="#local-1628045695"><span class="hs-identifier">exps</span></a></a><span> </span><a name="local-1628045696"><a href="#local-1628045696"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628045697"><a href="#local-1628045697"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045695"><span class="hs-identifier hs-var">exps</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045696"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045697"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1842"></a><span>
</span><a name="line-1843"></a><span class="hs-identifier">sameOccExtra</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1844"></a><span class="hs-comment">-- See Note [Disambiguating (X ~ X) errors]</span><span>
</span><a name="line-1845"></a><a name="sameOccExtra"><a href="TcErrors.html#sameOccExtra"><span class="hs-identifier">sameOccExtra</span></a></a><span> </span><a name="local-1628045698"><a href="#local-1628045698"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1628045699"><a href="#local-1628045699"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1846"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045706"><a href="#local-1628045706"><span class="hs-identifier">tc1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045698"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1847"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045707"><a href="#local-1628045707"><span class="hs-identifier">tc2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045699"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1848"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045708"><a href="#local-1628045708"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628045706"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-1849"></a><span>        </span><a name="local-1628045709"><a href="#local-1628045709"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628045707"><span class="hs-identifier hs-var">tc2</span></a><span>
</span><a name="line-1850"></a><span>        </span><a name="local-1628045710"><a href="#local-1628045710"><span class="hs-identifier">same_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628045708"><span class="hs-identifier hs-var">n1</span></a><span>                   </span><span class="hs-operator hs-var">==</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628045709"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-1851"></a><span>        </span><a name="local-1628045711"><a href="#local-1628045711"><span class="hs-identifier">same_pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-1628045708"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-1628045709"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1852"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045708"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-1628045709"><span class="hs-identifier hs-var">n2</span></a><span>   </span><span class="hs-comment">-- Different Names</span><span>
</span><a name="line-1853"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045710"><span class="hs-identifier hs-var">same_occ</span></a><span>   </span><span class="hs-comment">-- but same OccName</span><span>
</span><a name="line-1854"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045700"><span class="hs-identifier hs-var">ppr_from</span></a><span> </span><a href="#local-1628045711"><span class="hs-identifier hs-var">same_pkg</span></a><span> </span><a href="#local-1628045708"><span class="hs-identifier hs-var">n1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628045700"><span class="hs-identifier hs-var">ppr_from</span></a><span> </span><a href="#local-1628045711"><span class="hs-identifier hs-var">same_pkg</span></a><span> </span><a href="#local-1628045709"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1855"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1856"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1857"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1858"></a><span>    </span><a name="local-1628045700"><a href="#local-1628045700"><span class="hs-identifier">ppr_from</span></a></a><span> </span><a name="local-1628045701"><a href="#local-1628045701"><span class="hs-identifier">same_pkg</span></a></a><span> </span><a name="local-1628045702"><a href="#local-1628045702"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-1859"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#isGoodSrcSpan"><span class="hs-identifier hs-var">isGoodSrcSpan</span></a><span> </span><a href="#local-1628045705"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1860"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045702"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is defined at&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1861"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045705"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1862"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- Imported things have an UnhelpfulSrcSpan</span><span>
</span><a name="line-1863"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045702"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1864"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is defined in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1628045704"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1865"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045701"><span class="hs-identifier hs-var">same_pkg</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1628045703"><span class="hs-identifier hs-var">pkg</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Module.html#mainUnitId"><span class="hs-identifier hs-var">mainUnitId</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1866"></a><span>                    </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in package&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045703"><span class="hs-identifier hs-var">pkg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1867"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-1868"></a><span>         </span><a name="local-1628045703"><a href="#local-1628045703"><span class="hs-identifier">pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-1628045704"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-1869"></a><span>         </span><a name="local-1628045704"><a href="#local-1628045704"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-1628045702"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1870"></a><span>         </span><a name="local-1628045705"><a href="#local-1628045705"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628045702"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span class="hs-comment">{-
Note [Suggest adding a type signature]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The OutsideIn algorithm rejects GADT programs that don't have a principal
type, and indeed some that do.  Example:
   data T a where
     MkT :: Int -&gt; T Int

   f (MkT n) = n

Does this have type f :: T a -&gt; a, or f :: T a -&gt; Int?
The error that shows up tends to be an attempt to unify an
untouchable type variable.  So suggestAddSig sees if the offending
type variable is bound by an *inferred* signature, and suggests
adding a declared signature instead.

This initially came up in Trac #8968, concerning pattern synonyms.

Note [Disambiguating (X ~ X) errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See Trac #8278

Note [Reporting occurs-check errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Given (a ~ [a]), if 'a' is a rigid type variable bound by a user-supplied
type signature, then the best thing is to report that we can't unify
a with [a], because a is a skolem variable.  That avoids the confusing
&quot;occur-check&quot; error message.

But nowadays when inferring the type of a function with no type signature,
even if there are errors inside, we still generalise its signature and
carry on. For example
   f x = x:x
Here we will infer somethiing like
   f :: forall a. a -&gt; [a]
with a deferred error of (a ~ [a]).  So in the deferred unsolved constraint
'a' is now a skolem, but not one bound by the programmer in the context!
Here we really should report an occurs check.

So isUserSkolem distinguishes the two.

Note [Non-injective type functions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's very confusing to get a message like
     Couldn't match expected type `Depend s'
            against inferred type `Depend s1'
so mkTyFunInfoMsg adds:
       NB: `Depend' is type function, and hence may not be injective

Warn of loopy local equalities that were dropped.


************************************************************************
*                                                                      *
                 Type-class errors
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1930"></a><span>
</span><a name="line-1931"></a><span class="hs-identifier">mkDictErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="ErrUtils.html#ErrMsg"><span class="hs-identifier hs-type">ErrMsg</span></a><span>
</span><a name="line-1932"></a><a name="mkDictErr"><a href="TcErrors.html#mkDictErr"><span class="hs-identifier">mkDictErr</span></a></a><span> </span><a name="local-1628045712"><a href="#local-1628045712"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045713"><a href="#local-1628045713"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-1933"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">cts</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1934"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045728"><a href="#local-1628045728"><span class="hs-identifier">inst_envs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcGetInstEnvs"><span class="hs-identifier hs-var">tcGetInstEnvs</span></a><span>
</span><a name="line-1935"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628045729"><a href="#local-1628045729"><span class="hs-identifier">ct1</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045713"><span class="hs-identifier hs-var">cts</span></a><span>  </span><span class="hs-comment">-- ct1 just for its location</span><span>
</span><a name="line-1936"></a><span>             </span><a name="local-1628045730"><a href="#local-1628045730"><span class="hs-identifier">min_cts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045717"><span class="hs-identifier hs-var">elim_superclasses</span></a><span> </span><a href="#local-1628045713"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-1937"></a><span>             </span><a name="local-1628045731"><a href="#local-1628045731"><span class="hs-identifier">lookups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045716"><span class="hs-identifier hs-var">lookup_cls_inst</span></a><span> </span><a href="#local-1628045728"><span class="hs-identifier hs-var">inst_envs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045730"><span class="hs-identifier hs-var">min_cts</span></a><span>
</span><a name="line-1938"></a><span>             </span><span class="hs-special">(</span><a name="local-1628045732"><a href="#local-1628045732"><span class="hs-identifier">no_inst_cts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045733"><a href="#local-1628045733"><span class="hs-identifier">overlap_cts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-1628045715"><span class="hs-identifier hs-var">is_no_inst</span></a><span> </span><a href="#local-1628045731"><span class="hs-identifier hs-var">lookups</span></a><span>
</span><a name="line-1939"></a><span>
</span><a name="line-1940"></a><span>       </span><span class="hs-comment">-- Report definite no-instance errors,</span><span>
</span><a name="line-1941"></a><span>       </span><span class="hs-comment">-- or (iff there are none) overlap errors</span><span>
</span><a name="line-1942"></a><span>       </span><span class="hs-comment">-- But we report only one of them (hence 'head') because they all</span><span>
</span><a name="line-1943"></a><span>       </span><span class="hs-comment">-- have the same source-location origin, to try avoid a cascade</span><span>
</span><a name="line-1944"></a><span>       </span><span class="hs-comment">-- of error from one location</span><span>
</span><a name="line-1945"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628045734"><a href="#local-1628045734"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045735"><a href="#local-1628045735"><span class="hs-identifier">err</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#mk_dict_err"><span class="hs-identifier hs-var">mk_dict_err</span></a><span> </span><a href="#local-1628045712"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045732"><span class="hs-identifier hs-var">no_inst_cts</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045733"><span class="hs-identifier hs-var">overlap_cts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1946"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcErrors.html#mkErrorMsgFromCt"><span class="hs-identifier hs-var">mkErrorMsgFromCt</span></a><span> </span><a href="#local-1628045734"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045729"><span class="hs-identifier hs-var">ct1</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#important"><span class="hs-identifier hs-var">important</span></a><span> </span><a href="#local-1628045735"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1947"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1948"></a><span>    </span><a name="local-1628045714"><a href="#local-1628045714"><span class="hs-identifier">no_givens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a><span> </span><a href="#local-1628045712"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1949"></a><span>
</span><a name="line-1950"></a><span>    </span><a name="local-1628045715"><a href="#local-1628045715"><span class="hs-identifier">is_no_inst</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045718"><a href="#local-1628045718"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628045719"><a href="#local-1628045719"><span class="hs-identifier">matches</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045720"><a href="#local-1628045720"><span class="hs-identifier">unifiers</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1951"></a><span>      </span><span class="hs-glyph">=</span><span>  </span><a href="#local-1628045714"><span class="hs-identifier hs-var">no_givens</span></a><span>
</span><a name="line-1952"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045719"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-1953"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045720"><span class="hs-identifier hs-var">unifiers</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-var">isAmbiguousTyVar</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#tyCoVarsOfCtList"><span class="hs-identifier hs-var">tyCoVarsOfCtList</span></a><span> </span><a href="#local-1628045718"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1954"></a><span>
</span><a name="line-1955"></a><span>    </span><a name="local-1628045716"><a href="#local-1628045716"><span class="hs-identifier">lookup_cls_inst</span></a></a><span> </span><a name="local-1628045721"><a href="#local-1628045721"><span class="hs-identifier">inst_envs</span></a></a><span> </span><a name="local-1628045722"><a href="#local-1628045722"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-1956"></a><span>                </span><span class="hs-comment">-- Note [Flattening in error message generation]</span><span>
</span><a name="line-1957"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045722"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><span> </span><a href="InstEnv.html#lookupInstEnv"><span class="hs-identifier hs-var">lookupInstEnv</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045721"><span class="hs-identifier hs-var">inst_envs</span></a><span> </span><a href="#local-1628045723"><span class="hs-identifier hs-var">clas</span></a><span> </span><span class="hs-special">(</span><a href="FamInstEnv.html#flattenTys"><span class="hs-identifier hs-var">flattenTys</span></a><span> </span><a href="VarEnv.html#emptyInScopeSet"><span class="hs-identifier hs-var">emptyInScopeSet</span></a><span> </span><a href="#local-1628045724"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1958"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1959"></a><span>        </span><span class="hs-special">(</span><a name="local-1628045723"><a href="#local-1628045723"><span class="hs-identifier">clas</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045724"><a href="#local-1628045724"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045722"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-1960"></a><span>
</span><a name="line-1961"></a><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-comment">-- When simplifying [W] Ord (Set a), we need</span><span>
</span><a name="line-1963"></a><span>    </span><span class="hs-comment">--    [W] Eq a, [W] Ord a</span><span>
</span><a name="line-1964"></a><span>    </span><span class="hs-comment">-- but we really only want to report the latter</span><span>
</span><a name="line-1965"></a><span>    </span><a name="local-1628045717"><a href="#local-1628045717"><span class="hs-identifier">elim_superclasses</span></a></a><span> </span><a name="local-1628045725"><a href="#local-1628045725"><span class="hs-identifier">cts</span></a></a><span>
</span><a name="line-1966"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628045727"><a href="#local-1628045727"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045727"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628045726"><span class="hs-identifier hs-var">min_preds</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045725"><span class="hs-identifier hs-var">cts</span></a><span>
</span><a name="line-1967"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1968"></a><span>        </span><a name="local-1628045726"><a href="#local-1628045726"><span class="hs-identifier">min_preds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#mkMinimalBySCs"><span class="hs-identifier hs-var">mkMinimalBySCs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045725"><span class="hs-identifier hs-var">cts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1969"></a><span>
</span><a name="line-1970"></a><span class="hs-identifier">mk_dict_err</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">,</span><span> </span><a href="InstEnv.html#ClsInstLookupResult"><span class="hs-identifier hs-type">ClsInstLookupResult</span></a><span class="hs-special">)</span><span>
</span><a name="line-1971"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1972"></a><span class="hs-comment">-- Report an overlap error if this class constraint results</span><span>
</span><a name="line-1973"></a><span class="hs-comment">-- from an overlap (returning Left clas), otherwise return (Right pred)</span><span>
</span><a name="line-1974"></a><a name="mk_dict_err"><a href="TcErrors.html#mk_dict_err"><span class="hs-identifier">mk_dict_err</span></a></a><span> </span><a name="local-1628045736"><a href="#local-1628045736"><span class="hs-identifier">ctxt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcErrors.html#CEC"><span class="hs-identifier hs-var">CEC</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cec_encl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045737"><a href="#local-1628045737"><span class="hs-identifier">implics</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1628045738"><a href="#local-1628045738"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628045739"><a href="#local-1628045739"><span class="hs-identifier">matches</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045740"><a href="#local-1628045740"><span class="hs-identifier">unifiers</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045741"><a href="#local-1628045741"><span class="hs-identifier">unsafe_overlapped</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1975"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045739"><span class="hs-identifier hs-var">matches</span></a><span>  </span><span class="hs-comment">-- No matches but perhaps several unifiers</span><span>
</span><a name="line-1976"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045800"><a href="#local-1628045800"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045801"><a href="#local-1628045801"><span class="hs-identifier">binds_msg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045802"><a href="#local-1628045802"><span class="hs-identifier">ct</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045736"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628045738"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1977"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045803"><a href="#local-1628045803"><span class="hs-identifier">candidate_insts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045749"><span class="hs-identifier hs-var">get_candidate_instances</span></a><span>
</span><a name="line-1978"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045800"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045751"><span class="hs-identifier hs-var">cannot_resolve_msg</span></a><span> </span><a href="#local-1628045802"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045803"><span class="hs-identifier hs-var">candidate_insts</span></a><span> </span><a href="#local-1628045801"><span class="hs-identifier hs-var">binds_msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1979"></a><span>
</span><a name="line-1980"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045741"><span class="hs-identifier hs-var">unsafe_overlapped</span></a><span>   </span><span class="hs-comment">-- Some matches =&gt; overlap errors</span><span>
</span><a name="line-1981"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045736"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045756"><span class="hs-identifier hs-var">overlap_msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1982"></a><span>
</span><a name="line-1983"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1984"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045736"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045759"><span class="hs-identifier hs-var">safe_haskell_msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1985"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1986"></a><span>    </span><a name="local-1628045742"><a href="#local-1628045742"><span class="hs-identifier">orig</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045738"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1987"></a><span>    </span><a name="local-1628045743"><a href="#local-1628045743"><span class="hs-identifier">pred</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctPred"><span class="hs-identifier hs-var">ctPred</span></a><span> </span><a href="#local-1628045738"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-1988"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045744"><a href="#local-1628045744"><span class="hs-identifier">clas</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045745"><a href="#local-1628045745"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-1989"></a><span>    </span><a name="local-1628045746"><a href="#local-1628045746"><span class="hs-identifier">ispecs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628045760"><span class="hs-identifier hs-var">ispec</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045760"><a href="#local-1628045760"><span class="hs-identifier">ispec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045739"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">]</span><span>
</span><a name="line-1990"></a><span>    </span><a name="local-1628045747"><a href="#local-1628045747"><span class="hs-identifier">unsafe_ispecs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628045761"><span class="hs-identifier hs-var">ispec</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045761"><a href="#local-1628045761"><span class="hs-identifier">ispec</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045741"><span class="hs-identifier hs-var">unsafe_overlapped</span></a><span class="hs-special">]</span><span>
</span><a name="line-1991"></a><span>    </span><a name="local-1628045748"><a href="#local-1628045748"><span class="hs-identifier">useful_givens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#discardProvCtxtGivens"><span class="hs-identifier hs-var">discardProvCtxtGivens</span></a><span> </span><a href="#local-1628045742"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#getUserGivensFromImplics"><span class="hs-identifier hs-var">getUserGivensFromImplics</span></a><span> </span><a href="#local-1628045737"><span class="hs-identifier hs-var">implics</span></a><span class="hs-special">)</span><span>
</span><a name="line-1992"></a><span>         </span><span class="hs-comment">-- useful_givens are the enclosing implications with non-empty givens,</span><span>
</span><a name="line-1993"></a><span>         </span><span class="hs-comment">-- modulo the horrid discardProvCtxtGivens</span><span>
</span><a name="line-1994"></a><span>
</span><a name="line-1995"></a><span>    </span><span class="hs-identifier">get_candidate_instances</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a><span class="hs-special">]</span><span>
</span><a name="line-1996"></a><span>    </span><span class="hs-comment">-- See Note [Report candidate instances]</span><span>
</span><a name="line-1997"></a><span>    </span><a name="local-1628045749"><a href="#local-1628045749"><span class="hs-identifier">get_candidate_instances</span></a></a><span>
</span><a name="line-1998"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-1628045762"><a href="#local-1628045762"><span class="hs-identifier">ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span>   </span><span class="hs-comment">-- Only try for single-parameter classes</span><span>
</span><a name="line-1999"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045763"><a href="#local-1628045763"><span class="hs-identifier">instEnvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcGetInstEnvs"><span class="hs-identifier hs-var">tcGetInstEnvs</span></a><span>
</span><a name="line-2000"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045750"><span class="hs-identifier hs-var">is_candidate_inst</span></a><span> </span><a href="#local-1628045762"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2001"></a><span>                            </span><span class="hs-special">(</span><a href="InstEnv.html#classInstances"><span class="hs-identifier hs-var">classInstances</span></a><span> </span><a href="#local-1628045763"><span class="hs-identifier hs-var">instEnvs</span></a><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2002"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2003"></a><span>
</span><a name="line-2004"></a><span>    </span><a name="local-1628045750"><a href="#local-1628045750"><span class="hs-identifier">is_candidate_inst</span></a></a><span> </span><a name="local-1628045764"><a href="#local-1628045764"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628045765"><a href="#local-1628045765"><span class="hs-identifier">inst</span></a></a><span> </span><span class="hs-comment">-- See Note [Report candidate instances]</span><span>
</span><a name="line-2005"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-1628045766"><a href="#local-1628045766"><span class="hs-identifier">other_ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">is_tys</span><span> </span><a href="#local-1628045765"><span class="hs-identifier hs-var">inst</span></a><span>
</span><a name="line-2006"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045767"><a href="#local-1628045767"><span class="hs-identifier">tc1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045764"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2007"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045768"><a href="#local-1628045768"><span class="hs-identifier">tc2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045766"><span class="hs-identifier hs-var">other_ty</span></a><span>
</span><a name="line-2008"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045769"><a href="#local-1628045769"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628045767"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-2009"></a><span>            </span><a name="local-1628045770"><a href="#local-1628045770"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628045768"><span class="hs-identifier hs-var">tc2</span></a><span>
</span><a name="line-2010"></a><span>            </span><a name="local-1628045771"><a href="#local-1628045771"><span class="hs-identifier">different_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045769"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-1628045770"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-2011"></a><span>            </span><a name="local-1628045772"><a href="#local-1628045772"><span class="hs-identifier">same_occ_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628045769"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628045770"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-2012"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-1628045771"><span class="hs-identifier hs-var">different_names</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045772"><span class="hs-identifier hs-var">same_occ_names</span></a><span>
</span><a name="line-2013"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2014"></a><span>
</span><a name="line-2015"></a><span>    </span><span class="hs-identifier">cannot_resolve_msg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2016"></a><span>    </span><a name="local-1628045751"><a href="#local-1628045751"><span class="hs-identifier">cannot_resolve_msg</span></a></a><span> </span><a name="local-1628045773"><a href="#local-1628045773"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-1628045774"><a href="#local-1628045774"><span class="hs-identifier">candidate_insts</span></a></a><span> </span><a name="local-1628045775"><a href="#local-1628045775"><span class="hs-identifier">binds_msg</span></a></a><span>
</span><a name="line-2017"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628045781"><span class="hs-identifier hs-var">no_inst_msg</span></a><span>
</span><a name="line-2018"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628045753"><span class="hs-identifier hs-var">extra_note</span></a><span>
</span><a name="line-2019"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pp_givens"><span class="hs-identifier hs-var">pp_givens</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span class="hs-special">)</span><span>
</span><a name="line-2020"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-1628045784"><span class="hs-identifier hs-var">mb_patsyn_prov</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2021"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045778"><span class="hs-identifier hs-var">has_ambig_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2022"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><a href="#local-1628045777"><span class="hs-identifier hs-var">lead_with_ambig</span></a><span> </span><a href="#local-1628045779"><span class="hs-identifier hs-var">ambig_msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045775"><span class="hs-identifier hs-var">binds_msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045782"><span class="hs-identifier hs-var">potential_msg</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a><span> </span><a href="#local-1628045784"><span class="hs-identifier hs-var">mb_patsyn_prov</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2025"></a><span>                   </span><span class="hs-comment">-- Don't suggest fixes for the provided context of a pattern</span><span>
</span><a name="line-2026"></a><span>                   </span><span class="hs-comment">-- synonym; the right fix is to bind more in the pattern</span><span>
</span><a name="line-2027"></a><span>               </span><a href="TcErrors.html#show_fixes"><span class="hs-identifier hs-var">show_fixes</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ctxtFixes"><span class="hs-identifier hs-var">ctxtFixes</span></a><span> </span><a href="#local-1628045778"><span class="hs-identifier hs-var">has_ambig_tvs</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span> </span><a href="#local-1628045737"><span class="hs-identifier hs-var">implics</span></a><span>
</span><a name="line-2028"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045754"><span class="hs-identifier hs-var">drv_fixes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2029"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045774"><span class="hs-identifier hs-var">candidate_insts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2030"></a><span>               </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;There are instances for similar types:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2031"></a><span>                   </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045774"><span class="hs-identifier hs-var">candidate_insts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2032"></a><span>                   </span><span class="hs-comment">-- See Note [Report candidate instances]</span><span>
</span><a name="line-2033"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-2034"></a><span>        </span><a name="local-1628045776"><a href="#local-1628045776"><span class="hs-identifier">orig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a><span> </span><a href="#local-1628045773"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2035"></a><span>        </span><span class="hs-comment">-- See Note [Highlighting ambiguous type variables]</span><span>
</span><a name="line-2036"></a><span>        </span><a name="local-1628045777"><a href="#local-1628045777"><span class="hs-identifier">lead_with_ambig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045778"><span class="hs-identifier hs-var">has_ambig_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="TcType.html#isRuntimeUnkSkol"><span class="hs-identifier hs-var">isRuntimeUnkSkol</span></a><span> </span><a href="#local-1628045780"><span class="hs-identifier hs-var">ambig_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2037"></a><span>                        </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span>
</span><a name="line-2038"></a><span>
</span><a name="line-2039"></a><span>        </span><span class="hs-special">(</span><a name="local-1628045778"><a href="#local-1628045778"><span class="hs-identifier">has_ambig_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045779"><a href="#local-1628045779"><span class="hs-identifier">ambig_msg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#mkAmbigMsg"><span class="hs-identifier hs-var">mkAmbigMsg</span></a><span> </span><a href="#local-1628045777"><span class="hs-identifier hs-var">lead_with_ambig</span></a><span> </span><a href="#local-1628045773"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2040"></a><span>        </span><a name="local-1628045780"><a href="#local-1628045780"><span class="hs-identifier">ambig_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcErrors.html#getAmbigTkvs"><span class="hs-identifier hs-var">getAmbigTkvs</span></a><span> </span><a href="#local-1628045773"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-2041"></a><span>
</span><a name="line-2042"></a><span>        </span><a name="local-1628045781"><a href="#local-1628045781"><span class="hs-identifier">no_inst_msg</span></a></a><span>
</span><a name="line-2043"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045777"><span class="hs-identifier hs-var">lead_with_ambig</span></a><span>
</span><a name="line-2044"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045779"><span class="hs-identifier hs-var">ambig_msg</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcErrors.html#pprArising"><span class="hs-identifier hs-var">pprArising</span></a><span> </span><a href="#local-1628045776"><span class="hs-identifier hs-var">orig</span></a><span>
</span><a name="line-2045"></a><span>              </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;prevents the constraint&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>  </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span class="hs-special">)</span><span>
</span><a name="line-2046"></a><span>              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from being solved.&quot;</span><span>
</span><a name="line-2047"></a><span>
</span><a name="line-2048"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span>
</span><a name="line-2049"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045776"><span class="hs-identifier hs-var">orig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;No instance for&quot;</span><span>
</span><a name="line-2050"></a><span>            </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2051"></a><span>
</span><a name="line-2052"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2053"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045776"><span class="hs-identifier hs-var">orig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Could not deduce&quot;</span><span>
</span><a name="line-2054"></a><span>            </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2055"></a><span>
</span><a name="line-2056"></a><span>        </span><a name="local-1628045782"><a href="#local-1628045782"><span class="hs-identifier">potential_msg</span></a></a><span>
</span><a name="line-2057"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045752"><span class="hs-identifier hs-var">want_potential</span></a><span> </span><a href="#local-1628045776"><span class="hs-identifier hs-var">orig</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2058"></a><span>            </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045785"><a href="#local-1628045785"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2059"></a><span>            </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045786"><a href="#local-1628045786"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2060"></a><span>            </span><a href="TcErrors.html#pprPotentials"><span class="hs-identifier hs-var">pprPotentials</span></a><span> </span><a href="#local-1628045785"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045786"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-1628045783"><span class="hs-identifier hs-var">potential_hdr</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span>
</span><a name="line-2061"></a><span>
</span><a name="line-2062"></a><span>        </span><a name="local-1628045783"><a href="#local-1628045783"><span class="hs-identifier">potential_hdr</span></a></a><span>
</span><a name="line-2063"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><a href="#local-1628045777"><span class="hs-identifier hs-var">lead_with_ambig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2064"></a><span>                     </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Probable fix: use a type annotation to specify what&quot;</span><span>
</span><a name="line-2065"></a><span>                     </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628045780"><span class="hs-identifier hs-var">ambig_tvs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;should be.&quot;</span><span>
</span><a name="line-2066"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;These potential instance&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span>
</span><a name="line-2067"></a><span>                   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;exist:&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2068"></a><span>
</span><a name="line-2069"></a><span>        </span><span class="hs-identifier">mb_patsyn_prov</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2070"></a><span>        </span><a name="local-1628045784"><a href="#local-1628045784"><span class="hs-identifier">mb_patsyn_prov</span></a></a><span>
</span><a name="line-2071"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045777"><span class="hs-identifier hs-var">lead_with_ambig</span></a><span>
</span><a name="line-2072"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ProvCtxtOrigin"><span class="hs-identifier hs-var">ProvCtxtOrigin</span></a><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628045787"><a href="#local-1628045787"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045776"><span class="hs-identifier hs-var">orig</span></a><span>
</span><a name="line-2073"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In other words, a successful match on the pattern&quot;</span><span>
</span><a name="line-2074"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045787"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-2075"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;does not provide the constraint&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-1628045743"><span class="hs-identifier hs-var">pred</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2076"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2077"></a><span>
</span><a name="line-2078"></a><span>    </span><span class="hs-comment">-- Report &quot;potential instances&quot; only when the constraint arises</span><span>
</span><a name="line-2079"></a><span>    </span><span class="hs-comment">-- directly from the user's use of an overloaded function</span><span>
</span><a name="line-2080"></a><span>    </span><a name="local-1628045752"><a href="#local-1628045752"><span class="hs-identifier">want_potential</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TypeEqOrigin"><span class="hs-identifier hs-var">TypeEqOrigin</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2081"></a><span>    </span><span class="hs-identifier">want_potential</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2082"></a><span>
</span><a name="line-2083"></a><span>    </span><a name="local-1628045753"><a href="#local-1628045753"><span class="hs-identifier">extra_note</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-2084"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(maybe you haven't applied a function to enough arguments?)&quot;</span><span>
</span><a name="line-2085"></a><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">className</span><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeableClassName"><span class="hs-identifier hs-var">typeableClassName</span></a><span>  </span><span class="hs-comment">-- Avoid mysterious &quot;No instance for (Typeable T)</span><span>
</span><a name="line-2086"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628045788"><a href="#local-1628045788"><span class="hs-identifier">ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span>                        </span><span class="hs-comment">-- Look for (Typeable (k-&gt;*) (T k))</span><span>
</span><a name="line-2087"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045789"><a href="#local-1628045789"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-1628045788"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2088"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a><span> </span><a href="#local-1628045789"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2089"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;GHC can't yet do polykinded&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2090"></a><span>                    </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Typeable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2091"></a><span>                       </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045788"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628045788"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2092"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2093"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2094"></a><span>
</span><a name="line-2095"></a><span>    </span><a name="local-1628045754"><a href="#local-1628045754"><span class="hs-identifier">drv_fixes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045742"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2096"></a><span>                   </span><a href="TcRnTypes.html#DerivOrigin"><span class="hs-identifier hs-var">DerivOrigin</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628045755"><span class="hs-identifier hs-var">drv_fix</span></a><span class="hs-special">]</span><span>
</span><a name="line-2097"></a><span>                   </span><a href="TcRnTypes.html#DerivOriginDC"><span class="hs-identifier hs-var">DerivOriginDC</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628045755"><span class="hs-identifier hs-var">drv_fix</span></a><span class="hs-special">]</span><span>
</span><a name="line-2098"></a><span>                   </span><a href="TcRnTypes.html#DerivOriginCoerce"><span class="hs-identifier hs-var">DerivOriginCoerce</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628045755"><span class="hs-identifier hs-var">drv_fix</span></a><span class="hs-special">]</span><span>
</span><a name="line-2099"></a><span>                   </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2100"></a><span>
</span><a name="line-2101"></a><span>    </span><a name="local-1628045755"><a href="#local-1628045755"><span class="hs-identifier">drv_fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;use a standalone 'deriving instance' declaration,&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2102"></a><span>                 </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;so you can specify the instance context yourself&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2103"></a><span>
</span><a name="line-2104"></a><span>    </span><span class="hs-comment">-- Normal overlap error</span><span>
</span><a name="line-2105"></a><span>    </span><a name="local-1628045756"><a href="#local-1628045756"><span class="hs-identifier">overlap_msg</span></a></a><span>
</span><a name="line-2106"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">matches</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2107"></a><span>        </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span>  </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045742"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Overlapping instances for&quot;</span><span>
</span><a name="line-2108"></a><span>                                </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2109"></a><span>
</span><a name="line-2110"></a><span>             </span><span class="hs-special">,</span><span>  </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045757"><span class="hs-identifier hs-var">matching_givens</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2111"></a><span>                  </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Matching givens (or their superclasses):&quot;</span><span>
</span><a name="line-2112"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-1628045757"><span class="hs-identifier hs-var">matching_givens</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><span>             </span><span class="hs-special">,</span><span>  </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045790"><a href="#local-1628045790"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2115"></a><span>                </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628045791"><a href="#local-1628045791"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2116"></a><span>                </span><a href="TcErrors.html#pprPotentials"><span class="hs-identifier hs-var">pprPotentials</span></a><span> </span><a href="#local-1628045790"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628045791"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Matching instances:&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2117"></a><span>                </span><a href="#local-1628045746"><span class="hs-identifier hs-var">ispecs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span>
</span><a name="line-2118"></a><span>
</span><a name="line-2119"></a><span>             </span><span class="hs-special">,</span><span>  </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045757"><span class="hs-identifier hs-var">matching_givens</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Util.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a><span> </span><a href="#local-1628045739"><span class="hs-identifier hs-var">matches</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045740"><span class="hs-identifier hs-var">unifiers</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2120"></a><span>                </span><span class="hs-comment">-- Intuitively, some given matched the wanted in their</span><span>
</span><a name="line-2121"></a><span>                </span><span class="hs-comment">-- flattened or rewritten (from given equalities) form</span><span>
</span><a name="line-2122"></a><span>                </span><span class="hs-comment">-- but the matcher can't figure that out because the</span><span>
</span><a name="line-2123"></a><span>                </span><span class="hs-comment">-- constraints are non-flat and non-rewritten so we</span><span>
</span><a name="line-2124"></a><span>                </span><span class="hs-comment">-- simply report back the whole given</span><span>
</span><a name="line-2125"></a><span>                </span><span class="hs-comment">-- context. Accelerate Smart.hs showed this problem.</span><span>
</span><a name="line-2126"></a><span>                  </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;There exists a (perhaps superclass) match:&quot;</span><span>
</span><a name="line-2127"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#pp_givens"><span class="hs-identifier hs-var">pp_givens</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2128"></a><span>
</span><a name="line-2129"></a><span>             </span><span class="hs-special">,</span><span>  </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a><span> </span><a href="#local-1628045739"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2130"></a><span>                </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The choice depends on the instantiation of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2131"></a><span>                                  </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypesList"><span class="hs-identifier hs-var">tyCoVarsOfTypesList</span></a><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2132"></a><span>                             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045757"><span class="hs-identifier hs-var">matching_givens</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2133"></a><span>                               </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;To pick the first instance above, use IncoherentInstances&quot;</span><span>
</span><a name="line-2134"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;when compiling the other instance declarations&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2135"></a><span>                        </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2136"></a><span>
</span><a name="line-2137"></a><span>    </span><a name="local-1628045757"><a href="#local-1628045757"><span class="hs-identifier">matching_givens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><a href="#local-1628045758"><span class="hs-identifier hs-var">matchable</span></a><span> </span><a href="#local-1628045748"><span class="hs-identifier hs-var">useful_givens</span></a><span>
</span><a name="line-2138"></a><span>
</span><a name="line-2139"></a><span>    </span><a name="local-1628045758"><a href="#local-1628045758"><span class="hs-identifier">matchable</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045792"><a href="#local-1628045792"><span class="hs-identifier">evvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045793"><a href="#local-1628045793"><span class="hs-identifier">skol_info</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628045794"><a href="#local-1628045794"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2140"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045795"><span class="hs-identifier hs-var">ev_vars_matching</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2141"></a><span>             </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2142"></a><span>             </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span> </span><a href="#local-1628045795"><span class="hs-identifier hs-var">ev_vars_matching</span></a><span class="hs-special">)</span><span>
</span><a name="line-2143"></a><span>                            </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound by&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045793"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-2144"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_loc</span><span> </span><a href="#local-1628045794"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2145"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-1628045795"><a href="#local-1628045795"><span class="hs-identifier">ev_vars_matching</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628045796"><span class="hs-identifier hs-var">ev_var_matches</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1628045792"><span class="hs-identifier hs-var">evvars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2146"></a><span>              </span><a name="local-1628045796"><a href="#local-1628045796"><span class="hs-identifier">ev_var_matches</span></a></a><span> </span><a name="local-1628045797"><a href="#local-1628045797"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span> </span><a href="#local-1628045797"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2147"></a><span>                 </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628045798"><a href="#local-1628045798"><span class="hs-identifier">clas'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045799"><a href="#local-1628045799"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2148"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045798"><span class="hs-identifier hs-var">clas'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span>
</span><a name="line-2149"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Unify.html#tcMatchTys"><span class="hs-identifier hs-var">tcMatchTys</span></a><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-1628045799"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-2150"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2151"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2152"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="#local-1628045796"><span class="hs-identifier hs-var">ev_var_matches</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#immSuperClasses"><span class="hs-identifier hs-var">immSuperClasses</span></a><span> </span><a href="#local-1628045798"><span class="hs-identifier hs-var">clas'</span></a><span> </span><a href="#local-1628045799"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-2153"></a><span>                 </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2154"></a><span>
</span><a name="line-2155"></a><span>    </span><span class="hs-comment">-- Overlap error because of Safe Haskell (first</span><span>
</span><a name="line-2156"></a><span>    </span><span class="hs-comment">-- match should be the most specific match)</span><span>
</span><a name="line-2157"></a><span>    </span><a name="local-1628045759"><a href="#local-1628045759"><span class="hs-identifier">safe_haskell_msg</span></a></a><span>
</span><a name="line-2158"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">matches</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><a href="#local-1628045739"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">unsafe_ispecs</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2159"></a><span>       </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcErrors.html#addArising"><span class="hs-identifier hs-var">addArising</span></a><span> </span><a href="#local-1628045742"><span class="hs-identifier hs-var">orig</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unsafe overlapping instances for&quot;</span><span>
</span><a name="line-2160"></a><span>                       </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a><span> </span><a href="#local-1628045744"><span class="hs-identifier hs-var">clas</span></a><span> </span><a href="#local-1628045745"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2161"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The matching instance is:&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-2162"></a><span>                   </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="InstEnv.html#pprInstance"><span class="hs-identifier hs-var">pprInstance</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628045746"><span class="hs-identifier hs-var">ispecs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2163"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;It is compiled in a Safe module and as such can only&quot;</span><span>
</span><a name="line-2164"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;overlap instances from the same module, however it&quot;</span><span>
</span><a name="line-2165"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;overlaps the following instances from different&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2166"></a><span>                     </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;modules:&quot;</span><span>
</span><a name="line-2167"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="InstEnv.html#pprInstances"><span class="hs-identifier hs-var">pprInstances</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628045747"><span class="hs-identifier hs-var">unsafe_ispecs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2168"></a><span>                   </span><span class="hs-special">]</span><span>
</span><a name="line-2169"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-2170"></a><span>
</span><a name="line-2171"></a><span>
</span><a name="line-2172"></a><span class="hs-identifier">ctxtFixes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span>
</span><a name="line-2173"></a><a name="ctxtFixes"><a href="TcErrors.html#ctxtFixes"><span class="hs-identifier">ctxtFixes</span></a></a><span> </span><a name="local-1628045804"><a href="#local-1628045804"><span class="hs-identifier">has_ambig_tvs</span></a></a><span> </span><a name="local-1628045805"><a href="#local-1628045805"><span class="hs-identifier">pred</span></a></a><span> </span><a name="local-1628045806"><a href="#local-1628045806"><span class="hs-identifier">implics</span></a></a><span>
</span><a name="line-2174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628045804"><span class="hs-identifier hs-var">has_ambig_tvs</span></a><span>
</span><a name="line-2175"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcType.html#isTyVarClassPred"><span class="hs-identifier hs-var">isTyVarClassPred</span></a><span> </span><a href="#local-1628045805"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2176"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628045811"><a href="#local-1628045811"><span class="hs-identifier">skol</span></a></a><span class="hs-glyph">:</span><a name="local-1628045812"><a href="#local-1628045812"><span class="hs-identifier">skols</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#usefulContext"><span class="hs-identifier hs-var">usefulContext</span></a><span> </span><a href="#local-1628045806"><span class="hs-identifier hs-var">implics</span></a><span> </span><a href="#local-1628045805"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2177"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045813"><a href="#local-1628045813"><span class="hs-identifier">what</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045812"><span class="hs-identifier hs-var">skols</span></a><span>
</span><a name="line-2178"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#PatSynCtxt"><span class="hs-identifier hs-var">PatSynCtxt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045811"><span class="hs-identifier hs-var">skol</span></a><span>
</span><a name="line-2179"></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;\&quot;required\&quot;&quot;</span><span>
</span><a name="line-2180"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2181"></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2182"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;add&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-1628045805"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2183"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to the&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045813"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;context of&quot;</span><span>
</span><a name="line-2184"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628045807"><span class="hs-identifier hs-var">ppr_skol</span></a><span> </span><a href="#local-1628045811"><span class="hs-identifier hs-var">skol</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2185"></a><span>                    </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;or&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045807"><span class="hs-identifier hs-var">ppr_skol</span></a><span> </span><a href="#local-1628045814"><span class="hs-identifier hs-var">skol</span></a><span>
</span><a name="line-2186"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a name="local-1628045814"><a href="#local-1628045814"><span class="hs-identifier">skol</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045812"><span class="hs-identifier hs-var">skols</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2187"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2188"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2189"></a><span>    </span><a name="local-1628045807"><a href="#local-1628045807"><span class="hs-identifier">ppr_skol</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PatSkol"><span class="hs-identifier hs-var">PatSkol</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-1628045808"><a href="#local-1628045808"><span class="hs-identifier">dc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the data constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045808"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2190"></a><span>    </span><span class="hs-identifier">ppr_skol</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#PatSkol"><span class="hs-identifier hs-var">PatSkol</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><a name="local-1628045809"><a href="#local-1628045809"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the pattern synonym&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045809"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-2191"></a><span>    </span><span class="hs-identifier">ppr_skol</span><span> </span><a name="local-1628045810"><a href="#local-1628045810"><span class="hs-identifier">skol_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045810"><span class="hs-identifier hs-var">skol_info</span></a><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span class="hs-identifier">discardProvCtxtGivens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcErrors.html#UserGiven"><span class="hs-identifier hs-type">UserGiven</span></a><span class="hs-special">]</span><span>
</span><a name="line-2194"></a><a name="discardProvCtxtGivens"><a href="TcErrors.html#discardProvCtxtGivens"><span class="hs-identifier">discardProvCtxtGivens</span></a></a><span> </span><a name="local-1628045815"><a href="#local-1628045815"><span class="hs-identifier">orig</span></a></a><span> </span><a name="local-1628045816"><a href="#local-1628045816"><span class="hs-identifier">givens</span></a></a><span>  </span><span class="hs-comment">-- See Note [discardProvCtxtGivens]</span><span>
</span><a name="line-2195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#ProvCtxtOrigin"><span class="hs-identifier hs-var">ProvCtxtOrigin</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628045820"><a href="#local-1628045820"><span class="hs-identifier">name</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045815"><span class="hs-identifier hs-var">orig</span></a><span>
</span><a name="line-2196"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045817"><span class="hs-identifier hs-var">discard</span></a><span> </span><a href="#local-1628045820"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045816"><span class="hs-identifier hs-var">givens</span></a><span>
</span><a name="line-2197"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045816"><span class="hs-identifier hs-var">givens</span></a><span>
</span><a name="line-2199"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2200"></a><span>    </span><a name="local-1628045817"><a href="#local-1628045817"><span class="hs-identifier">discard</span></a></a><span> </span><a name="local-1628045818"><a href="#local-1628045818"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Implic"><span class="hs-identifier hs-var">Implic</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#PatSynCtxt"><span class="hs-identifier hs-var">PatSynCtxt</span></a><span> </span><a name="local-1628045819"><a href="#local-1628045819"><span class="hs-identifier">n'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045818"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628045819"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-2201"></a><span>    </span><span class="hs-identifier">discard</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2202"></a><span>
</span><a name="line-2203"></a><span class="hs-identifier">usefulContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span class="hs-special">]</span><span>
</span><a name="line-2204"></a><span class="hs-comment">-- usefulContext picks out the implications whose context</span><span>
</span><a name="line-2205"></a><span class="hs-comment">-- the programmer might plausibly augment to solve 'pred'</span><span>
</span><a name="line-2206"></a><a name="usefulContext"><a href="TcErrors.html#usefulContext"><span class="hs-identifier">usefulContext</span></a></a><span> </span><a name="local-1628045821"><a href="#local-1628045821"><span class="hs-identifier">implics</span></a></a><span> </span><a name="local-1628045822"><a href="#local-1628045822"><span class="hs-identifier">pred</span></a></a><span>
</span><a name="line-2207"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045824"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045821"><span class="hs-identifier hs-var">implics</span></a><span>
</span><a name="line-2208"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2209"></a><span>    </span><a name="local-1628045823"><a href="#local-1628045823"><span class="hs-identifier">pred_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045822"><span class="hs-identifier hs-var">pred</span></a><span>
</span><a name="line-2210"></a><span>    </span><a name="local-1628045824"><a href="#local-1628045824"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2211"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1628045827"><a href="#local-1628045827"><span class="hs-identifier">ic</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628045828"><a href="#local-1628045828"><span class="hs-identifier">ics</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2212"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045825"><span class="hs-identifier hs-var">implausible</span></a><span> </span><a href="#local-1628045827"><span class="hs-identifier hs-var">ic</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045829"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-2213"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><a href="#local-1628045827"><span class="hs-identifier hs-var">ic</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628045829"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-2214"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-2215"></a><span>          </span><span class="hs-comment">-- Stop when the context binds a variable free in the predicate</span><span>
</span><a name="line-2216"></a><span>          </span><a name="local-1628045829"><a href="#local-1628045829"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045823"><span class="hs-identifier hs-var">pred_tvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_skols</span><span> </span><a href="#local-1628045827"><span class="hs-identifier hs-var">ic</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2217"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                                 </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045824"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045828"><span class="hs-identifier hs-var">ics</span></a><span>
</span><a name="line-2218"></a><span>
</span><a name="line-2219"></a><span>    </span><a name="local-1628045825"><a href="#local-1628045825"><span class="hs-identifier">implausible</span></a></a><span> </span><a name="local-1628045830"><a href="#local-1628045830"><span class="hs-identifier">ic</span></a></a><span>
</span><a name="line-2220"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_skols</span><span> </span><a href="#local-1628045830"><span class="hs-identifier hs-var">ic</span></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2221"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045826"><span class="hs-identifier hs-var">implausible_info</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ic_info</span><span> </span><a href="#local-1628045830"><span class="hs-identifier hs-var">ic</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2222"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2223"></a><span>
</span><a name="line-2224"></a><span>    </span><a name="local-1628045826"><a href="#local-1628045826"><span class="hs-identifier">implausible_info</span></a></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#InfSigCtxt"><span class="hs-identifier hs-var">InfSigCtxt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2225"></a><span>    </span><span class="hs-identifier">implausible_info</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2226"></a><span>    </span><span class="hs-comment">-- Do not suggest adding constraints to an *inferred* type signature</span><span>
</span><a name="line-2227"></a><span>
</span><a name="line-2228"></a><span class="hs-comment">{- Note [Report candidate instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we have an unsolved (Num Int), where `Int` is not the Prelude Int,
but comes from some other module, then it may be helpful to point out
that there are some similarly named instances elsewhere.  So we get
something like
    No instance for (Num Int) arising from the literal &#8216;3&#8217;
    There are instances for similar types:
      instance Num GHC.Types.Int -- Defined in &#8216;GHC.Num&#8217;
Discussion in Trac #9611.

Note [Highlighting ambiguous type variables]
~-------------------------------------------
When we encounter ambiguous type variables (i.e. type variables
that remain metavariables after type inference), we need a few more
conditions before we can reason that *ambiguity* prevents constraints
from being solved:
  - We can't have any givens, as encountering a typeclass error
    with given constraints just means we couldn't deduce
    a solution satisfying those constraints and as such couldn't
    bind the type variable to a known type.
  - If we don't have any unifiers, we don't even have potential
    instances from which an ambiguity could arise.
  - Lastly, I don't want to mess with error reporting for
    unknown runtime types so we just fall back to the old message there.
Once these conditions are satisfied, we can safely say that ambiguity prevents
the constraint from being solved.

Note [discardProvCtxtGivens]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
In most situations we call all enclosing implications &quot;useful&quot;. There is one
exception, and that is when the constraint that causes the error is from the
&quot;provided&quot; context of a pattern synonym declaration:

  pattern Pat :: (Num a, Eq a) =&gt; Show a   =&gt; a -&gt; Maybe a
             --  required      =&gt; provided =&gt; type
  pattern Pat x &lt;- (Just x, 4)

When checking the pattern RHS we must check that it does actually bind all
the claimed &quot;provided&quot; constraints; in this case, does the pattern (Just x, 4)
bind the (Show a) constraint.  Answer: no!

But the implication we generate for this will look like
   forall a. (Num a, Eq a) =&gt; [W] Show a
because when checking the pattern we must make the required
constraints available, since they are needed to match the pattern (in
this case the literal '4' needs (Num a, Eq a)).

BUT we don't want to suggest adding (Show a) to the &quot;required&quot; constraints
of the pattern synonym, thus:
  pattern Pat :: (Num a, Eq a, Show a) =&gt; Show a =&gt; a -&gt; Maybe a
It would then typecheck but it's silly.  We want the /pattern/ to bind
the alleged &quot;provided&quot; constraints, Show a.

So we suppress that Implication in discardProvCtxtGivens.  It's
painfully ad-hoc but the truth is that adding it to the &quot;required&quot;
constraints would work.  Suprressing it solves two problems.  First,
we never tell the user that we could not deduce a &quot;provided&quot;
constraint from the &quot;required&quot; context. Second, we never give a
possible fix that suggests to add a &quot;provided&quot; constraint to the
&quot;required&quot; context.

For example, without this distinction the above code gives a bad error
message (showing both problems):

  error: Could not deduce (Show a) ... from the context: (Eq a)
         ... Possible fix: add (Show a) to the context of
         the signature for pattern synonym `Pat' ...

-}</span><span>
</span><a name="line-2298"></a><span>
</span><a name="line-2299"></a><span class="hs-identifier">show_fixes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2300"></a><a name="show_fixes"><a href="TcErrors.html#show_fixes"><span class="hs-identifier">show_fixes</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2301"></a><span class="hs-identifier">show_fixes</span><span> </span><span class="hs-special">(</span><a name="local-1628045831"><a href="#local-1628045831"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-1628045832"><a href="#local-1628045832"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Possible fix:&quot;</span><span>
</span><a name="line-2302"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045831"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;or&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045832"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2303"></a><span>
</span><a name="line-2304"></a><span class="hs-identifier">pprPotentials</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2305"></a><span class="hs-comment">-- See Note [Displaying potential instances]</span><span>
</span><a name="line-2306"></a><a name="pprPotentials"><a href="TcErrors.html#pprPotentials"><span class="hs-identifier">pprPotentials</span></a></a><span> </span><a name="local-1628045833"><a href="#local-1628045833"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628045834"><a href="#local-1628045834"><span class="hs-identifier">sty</span></a></a><span> </span><a name="local-1628045835"><a href="#local-1628045835"><span class="hs-identifier">herald</span></a></a><span> </span><a name="local-1628045836"><a href="#local-1628045836"><span class="hs-identifier">insts</span></a></a><span>
</span><a name="line-2307"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045836"><span class="hs-identifier hs-var">insts</span></a><span>
</span><a name="line-2308"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2309"></a><span>
</span><a name="line-2310"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045842"><span class="hs-identifier hs-var">show_these</span></a><span>
</span><a name="line-2311"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-1628045835"><span class="hs-identifier hs-var">herald</span></a><span>
</span><a name="line-2312"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628045847"><span class="hs-identifier hs-var">not_in_scope_msg</span></a><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2313"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="#local-1628045848"><span class="hs-identifier hs-var">flag_hint</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2314"></a><span>
</span><a name="line-2315"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2316"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-1628045835"><span class="hs-identifier hs-var">herald</span></a><span>
</span><a name="line-2317"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="InstEnv.html#pprInstances"><span class="hs-identifier hs-var">pprInstances</span></a><span> </span><a href="#local-1628045842"><span class="hs-identifier hs-var">show_these</span></a><span>
</span><a name="line-2318"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045843"><span class="hs-identifier hs-var">n_in_scope_hidden</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2319"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;...plus&quot;</span><span>
</span><a name="line-2320"></a><span>                   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakNOf"><span class="hs-identifier hs-var">speakNOf</span></a><span> </span><a href="#local-1628045843"><span class="hs-identifier hs-var">n_in_scope_hidden</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;other&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2321"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="#local-1628045847"><span class="hs-identifier hs-var">not_in_scope_msg</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;...plus&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2322"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="#local-1628045848"><span class="hs-identifier hs-var">flag_hint</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2323"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2324"></a><span>    </span><a name="local-1628045837"><a href="#local-1628045837"><span class="hs-identifier">n_show</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2325"></a><span>    </span><a name="local-1628045838"><a href="#local-1628045838"><span class="hs-identifier">show_potentials</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintPotentialInstances"><span class="hs-identifier hs-var">Opt_PrintPotentialInstances</span></a><span> </span><a href="#local-1628045833"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2326"></a><span>
</span><a name="line-2327"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045839"><a href="#local-1628045839"><span class="hs-identifier">in_scope</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045840"><a href="#local-1628045840"><span class="hs-identifier">not_in_scope</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-1628045844"><span class="hs-identifier hs-var">inst_in_scope</span></a><span> </span><a href="#local-1628045836"><span class="hs-identifier hs-var">insts</span></a><span>
</span><a name="line-2328"></a><span>    </span><a name="local-1628045841"><a href="#local-1628045841"><span class="hs-identifier">sorted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span> </span><a href="InstEnv.html#fuzzyClsInstCmp"><span class="hs-identifier hs-var">fuzzyClsInstCmp</span></a><span> </span><a href="#local-1628045839"><span class="hs-identifier hs-var">in_scope</span></a><span>
</span><a name="line-2329"></a><span>    </span><a name="local-1628045842"><a href="#local-1628045842"><span class="hs-identifier">show_these</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045838"><span class="hs-identifier hs-var">show_potentials</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045841"><span class="hs-identifier hs-var">sorted</span></a><span>
</span><a name="line-2330"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628045837"><span class="hs-identifier hs-var">n_show</span></a><span> </span><a href="#local-1628045841"><span class="hs-identifier hs-var">sorted</span></a><span>
</span><a name="line-2331"></a><span>    </span><a name="local-1628045843"><a href="#local-1628045843"><span class="hs-identifier">n_in_scope_hidden</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045841"><span class="hs-identifier hs-var">sorted</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045842"><span class="hs-identifier hs-var">show_these</span></a><span>
</span><a name="line-2332"></a><span>
</span><a name="line-2333"></a><span>       </span><span class="hs-comment">-- &quot;in scope&quot; means that all the type constructors</span><span>
</span><a name="line-2334"></a><span>       </span><span class="hs-comment">-- are lexically in scope; these instances are likely</span><span>
</span><a name="line-2335"></a><span>       </span><span class="hs-comment">-- to be more useful</span><span>
</span><a name="line-2336"></a><span>    </span><span class="hs-identifier">inst_in_scope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2337"></a><span>    </span><a name="local-1628045844"><a href="#local-1628045844"><span class="hs-identifier">inst_in_scope</span></a></a><span> </span><a name="local-1628045849"><a href="#local-1628045849"><span class="hs-identifier">cls_inst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#foldNameSet"><span class="hs-identifier hs-var">foldNameSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1628045845"><span class="hs-identifier hs-var">name_in_scope</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2338"></a><span>                             </span><a href="CoreFVs.html#orphNamesOfTypes"><span class="hs-identifier hs-var">orphNamesOfTypes</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">is_tys</span><span> </span><a href="#local-1628045849"><span class="hs-identifier hs-var">cls_inst</span></a><span class="hs-special">)</span><span>
</span><a name="line-2339"></a><span>
</span><a name="line-2340"></a><span>    </span><a name="local-1628045845"><a href="#local-1628045845"><span class="hs-identifier">name_in_scope</span></a></a><span> </span><a name="local-1628045850"><a href="#local-1628045850"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-2341"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isBuiltInSyntax"><span class="hs-identifier hs-var">isBuiltInSyntax</span></a><span> </span><a href="#local-1628045850"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2342"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- E.g. (-&gt;)</span><span>
</span><a name="line-2343"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045851"><a href="#local-1628045851"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-1628045850"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2344"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045846"><span class="hs-identifier hs-var">qual_in_scope</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#qualName"><span class="hs-identifier hs-var">qualName</span></a><span> </span><a href="#local-1628045834"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-1628045851"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628045850"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2345"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2346"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2347"></a><span>
</span><a name="line-2348"></a><span>    </span><span class="hs-identifier">qual_in_scope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#QualifyName"><span class="hs-identifier hs-type">QualifyName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2349"></a><span>    </span><a name="local-1628045846"><a href="#local-1628045846"><span class="hs-identifier">qual_in_scope</span></a></a><span> </span><a href="Outputable.html#NameUnqual"><span class="hs-identifier hs-var">NameUnqual</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2350"></a><span>    </span><span class="hs-identifier">qual_in_scope</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#NameQual"><span class="hs-identifier hs-var">NameQual</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2351"></a><span>    </span><span class="hs-identifier">qual_in_scope</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2352"></a><span>
</span><a name="line-2353"></a><span>    </span><a name="local-1628045847"><a href="#local-1628045847"><span class="hs-identifier">not_in_scope_msg</span></a></a><span> </span><a name="local-1628045852"><a href="#local-1628045852"><span class="hs-identifier">herald</span></a></a><span>
</span><a name="line-2354"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045840"><span class="hs-identifier hs-var">not_in_scope</span></a><span>
</span><a name="line-2355"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2356"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2357"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045852"><span class="hs-identifier hs-var">herald</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakNOf"><span class="hs-identifier hs-var">speakNOf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045840"><span class="hs-identifier hs-var">not_in_scope</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;instance&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2358"></a><span>                     </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;involving out-of-scope types&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2359"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><a href="#local-1628045838"><span class="hs-identifier hs-var">show_potentials</span></a><span> </span><span class="hs-special">(</span><a href="InstEnv.html#pprInstances"><span class="hs-identifier hs-var">pprInstances</span></a><span> </span><a href="#local-1628045840"><span class="hs-identifier hs-var">not_in_scope</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2360"></a><span>
</span><a name="line-2361"></a><span>    </span><a name="local-1628045848"><a href="#local-1628045848"><span class="hs-identifier">flag_hint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045838"><span class="hs-identifier hs-var">show_potentials</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045842"><span class="hs-identifier hs-var">show_these</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628045836"><span class="hs-identifier hs-var">insts</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2362"></a><span>                </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(use -fprint-potential-instances to see them all)&quot;</span><span>
</span><a name="line-2363"></a><span>
</span><a name="line-2364"></a><span class="hs-comment">{- Note [Displaying potential instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When showing a list of instances for
  - overlapping instances (show ones that match)
  - no such instance (show ones that could match)
we want to give it a bit of structure.  Here's the plan

* Say that an instance is &quot;in scope&quot; if all of the
  type constructors it mentions are lexically in scope.
  These are the ones most likely to be useful to the programmer.

* Show at most n_show in-scope instances,
  and summarise the rest (&quot;plus 3 others&quot;)

* Summarise the not-in-scope instances (&quot;plus 4 not in scope&quot;)

* Add the flag -fshow-potential-instances which replaces the
  summary with the full list
-}</span><span>
</span><a name="line-2383"></a><span>
</span><a name="line-2384"></a><span class="hs-comment">{-
Note [Flattening in error message generation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider (C (Maybe (F x))), where F is a type function, and we have
instances
                C (Maybe Int) and C (Maybe a)
Since (F x) might turn into Int, this is an overlap situation, and
indeed (because of flattening) the main solver will have refrained
from solving.  But by the time we get to error message generation, we've
un-flattened the constraint.  So we must *re*-flatten it before looking
up in the instance environment, lest we only report one matching
instance when in fact there are two.

Re-flattening is pretty easy, because we don't need to keep track of
evidence.  We don't re-use the code in TcCanonical because that's in
the TcS monad, and we are in TcM here.

Note [Suggest -fprint-explicit-kinds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It can be terribly confusing to get an error message like (Trac #9171)
    Couldn't match expected type &#8216;GetParam Base (GetParam Base Int)&#8217;
                with actual type &#8216;GetParam Base (GetParam Base Int)&#8217;
The reason may be that the kinds don't match up.  Typically you'll get
more useful information, but not when it's as a result of ambiguity.
This test suggests -fprint-explicit-kinds when all the ambiguous type
variables are kind variables.
-}</span><span>
</span><a name="line-2411"></a><span>
</span><a name="line-2412"></a><span class="hs-identifier">mkAmbigMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- True when message has to be at beginning of sentence</span><span>
</span><a name="line-2413"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2414"></a><a name="mkAmbigMsg"><a href="TcErrors.html#mkAmbigMsg"><span class="hs-identifier">mkAmbigMsg</span></a></a><span> </span><a name="local-1628045853"><a href="#local-1628045853"><span class="hs-identifier">prepend_msg</span></a></a><span> </span><a name="local-1628045854"><a href="#local-1628045854"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-2415"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045855"><span class="hs-identifier hs-var">ambig_kvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2416"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><a href="#local-1628045857"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-2417"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2418"></a><span>    </span><span class="hs-special">(</span><a name="local-1628045855"><a href="#local-1628045855"><span class="hs-identifier">ambig_kvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045856"><a href="#local-1628045856"><span class="hs-identifier">ambig_tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#getAmbigTkvs"><span class="hs-identifier hs-var">getAmbigTkvs</span></a><span> </span><a href="#local-1628045854"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2419"></a><span>
</span><a name="line-2420"></a><span>    </span><a name="local-1628045857"><a href="#local-1628045857"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">|</span><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="TcType.html#isRuntimeUnkSkol"><span class="hs-identifier hs-var">isRuntimeUnkSkol</span></a><span> </span><a href="#local-1628045855"><span class="hs-identifier hs-var">ambig_kvs</span></a><span>  </span><span class="hs-comment">-- See Note [Runtime skolems]</span><span>
</span><a name="line-2421"></a><span>        </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><a href="TcType.html#isRuntimeUnkSkol"><span class="hs-identifier hs-var">isRuntimeUnkSkol</span></a><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span>
</span><a name="line-2422"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Cannot resolve unknown runtime type&quot;</span><span>
</span><a name="line-2423"></a><span>                 </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span>
</span><a name="line-2424"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use :print or :force to determine these types&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2425"></a><span>
</span><a name="line-2426"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2427"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045858"><span class="hs-identifier hs-var">pp_ambig</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628045856"><span class="hs-identifier hs-var">ambig_tvs</span></a><span>
</span><a name="line-2428"></a><span>
</span><a name="line-2429"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- All ambiguous kind variabes; suggest -fprint-explicit-kinds</span><span>
</span><a name="line-2430"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628045858"><span class="hs-identifier hs-var">pp_ambig</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628045855"><span class="hs-identifier hs-var">ambig_kvs</span></a><span>
</span><a name="line-2431"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><a href="#local-1628045860"><span class="hs-identifier hs-var">suggest_explicit_kinds</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2432"></a><span>
</span><a name="line-2433"></a><span>    </span><a name="local-1628045858"><a href="#local-1628045858"><span class="hs-identifier">pp_ambig</span></a></a><span> </span><a name="local-1628045861"><a href="#local-1628045861"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628045862"><a href="#local-1628045862"><span class="hs-identifier">tkvs</span></a></a><span>
</span><a name="line-2434"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628045853"><span class="hs-identifier hs-var">prepend_msg</span></a><span> </span><span class="hs-comment">-- &quot;Ambiguous type variable 't0'&quot;</span><span>
</span><a name="line-2435"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Ambiguous&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045861"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variable&quot;</span><span>
</span><a name="line-2436"></a><span>        </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045862"><span class="hs-identifier hs-var">tkvs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628045862"><span class="hs-identifier hs-var">tkvs</span></a><span>
</span><a name="line-2437"></a><span>
</span><a name="line-2438"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-comment">-- &quot;The type variable 't0' is ambiguous&quot;</span><span>
</span><a name="line-2439"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045861"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;variable&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045862"><span class="hs-identifier hs-var">tkvs</span></a><span>
</span><a name="line-2440"></a><span>        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628045862"><span class="hs-identifier hs-var">tkvs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628045859"><span class="hs-identifier hs-var">is_or_are</span></a><span> </span><a href="#local-1628045862"><span class="hs-identifier hs-var">tkvs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ambiguous&quot;</span><span>
</span><a name="line-2441"></a><span>
</span><a name="line-2442"></a><span>    </span><a name="local-1628045859"><a href="#local-1628045859"><span class="hs-identifier">is_or_are</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is&quot;</span><span>
</span><a name="line-2443"></a><span>    </span><span class="hs-identifier">is_or_are</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;are&quot;</span><span>
</span><a name="line-2444"></a><span>
</span><a name="line-2445"></a><span>    </span><a name="local-1628045860"><a href="#local-1628045860"><span class="hs-identifier">suggest_explicit_kinds</span></a></a><span> </span><a name="local-1628045863"><a href="#local-1628045863"><span class="hs-identifier">dflags</span></a></a><span>  </span><span class="hs-comment">-- See Note [Suggest -fprint-explicit-kinds]</span><span>
</span><a name="line-2446"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintExplicitKinds"><span class="hs-identifier hs-var">Opt_PrintExplicitKinds</span></a><span> </span><a href="#local-1628045863"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2447"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use -fprint-explicit-kinds to see the kind arguments&quot;</span><span>
</span><a name="line-2448"></a><span>
</span><a name="line-2449"></a><span class="hs-identifier">pprSkol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2450"></a><a name="pprSkol"><a href="TcErrors.html#pprSkol"><span class="hs-identifier">pprSkol</span></a></a><span> </span><a name="local-1628045864"><a href="#local-1628045864"><span class="hs-identifier">implics</span></a></a><span> </span><a name="local-1628045865"><a href="#local-1628045865"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-2451"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628045869"><a href="#local-1628045869"><span class="hs-identifier">skol_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045870"><a href="#local-1628045870"><span class="hs-identifier">skol_info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcErrors.html#getSkolemInfo"><span class="hs-identifier hs-var">getSkolemInfo</span></a><span> </span><a href="#local-1628045864"><span class="hs-identifier hs-var">implics</span></a><span> </span><a href="#local-1628045865"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-2452"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045870"><span class="hs-identifier hs-var">skol_info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2453"></a><span>      </span><a href="TcRnTypes.html#UnkSkol"><span class="hs-identifier hs-var">UnkSkol</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045866"><span class="hs-identifier hs-var">pp_tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is an unknown type variable&quot;</span><span>
</span><a name="line-2454"></a><span>      </span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><a name="local-1628045871"><a href="#local-1628045871"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045872"><a href="#local-1628045872"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045867"><span class="hs-identifier hs-var">ppr_rigid</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprSigSkolInfo"><span class="hs-identifier hs-var">pprSigSkolInfo</span></a><span> </span><a href="#local-1628045871"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-2455"></a><span>                                      </span><span class="hs-special">(</span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span> </span><a href="#local-1628045869"><span class="hs-identifier hs-var">skol_tvs</span></a><span> </span><a href="#local-1628045872"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2456"></a><span>      </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045867"><span class="hs-identifier hs-var">ppr_rigid</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#pprSkolInfo"><span class="hs-identifier hs-var">pprSkolInfo</span></a><span> </span><a href="#local-1628045870"><span class="hs-identifier hs-var">skol_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-2457"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2458"></a><span>    </span><a name="local-1628045866"><a href="#local-1628045866"><span class="hs-identifier">pp_tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045865"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2459"></a><span>    </span><a name="local-1628045867"><a href="#local-1628045867"><span class="hs-identifier">ppr_rigid</span></a></a><span> </span><a name="local-1628045868"><a href="#local-1628045868"><span class="hs-identifier">pp_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045866"><span class="hs-identifier hs-var">pp_tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is a rigid type variable bound by&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2460"></a><span>                           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628045868"><span class="hs-identifier hs-var">pp_info</span></a><span>
</span><a name="line-2461"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span> </span><a href="#local-1628045865"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2462"></a><span>
</span><a name="line-2463"></a><span class="hs-identifier">getAmbigTkvs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2464"></a><a name="getAmbigTkvs"><a href="TcErrors.html#getAmbigTkvs"><span class="hs-identifier">getAmbigTkvs</span></a></a><span> </span><a name="local-1628045873"><a href="#local-1628045873"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-2465"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045876"><span class="hs-identifier hs-var">dep_tkv_set</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045877"><span class="hs-identifier hs-var">ambig_tkvs</span></a><span>
</span><a name="line-2466"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2467"></a><span>    </span><a name="local-1628045874"><a href="#local-1628045874"><span class="hs-identifier">tkv_set</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfCt"><span class="hs-identifier hs-var">tyCoVarsOfCt</span></a><span> </span><a href="#local-1628045873"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2468"></a><span>    </span><a name="local-1628045875"><a href="#local-1628045875"><span class="hs-identifier">ambig_tkv_set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#filterVarSet"><span class="hs-identifier hs-var">filterVarSet</span></a><span> </span><a href="TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-var">isAmbiguousTyVar</span></a><span> </span><a href="#local-1628045874"><span class="hs-identifier hs-var">tkv_set</span></a><span>
</span><a name="line-2469"></a><span>    </span><a name="local-1628045876"><a href="#local-1628045876"><span class="hs-identifier">dep_tkv_set</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="#local-1628045874"><span class="hs-identifier hs-var">tkv_set</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2470"></a><span>    </span><a name="local-1628045877"><a href="#local-1628045877"><span class="hs-identifier">ambig_tkvs</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="#local-1628045875"><span class="hs-identifier hs-var">ambig_tkv_set</span></a><span>
</span><a name="line-2471"></a><span>
</span><a name="line-2472"></a><span class="hs-identifier">getSkolemInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Implication"><span class="hs-identifier hs-type">Implication</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a><span class="hs-special">)</span><span>
</span><a name="line-2473"></a><span class="hs-comment">-- Get the skolem info for a type variable</span><span>
</span><a name="line-2474"></a><span class="hs-comment">-- from the implication constraint that binds it</span><span>
</span><a name="line-2475"></a><a name="getSkolemInfo"><a href="TcErrors.html#getSkolemInfo"><span class="hs-identifier">getSkolemInfo</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628045878"><a href="#local-1628045878"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-2476"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;No skolem info:&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045878"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2477"></a><span>
</span><a name="line-2478"></a><span class="hs-identifier">getSkolemInfo</span><span> </span><span class="hs-special">(</span><a name="local-1628045879"><a href="#local-1628045879"><span class="hs-identifier">implic</span></a></a><span class="hs-glyph">:</span><a name="local-1628045880"><a href="#local-1628045880"><span class="hs-identifier">implics</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628045881"><a href="#local-1628045881"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-2479"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045882"><a href="#local-1628045882"><span class="hs-identifier">skols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><a href="#local-1628045879"><span class="hs-identifier hs-var">implic</span></a><span>
</span><a name="line-2480"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1628045881"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">ic_skols</span><span> </span><a href="#local-1628045879"><span class="hs-identifier hs-var">implic</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628045882"><span class="hs-identifier hs-var">skols</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ic_info</span><span> </span><a href="#local-1628045879"><span class="hs-identifier hs-var">implic</span></a><span class="hs-special">)</span><span>
</span><a name="line-2481"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#getSkolemInfo"><span class="hs-identifier hs-var">getSkolemInfo</span></a><span> </span><a href="#local-1628045880"><span class="hs-identifier hs-var">implics</span></a><span> </span><a href="#local-1628045881"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-2482"></a><span>
</span><a name="line-2483"></a><span class="hs-comment">-----------------------</span><span>
</span><a name="line-2484"></a><span class="hs-comment">-- relevantBindings looks at the value environment and finds values whose</span><span>
</span><a name="line-2485"></a><span class="hs-comment">-- types mention any of the offending type variables.  It has to be</span><span>
</span><a name="line-2486"></a><span class="hs-comment">-- careful to zonk the Id's type first, so it has to be in the monad.</span><span>
</span><a name="line-2487"></a><span class="hs-comment">-- We must be careful to pass it a zonked type variable, too.</span><span>
</span><a name="line-2488"></a><span class="hs-comment">--</span><span>
</span><a name="line-2489"></a><span class="hs-comment">-- We always remove closed top-level bindings, though,</span><span>
</span><a name="line-2490"></a><span class="hs-comment">-- since they are never relevant (cf Trac #8233)</span><span>
</span><a name="line-2491"></a><span>
</span><a name="line-2492"></a><span class="hs-identifier">relevantBindings</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- True &lt;=&gt; filter by tyvar; False &lt;=&gt; no filtering</span><span>
</span><a name="line-2493"></a><span>                          </span><span class="hs-comment">-- See Trac #8191</span><span>
</span><a name="line-2494"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span>
</span><a name="line-2495"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcErrors.html#ReportErrCtxt"><span class="hs-identifier hs-type">ReportErrCtxt</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">)</span><span>
</span><a name="line-2496"></a><span class="hs-comment">-- Also returns the zonked and tidied CtOrigin of the constraint</span><span>
</span><a name="line-2497"></a><a name="relevantBindings"><a href="TcErrors.html#relevantBindings"><span class="hs-identifier">relevantBindings</span></a></a><span> </span><a name="local-1628045883"><a href="#local-1628045883"><span class="hs-identifier">want_filtering</span></a></a><span> </span><a name="local-1628045884"><a href="#local-1628045884"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628045885"><a href="#local-1628045885"><span class="hs-identifier">ct</span></a></a><span>
</span><a name="line-2498"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045922"><a href="#local-1628045922"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-2499"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628045923"><a href="#local-1628045923"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045924"><a href="#local-1628045924"><span class="hs-identifier">tidy_orig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTidyOrigin"><span class="hs-identifier hs-var">zonkTidyOrigin</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cec_tidy</span><span> </span><a href="#local-1628045884"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1628045887"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2500"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045925"><a href="#local-1628045925"><span class="hs-identifier">ct_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#tyCoVarsOfCt"><span class="hs-identifier hs-var">tyCoVarsOfCt</span></a><span> </span><a href="#local-1628045885"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045926"><span class="hs-identifier hs-var">extra_tvs</span></a><span>
</span><a name="line-2501"></a><span>
</span><a name="line-2502"></a><span>             </span><span class="hs-comment">-- For *kind* errors, report the relevant bindings of the</span><span>
</span><a name="line-2503"></a><span>             </span><span class="hs-comment">-- enclosing *type* equality, because that's more useful for the programmer</span><span>
</span><a name="line-2504"></a><span>             </span><a name="local-1628045926"><a href="#local-1628045926"><span class="hs-identifier">extra_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045924"><span class="hs-identifier hs-var">tidy_orig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2505"></a><span>                             </span><a href="TcRnTypes.html#KindEqOrigin"><span class="hs-identifier hs-var">KindEqOrigin</span></a><span> </span><a name="local-1628045927"><a href="#local-1628045927"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628045928"><a href="#local-1628045928"><span class="hs-identifier">m_t2</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2506"></a><span>                                                         </span><a href="#local-1628045927"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybeToList"><span class="hs-identifier hs-var">maybeToList</span></a><span> </span><a href="#local-1628045928"><span class="hs-identifier hs-var">m_t2</span></a><span>
</span><a name="line-2507"></a><span>                             </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-2508"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;relevantBindings&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2509"></a><span>           </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045885"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2510"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#pprCtOrigin"><span class="hs-identifier hs-var">pprCtOrigin</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a><span> </span><a href="#local-1628045887"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2511"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045925"><span class="hs-identifier hs-var">ct_tvs</span></a><span>
</span><a name="line-2512"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045929"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628045929"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-2513"></a><span>                                   </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#TcIdBndr"><span class="hs-identifier hs-var">TcIdBndr</span></a><span> </span><a name="local-1628045929"><a href="#local-1628045929"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">tcl_bndrs</span><span> </span><a href="#local-1628045888"><span class="hs-identifier hs-var">lcl_env</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2514"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-2515"></a><span>                    </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045930"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-var">TcIdBndr_ExpType</span></a><span> </span><a name="local-1628045930"><a href="#local-1628045930"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">tcl_bndrs</span><span> </span><a href="#local-1628045888"><span class="hs-identifier hs-var">lcl_env</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2516"></a><span>
</span><a name="line-2517"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628045931"><a href="#local-1628045931"><span class="hs-identifier">tidy_env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045932"><a href="#local-1628045932"><span class="hs-identifier">docs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045933"><a href="#local-1628045933"><span class="hs-identifier">discards</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2518"></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628045891"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045923"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628045925"><span class="hs-identifier hs-var">ct_tvs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxRelevantBinds</span><span> </span><a href="#local-1628045922"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2519"></a><span>                    </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2520"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">tcl_bndrs</span><span> </span><a href="#local-1628045888"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-2521"></a><span>         </span><span class="hs-comment">-- tcl_bndrs has the innermost bindings first,</span><span>
</span><a name="line-2522"></a><span>         </span><span class="hs-comment">-- which are probably the most relevant ones</span><span>
</span><a name="line-2523"></a><span>
</span><a name="line-2524"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045934"><a href="#local-1628045934"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628045932"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2525"></a><span>                   </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Relevant bindings include&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2526"></a><span>                      </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-1628045932"><span class="hs-identifier hs-var">docs</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a><span> </span><a href="#local-1628045933"><span class="hs-identifier hs-var">discards</span></a><span> </span><a href="TcErrors.html#discardMsg"><span class="hs-identifier hs-var">discardMsg</span></a><span class="hs-special">)</span><span>
</span><a name="line-2527"></a><span>
</span><a name="line-2528"></a><span>             </span><span class="hs-comment">-- Put a zonked, tidied CtOrigin into the Ct</span><span>
</span><a name="line-2529"></a><span>             </span><a name="local-1628045935"><a href="#local-1628045935"><span class="hs-identifier">loc'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#setCtLocOrigin"><span class="hs-identifier hs-var">setCtLocOrigin</span></a><span> </span><a href="#local-1628045887"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628045924"><span class="hs-identifier hs-var">tidy_orig</span></a><span>
</span><a name="line-2530"></a><span>             </span><a name="local-1628045936"><a href="#local-1628045936"><span class="hs-identifier">ct'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#setCtLoc"><span class="hs-identifier hs-var">setCtLoc</span></a><span> </span><a href="#local-1628045885"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-1628045935"><span class="hs-identifier hs-var">loc'</span></a><span>
</span><a name="line-2531"></a><span>             </span><a name="local-1628045937"><a href="#local-1628045937"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045884"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cec_tidy</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045931"><span class="hs-identifier hs-var">tidy_env'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2532"></a><span>
</span><a name="line-2533"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045937"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045934"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045936"><span class="hs-identifier hs-var">ct'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2534"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2535"></a><span>    </span><a name="local-1628045886"><a href="#local-1628045886"><span class="hs-identifier">ev</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a><span> </span><a href="#local-1628045885"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-2536"></a><span>    </span><a name="local-1628045887"><a href="#local-1628045887"><span class="hs-identifier">loc</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctEvLoc"><span class="hs-identifier hs-var">ctEvLoc</span></a><span> </span><a href="#local-1628045886"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-2537"></a><span>    </span><a name="local-1628045888"><a href="#local-1628045888"><span class="hs-identifier">lcl_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a><span> </span><a href="#local-1628045887"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-2538"></a><span>
</span><a name="line-2539"></a><span>    </span><span class="hs-identifier">run_out</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2540"></a><span>    </span><a name="local-1628045889"><a href="#local-1628045889"><span class="hs-identifier">run_out</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2541"></a><span>    </span><span class="hs-identifier">run_out</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045892"><a href="#local-1628045892"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045892"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2542"></a><span>
</span><a name="line-2543"></a><span>    </span><span class="hs-identifier">dec_max</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2544"></a><span>    </span><a name="local-1628045890"><a href="#local-1628045890"><span class="hs-identifier">dec_max</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628045893"><a href="#local-1628045893"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045893"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2545"></a><span>
</span><a name="line-2546"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVarSet"><span class="hs-identifier hs-type">TcTyVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVarSet"><span class="hs-identifier hs-type">TcTyVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span>
</span><a name="line-2547"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                          </span><span class="hs-comment">-- True &lt;=&gt; some filtered out due to lack of fuel</span><span>
</span><a name="line-2548"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcIdBinder"><span class="hs-identifier hs-type">TcIdBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-2549"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- The bool says if we filtered any out</span><span>
</span><a name="line-2550"></a><span>                                        </span><span class="hs-comment">-- because of lack of fuel</span><span>
</span><a name="line-2551"></a><span>    </span><a name="local-1628045891"><a href="#local-1628045891"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1628045894"><a href="#local-1628045894"><span class="hs-identifier">tidy_env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628045895"><a href="#local-1628045895"><span class="hs-identifier">docs</span></a></a><span> </span><a name="local-1628045896"><a href="#local-1628045896"><span class="hs-identifier">discards</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2552"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045894"><span class="hs-identifier hs-var">tidy_env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1628045895"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045896"><span class="hs-identifier hs-var">discards</span></a><span class="hs-special">)</span><span>
</span><a name="line-2553"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628045897"><a href="#local-1628045897"><span class="hs-identifier">tidy_env</span></a></a><span> </span><a name="local-1628045898"><a href="#local-1628045898"><span class="hs-identifier">ct_tvs</span></a></a><span> </span><a name="local-1628045899"><a href="#local-1628045899"><span class="hs-identifier">n_left</span></a></a><span> </span><a name="local-1628045900"><a href="#local-1628045900"><span class="hs-identifier">tvs_seen</span></a></a><span> </span><a name="local-1628045901"><a href="#local-1628045901"><span class="hs-identifier">docs</span></a></a><span> </span><a name="local-1628045902"><a href="#local-1628045902"><span class="hs-identifier">discards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628045903"><a href="#local-1628045903"><span class="hs-identifier">tc_bndr</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628045904"><a href="#local-1628045904"><span class="hs-identifier">tc_bndrs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2554"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045903"><span class="hs-identifier hs-var">tc_bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2555"></a><span>          </span><a href="TcRnTypes.html#TcIdBndr"><span class="hs-identifier hs-var">TcIdBndr</span></a><span> </span><a name="local-1628045914"><a href="#local-1628045914"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-1628045915"><a href="#local-1628045915"><span class="hs-identifier">top_lvl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628045905"><span class="hs-identifier hs-var">go2</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-1628045914"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628045914"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045915"><span class="hs-identifier hs-var">top_lvl</span></a><span>
</span><a name="line-2556"></a><span>          </span><a href="TcRnTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-var">TcIdBndr_ExpType</span></a><span> </span><a name="local-1628045916"><a href="#local-1628045916"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628045917"><a href="#local-1628045917"><span class="hs-identifier">et</span></a></a><span> </span><a name="local-1628045918"><a href="#local-1628045918"><span class="hs-identifier">top_lvl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2557"></a><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045919"><a href="#local-1628045919"><span class="hs-identifier">mb_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#readExpType_maybe"><span class="hs-identifier hs-var">readExpType_maybe</span></a><span> </span><a href="#local-1628045917"><span class="hs-identifier hs-var">et</span></a><span>
</span><a name="line-2558"></a><span>                   </span><span class="hs-comment">-- et really should be filled in by now. But there's a chance</span><span>
</span><a name="line-2559"></a><span>                   </span><span class="hs-comment">-- it hasn't, if, say, we're reporting a kind error en route to</span><span>
</span><a name="line-2560"></a><span>                   </span><span class="hs-comment">-- checking a term. See test indexed-types/should_fail/T8129</span><span>
</span><a name="line-2561"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-1628045921"><a href="#local-1628045921"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628045919"><span class="hs-identifier hs-var">mb_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2562"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628045920"><a href="#local-1628045920"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628045920"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2563"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;Defaulting an ExpType in relevantBindings&quot;</span><span>
</span><a name="line-2564"></a><span>                                     </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045917"><span class="hs-identifier hs-var">et</span></a><span class="hs-special">)</span><span>
</span><a name="line-2565"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#expTypeToType"><span class="hs-identifier hs-var">expTypeToType</span></a><span> </span><a href="#local-1628045917"><span class="hs-identifier hs-var">et</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2566"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="#local-1628045905"><span class="hs-identifier hs-var">go2</span></a><span> </span><a href="#local-1628045916"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1628045921"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628045918"><span class="hs-identifier hs-var">top_lvl</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2567"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-2568"></a><span>        </span><a name="local-1628045905"><a href="#local-1628045905"><span class="hs-identifier">go2</span></a></a><span> </span><a name="local-1628045906"><a href="#local-1628045906"><span class="hs-identifier">id_name</span></a></a><span> </span><a name="local-1628045907"><a href="#local-1628045907"><span class="hs-identifier">id_type</span></a></a><span> </span><a name="local-1628045908"><a href="#local-1628045908"><span class="hs-identifier">top_lvl</span></a></a><span>
</span><a name="line-2569"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628045909"><a href="#local-1628045909"><span class="hs-identifier">tidy_env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045910"><a href="#local-1628045910"><span class="hs-identifier">tidy_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTidyTcType"><span class="hs-identifier hs-var">zonkTidyTcType</span></a><span> </span><a href="#local-1628045897"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><a href="#local-1628045907"><span class="hs-identifier hs-var">id_type</span></a><span>
</span><a name="line-2570"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;relevantBindings 1&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045906"><span class="hs-identifier hs-var">id_name</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045910"><span class="hs-identifier hs-var">tidy_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2571"></a><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045911"><a href="#local-1628045911"><span class="hs-identifier">id_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045910"><span class="hs-identifier hs-var">tidy_ty</span></a><span>
</span><a name="line-2572"></a><span>                     </span><a name="local-1628045912"><a href="#local-1628045912"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier hs-var">pprPrefixOcc</span></a><span> </span><a href="#local-1628045906"><span class="hs-identifier hs-var">id_name</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045910"><span class="hs-identifier hs-var">tidy_ty</span></a><span>
</span><a name="line-2573"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound at&quot;</span><span>
</span><a name="line-2574"></a><span>                                    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span> </span><a href="#local-1628045906"><span class="hs-identifier hs-var">id_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2575"></a><span>                     </span><a name="local-1628045913"><a href="#local-1628045913"><span class="hs-identifier">new_seen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628045900"><span class="hs-identifier hs-var">tvs_seen</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045911"><span class="hs-identifier hs-var">id_tvs</span></a><span>
</span><a name="line-2576"></a><span>
</span><a name="line-2577"></a><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-1628045883"><span class="hs-identifier hs-var">want_filtering</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="StaticFlags.html#opt_PprStyle_Debug"><span class="hs-identifier hs-var">opt_PprStyle_Debug</span></a><span>
</span><a name="line-2578"></a><span>                                    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045911"><span class="hs-identifier hs-var">id_tvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#disjointVarSet"><span class="hs-identifier hs-var">disjointVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045898"><span class="hs-identifier hs-var">ct_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2579"></a><span>                          </span><span class="hs-comment">-- We want to filter out this binding anyway</span><span>
</span><a name="line-2580"></a><span>                          </span><span class="hs-comment">-- so discard it silently</span><span>
</span><a name="line-2581"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628045891"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045897"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><a href="#local-1628045898"><span class="hs-identifier hs-var">ct_tvs</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span> </span><a href="#local-1628045900"><span class="hs-identifier hs-var">tvs_seen</span></a><span> </span><a href="#local-1628045901"><span class="hs-identifier hs-var">docs</span></a><span> </span><a href="#local-1628045902"><span class="hs-identifier hs-var">discards</span></a><span> </span><a href="#local-1628045904"><span class="hs-identifier hs-var">tc_bndrs</span></a><span>
</span><a name="line-2582"></a><span>
</span><a name="line-2583"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="BasicTypes.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a><span> </span><a href="#local-1628045908"><span class="hs-identifier hs-var">top_lvl</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span class="hs-special">)</span><span>
</span><a name="line-2584"></a><span>                          </span><span class="hs-comment">-- It's a top-level binding and we have not specified</span><span>
</span><a name="line-2585"></a><span>                          </span><span class="hs-comment">-- -fno-max-relevant-bindings, so discard it silently</span><span>
</span><a name="line-2586"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628045891"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045897"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><a href="#local-1628045898"><span class="hs-identifier hs-var">ct_tvs</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span> </span><a href="#local-1628045900"><span class="hs-identifier hs-var">tvs_seen</span></a><span> </span><a href="#local-1628045901"><span class="hs-identifier hs-var">docs</span></a><span> </span><a href="#local-1628045902"><span class="hs-identifier hs-var">discards</span></a><span> </span><a href="#local-1628045904"><span class="hs-identifier hs-var">tc_bndrs</span></a><span>
</span><a name="line-2587"></a><span>
</span><a name="line-2588"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628045889"><span class="hs-identifier hs-var">run_out</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628045911"><span class="hs-identifier hs-var">id_tvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#subVarSet"><span class="hs-identifier hs-var">subVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628045900"><span class="hs-identifier hs-var">tvs_seen</span></a><span>
</span><a name="line-2589"></a><span>                          </span><span class="hs-comment">-- We've run out of n_left fuel and this binding only</span><span>
</span><a name="line-2590"></a><span>                          </span><span class="hs-comment">-- mentions aleady-seen type variables, so discard it</span><span>
</span><a name="line-2591"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628045891"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045897"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><a href="#local-1628045898"><span class="hs-identifier hs-var">ct_tvs</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span> </span><a href="#local-1628045900"><span class="hs-identifier hs-var">tvs_seen</span></a><span> </span><a href="#local-1628045901"><span class="hs-identifier hs-var">docs</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628045904"><span class="hs-identifier hs-var">tc_bndrs</span></a><span>
</span><a name="line-2592"></a><span>
</span><a name="line-2593"></a><span>                          </span><span class="hs-comment">-- Keep this binding, decrement fuel</span><span>
</span><a name="line-2594"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="#local-1628045891"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628045909"><span class="hs-identifier hs-var">tidy_env'</span></a><span> </span><a href="#local-1628045898"><span class="hs-identifier hs-var">ct_tvs</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045890"><span class="hs-identifier hs-var">dec_max</span></a><span> </span><a href="#local-1628045899"><span class="hs-identifier hs-var">n_left</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045913"><span class="hs-identifier hs-var">new_seen</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045912"><span class="hs-identifier hs-var">doc</span></a><span class="hs-glyph">:</span><a href="#local-1628045901"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045902"><span class="hs-identifier hs-var">discards</span></a><span> </span><a href="#local-1628045904"><span class="hs-identifier hs-var">tc_bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2595"></a><span>
</span><a name="line-2596"></a><span class="hs-identifier">discardMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2597"></a><a name="discardMsg"><a href="TcErrors.html#discardMsg"><span class="hs-identifier">discardMsg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(Some bindings suppressed;&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2598"></a><span>             </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;use -fmax-relevant-binds=N or -fno-max-relevant-binds)&quot;</span><span>
</span><a name="line-2599"></a><span>
</span><a name="line-2600"></a><span class="hs-comment">-----------------------</span><span>
</span><a name="line-2601"></a><span class="hs-identifier">warnDefaulting</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#Ct"><span class="hs-identifier hs-type">Ct</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2602"></a><a name="warnDefaulting"><a href="TcErrors.html#warnDefaulting"><span class="hs-identifier">warnDefaulting</span></a></a><span> </span><a name="local-1628045938"><a href="#local-1628045938"><span class="hs-identifier">wanteds</span></a></a><span> </span><a name="local-1628045939"><a href="#local-1628045939"><span class="hs-identifier">default_ty</span></a></a><span>
</span><a name="line-2603"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045940"><a href="#local-1628045940"><span class="hs-identifier">warn_default</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnTypeDefaults"><span class="hs-identifier hs-var">Opt_WarnTypeDefaults</span></a><span>
</span><a name="line-2604"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045941"><a href="#local-1628045941"><span class="hs-identifier">env0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#tcInitTidyEnv"><span class="hs-identifier hs-var">tcInitTidyEnv</span></a><span>
</span><a name="line-2605"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045942"><a href="#local-1628045942"><span class="hs-identifier">tidy_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a><span> </span><a href="#local-1628045941"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2606"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TcRnTypes.html#tyCoVarsOfCt"><span class="hs-identifier hs-var">tyCoVarsOfCt</span></a><span class="hs-special">)</span><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><a href="#local-1628045938"><span class="hs-identifier hs-var">wanteds</span></a><span>
</span><a name="line-2607"></a><span>             </span><a name="local-1628045943"><a href="#local-1628045943"><span class="hs-identifier">tidy_wanteds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcMType.html#tidyCt"><span class="hs-identifier hs-var">tidyCt</span></a><span> </span><a href="#local-1628045942"><span class="hs-identifier hs-var">tidy_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045938"><span class="hs-identifier hs-var">wanteds</span></a><span>
</span><a name="line-2608"></a><span>             </span><span class="hs-special">(</span><a name="local-1628045944"><a href="#local-1628045944"><span class="hs-identifier">loc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628045945"><a href="#local-1628045945"><span class="hs-identifier">ppr_wanteds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcErrors.html#pprWithArising"><span class="hs-identifier hs-var">pprWithArising</span></a><span> </span><a href="#local-1628045943"><span class="hs-identifier hs-var">tidy_wanteds</span></a><span>
</span><a name="line-2609"></a><span>             </span><a name="local-1628045946"><a href="#local-1628045946"><span class="hs-identifier">warn_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2610"></a><span>                </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Defaulting the following&quot;</span><span>
</span><a name="line-2611"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;constraint&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628045943"><span class="hs-identifier hs-var">tidy_wanteds</span></a><span>
</span><a name="line-2612"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to type&quot;</span><span>
</span><a name="line-2613"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045939"><span class="hs-identifier hs-var">default_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2614"></a><span>                     </span><span class="hs-number">2</span><span>
</span><a name="line-2615"></a><span>                     </span><a href="#local-1628045945"><span class="hs-identifier hs-var">ppr_wanteds</span></a><span>
</span><a name="line-2616"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#setCtLocM"><span class="hs-identifier hs-var">setCtLocM</span></a><span> </span><a href="#local-1628045944"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#warnTc"><span class="hs-identifier hs-var">warnTc</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnTypeDefaults"><span class="hs-identifier hs-var">Opt_WarnTypeDefaults</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628045940"><span class="hs-identifier hs-var">warn_default</span></a><span> </span><a href="#local-1628045946"><span class="hs-identifier hs-var">warn_msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2617"></a><span>
</span><a name="line-2618"></a><span class="hs-comment">{-
Note [Runtime skolems]
~~~~~~~~~~~~~~~~~~~~~~
We want to give a reasonably helpful error message for ambiguity
arising from *runtime* skolems in the debugger.  These
are created by in RtClosureInspect.zonkRTTIType.

************************************************************************
*                                                                      *
                 Error from the canonicaliser
         These ones are called *during* constraint simplification
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2632"></a><span>
</span><a name="line-2633"></a><span class="hs-identifier">solverDepthErrorTcS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628045095"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2634"></a><a name="solverDepthErrorTcS"><a href="TcErrors.html#solverDepthErrorTcS"><span class="hs-identifier">solverDepthErrorTcS</span></a></a><span> </span><a name="local-1628045947"><a href="#local-1628045947"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628045948"><a href="#local-1628045948"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2635"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setCtLocM"><span class="hs-identifier hs-var">setCtLocM</span></a><span> </span><a href="#local-1628045947"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2636"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628045951"><a href="#local-1628045951"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a><span> </span><a href="#local-1628045948"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2637"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628045952"><a href="#local-1628045952"><span class="hs-identifier">env0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#tcInitTidyEnv"><span class="hs-identifier hs-var">tcInitTidyEnv</span></a><span>
</span><a name="line-2638"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628045953"><a href="#local-1628045953"><span class="hs-identifier">tidy_env</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a><span> </span><a href="#local-1628045952"><span class="hs-identifier hs-var">env0</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628045951"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2639"></a><span>             </span><a name="local-1628045954"><a href="#local-1628045954"><span class="hs-identifier">tidy_ty</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a><span> </span><a href="#local-1628045953"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><a href="#local-1628045951"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2640"></a><span>             </span><a name="local-1628045955"><a href="#local-1628045955"><span class="hs-identifier">msg</span></a></a><span>
</span><a name="line-2641"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Reduction stack overflow; size =&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045949"><span class="hs-identifier hs-var">depth</span></a><span>
</span><a name="line-2642"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;When simplifying the following type:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2643"></a><span>                           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628045954"><span class="hs-identifier hs-var">tidy_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2644"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="#local-1628045950"><span class="hs-identifier hs-var">note</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2645"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#failWithTcM"><span class="hs-identifier hs-var">failWithTcM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628045953"><span class="hs-identifier hs-var">tidy_env</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628045955"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2646"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2647"></a><span>    </span><a name="local-1628045949"><a href="#local-1628045949"><span class="hs-identifier">depth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ctLocDepth"><span class="hs-identifier hs-var">ctLocDepth</span></a><span> </span><a href="#local-1628045947"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-2648"></a><span>    </span><a name="local-1628045950"><a href="#local-1628045950"><span class="hs-identifier">note</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-2649"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use -freduction-depth=0 to disable this check&quot;</span><span>
</span><a name="line-2650"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(any upper bound you could choose might fail unpredictably with&quot;</span><span>
</span><a name="line-2651"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot; minor updates to GHC, so disabling the check is recommended if&quot;</span><span>
</span><a name="line-2652"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot; you're sure that type checking should terminate)&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2653"></a></pre></body></html>