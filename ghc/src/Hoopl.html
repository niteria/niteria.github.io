<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes, ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hoopl</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span>    </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>    </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Dataflow</span><span class="hs-special">,</span><span>
</span><a name="line-6"></a><span>    </span><a href="Hoopl.html#deepFwdRw"><span class="hs-identifier hs-var">deepFwdRw</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.html#deepFwdRw3"><span class="hs-identifier hs-var">deepFwdRw3</span></a><span class="hs-special">,</span><span>
</span><a name="line-7"></a><span>    </span><a href="Hoopl.html#deepBwdRw"><span class="hs-identifier hs-var">deepBwdRw</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.html#deepBwdRw3"><span class="hs-identifier hs-var">deepBwdRw3</span></a><span class="hs-special">,</span><span>
</span><a name="line-8"></a><span>    </span><a href="Hoopl.html#thenFwdRw"><span class="hs-identifier hs-var">thenFwdRw</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span></a><span> </span><span class="hs-keyword">hiding</span><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.MkGraph.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.MkGraph.html#mkLabel"><span class="hs-identifier hs-var">mkLabel</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.MkGraph.html#mkBranch"><span class="hs-identifier hs-var">mkBranch</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.MkGraph.html#mkMiddle"><span class="hs-identifier hs-var">mkMiddle</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.MkGraph.html#mkLast"><span class="hs-identifier hs-var">mkLast</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- clashes with our MkGraph</span><span>
</span><a name="line-13"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer"><span class="hs-identifier hs-type">FwdTransfer</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer"><span class="hs-identifier hs-type">BwdTransfer</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-type">BwdPass</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#noFwdRewrite"><span class="hs-identifier hs-var">noFwdRewrite</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#noBwdRewrite"><span class="hs-identifier hs-var">noBwdRewrite</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#analyzeAndRewriteFwd"><span class="hs-identifier hs-var">analyzeAndRewriteFwd</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#analyzeAndRewriteBwd"><span class="hs-identifier hs-var">analyzeAndRewriteBwd</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFactBase"><span class="hs-identifier hs-var">mkFactBase</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBRewrite"><span class="hs-identifier hs-var">mkBRewrite</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBRewrite3"><span class="hs-identifier hs-var">mkBRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBTransfer"><span class="hs-identifier hs-var">mkBTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBTransfer3"><span class="hs-identifier hs-var">mkBTransfer3</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFRewrite"><span class="hs-identifier hs-var">mkFRewrite</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFRewrite3"><span class="hs-identifier hs-var">mkFRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFTransfer"><span class="hs-identifier hs-var">mkFTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFTransfer3"><span class="hs-identifier hs-var">mkFTransfer3</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#deepFwdRw"><span class="hs-identifier hs-var">deepFwdRw</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#deepFwdRw3"><span class="hs-identifier hs-var">deepFwdRw3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#thenFwdRw"><span class="hs-identifier hs-var">thenFwdRw</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#iterFwdRw"><span class="hs-identifier hs-var">iterFwdRw</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>    </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#deepBwdRw"><span class="hs-identifier hs-var">deepBwdRw</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#deepBwdRw3"><span class="hs-identifier hs-var">deepBwdRw3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#thenBwdRw"><span class="hs-identifier hs-var">thenBwdRw</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Combinators.html#iterBwdRw"><span class="hs-identifier hs-var">iterBwdRw</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Hoopl.Dataflow.html"><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Dataflow</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-identifier">deepFwdRw3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465524"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465524"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465524"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465523"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465524"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-identifier">deepFwdRw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465521"><a href="#local-1627465521"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465522"><a href="#local-1627465522"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="#local-1627465519"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465521"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465522"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465520"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465519"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465521"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465522"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465519"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465520"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-34"></a><a name="deepFwdRw3"><a href="Hoopl.html#deepFwdRw3"><span class="hs-identifier">deepFwdRw3</span></a></a><span> </span><a name="local-1627465525"><a href="#local-1627465525"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627465526"><a href="#local-1627465526"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627465527"><a href="#local-1627465527"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.html#iterFwdRw"><span class="hs-identifier hs-var">iterFwdRw</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.Dataflow.html#mkFRewrite3"><span class="hs-identifier hs-var">mkFRewrite3</span></a><span> </span><a href="#local-1627465525"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465526"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627465527"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-35"></a><a name="deepFwdRw"><a href="Hoopl.html#deepFwdRw"><span class="hs-identifier">deepFwdRw</span></a></a><span> </span><a name="local-1627465528"><a href="#local-1627465528"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.html#deepFwdRw3"><span class="hs-identifier hs-var">deepFwdRw3</span></a><span> </span><a href="#local-1627465528"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465528"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465528"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- N.B. rw3, rw3', and rw3a are triples of functions.</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- But rw and rw' are single functions.</span><span>
</span><a name="line-39"></a><span class="hs-identifier">thenFwdRw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465517"><a href="#local-1627465517"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465518"><a href="#local-1627465518"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-40"></a><span>             </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-41"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-42"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-43"></a><a name="thenFwdRw"><a href="Hoopl.html#thenFwdRw"><span class="hs-identifier">thenFwdRw</span></a></a><span> </span><a name="local-1627465529"><a href="#local-1627465529"><span class="hs-identifier">rw3</span></a></a><span> </span><a name="local-1627465530"><a href="#local-1627465530"><span class="hs-identifier">rw3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR2"><span class="hs-identifier hs-var">wrapFR2</span></a><span> </span><a href="#local-1627465531"><span class="hs-identifier hs-var">thenrw</span></a><span> </span><a href="#local-1627465529"><span class="hs-identifier hs-var">rw3</span></a><span> </span><a href="#local-1627465530"><span class="hs-identifier hs-var">rw3'</span></a><span>
</span><a name="line-44"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-identifier">thenrw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465532"><a href="#local-1627465532"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465533"><a href="#local-1627465533"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627465534"><a href="#local-1627465534"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627465535"><a href="#local-1627465535"><span class="hs-identifier">t1</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-46"></a><span>               </span><span class="hs-special">(</span><a href="#local-1627465534"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465535"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465532"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465533"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465534"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465535"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465532"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465533"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465534"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-49"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465535"><span class="hs-identifier hs-type">t1</span></a><span>
</span><a name="line-50"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465532"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465533"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465517"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465518"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>  </span><a name="local-1627465531"><a href="#local-1627465531"><span class="hs-identifier">thenrw</span></a></a><span> </span><a name="local-1627465536"><a href="#local-1627465536"><span class="hs-identifier">rw</span></a></a><span> </span><a name="local-1627465537"><a href="#local-1627465537"><span class="hs-identifier">rw'</span></a></a><span> </span><a name="local-1627465538"><a href="#local-1627465538"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465539"><a href="#local-1627465539"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627465536"><span class="hs-identifier hs-var">rw</span></a><span> </span><a href="#local-1627465538"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627465539"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-1627465540"><span class="hs-identifier hs-var">fwdRes</span></a><span>
</span><a name="line-52"></a><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-1627465540"><a href="#local-1627465540"><span class="hs-identifier">fwdRes</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627465537"><span class="hs-identifier hs-var">rw'</span></a><span> </span><a href="#local-1627465538"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627465539"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-53"></a><span>           </span><span class="hs-identifier">fwdRes</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627465541"><a href="#local-1627465541"><span class="hs-identifier">gr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.html#fadd_rw"><span class="hs-identifier hs-var">fadd_rw</span></a><span> </span><a href="#local-1627465530"><span class="hs-identifier hs-var">rw3'</span></a><span> </span><a href="#local-1627465541"><span class="hs-identifier hs-var">gr</span></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-identifier">iterFwdRw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465515"><a href="#local-1627465515"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465516"><a href="#local-1627465516"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-56"></a><span>             </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465516"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-57"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465516"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-58"></a><a name="iterFwdRw"><a href="Hoopl.html#iterFwdRw"><span class="hs-identifier">iterFwdRw</span></a></a><span> </span><a name="local-1627465542"><a href="#local-1627465542"><span class="hs-identifier">rw3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR"><span class="hs-identifier hs-var">wrapFR</span></a><span> </span><a href="#local-1627465543"><span class="hs-identifier hs-var">iter</span></a><span> </span><a href="#local-1627465542"><span class="hs-identifier hs-var">rw3</span></a><span>
</span><a name="line-59"></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">iter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465544"><a href="#local-1627465544"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627465545"><a href="#local-1627465545"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465546"><a href="#local-1627465546"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627465547"><a href="#local-1627465547"><span class="hs-identifier">t</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-60"></a><span>               </span><span class="hs-special">(</span><a href="#local-1627465547"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465544"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465545"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465546"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465516"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465547"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-62"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465544"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-63"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465545"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465546"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465515"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465516"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>       </span><a name="local-1627465543"><a href="#local-1627465543"><span class="hs-identifier">iter</span></a></a><span> </span><a name="local-1627465548"><a href="#local-1627465548"><span class="hs-identifier">rw</span></a></a><span> </span><a name="local-1627465549"><a href="#local-1627465549"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.html#fadd_rw"><span class="hs-identifier hs-var">fadd_rw</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.html#iterFwdRw"><span class="hs-identifier hs-var">iterFwdRw</span></a><span> </span><a href="#local-1627465542"><span class="hs-identifier hs-var">rw3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1627465548"><span class="hs-identifier hs-var">rw</span></a><span> </span><a href="#local-1627465549"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- | Function inspired by 'rew' in the paper</span><span>
</span><a name="line-67"></a><span class="hs-identifier">_frewrite_cps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465509"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465510"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465511"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465512"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465512"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-69"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465513"><a href="#local-1627465513"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465514"><a href="#local-1627465514"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465513"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465514"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465511"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465513"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465514"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465511"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465508"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465509"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465510"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-71"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465511"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-72"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465512"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-73"></a><a name="_frewrite_cps"><a href="Hoopl.html#_frewrite_cps"><span class="hs-identifier">_frewrite_cps</span></a></a><span> </span><a name="local-1627465550"><a href="#local-1627465550"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-1627465551"><a href="#local-1627465551"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465552"><a href="#local-1627465552"><span class="hs-identifier">rw</span></a></a><span> </span><a name="local-1627465553"><a href="#local-1627465553"><span class="hs-identifier">node</span></a></a><span> </span><a name="local-1627465554"><a href="#local-1627465554"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-1627465555"><a href="#local-1627465555"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627465552"><span class="hs-identifier hs-var">rw</span></a><span> </span><a href="#local-1627465553"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627465554"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-75"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627465555"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465551"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-76"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627465556"><a href="#local-1627465556"><span class="hs-identifier">gr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465550"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-1627465556"><span class="hs-identifier hs-var">gr</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | Function inspired by 'add' in the paper</span><span>
</span><a name="line-81"></a><span class="hs-identifier">fadd_rw</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465505"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-82"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465506"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465507"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465505"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465506"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465507"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465504"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465505"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><a name="fadd_rw"><a href="Hoopl.html#fadd_rw"><span class="hs-identifier">fadd_rw</span></a></a><span> </span><a name="local-1627465557"><a href="#local-1627465557"><span class="hs-identifier">rw2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627465558"><a href="#local-1627465558"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627465559"><a href="#local-1627465559"><span class="hs-identifier">rw1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627465558"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627465559"><span class="hs-identifier hs-var">rw1</span></a><span> </span><span class="hs-special">`</span><a href="Hoopl.html#thenFwdRw"><span class="hs-identifier hs-var">thenFwdRw</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627465557"><span class="hs-identifier hs-var">rw2</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">deepBwdRw3</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-89"></a><span>              </span><span class="hs-special">(</span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465503"><span class="hs-identifier hs-type">f</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465503"><span class="hs-identifier hs-type">f</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627465503"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465502"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465503"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-identifier">deepBwdRw</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465500"><a href="#local-1627465500"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465501"><a href="#local-1627465501"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="#local-1627465498"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465500"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465501"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627465501"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627465499"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465498"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465500"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465501"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465498"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465499"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-95"></a><a name="deepBwdRw3"><a href="Hoopl.html#deepBwdRw3"><span class="hs-identifier">deepBwdRw3</span></a></a><span> </span><a name="local-1627465560"><a href="#local-1627465560"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627465561"><a href="#local-1627465561"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627465562"><a href="#local-1627465562"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.html#iterBwdRw"><span class="hs-identifier hs-var">iterBwdRw</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.Dataflow.html#mkBRewrite3"><span class="hs-identifier hs-var">mkBRewrite3</span></a><span> </span><a href="#local-1627465560"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465561"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1627465562"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-96"></a><a name="deepBwdRw"><a href="Hoopl.html#deepBwdRw"><span class="hs-identifier">deepBwdRw</span></a></a><span>  </span><a name="local-1627465563"><a href="#local-1627465563"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.html#deepBwdRw3"><span class="hs-identifier hs-var">deepBwdRw3</span></a><span> </span><a href="#local-1627465563"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465563"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465563"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">thenBwdRw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465496"><a href="#local-1627465496"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465497"><a href="#local-1627465497"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-100"></a><a name="thenBwdRw"><a href="Hoopl.html#thenBwdRw"><span class="hs-identifier">thenBwdRw</span></a></a><span> </span><a name="local-1627465564"><a href="#local-1627465564"><span class="hs-identifier">rw1</span></a></a><span> </span><a name="local-1627465565"><a href="#local-1627465565"><span class="hs-identifier">rw2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR2"><span class="hs-identifier hs-var">wrapBR2</span></a><span> </span><a href="#local-1627465566"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465564"><span class="hs-identifier hs-var">rw1</span></a><span> </span><a href="#local-1627465565"><span class="hs-identifier hs-var">rw2</span></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465567"><a href="#local-1627465567"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627465568"><a href="#local-1627465568"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627465569"><a href="#local-1627465569"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-1627465570"><a href="#local-1627465570"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465571"><a href="#local-1627465571"><span class="hs-identifier">x</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-102"></a><span>             </span><a href="#local-1627465567"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-103"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465568"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465569"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465570"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465571"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465568"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465569"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465570"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465571"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465568"><span class="hs-identifier hs-type">t1</span></a><span>
</span><a name="line-106"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465569"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-107"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465570"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465571"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465496"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465497"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>        </span><a name="local-1627465566"><a href="#local-1627465566"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627465572"><a href="#local-1627465572"><span class="hs-identifier">rw1</span></a></a><span> </span><a name="local-1627465573"><a href="#local-1627465573"><span class="hs-identifier">rw2'</span></a></a><span> </span><a name="local-1627465574"><a href="#local-1627465574"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465575"><a href="#local-1627465575"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-109"></a><span>          </span><a name="local-1627465576"><a href="#local-1627465576"><span class="hs-identifier">res1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627465572"><span class="hs-identifier hs-var">rw1</span></a><span> </span><a href="#local-1627465574"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627465575"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-110"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627465576"><span class="hs-identifier hs-var">res1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-111"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465573"><span class="hs-identifier hs-var">rw2'</span></a><span> </span><a href="#local-1627465574"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627465575"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-112"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627465577"><a href="#local-1627465577"><span class="hs-identifier">gr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.html#badd_rw"><span class="hs-identifier hs-var">badd_rw</span></a><span> </span><a href="#local-1627465565"><span class="hs-identifier hs-var">rw2</span></a><span> </span><a href="#local-1627465577"><span class="hs-identifier hs-var">gr</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-identifier">iterBwdRw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465494"><a href="#local-1627465494"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465495"><a href="#local-1627465495"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465495"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465495"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-115"></a><a name="iterBwdRw"><a href="Hoopl.html#iterBwdRw"><span class="hs-identifier">iterBwdRw</span></a></a><span> </span><a name="local-1627465578"><a href="#local-1627465578"><span class="hs-identifier">rw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR"><span class="hs-identifier hs-var">wrapBR</span></a><span> </span><a href="#local-1627465579"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627465578"><span class="hs-identifier hs-var">rw</span></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627465580"><a href="#local-1627465580"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627465581"><a href="#local-1627465581"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627465582"><a href="#local-1627465582"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627465583"><a href="#local-1627465583"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627465584"><a href="#local-1627465584"><span class="hs-identifier">t2</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-117"></a><span>             </span><a href="#local-1627465580"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-118"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627465583"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465584"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465581"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465582"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465495"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465583"><span class="hs-identifier hs-type">t1</span></a><span>
</span><a name="line-120"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627465584"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-121"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465581"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465582"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465494"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465495"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>        </span><a name="local-1627465579"><a href="#local-1627465579"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627465585"><a href="#local-1627465585"><span class="hs-identifier">rw'</span></a></a><span> </span><a name="local-1627465586"><a href="#local-1627465586"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627465587"><a href="#local-1627465587"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.html#badd_rw"><span class="hs-identifier hs-var">badd_rw</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.html#iterBwdRw"><span class="hs-identifier hs-var">iterBwdRw</span></a><span> </span><a href="#local-1627465578"><span class="hs-identifier hs-var">rw</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627465585"><span class="hs-identifier hs-var">rw'</span></a><span> </span><a href="#local-1627465586"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627465587"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- | Function inspired by 'add' in the paper</span><span>
</span><a name="line-125"></a><span class="hs-identifier">badd_rw</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465491"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-126"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465492"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465493"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465491"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627465490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465492"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627465493"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627465490"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627465491"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><a name="badd_rw"><a href="Hoopl.html#badd_rw"><span class="hs-identifier">badd_rw</span></a></a><span> </span><a name="local-1627465588"><a href="#local-1627465588"><span class="hs-identifier">rw2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627465589"><a href="#local-1627465589"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627465590"><a href="#local-1627465590"><span class="hs-identifier">rw1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627465589"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627465590"><span class="hs-identifier hs-var">rw1</span></a><span> </span><span class="hs-special">`</span><a href="Hoopl.html#thenBwdRw"><span class="hs-identifier hs-var">thenBwdRw</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627465588"><span class="hs-identifier hs-var">rw2</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- Note [Deprecations in Hoopl]</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- CmmLive and CmmBuildInfoTables modules enable -fno-warn-warnings-deprecations</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- flag because they import deprecated functions from Hoopl. I spent some time</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- trying to figure out what is going on, so here's a brief explanation. The</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- culprit is the joinOutFacts function, which should be replaced with</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- joinFacts. The difference between them is that the latter one needs extra</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- Label parameter. Labels identify blocks and are used in the fact base to</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- assign facts to a block (in case you're wondering, Label is an Int wrapped in</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- a newtype). Lattice join function is also required to accept a Label but the</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- only reason why it is so are the debugging purposes: see joinInFacts function</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- which is a no-op and is run only because join function might produce</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- debugging output. Now, going back to the Cmm modules. The &quot;problem&quot; with the</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- deprecated joinOutFacts function is that it passes wrong label when calling</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- lattice join function: instead of label of a block for which we are joining</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- facts it uses labels of successors of that block. So the joinFacts function</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- expects to be given a label of a block for which we are joining facts. I</span><span>
</span><a name="line-148"></a><span class="hs-comment">-- don't see an obvious way of recovering that Label at the call sites of</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- joinOutFacts (if that was easily done then joinFacts function could do it</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- internally without requiring label as a parameter). A cheap way of</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- eliminating these warnings would be to create a bogus Label, since none of</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- our join functions is actually using the Label parameter. But that doesn't</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- feel right. I think the real solution here is to fix Hoopl API, which is</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- already broken in several ways. See Hoopl/Cleanup page on the wiki for more</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- notes on improving Hoopl.</span><span>
</span><a name="line-156"></a></pre></body></html>