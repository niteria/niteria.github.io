<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
    %
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


TcGenDeriv: Generating derived instance declarations

This module is nominally ``subordinate'' to @TcDeriv@, which is the
``official'' interface to deriving-related things.

This is where we do all the grimy bindings' generation.
-}</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE CPP, ScopedTypeVariables #-}</span><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcGenDeriv</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-19"></a><span>        </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#DerivStuff"><span class="hs-identifier hs-type">DerivStuff</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>        </span><a href="TcGenDeriv.html#hasBuiltinDeriving"><span class="hs-identifier hs-var">hasBuiltinDeriving</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#functorLikeTraverse"><span class="hs-identifier hs-var">functorLikeTraverse</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="TcGenDeriv.html#deepSubtypesContaining"><span class="hs-identifier hs-var">deepSubtypesContaining</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>        </span><a href="TcGenDeriv.html#mkCoerceClassMethEqn"><span class="hs-identifier hs-var">mkCoerceClassMethEqn</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="TcGenDeriv.html#gen_Newtype_binds"><span class="hs-identifier hs-var">gen_Newtype_binds</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>        </span><a href="TcGenDeriv.html#genAuxBinds"><span class="hs-identifier hs-var">genAuxBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="TcGenDeriv.html#ordOpTbl"><span class="hs-identifier hs-var">ordOpTbl</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#boxConTbl"><span class="hs-identifier hs-var">boxConTbl</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#litConTbl"><span class="hs-identifier hs-var">litConTbl</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Fingerprint.html"><span class="hs-identifier">Fingerprint</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="Encoding.html"><span class="hs-identifier">Encoding</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="PrelInfo.html"><span class="hs-identifier">PrelInfo</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="FamInstEnv.html"><span class="hs-identifier">FamInstEnv</span></a><span class="hs-special">(</span><span> </span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="THNames.html"><span class="hs-identifier">THNames</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Module.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a><span class="hs-special">,</span><span> </span><a href="Module.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a><span>
</span><a name="line-47"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Module.html#moduleUnitId"><span class="hs-identifier hs-var">moduleUnitId</span></a><span class="hs-special">,</span><span> </span><a href="Module.html#unitIdString"><span class="hs-identifier hs-var">unitIdString</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="MkId.html"><span class="hs-identifier">MkId</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="MkId.html#coerceId"><span class="hs-identifier hs-var">coerceId</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="PrimOp.html"><span class="hs-identifier">PrimOp</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="State.html"><span class="hs-identifier">State</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Lexeme.html"><span class="hs-identifier">Lexeme</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="TcEnv.html"><span class="hs-identifier">TcEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcEnv.html#InstInfo"><span class="hs-identifier hs-type">InstInfo</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="StaticFlags.html"><span class="hs-identifier">StaticFlags</span></a><span class="hs-special">(</span><span> </span><a href="StaticFlags.html#opt_PprStyle_Debug"><span class="hs-identifier hs-var">opt_PprStyle_Debug</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="ListSetOps.html#assocMaybe"><span class="hs-identifier hs-var">assocMaybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">type</span><span> </span><a name="BagDerivStuff"><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier">BagDerivStuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcGenDeriv.html#DerivStuff"><span class="hs-identifier hs-type">DerivStuff</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">data</span><span> </span><a name="AuxBindSpec"><a href="TcGenDeriv.html#AuxBindSpec"><span class="hs-identifier">AuxBindSpec</span></a></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="DerivCon2Tag"><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier">DerivCon2Tag</span></a></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- The con2Tag for given TyCon</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivTag2Con"><a href="TcGenDeriv.html#DerivTag2Con"><span class="hs-identifier">DerivTag2Con</span></a></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- ...ditto tag2Con</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivMaxTag"><a href="TcGenDeriv.html#DerivMaxTag"><span class="hs-identifier">DerivMaxTag</span></a></a><span>  </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- ...and maxTag</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- All these generate ZERO-BASED tag operations</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-comment">-- I.e first constructor has tag 0</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">data</span><span> </span><a name="DerivStuff"><a href="TcGenDeriv.html#DerivStuff"><span class="hs-identifier">DerivStuff</span></a></a><span>     </span><span class="hs-comment">-- Please add this auxiliary stuff</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="DerivAuxBind"><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier">DerivAuxBind</span></a></a><span> </span><a href="TcGenDeriv.html#AuxBindSpec"><span class="hs-identifier hs-type">AuxBindSpec</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>  </span><span class="hs-comment">-- Generics</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivFamInst"><a href="TcGenDeriv.html#DerivFamInst"><span class="hs-identifier">DerivFamInst</span></a></a><span> </span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span>               </span><span class="hs-comment">-- New type family instances</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span>  </span><span class="hs-comment">-- New top-level auxiliary bindings</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivHsBind"><a href="TcGenDeriv.html#DerivHsBind"><span class="hs-identifier">DerivHsBind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Also used for SYB</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivInst"><a href="TcGenDeriv.html#DerivInst"><span class="hs-identifier">DerivInst</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEnv.html#InstInfo"><span class="hs-identifier hs-type">InstInfo</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- New, auxiliary instances</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Class deriving diagnostics
*                                                                      *
************************************************************************

Only certain blessed classes can be used in a deriving clause. These classes
are listed below in the definition of hasBuiltinDeriving (with the exception
of Generic and Generic1, which are handled separately in TcGenGenerics).

A class might be able to be used in a deriving clause if it -XDeriveAnyClass
is willing to support it. The canDeriveAnyClass function checks if this is
the case.
-}</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">hasBuiltinDeriving</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-112"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>
</span><a name="line-114"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-115"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-116"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><a name="hasBuiltinDeriving"><a href="TcGenDeriv.html#hasBuiltinDeriving"><span class="hs-identifier">hasBuiltinDeriving</span></a></a><span> </span><a name="local-1628017569"><a href="#local-1628017569"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628017570"><a href="#local-1628017570"><span class="hs-identifier">fix_env</span></a></a><span> </span><a name="local-1628017571"><a href="#local-1628017571"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#assocMaybe"><span class="hs-identifier hs-var">assocMaybe</span></a><span> </span><a href="#local-1628017572"><span class="hs-identifier hs-var">gen_list</span></a><span> </span><span class="hs-special">(</span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-1628017571"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier">gen_list</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>    </span><a name="local-1628017572"><a href="#local-1628017572"><span class="hs-identifier">gen_list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#eqClassKey"><span class="hs-identifier hs-var">eqClassKey</span></a><span class="hs-special">,</span><span>          </span><a href="TcGenDeriv.html#gen_Eq_binds"><span class="hs-identifier hs-var">gen_Eq_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#ordClassKey"><span class="hs-identifier hs-var">ordClassKey</span></a><span class="hs-special">,</span><span>         </span><a href="TcGenDeriv.html#gen_Ord_binds"><span class="hs-identifier hs-var">gen_Ord_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#enumClassKey"><span class="hs-identifier hs-var">enumClassKey</span></a><span class="hs-special">,</span><span>        </span><a href="TcGenDeriv.html#gen_Enum_binds"><span class="hs-identifier hs-var">gen_Enum_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#boundedClassKey"><span class="hs-identifier hs-var">boundedClassKey</span></a><span class="hs-special">,</span><span>     </span><a href="TcGenDeriv.html#gen_Bounded_binds"><span class="hs-identifier hs-var">gen_Bounded_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#ixClassKey"><span class="hs-identifier hs-var">ixClassKey</span></a><span class="hs-special">,</span><span>          </span><a href="TcGenDeriv.html#gen_Ix_binds"><span class="hs-identifier hs-var">gen_Ix_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#showClassKey"><span class="hs-identifier hs-var">showClassKey</span></a><span class="hs-special">,</span><span>        </span><a href="TcGenDeriv.html#gen_Show_binds"><span class="hs-identifier hs-var">gen_Show_binds</span></a><span> </span><a href="#local-1628017570"><span class="hs-identifier hs-var">fix_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#readClassKey"><span class="hs-identifier hs-var">readClassKey</span></a><span class="hs-special">,</span><span>        </span><a href="TcGenDeriv.html#gen_Read_binds"><span class="hs-identifier hs-var">gen_Read_binds</span></a><span> </span><a href="#local-1628017570"><span class="hs-identifier hs-var">fix_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#dataClassKey"><span class="hs-identifier hs-var">dataClassKey</span></a><span class="hs-special">,</span><span>        </span><a href="TcGenDeriv.html#gen_Data_binds"><span class="hs-identifier hs-var">gen_Data_binds</span></a><span> </span><a href="#local-1628017569"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#functorClassKey"><span class="hs-identifier hs-var">functorClassKey</span></a><span class="hs-special">,</span><span>     </span><a href="TcGenDeriv.html#gen_Functor_binds"><span class="hs-identifier hs-var">gen_Functor_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#foldableClassKey"><span class="hs-identifier hs-var">foldableClassKey</span></a><span class="hs-special">,</span><span>    </span><a href="TcGenDeriv.html#gen_Foldable_binds"><span class="hs-identifier hs-var">gen_Foldable_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#traversableClassKey"><span class="hs-identifier hs-var">traversableClassKey</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gen_Traversable_binds"><span class="hs-identifier hs-var">gen_Traversable_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="THNames.html#liftClassKey"><span class="hs-identifier hs-var">liftClassKey</span></a><span class="hs-special">,</span><span>        </span><a href="TcGenDeriv.html#gen_Lift_binds"><span class="hs-identifier hs-var">gen_Lift_binds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Eq instances
*                                                                      *
************************************************************************

Here are the heuristics for the code we generate for @Eq@. Let's
assume we have a data type with some (possibly zero) nullary data
constructors and some ordinary, non-nullary ones (the rest, also
possibly zero of them).  Here's an example, with both \tr{N}ullary and
\tr{O}rdinary data cons.

  data Foo ... = N1 | N2 ... | Nn | O1 a b | O2 Int | O3 Double b b | ...

* For the ordinary constructors (if any), we emit clauses to do The
  Usual Thing, e.g.,:

    (==) (O1 a1 b1)    (O1 a2 b2)    = a1 == a2 &amp;&amp; b1 == b2
    (==) (O2 a1)       (O2 a2)       = a1 == a2
    (==) (O3 a1 b1 c1) (O3 a2 b2 c2) = a1 == a2 &amp;&amp; b1 == b2 &amp;&amp; c1 == c2

  Note: if we're comparing unlifted things, e.g., if 'a1' and
  'a2' are Float#s, then we have to generate
       case (a1 `eqFloat#` a2) of r -&gt; r
  for that particular test.

* If there are a lot of (more than en) nullary constructors, we emit a
  catch-all clause of the form:

      (==) a b  = case (con2tag_Foo a) of { a# -&gt;
                  case (con2tag_Foo b) of { b# -&gt;
                  case (a# ==# b#)     of {
                    r -&gt; r }}}

  If con2tag gets inlined this leads to join point stuff, so
  it's better to use regular pattern matching if there aren't too
  many nullary constructors.  &quot;Ten&quot; is arbitrary, of course

* If there aren't any nullary constructors, we emit a simpler
  catch-all:

     (==) a b  = False

* For the @(/=)@ method, we normally just use the default method.
  If the type is an enumeration type, we could/may/should? generate
  special code that calls @con2tag_Foo@, much like for @(==)@ shown
  above.

We thought about doing this: If we're also deriving 'Ord' for this
tycon, we generate:
  instance ... Eq (Foo ...) where
    (==) a b  = case (compare a b) of { _LT -&gt; False; _EQ -&gt; True ; _GT -&gt; False}
    (/=) a b  = case (compare a b) of { _LT -&gt; True ; _EQ -&gt; False; _GT -&gt; True }
However, that requires that (Ord &lt;whatever&gt;) was put in the context
for the instance decl, which it probably wasn't, so the decls
produced don't get through the typechecker.
-}</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-identifier">gen_Eq_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><a name="gen_Eq_binds"><a href="TcGenDeriv.html#gen_Eq_binds"><span class="hs-identifier">gen_Eq_binds</span></a></a><span> </span><a name="local-1628017573"><a href="#local-1628017573"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017574"><a href="#local-1628017574"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017583"><span class="hs-identifier hs-var">method_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017582"><span class="hs-identifier hs-var">aux_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>    </span><a name="local-1628017575"><a href="#local-1628017575"><span class="hs-identifier">all_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017574"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017576"><a href="#local-1628017576"><span class="hs-identifier">nullary_cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017577"><a href="#local-1628017577"><span class="hs-identifier">non_nullary_cons</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="DataCon.html#isNullarySrcDataCon"><span class="hs-identifier hs-var">isNullarySrcDataCon</span></a><span> </span><a href="#local-1628017575"><span class="hs-identifier hs-var">all_cons</span></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-comment">-- If there are ten or more (arbitrary number) nullary constructors,</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-comment">-- use the con2tag stuff.  For small types it's better to use</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-comment">-- ordinary pattern matching.</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017578"><a href="#local-1628017578"><span class="hs-identifier">tag_match_cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017579"><a href="#local-1628017579"><span class="hs-identifier">pat_match_cons</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017576"><span class="hs-identifier hs-var">nullary_cons</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017576"><span class="hs-identifier hs-var">nullary_cons</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017577"><span class="hs-identifier hs-var">non_nullary_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>           </span><a href="#local-1628017575"><span class="hs-identifier hs-var">all_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>    </span><a name="local-1628017580"><a href="#local-1628017580"><span class="hs-identifier">no_tag_match_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017578"><span class="hs-identifier hs-var">tag_match_cons</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span>    </span><a name="local-1628017581"><a href="#local-1628017581"><span class="hs-identifier">fall_through_eqn</span></a></a><span>
</span><a name="line-209"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017580"><span class="hs-identifier hs-var">no_tag_match_cons</span></a><span>   </span><span class="hs-comment">-- All constructors have arguments</span><span>
</span><a name="line-210"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628017579"><span class="hs-identifier hs-var">pat_match_cons</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-211"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- No constructors; no fall-though case</span><span>
</span><a name="line-212"></a><span>          </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- One constructor; no fall-though case</span><span>
</span><a name="line-213"></a><span>          </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-comment">-- Two or more constructors; add fall-through of</span><span>
</span><a name="line-214"></a><span>                      </span><span class="hs-comment">--       (==) _ _ = False</span><span>
</span><a name="line-215"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-comment">-- One or more tag_match cons; add fall-through of</span><span>
</span><a name="line-218"></a><span>                  </span><span class="hs-comment">-- extract tags compare for equality</span><span>
</span><a name="line-219"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-220"></a><span>         </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017574"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-221"></a><span>                    </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#eqInt_RDR"><span class="hs-identifier hs-var">eqInt_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>    </span><a name="local-1628017582"><a href="#local-1628017582"><span class="hs-identifier">aux_binds</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017580"><span class="hs-identifier hs-var">no_tag_match_cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-224"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a href="#local-1628017574"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span>    </span><a name="local-1628017583"><a href="#local-1628017583"><span class="hs-identifier">method_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017584"><span class="hs-identifier hs-var">eq_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017585"><span class="hs-identifier hs-var">ne_bind</span></a><span class="hs-special">]</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-1628017584"><a href="#local-1628017584"><span class="hs-identifier">eq_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628017573"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#eq_RDR"><span class="hs-identifier hs-var">eq_RDR</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017586"><span class="hs-identifier hs-var">pats_etc</span></a><span> </span><a href="#local-1628017579"><span class="hs-identifier hs-var">pat_match_cons</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017581"><span class="hs-identifier hs-var">fall_through_eqn</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>    </span><a name="local-1628017585"><a href="#local-1628017585"><span class="hs-identifier">ne_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017573"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#ne_RDR"><span class="hs-identifier hs-var">ne_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-229"></a><span>                        </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#not_RDR"><span class="hs-identifier hs-var">not_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="PrelNames.html#eq_RDR"><span class="hs-identifier hs-var">eq_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-232"></a><span>    </span><a name="local-1628017586"><a href="#local-1628017586"><span class="hs-identifier">pats_etc</span></a></a><span> </span><a name="local-1628017587"><a href="#local-1628017587"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-233"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><a name="line-234"></a><span>            </span><a name="local-1628017596"><a href="#local-1628017596"><span class="hs-identifier">con1_pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017598"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017600"><span class="hs-identifier hs-var">as_needed</span></a><span>
</span><a name="line-235"></a><span>            </span><a name="local-1628017597"><a href="#local-1628017597"><span class="hs-identifier">con2_pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017598"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017601"><span class="hs-identifier hs-var">bs_needed</span></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span>            </span><a name="local-1628017598"><a href="#local-1628017598"><span class="hs-identifier">data_con_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017587"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-238"></a><span>            </span><a name="local-1628017599"><a href="#local-1628017599"><span class="hs-identifier">con_arity</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628017602"><span class="hs-identifier hs-var">tys_needed</span></a><span>
</span><a name="line-239"></a><span>            </span><a name="local-1628017600"><a href="#local-1628017600"><span class="hs-identifier">as_needed</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017599"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-240"></a><span>            </span><a name="local-1628017601"><a href="#local-1628017601"><span class="hs-identifier">bs_needed</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017599"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-241"></a><span>            </span><a name="local-1628017602"><a href="#local-1628017602"><span class="hs-identifier">tys_needed</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628017587"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-242"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-243"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1628017596"><span class="hs-identifier hs-var">con1_pat</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017597"><span class="hs-identifier hs-var">con2_pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1628017588"><span class="hs-identifier hs-var">nested_eq_expr</span></a><span> </span><a href="#local-1628017602"><span class="hs-identifier hs-var">tys_needed</span></a><span> </span><a href="#local-1628017600"><span class="hs-identifier hs-var">as_needed</span></a><span> </span><a href="#local-1628017601"><span class="hs-identifier hs-var">bs_needed</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-245"></a><span>        </span><a name="local-1628017588"><a href="#local-1628017588"><span class="hs-identifier">nested_eq_expr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-246"></a><span>        </span><span class="hs-identifier">nested_eq_expr</span><span> </span><a name="local-1628017589"><a href="#local-1628017589"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-1628017591"><a href="#local-1628017591"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-247"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span> </span><a href="TcGenDeriv.html#and_Expr"><span class="hs-identifier hs-var">and_Expr</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#zipWith3Equal"><span class="hs-identifier hs-var">zipWith3Equal</span></a><span> </span><span class="hs-string">&quot;nested_eq&quot;</span><span> </span><a href="#local-1628017592"><span class="hs-identifier hs-var">nested_eq</span></a><span> </span><a href="#local-1628017589"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-1628017591"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-249"></a><span>            </span><a name="local-1628017592"><a href="#local-1628017592"><span class="hs-identifier">nested_eq</span></a></a><span> </span><a name="local-1628017593"><a href="#local-1628017593"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628017594"><a href="#local-1628017594"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017595"><a href="#local-1628017595"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#eq_Expr"><span class="hs-identifier hs-var">eq_Expr</span></a><span> </span><a href="#local-1628017574"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017593"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017594"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017595"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Ord instances
*                                                                      *
************************************************************************

Note [Generating Ord instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose constructors are K1..Kn, and some are nullary.
The general form we generate is:

* Do case on first argument
        case a of
          K1 ... -&gt; rhs_1
          K2 ... -&gt; rhs_2
          ...
          Kn ... -&gt; rhs_n
          _ -&gt; nullary_rhs

* To make rhs_i
     If i = 1, 2, n-1, n, generate a single case.
        rhs_2    case b of
                   K1 {}  -&gt; LT
                   K2 ... -&gt; ...eq_rhs(K2)...
                   _      -&gt; GT

     Otherwise do a tag compare against the bigger range
     (because this is the one most likely to succeed)
        rhs_3    case tag b of tb -&gt;
                 if 3 &lt;# tg then GT
                 else case b of
                         K3 ... -&gt; ...eq_rhs(K3)....
                         _      -&gt; LT

* To make eq_rhs(K), which knows that
    a = K a1 .. av
    b = K b1 .. bv
  we just want to compare (a1,b1) then (a2,b2) etc.
  Take care on the last field to tail-call into comparing av,bv

* To make nullary_rhs generate this
     case con2tag a of a# -&gt;
     case con2tag b of -&gt;
     a# `compare` b#

Several special cases:

* Two or fewer nullary constructors: don't generate nullary_rhs

* Be careful about unlifted comparisons.  When comparing unboxed
  values we can't call the overloaded functions.
  See function unliftedOrdOp

Note [Do not rely on compare]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's a bad idea to define only 'compare', and build the other binary
comparisons on top of it; see Trac #2130, #4019.  Reason: we don't
want to laboriously make a three-way comparison, only to extract a
binary result, something like this:
     (&gt;) (I# x) (I# y) = case &lt;# x y of
                            True -&gt; False
                            False -&gt; case ==# x y of
                                       True  -&gt; False
                                       False -&gt; True

So for sufficiently small types (few constructors, or all nullary)
we generate all methods; for large ones we just use 'compare'.
-}</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-keyword">data</span><span> </span><a name="OrdOp"><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier">OrdOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OrdCompare"><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier">OrdCompare</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OrdLT"><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier">OrdLT</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OrdLE"><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier">OrdLE</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OrdGE"><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier">OrdGE</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OrdGT"><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier">OrdGT</span></a></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-comment">------------</span><span>
</span><a name="line-324"></a><span class="hs-identifier">ordMethRdr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-325"></a><a name="ordMethRdr"><a href="TcGenDeriv.html#ordMethRdr"><span class="hs-identifier">ordMethRdr</span></a></a><span> </span><a name="local-1628017603"><a href="#local-1628017603"><span class="hs-identifier">op</span></a></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628017603"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-327"></a><span>       </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PrelNames.html#compare_RDR"><span class="hs-identifier hs-var">compare_RDR</span></a><span>
</span><a name="line-328"></a><span>       </span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PrelNames.html#lt_RDR"><span class="hs-identifier hs-var">lt_RDR</span></a><span>
</span><a name="line-329"></a><span>       </span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PrelNames.html#le_RDR"><span class="hs-identifier hs-var">le_RDR</span></a><span>
</span><a name="line-330"></a><span>       </span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PrelNames.html#ge_RDR"><span class="hs-identifier hs-var">ge_RDR</span></a><span>
</span><a name="line-331"></a><span>       </span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PrelNames.html#gt_RDR"><span class="hs-identifier hs-var">gt_RDR</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">------------</span><span>
</span><a name="line-334"></a><span class="hs-identifier">ltResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- Knowing a&lt;b, what is the result for a `op` b?</span><span>
</span><a name="line-336"></a><a name="ltResult"><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier">ltResult</span></a></a><span> </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#ltTag_Expr"><span class="hs-identifier hs-var">ltTag_Expr</span></a><span>
</span><a name="line-337"></a><span class="hs-identifier">ltResult</span><span> </span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-338"></a><span class="hs-identifier">ltResult</span><span> </span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-339"></a><span class="hs-identifier">ltResult</span><span> </span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-340"></a><span class="hs-identifier">ltResult</span><span> </span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">------------</span><span>
</span><a name="line-343"></a><span class="hs-identifier">eqResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-344"></a><span class="hs-comment">-- Knowing a=b, what is the result for a `op` b?</span><span>
</span><a name="line-345"></a><a name="eqResult"><a href="TcGenDeriv.html#eqResult"><span class="hs-identifier">eqResult</span></a></a><span> </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#eqTag_Expr"><span class="hs-identifier hs-var">eqTag_Expr</span></a><span>
</span><a name="line-346"></a><span class="hs-identifier">eqResult</span><span> </span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-347"></a><span class="hs-identifier">eqResult</span><span> </span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-348"></a><span class="hs-identifier">eqResult</span><span> </span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-349"></a><span class="hs-identifier">eqResult</span><span> </span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-comment">------------</span><span>
</span><a name="line-352"></a><span class="hs-identifier">gtResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- Knowing a&gt;b, what is the result for a `op` b?</span><span>
</span><a name="line-354"></a><a name="gtResult"><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier">gtResult</span></a></a><span> </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#gtTag_Expr"><span class="hs-identifier hs-var">gtTag_Expr</span></a><span>
</span><a name="line-355"></a><span class="hs-identifier">gtResult</span><span> </span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-356"></a><span class="hs-identifier">gtResult</span><span> </span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier hs-var">false_Expr</span></a><span>
</span><a name="line-357"></a><span class="hs-identifier">gtResult</span><span> </span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-358"></a><span class="hs-identifier">gtResult</span><span> </span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier hs-var">true_Expr</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">------------</span><span>
</span><a name="line-361"></a><span class="hs-identifier">gen_Ord_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><a name="gen_Ord_binds"><a href="TcGenDeriv.html#gen_Ord_binds"><span class="hs-identifier">gen_Ord_binds</span></a></a><span> </span><a name="local-1628017604"><a href="#local-1628017604"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017605"><a href="#local-1628017605"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-363"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>        </span><span class="hs-comment">-- No data-cons =&gt; invoke bale-out case</span><span>
</span><a name="line-364"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628017604"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#compare_RDR"><span class="hs-identifier hs-var">compare_RDR</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-366"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017617"><span class="hs-identifier hs-var">mkOrdOp</span></a><span> </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628017607"><span class="hs-identifier hs-var">other_ops</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017606"><span class="hs-identifier hs-var">aux_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-368"></a><span>    </span><a name="local-1628017606"><a href="#local-1628017606"><span class="hs-identifier">aux_binds</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017610"><span class="hs-identifier hs-var">single_con_type</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-369"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span>        </span><span class="hs-comment">-- Note [Do not rely on compare]</span><span>
</span><a name="line-372"></a><span>    </span><a name="local-1628017607"><a href="#local-1628017607"><span class="hs-identifier">other_ops</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1628017614"><span class="hs-identifier hs-var">last_tag</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1628017613"><span class="hs-identifier hs-var">first_tag</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">2</span><span>     </span><span class="hs-comment">-- 1-3 constructors</span><span>
</span><a name="line-373"></a><span>                </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017616"><span class="hs-identifier hs-var">non_nullary_cons</span></a><span>        </span><span class="hs-comment">-- Or it's an enumeration</span><span>
</span><a name="line-374"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017617"><span class="hs-identifier hs-var">mkOrdOp</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-376"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span>    </span><a name="local-1628017608"><a href="#local-1628017608"><span class="hs-identifier">get_tag</span></a></a><span> </span><a name="local-1628017623"><a href="#local-1628017623"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a><span> </span><a href="#local-1628017623"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span>
</span><a name="line-379"></a><span>        </span><span class="hs-comment">-- We want *zero-based* tags, because that's what</span><span>
</span><a name="line-380"></a><span>        </span><span class="hs-comment">-- con2Tag returns (generated by untag_Expr)!</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span>    </span><a name="local-1628017609"><a href="#local-1628017609"><span class="hs-identifier">tycon_data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-383"></a><span>    </span><a name="local-1628017610"><a href="#local-1628017610"><span class="hs-identifier">single_con_type</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>
</span><a name="line-384"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017611"><a href="#local-1628017611"><span class="hs-identifier">first_con</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>
</span><a name="line-385"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017612"><a href="#local-1628017612"><span class="hs-identifier">last_con</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>
</span><a name="line-386"></a><span>    </span><a name="local-1628017613"><a href="#local-1628017613"><span class="hs-identifier">first_tag</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017608"><span class="hs-identifier hs-var">get_tag</span></a><span> </span><a href="#local-1628017611"><span class="hs-identifier hs-var">first_con</span></a><span>
</span><a name="line-387"></a><span>    </span><a name="local-1628017614"><a href="#local-1628017614"><span class="hs-identifier">last_tag</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017608"><span class="hs-identifier hs-var">get_tag</span></a><span> </span><a href="#local-1628017612"><span class="hs-identifier hs-var">last_con</span></a><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017615"><a href="#local-1628017615"><span class="hs-identifier">nullary_cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017616"><a href="#local-1628017616"><span class="hs-identifier">non_nullary_cons</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="DataCon.html#isNullarySrcDataCon"><span class="hs-identifier hs-var">isNullarySrcDataCon</span></a><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span>    </span><span class="hs-identifier">mkOrdOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-393"></a><span>    </span><span class="hs-comment">-- Returns a binding   op a b = ... compares a and b according to op ....</span><span>
</span><a name="line-394"></a><span>    </span><a name="local-1628017617"><a href="#local-1628017617"><span class="hs-identifier">mkOrdOp</span></a></a><span> </span><a name="local-1628017624"><a href="#local-1628017624"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017604"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ordMethRdr"><span class="hs-identifier hs-var">ordMethRdr</span></a><span> </span><a href="#local-1628017624"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-1628017618"><span class="hs-identifier hs-var">mkOrdOpRhs</span></a><span> </span><a href="#local-1628017624"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span>    </span><span class="hs-identifier">mkOrdOpRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-397"></a><span>    </span><a name="local-1628017618"><a href="#local-1628017618"><span class="hs-identifier">mkOrdOpRhs</span></a></a><span> </span><a name="local-1628017625"><a href="#local-1628017625"><span class="hs-identifier">op</span></a></a><span>       </span><span class="hs-comment">-- RHS for comparing 'a' and 'b' according to op</span><span>
</span><a name="line-398"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628017615"><span class="hs-identifier hs-var">nullary_cons</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">2</span><span>  </span><span class="hs-comment">-- Two nullary or fewer, so use cases</span><span>
</span><a name="line-399"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-400"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017619"><span class="hs-identifier hs-var">mkOrdOpAlt</span></a><span> </span><a href="#local-1628017625"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017609"><span class="hs-identifier hs-var">tycon_data_cons</span></a><span>
</span><a name="line-401"></a><span>        </span><span class="hs-comment">-- i.e.  case a of { C1 x y -&gt; case b of C1 x y -&gt; ....compare x,y...</span><span>
</span><a name="line-402"></a><span>        </span><span class="hs-comment">--                   C2 x   -&gt; case b of C2 x -&gt; ....comopare x.... }</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017616"><span class="hs-identifier hs-var">non_nullary_cons</span></a><span>    </span><span class="hs-comment">-- All nullary, so go straight to comparing tags</span><span>
</span><a name="line-405"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017622"><span class="hs-identifier hs-var">mkTagCmp</span></a><span> </span><a href="#local-1628017625"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                </span><span class="hs-comment">-- Mixed nullary and non-nullary</span><span>
</span><a name="line-408"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-409"></a><span>        </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017619"><span class="hs-identifier hs-var">mkOrdOpAlt</span></a><span> </span><a href="#local-1628017625"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017616"><span class="hs-identifier hs-var">non_nullary_cons</span></a><span>
</span><a name="line-410"></a><span>         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017622"><span class="hs-identifier hs-var">mkTagCmp</span></a><span> </span><a href="#local-1628017625"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span>    </span><span class="hs-identifier">mkOrdOpAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>    </span><span class="hs-comment">-- Make the alternative  (Ki a1 a2 .. av -&gt;</span><span>
</span><a name="line-415"></a><span>    </span><a name="local-1628017619"><a href="#local-1628017619"><span class="hs-identifier">mkOrdOpAlt</span></a></a><span> </span><a name="local-1628017626"><a href="#local-1628017626"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628017627"><a href="#local-1628017627"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-416"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017629"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017628"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628017620"><span class="hs-identifier hs-var">mkInnerRhs</span></a><span> </span><a href="#local-1628017626"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017627"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-418"></a><span>        </span><a name="local-1628017628"><a href="#local-1628017628"><span class="hs-identifier">as_needed</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017627"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-419"></a><span>        </span><a name="local-1628017629"><a href="#local-1628017629"><span class="hs-identifier">data_con_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017627"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span>    </span><a name="local-1628017620"><a href="#local-1628017620"><span class="hs-identifier">mkInnerRhs</span></a></a><span> </span><a name="local-1628017630"><a href="#local-1628017630"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628017631"><a href="#local-1628017631"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-422"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017610"><span class="hs-identifier hs-var">single_con_type</span></a><span>
</span><a name="line-423"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017613"><span class="hs-identifier hs-var">first_tag</span></a><span>
</span><a name="line-426"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-427"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-428"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017614"><span class="hs-identifier hs-var">last_tag</span></a><span>
</span><a name="line-429"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-430"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017613"><span class="hs-identifier hs-var">first_tag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-433"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#nlConWildPat"><span class="hs-identifier hs-var">nlConWildPat</span></a><span> </span><a href="#local-1628017611"><span class="hs-identifier hs-var">first_con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-435"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-436"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017614"><span class="hs-identifier hs-var">last_tag</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-437"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#nlConWildPat"><span class="hs-identifier hs-var">nlConWildPat</span></a><span> </span><a href="#local-1628017612"><span class="hs-identifier hs-var">last_con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-439"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-1628017614"><span class="hs-identifier hs-var">last_tag</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#div"><span class="hs-identifier hs-var">div</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>  </span><span class="hs-comment">-- lower range is larger</span><span>
</span><a name="line-442"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-443"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#ltInt_RDR"><span class="hs-identifier hs-var">ltInt_RDR</span></a><span> </span><a href="#local-1628017633"><span class="hs-identifier hs-var">tag_lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-444"></a><span>               </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-comment">-- Definitely GT</span><span>
</span><a name="line-445"></a><span>        </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-446"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-comment">-- upper range is larger</span><span>
</span><a name="line-449"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-450"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#gtInt_RDR"><span class="hs-identifier hs-var">gtInt_RDR</span></a><span> </span><a href="#local-1628017633"><span class="hs-identifier hs-var">tag_lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span>               </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-comment">-- Definitely LT</span><span>
</span><a name="line-452"></a><span>        </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017621"><span class="hs-identifier hs-var">mkInnerEqAlt</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-453"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017630"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-454"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-455"></a><span>        </span><a name="local-1628017632"><a href="#local-1628017632"><span class="hs-identifier">tag</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017608"><span class="hs-identifier hs-var">get_tag</span></a><span> </span><a href="#local-1628017631"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-456"></a><span>        </span><a name="local-1628017633"><a href="#local-1628017633"><span class="hs-identifier">tag_lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><a href="#local-1628017632"><span class="hs-identifier hs-var">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span>    </span><span class="hs-identifier">mkInnerEqAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>    </span><span class="hs-comment">-- First argument 'a' known to be built with K</span><span>
</span><a name="line-460"></a><span>    </span><span class="hs-comment">-- Returns a case alternative  Ki b1 b2 ... bv -&gt; compare (a1,a2,...) with (b1,b2,...)</span><span>
</span><a name="line-461"></a><span>    </span><a name="local-1628017621"><a href="#local-1628017621"><span class="hs-identifier">mkInnerEqAlt</span></a></a><span> </span><a name="local-1628017634"><a href="#local-1628017634"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628017635"><a href="#local-1628017635"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-462"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017636"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017637"><span class="hs-identifier hs-var">bs_needed</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-463"></a><span>        </span><a href="TcGenDeriv.html#mkCompareFields"><span class="hs-identifier hs-var">mkCompareFields</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017634"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628017635"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-465"></a><span>        </span><a name="local-1628017636"><a href="#local-1628017636"><span class="hs-identifier">data_con_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017635"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-466"></a><span>        </span><a name="local-1628017637"><a href="#local-1628017637"><span class="hs-identifier">bs_needed</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017635"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span>    </span><span class="hs-identifier">mkTagCmp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-469"></a><span>    </span><span class="hs-comment">-- Both constructors known to be nullary</span><span>
</span><a name="line-470"></a><span>    </span><span class="hs-comment">-- genreates (case data2Tag a of a# -&gt; case data2Tag b of b# -&gt; a# `op` b#</span><span>
</span><a name="line-471"></a><span>    </span><a name="local-1628017622"><a href="#local-1628017622"><span class="hs-identifier">mkTagCmp</span></a></a><span> </span><a name="local-1628017638"><a href="#local-1628017638"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-472"></a><span>                  </span><a href="TcGenDeriv.html#unliftedOrdOp"><span class="hs-identifier hs-var">unliftedOrdOp</span></a><span> </span><a href="#local-1628017605"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span> </span><a href="#local-1628017638"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-identifier">mkCompareFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- Generates nested comparisons for (a1,a2...) against (b1,b2,...)</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- where the ai,bi have the given types</span><span>
</span><a name="line-477"></a><a name="mkCompareFields"><a href="TcGenDeriv.html#mkCompareFields"><span class="hs-identifier">mkCompareFields</span></a></a><span> </span><a name="local-1628017639"><a href="#local-1628017639"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628017640"><a href="#local-1628017640"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628017641"><a href="#local-1628017641"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-478"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017642"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017641"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-479"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-480"></a><span>    </span><a name="local-1628017642"><a href="#local-1628017642"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#eqResult"><span class="hs-identifier hs-var">eqResult</span></a><span> </span><a href="#local-1628017640"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-481"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><a name="local-1628017644"><a href="#local-1628017644"><span class="hs-identifier">ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a name="local-1628017645"><a href="#local-1628017645"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a name="local-1628017646"><a href="#local-1628017646"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628017644"><span class="hs-identifier hs-var">ty</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#unliftedOrdOp"><span class="hs-identifier hs-var">unliftedOrdOp</span></a><span> </span><a href="#local-1628017639"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017644"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628017640"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628017645"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1628017646"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-483"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017645"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ordMethRdr"><span class="hs-identifier hs-var">ordMethRdr</span></a><span> </span><a href="#local-1628017640"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017646"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1628017647"><a href="#local-1628017647"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><a name="local-1628017648"><a href="#local-1628017648"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1628017649"><a href="#local-1628017649"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1628017651"><a href="#local-1628017651"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-1628017652"><a href="#local-1628017652"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017643"><span class="hs-identifier hs-var">mk_compare</span></a><span> </span><a href="#local-1628017647"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628017649"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1628017651"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-485"></a><span>                                  </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltResult"><span class="hs-identifier hs-var">ltResult</span></a><span> </span><a href="#local-1628017640"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>                                  </span><span class="hs-special">(</span><a href="#local-1628017642"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017648"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-1628017652"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>                                  </span><span class="hs-special">(</span><a href="TcGenDeriv.html#gtResult"><span class="hs-identifier hs-var">gtResult</span></a><span> </span><a href="#local-1628017640"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-488"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkCompareFields&quot;</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span>    </span><span class="hs-comment">-- (mk_compare ty a b) generates</span><span>
</span><a name="line-491"></a><span>    </span><span class="hs-comment">--    (case (compare a b) of { LT -&gt; &lt;lt&gt;; EQ -&gt; &lt;eq&gt;; GT -&gt; &lt;bt&gt; })</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-comment">-- but with suitable special cases for</span><span>
</span><a name="line-493"></a><span>    </span><a name="local-1628017643"><a href="#local-1628017643"><span class="hs-identifier">mk_compare</span></a></a><span> </span><a name="local-1628017653"><a href="#local-1628017653"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628017654"><a href="#local-1628017654"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017655"><a href="#local-1628017655"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1628017656"><a href="#local-1628017656"><span class="hs-identifier">lt</span></a></a><span> </span><a name="local-1628017657"><a href="#local-1628017657"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-1628017658"><a href="#local-1628017658"><span class="hs-identifier">gt</span></a></a><span>
</span><a name="line-494"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628017653"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-495"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#unliftedCompare"><span class="hs-identifier hs-var">unliftedCompare</span></a><span> </span><a href="#local-1628017661"><span class="hs-identifier hs-var">lt_op</span></a><span> </span><a href="#local-1628017662"><span class="hs-identifier hs-var">eq_op</span></a><span> </span><a href="#local-1628017659"><span class="hs-identifier hs-var">a_expr</span></a><span> </span><a href="#local-1628017660"><span class="hs-identifier hs-var">b_expr</span></a><span> </span><a href="#local-1628017656"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-1628017657"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-1628017658"><span class="hs-identifier hs-var">gt</span></a><span>
</span><a name="line-496"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-497"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#compare_RDR"><span class="hs-identifier hs-var">compare_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017659"><span class="hs-identifier hs-var">a_expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017660"><span class="hs-identifier hs-var">b_expr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>          </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a><span> </span><a href="PrelNames.html#ltTag_RDR"><span class="hs-identifier hs-var">ltTag_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017656"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span>
</span><a name="line-499"></a><span>           </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a><span> </span><a href="PrelNames.html#eqTag_RDR"><span class="hs-identifier hs-var">eqTag_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017657"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">,</span><span>
</span><a name="line-500"></a><span>           </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a><span> </span><a href="PrelNames.html#gtTag_RDR"><span class="hs-identifier hs-var">gtTag_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017658"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">]</span><span>
</span><a name="line-501"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-502"></a><span>        </span><a name="local-1628017659"><a href="#local-1628017659"><span class="hs-identifier">a_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017654"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-503"></a><span>        </span><a name="local-1628017660"><a href="#local-1628017660"><span class="hs-identifier">b_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017655"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-504"></a><span>        </span><span class="hs-special">(</span><a name="local-1628017661"><a href="#local-1628017661"><span class="hs-identifier">lt_op</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628017662"><a href="#local-1628017662"><span class="hs-identifier">eq_op</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#primOrdOps"><span class="hs-identifier hs-var">primOrdOps</span></a><span> </span><span class="hs-string">&quot;Ord&quot;</span><span> </span><a href="#local-1628017639"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017653"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-identifier">unliftedOrdOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#OrdOp"><span class="hs-identifier hs-type">OrdOp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-507"></a><a name="unliftedOrdOp"><a href="TcGenDeriv.html#unliftedOrdOp"><span class="hs-identifier">unliftedOrdOp</span></a></a><span> </span><a name="local-1628017663"><a href="#local-1628017663"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628017664"><a href="#local-1628017664"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628017665"><a href="#local-1628017665"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628017666"><a href="#local-1628017666"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017667"><a href="#local-1628017667"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-508"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628017665"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-509"></a><span>       </span><a href="TcGenDeriv.html#OrdCompare"><span class="hs-identifier hs-var">OrdCompare</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#unliftedCompare"><span class="hs-identifier hs-var">unliftedCompare</span></a><span> </span><a href="#local-1628017668"><span class="hs-identifier hs-var">lt_op</span></a><span> </span><a href="#local-1628017670"><span class="hs-identifier hs-var">eq_op</span></a><span> </span><a href="#local-1628017674"><span class="hs-identifier hs-var">a_expr</span></a><span> </span><a href="#local-1628017675"><span class="hs-identifier hs-var">b_expr</span></a><span>
</span><a name="line-510"></a><span>                                     </span><a href="TcGenDeriv.html#ltTag_Expr"><span class="hs-identifier hs-var">ltTag_Expr</span></a><span> </span><a href="TcGenDeriv.html#eqTag_Expr"><span class="hs-identifier hs-var">eqTag_Expr</span></a><span> </span><a href="TcGenDeriv.html#gtTag_Expr"><span class="hs-identifier hs-var">gtTag_Expr</span></a><span>
</span><a name="line-511"></a><span>       </span><a href="TcGenDeriv.html#OrdLT"><span class="hs-identifier hs-var">OrdLT</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017673"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-1628017668"><span class="hs-identifier hs-var">lt_op</span></a><span>
</span><a name="line-512"></a><span>       </span><a href="TcGenDeriv.html#OrdLE"><span class="hs-identifier hs-var">OrdLE</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017673"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-1628017669"><span class="hs-identifier hs-var">le_op</span></a><span>
</span><a name="line-513"></a><span>       </span><a href="TcGenDeriv.html#OrdGE"><span class="hs-identifier hs-var">OrdGE</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017673"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-1628017671"><span class="hs-identifier hs-var">ge_op</span></a><span>
</span><a name="line-514"></a><span>       </span><a href="TcGenDeriv.html#OrdGT"><span class="hs-identifier hs-var">OrdGT</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017673"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-1628017672"><span class="hs-identifier hs-var">gt_op</span></a><span>
</span><a name="line-515"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-516"></a><span>   </span><span class="hs-special">(</span><a name="local-1628017668"><a href="#local-1628017668"><span class="hs-identifier">lt_op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017669"><a href="#local-1628017669"><span class="hs-identifier">le_op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017670"><a href="#local-1628017670"><span class="hs-identifier">eq_op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017671"><a href="#local-1628017671"><span class="hs-identifier">ge_op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017672"><a href="#local-1628017672"><span class="hs-identifier">gt_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#primOrdOps"><span class="hs-identifier hs-var">primOrdOps</span></a><span> </span><span class="hs-string">&quot;Ord&quot;</span><span> </span><a href="#local-1628017663"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017664"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-517"></a><span>   </span><a name="local-1628017673"><a href="#local-1628017673"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-1628017676"><a href="#local-1628017676"><span class="hs-identifier">prim_op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><a href="#local-1628017674"><span class="hs-identifier hs-var">a_expr</span></a><span> </span><a href="#local-1628017676"><span class="hs-identifier hs-var">prim_op</span></a><span> </span><a href="#local-1628017675"><span class="hs-identifier hs-var">b_expr</span></a><span>
</span><a name="line-518"></a><span>   </span><a name="local-1628017674"><a href="#local-1628017674"><span class="hs-identifier">a_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017666"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-519"></a><span>   </span><a name="local-1628017675"><a href="#local-1628017675"><span class="hs-identifier">b_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017667"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">unliftedCompare</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-522"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>   </span><span class="hs-comment">-- What to cmpare</span><span>
</span><a name="line-523"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>  </span><span class="hs-comment">-- Three results</span><span>
</span><a name="line-524"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-525"></a><span class="hs-comment">-- Return (if a &lt; b then lt else if a == b then eq else gt)</span><span>
</span><a name="line-526"></a><a name="unliftedCompare"><a href="TcGenDeriv.html#unliftedCompare"><span class="hs-identifier">unliftedCompare</span></a></a><span> </span><a name="local-1628017677"><a href="#local-1628017677"><span class="hs-identifier">lt_op</span></a></a><span> </span><a name="local-1628017678"><a href="#local-1628017678"><span class="hs-identifier">eq_op</span></a></a><span> </span><a name="local-1628017679"><a href="#local-1628017679"><span class="hs-identifier">a_expr</span></a></a><span> </span><a name="local-1628017680"><a href="#local-1628017680"><span class="hs-identifier">b_expr</span></a></a><span> </span><a name="local-1628017681"><a href="#local-1628017681"><span class="hs-identifier">lt</span></a></a><span> </span><a name="local-1628017682"><a href="#local-1628017682"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-1628017683"><a href="#local-1628017683"><span class="hs-identifier">gt</span></a></a><span>
</span><a name="line-527"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><a href="#local-1628017679"><span class="hs-identifier hs-var">a_expr</span></a><span> </span><a href="#local-1628017677"><span class="hs-identifier hs-var">lt_op</span></a><span> </span><a href="#local-1628017680"><span class="hs-identifier hs-var">b_expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017681"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-528"></a><span>                        </span><span class="hs-comment">-- Test (&lt;) first, not (==), because the latter</span><span>
</span><a name="line-529"></a><span>                        </span><span class="hs-comment">-- is true less often, so putting it first would</span><span>
</span><a name="line-530"></a><span>                        </span><span class="hs-comment">-- mean more tests (dynamically)</span><span>
</span><a name="line-531"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><a href="#local-1628017679"><span class="hs-identifier hs-var">a_expr</span></a><span> </span><a href="#local-1628017678"><span class="hs-identifier hs-var">eq_op</span></a><span> </span><a href="#local-1628017680"><span class="hs-identifier hs-var">b_expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017682"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-1628017683"><span class="hs-identifier hs-var">gt</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">nlConWildPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-534"></a><span class="hs-comment">-- The pattern (K {})</span><span>
</span><a name="line-535"></a><a name="nlConWildPat"><a href="TcGenDeriv.html#nlConWildPat"><span class="hs-identifier">nlConWildPat</span></a></a><span> </span><a name="local-1628017684"><a href="#local-1628017684"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017684"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-536"></a><span>                                   </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-537"></a><span>                                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rec_dotdot</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Enum instances
*                                                                      *
************************************************************************

@Enum@ can only be derived for enumeration types.  For a type
\begin{verbatim}
data Foo ... = N1 | N2 | ... | Nn
\end{verbatim}

we use both @con2tag_Foo@ and @tag2con_Foo@ functions, as well as a
@maxtag_Foo@ variable (all generated by @gen_tag_n_con_binds@).

\begin{verbatim}
instance ... Enum (Foo ...) where
    succ x   = toEnum (1 + fromEnum x)
    pred x   = toEnum (fromEnum x - 1)

    toEnum i = tag2con_Foo i

    enumFrom a = map tag2con_Foo [con2tag_Foo a .. maxtag_Foo]

    -- or, really...
    enumFrom a
      = case con2tag_Foo a of
          a# -&gt; map tag2con_Foo (enumFromTo (I# a#) maxtag_Foo)

   enumFromThen a b
     = map tag2con_Foo [con2tag_Foo a, con2tag_Foo b .. maxtag_Foo]

    -- or, really...
    enumFromThen a b
      = case con2tag_Foo a of { a# -&gt;
        case con2tag_Foo b of { b# -&gt;
        map tag2con_Foo (enumFromThenTo (I# a#) (I# b#) maxtag_Foo)
        }}
\end{verbatim}

For @enumFromTo@ and @enumFromThenTo@, we use the default methods.
-}</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-identifier">gen_Enum_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-583"></a><a name="gen_Enum_binds"><a href="TcGenDeriv.html#gen_Enum_binds"><span class="hs-identifier">gen_Enum_binds</span></a></a><span> </span><a name="local-1628017685"><a href="#local-1628017685"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017686"><a href="#local-1628017686"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-584"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017687"><span class="hs-identifier hs-var">method_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017688"><span class="hs-identifier hs-var">aux_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-586"></a><span>    </span><a name="local-1628017687"><a href="#local-1628017687"><span class="hs-identifier">method_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-587"></a><span>                        </span><a href="#local-1628017690"><span class="hs-identifier hs-var">succ_enum</span></a><span class="hs-special">,</span><span>
</span><a name="line-588"></a><span>                        </span><a href="#local-1628017691"><span class="hs-identifier hs-var">pred_enum</span></a><span class="hs-special">,</span><span>
</span><a name="line-589"></a><span>                        </span><a href="#local-1628017692"><span class="hs-identifier hs-var">to_enum</span></a><span class="hs-special">,</span><span>
</span><a name="line-590"></a><span>                        </span><a href="#local-1628017693"><span class="hs-identifier hs-var">enum_from</span></a><span class="hs-special">,</span><span>
</span><a name="line-591"></a><span>                        </span><a href="#local-1628017694"><span class="hs-identifier hs-var">enum_from_then</span></a><span class="hs-special">,</span><span>
</span><a name="line-592"></a><span>                        </span><a href="#local-1628017695"><span class="hs-identifier hs-var">from_enum</span></a><span>
</span><a name="line-593"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-594"></a><span>    </span><a name="local-1628017688"><a href="#local-1628017688"><span class="hs-identifier">aux_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span>
</span><a name="line-595"></a><span>                  </span><span class="hs-special">[</span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#DerivTag2Con"><span class="hs-identifier hs-var">DerivTag2Con</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#DerivMaxTag"><span class="hs-identifier hs-var">DerivMaxTag</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">]</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span>    </span><a name="local-1628017689"><a href="#local-1628017689"><span class="hs-identifier">occ_nm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getOccString"><span class="hs-identifier hs-var">getOccString</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span>    </span><a name="local-1628017690"><a href="#local-1628017690"><span class="hs-identifier">succ_enum</span></a></a><span>
</span><a name="line-600"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#succ_RDR"><span class="hs-identifier hs-var">succ_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-601"></a><span>        </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-602"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#eq_RDR"><span class="hs-identifier hs-var">eq_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-603"></a><span>                               </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>             </span><span class="hs-special">(</span><a href="TcGenDeriv.html#illegal_Expr"><span class="hs-identifier hs-var">illegal_Expr</span></a><span> </span><span class="hs-string">&quot;succ&quot;</span><span> </span><a href="#local-1628017689"><span class="hs-identifier hs-var">occ_nm</span></a><span> </span><span class="hs-string">&quot;tried to take `succ' of last tag in enumeration&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>             </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-606"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#plus_RDR"><span class="hs-identifier hs-var">plus_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-607"></a><span>                                        </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span>    </span><a name="local-1628017691"><a href="#local-1628017691"><span class="hs-identifier">pred_enum</span></a></a><span>
</span><a name="line-610"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#pred_RDR"><span class="hs-identifier hs-var">pred_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-611"></a><span>        </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-612"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#eq_RDR"><span class="hs-identifier hs-var">eq_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-613"></a><span>                               </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>             </span><span class="hs-special">(</span><a href="TcGenDeriv.html#illegal_Expr"><span class="hs-identifier hs-var">illegal_Expr</span></a><span> </span><span class="hs-string">&quot;pred&quot;</span><span> </span><a href="#local-1628017689"><span class="hs-identifier hs-var">occ_nm</span></a><span> </span><span class="hs-string">&quot;tried to take `pred' of first tag in enumeration&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>             </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#plus_RDR"><span class="hs-identifier hs-var">plus_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-617"></a><span>                                               </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><span class="hs-string">&quot;-1&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span>    </span><a name="local-1628017692"><a href="#local-1628017692"><span class="hs-identifier">to_enum</span></a></a><span>
</span><a name="line-620"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#toEnum_RDR"><span class="hs-identifier hs-var">toEnum_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-621"></a><span>        </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#and_RDR"><span class="hs-identifier hs-var">and_RDR</span></a><span>
</span><a name="line-622"></a><span>                </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#ge_RDR"><span class="hs-identifier hs-var">ge_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-623"></a><span>                 </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#le_RDR"><span class="hs-identifier hs-var">le_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>             </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>             </span><span class="hs-special">(</span><a href="TcGenDeriv.html#illegal_toEnum_tag"><span class="hs-identifier hs-var">illegal_toEnum_tag</span></a><span> </span><a href="#local-1628017689"><span class="hs-identifier hs-var">occ_nm</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span>    </span><a name="local-1628017693"><a href="#local-1628017693"><span class="hs-identifier">enum_from</span></a></a><span>
</span><a name="line-628"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#enumFrom_RDR"><span class="hs-identifier hs-var">enumFrom_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-629"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-630"></a><span>          </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#map_RDR"><span class="hs-identifier hs-var">map_RDR</span></a><span>
</span><a name="line-631"></a><span>                </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-632"></a><span>                 </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#enum_from_to_Expr"><span class="hs-identifier hs-var">enum_from_to_Expr</span></a><span>
</span><a name="line-633"></a><span>                            </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>                            </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span>    </span><a name="local-1628017694"><a href="#local-1628017694"><span class="hs-identifier">enum_from_then</span></a></a><span>
</span><a name="line-637"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#enumFromThen_RDR"><span class="hs-identifier hs-var">enumFromThen_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-638"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-639"></a><span>          </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="PrelNames.html#map_RDR"><span class="hs-identifier hs-var">map_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-640"></a><span>            </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#enum_from_then_to_Expr"><span class="hs-identifier hs-var">enum_from_then_to_Expr</span></a><span>
</span><a name="line-641"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span>  </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#gt_RDR"><span class="hs-identifier hs-var">gt_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-644"></a><span>                                               </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>                           </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span>    </span><a name="local-1628017695"><a href="#local-1628017695"><span class="hs-identifier">from_enum</span></a></a><span>
</span><a name="line-650"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017685"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#fromEnum_RDR"><span class="hs-identifier hs-var">fromEnum_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-651"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017686"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-652"></a><span>          </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Bounded instances
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-identifier">gen_Bounded_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><a name="gen_Bounded_binds"><a href="TcGenDeriv.html#gen_Bounded_binds"><span class="hs-identifier">gen_Bounded_binds</span></a></a><span> </span><a name="local-1628017696"><a href="#local-1628017696"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017697"><a href="#local-1628017697"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-664"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isEnumerationTyCon"><span class="hs-identifier hs-var">isEnumerationTyCon</span></a><span> </span><a href="#local-1628017697"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-665"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017699"><span class="hs-identifier hs-var">min_bound_enum</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017700"><span class="hs-identifier hs-var">max_bound_enum</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-667"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">isSingleton</span><span> </span><span class="hs-identifier">data_cons</span><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>    </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017706"><span class="hs-identifier hs-var">min_bound_1con</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017707"><span class="hs-identifier hs-var">max_bound_1con</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-670"></a><span>    </span><a name="local-1628017698"><a href="#local-1628017698"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017697"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span>    </span><span class="hs-comment">----- enum-flavored: ---------------------------</span><span>
</span><a name="line-673"></a><span>    </span><a name="local-1628017699"><a href="#local-1628017699"><span class="hs-identifier">min_bound_enum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017696"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#minBound_RDR"><span class="hs-identifier hs-var">minBound_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017703"><span class="hs-identifier hs-var">data_con_1_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>    </span><a name="local-1628017700"><a href="#local-1628017700"><span class="hs-identifier">max_bound_enum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017696"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#maxBound_RDR"><span class="hs-identifier hs-var">maxBound_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017704"><span class="hs-identifier hs-var">data_con_N_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span>    </span><a name="local-1628017701"><a href="#local-1628017701"><span class="hs-identifier">data_con_1</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628017698"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-677"></a><span>    </span><a name="local-1628017702"><a href="#local-1628017702"><span class="hs-identifier">data_con_N</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span> </span><a href="#local-1628017698"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-678"></a><span>    </span><a name="local-1628017703"><a href="#local-1628017703"><span class="hs-identifier">data_con_1_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017701"><span class="hs-identifier hs-var">data_con_1</span></a><span>
</span><a name="line-679"></a><span>    </span><a name="local-1628017704"><a href="#local-1628017704"><span class="hs-identifier">data_con_N_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017702"><span class="hs-identifier hs-var">data_con_N</span></a><span>
</span><a name="line-680"></a><span>
</span><a name="line-681"></a><span>    </span><span class="hs-comment">----- single-constructor-flavored: -------------</span><span>
</span><a name="line-682"></a><span>    </span><a name="local-1628017705"><a href="#local-1628017705"><span class="hs-identifier">arity</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017701"><span class="hs-identifier hs-var">data_con_1</span></a><span>
</span><a name="line-683"></a><span>
</span><a name="line-684"></a><span>    </span><a name="local-1628017706"><a href="#local-1628017706"><span class="hs-identifier">min_bound_1con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017696"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#minBound_RDR"><span class="hs-identifier hs-var">minBound_RDR</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-685"></a><span>                     </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="#local-1628017703"><span class="hs-identifier hs-var">data_con_1_RDR</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#nOfThem"><span class="hs-identifier hs-var">nOfThem</span></a><span> </span><a href="#local-1628017705"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="PrelNames.html#minBound_RDR"><span class="hs-identifier hs-var">minBound_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>    </span><a name="local-1628017707"><a href="#local-1628017707"><span class="hs-identifier">max_bound_1con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017696"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#maxBound_RDR"><span class="hs-identifier hs-var">maxBound_RDR</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-687"></a><span>                     </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="#local-1628017703"><span class="hs-identifier hs-var">data_con_1_RDR</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#nOfThem"><span class="hs-identifier hs-var">nOfThem</span></a><span> </span><a href="#local-1628017705"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="PrelNames.html#maxBound_RDR"><span class="hs-identifier hs-var">maxBound_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>
</span><a name="line-689"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Ix instances
*                                                                      *
************************************************************************

Deriving @Ix@ is only possible for enumeration types and
single-constructor types.  We deal with them in turn.

For an enumeration type, e.g.,
\begin{verbatim}
    data Foo ... = N1 | N2 | ... | Nn
\end{verbatim}
things go not too differently from @Enum@:
\begin{verbatim}
instance ... Ix (Foo ...) where
    range (a, b)
      = map tag2con_Foo [con2tag_Foo a .. con2tag_Foo b]

    -- or, really...
    range (a, b)
      = case (con2tag_Foo a) of { a# -&gt;
        case (con2tag_Foo b) of { b# -&gt;
        map tag2con_Foo (enumFromTo (I# a#) (I# b#))
        }}

    -- Generate code for unsafeIndex, because using index leads
    -- to lots of redundant range tests
    unsafeIndex c@(a, b) d
      = case (con2tag_Foo d -# con2tag_Foo a) of
               r# -&gt; I# r#

    inRange (a, b) c
      = let
            p_tag = con2tag_Foo c
        in
        p_tag &gt;= con2tag_Foo a &amp;&amp; p_tag &lt;= con2tag_Foo b

    -- or, really...
    inRange (a, b) c
      = case (con2tag_Foo a)   of { a_tag -&gt;
        case (con2tag_Foo b)   of { b_tag -&gt;
        case (con2tag_Foo c)   of { c_tag -&gt;
        if (c_tag &gt;=# a_tag) then
          c_tag &lt;=# b_tag
        else
          False
        }}}
\end{verbatim}
(modulo suitable case-ification to handle the unlifted tags)

For a single-constructor type (NB: this includes all tuples), e.g.,
\begin{verbatim}
    data Foo ... = MkFoo a b Int Double c c
\end{verbatim}
we follow the scheme given in Figure~19 of the Haskell~1.2 report
(p.~147).
-}</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-identifier">gen_Ix_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><a name="gen_Ix_binds"><a href="TcGenDeriv.html#gen_Ix_binds"><span class="hs-identifier">gen_Ix_binds</span></a></a><span> </span><a name="local-1628017708"><a href="#local-1628017708"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017709"><a href="#local-1628017709"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-752"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isEnumerationTyCon"><span class="hs-identifier hs-var">isEnumerationTyCon</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-753"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1628017710"><span class="hs-identifier hs-var">enum_ixes</span></a><span>
</span><a name="line-754"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span>
</span><a name="line-755"></a><span>                   </span><span class="hs-special">[</span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#DerivTag2Con"><span class="hs-identifier hs-var">DerivTag2Con</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#DerivMaxTag"><span class="hs-identifier hs-var">DerivMaxTag</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-756"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017714"><span class="hs-identifier hs-var">single_con_ixes</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-759"></a><span>    </span><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-760"></a><span>    </span><a name="local-1628017710"><a href="#local-1628017710"><span class="hs-identifier">enum_ixes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017711"><span class="hs-identifier hs-var">enum_range</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017712"><span class="hs-identifier hs-var">enum_index</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017713"><span class="hs-identifier hs-var">enum_inRange</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span>    </span><a name="local-1628017711"><a href="#local-1628017711"><span class="hs-identifier">enum_range</span></a></a><span>
</span><a name="line-763"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#range_RDR"><span class="hs-identifier hs-var">range_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-764"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-765"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-766"></a><span>          </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="PrelNames.html#map_RDR"><span class="hs-identifier hs-var">map_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-767"></a><span>              </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#enum_from_to_Expr"><span class="hs-identifier hs-var">enum_from_to_Expr</span></a><span>
</span><a name="line-768"></a><span>                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span>    </span><a name="local-1628017712"><a href="#local-1628017712"><span class="hs-identifier">enum_index</span></a></a><span>
</span><a name="line-772"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#unsafeIndex_RDR"><span class="hs-identifier hs-var">unsafeIndex_RDR</span></a><span>
</span><a name="line-773"></a><span>                </span><span class="hs-special">[</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-775"></a><span>                                </span><a href="TcGenDeriv.html#d_Pat"><span class="hs-identifier hs-var">d_Pat</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-776"></a><span>           </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-777"></a><span>           </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#d_RDR"><span class="hs-identifier hs-var">d_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#dh_RDR"><span class="hs-identifier hs-var">dh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-778"></a><span>           </span><span class="hs-keyword">let</span><span>
</span><a name="line-779"></a><span>                </span><a name="local-1628017726"><a href="#local-1628017726"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span class="hs-special">]</span><span>
</span><a name="line-780"></a><span>           </span><span class="hs-keyword">in</span><span>
</span><a name="line-781"></a><span>           </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span>
</span><a name="line-782"></a><span>             </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#dh_RDR"><span class="hs-identifier hs-var">dh_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#minusInt_RDR"><span class="hs-identifier hs-var">minusInt_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-783"></a><span>             </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017726"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-784"></a><span>           </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-785"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span>    </span><span class="hs-comment">-- This produces something like `(ch &gt;= ah) &amp;&amp; (ch &lt;= bh)`</span><span>
</span><a name="line-788"></a><span>    </span><a name="local-1628017713"><a href="#local-1628017713"><span class="hs-identifier">enum_inRange</span></a></a><span>
</span><a name="line-789"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#inRange_RDR"><span class="hs-identifier hs-var">inRange_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier hs-var">b_Pat</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#c_Pat"><span class="hs-identifier hs-var">c_Pat</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-790"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-791"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-792"></a><span>          </span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#ch_RDR"><span class="hs-identifier hs-var">ch_RDR</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-793"></a><span>          </span><span class="hs-comment">-- This used to use `if`, which interacts badly with RebindableSyntax.</span><span>
</span><a name="line-794"></a><span>          </span><span class="hs-comment">-- See #11396.</span><span>
</span><a name="line-795"></a><span>          </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#and_RDR"><span class="hs-identifier hs-var">and_RDR</span></a><span>
</span><a name="line-796"></a><span>              </span><span class="hs-special">[</span><span> </span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#ch_RDR"><span class="hs-identifier hs-var">ch_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#geInt_RDR"><span class="hs-identifier hs-var">geInt_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier hs-var">ah_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#ch_RDR"><span class="hs-identifier hs-var">ch_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#leInt_RDR"><span class="hs-identifier hs-var">leInt_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier hs-var">bh_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-798"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-799"></a><span>          </span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span>    </span><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-802"></a><span>    </span><a name="local-1628017714"><a href="#local-1628017714"><span class="hs-identifier">single_con_ixes</span></a></a><span>
</span><a name="line-803"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017723"><span class="hs-identifier hs-var">single_con_range</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017724"><span class="hs-identifier hs-var">single_con_index</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017725"><span class="hs-identifier hs-var">single_con_inRange</span></a><span class="hs-special">]</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span>    </span><a name="local-1628017715"><a href="#local-1628017715"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-806"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleDataCon_maybe</span></a><span> </span><a href="#local-1628017709"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- just checking...</span><span>
</span><a name="line-807"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;get_Ix_binds&quot;</span><span>
</span><a name="line-808"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628017727"><a href="#local-1628017727"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017727"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-809"></a><span>
</span><a name="line-810"></a><span>    </span><a name="local-1628017716"><a href="#local-1628017716"><span class="hs-identifier">con_arity</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017715"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-811"></a><span>    </span><a name="local-1628017717"><a href="#local-1628017717"><span class="hs-identifier">data_con_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017715"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span>    </span><a name="local-1628017718"><a href="#local-1628017718"><span class="hs-identifier">as_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017716"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-814"></a><span>    </span><a name="local-1628017719"><a href="#local-1628017719"><span class="hs-identifier">bs_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017716"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-815"></a><span>    </span><a name="local-1628017720"><a href="#local-1628017720"><span class="hs-identifier">cs_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017716"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#cs_RDRs"><span class="hs-identifier hs-var">cs_RDRs</span></a><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span>    </span><a name="local-1628017721"><a href="#local-1628017721"><span class="hs-identifier">con_pat</span></a></a><span>  </span><a name="local-1628017728"><a href="#local-1628017728"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017717"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017728"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-818"></a><span>    </span><a name="local-1628017722"><a href="#local-1628017722"><span class="hs-identifier">con_expr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="#local-1628017717"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span>
</span><a name="line-819"></a><span>
</span><a name="line-820"></a><span>    </span><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-821"></a><span>    </span><a name="local-1628017723"><a href="#local-1628017723"><span class="hs-identifier">single_con_range</span></a></a><span>
</span><a name="line-822"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#range_RDR"><span class="hs-identifier hs-var">range_RDR</span></a><span>
</span><a name="line-823"></a><span>          </span><span class="hs-special">[</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-824"></a><span>        </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsComp"><span class="hs-identifier hs-var">mkHsComp</span></a><span> </span><a href="HsExpr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a><span> </span><a href="#local-1628017729"><span class="hs-identifier hs-var">stmts</span></a><span> </span><a href="#local-1628017722"><span class="hs-identifier hs-var">con_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-826"></a><span>        </span><a name="local-1628017729"><a href="#local-1628017729"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#zipWith3Equal"><span class="hs-identifier hs-var">zipWith3Equal</span></a><span> </span><span class="hs-string">&quot;single_con_range&quot;</span><span> </span><a href="#local-1628017730"><span class="hs-identifier hs-var">mk_qual</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span>        </span><a name="local-1628017730"><a href="#local-1628017730"><span class="hs-identifier">mk_qual</span></a></a><span> </span><a name="local-1628017731"><a href="#local-1628017731"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017732"><a href="#local-1628017732"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1628017733"><a href="#local-1628017733"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier hs-var">mkBindStmt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628017733"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-829"></a><span>                                 </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#range_RDR"><span class="hs-identifier hs-var">range_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-830"></a><span>                                          </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017731"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1628017732"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>
</span><a name="line-832"></a><span>    </span><span class="hs-comment">----------------</span><span>
</span><a name="line-833"></a><span>    </span><a name="local-1628017724"><a href="#local-1628017724"><span class="hs-identifier">single_con_index</span></a></a><span>
</span><a name="line-834"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#unsafeIndex_RDR"><span class="hs-identifier hs-var">unsafeIndex_RDR</span></a><span>
</span><a name="line-835"></a><span>                </span><span class="hs-special">[</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">,</span><span>
</span><a name="line-836"></a><span>                 </span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span class="hs-special">]</span><span>
</span><a name="line-837"></a><span>        </span><span class="hs-comment">-- We need to reverse the order we consider the components in</span><span>
</span><a name="line-838"></a><span>        </span><span class="hs-comment">-- so that</span><span>
</span><a name="line-839"></a><span>        </span><span class="hs-comment">--     range (l,u) !! index (l,u) i == i   -- when i is in range</span><span>
</span><a name="line-840"></a><span>        </span><span class="hs-comment">-- (from http://haskell.org/onlinereport/ix.html) holds.</span><span>
</span><a name="line-841"></a><span>                </span><span class="hs-special">(</span><a href="#local-1628017734"><span class="hs-identifier hs-var">mk_index</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-842"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-843"></a><span>        </span><span class="hs-comment">-- index (l1,u1) i1 + rangeSize (l1,u1) * (index (l2,u2) i2 + ...)</span><span>
</span><a name="line-844"></a><span>        </span><a name="local-1628017734"><a href="#local-1628017734"><span class="hs-identifier">mk_index</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-845"></a><span>        </span><span class="hs-identifier">mk_index</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-1628017736"><a href="#local-1628017736"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-1628017737"><a href="#local-1628017737"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><a name="local-1628017738"><a href="#local-1628017738"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017735"><span class="hs-identifier hs-var">mk_one</span></a><span> </span><a href="#local-1628017736"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628017737"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1628017738"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-846"></a><span>        </span><span class="hs-identifier">mk_index</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1628017739"><a href="#local-1628017739"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-1628017740"><a href="#local-1628017740"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><a name="local-1628017741"><a href="#local-1628017741"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628017742"><a href="#local-1628017742"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-847"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-848"></a><span>                </span><a href="#local-1628017735"><span class="hs-identifier hs-var">mk_one</span></a><span> </span><a href="#local-1628017739"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628017740"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1628017741"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-849"></a><span>            </span><span class="hs-special">)</span><span> </span><a href="PrelNames.html#plus_RDR"><span class="hs-identifier hs-var">plus_RDR</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-850"></a><span>                </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-851"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#unsafeRangeSize_RDR"><span class="hs-identifier hs-var">unsafeRangeSize_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>                             </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017739"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-1628017740"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-853"></a><span>                </span><span class="hs-special">)</span><span> </span><a href="PrelNames.html#times_RDR"><span class="hs-identifier hs-var">times_RDR</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017734"><span class="hs-identifier hs-var">mk_index</span></a><span> </span><a href="#local-1628017742"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>           </span><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>        </span><a name="local-1628017735"><a href="#local-1628017735"><span class="hs-identifier">mk_one</span></a></a><span> </span><a name="local-1628017743"><a href="#local-1628017743"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628017744"><a href="#local-1628017744"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-1628017745"><a href="#local-1628017745"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-856"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#unsafeIndex_RDR"><span class="hs-identifier hs-var">unsafeIndex_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017743"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-1628017744"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017745"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span>    </span><span class="hs-comment">------------------</span><span>
</span><a name="line-859"></a><span>    </span><a name="local-1628017725"><a href="#local-1628017725"><span class="hs-identifier">single_con_inRange</span></a></a><span>
</span><a name="line-860"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017708"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#inRange_RDR"><span class="hs-identifier hs-var">inRange_RDR</span></a><span>
</span><a name="line-861"></a><span>                </span><span class="hs-special">[</span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span class="hs-special">,</span><span>
</span><a name="line-862"></a><span>                 </span><a href="#local-1628017721"><span class="hs-identifier hs-var">con_pat</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-863"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span> </span><a href="TcGenDeriv.html#and_Expr"><span class="hs-identifier hs-var">and_Expr</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#zipWith3Equal"><span class="hs-identifier hs-var">zipWith3Equal</span></a><span> </span><span class="hs-string">&quot;single_con_inRange&quot;</span><span> </span><a href="#local-1628017746"><span class="hs-identifier hs-var">in_range</span></a><span> </span><a href="#local-1628017718"><span class="hs-identifier hs-var">as_needed</span></a><span> </span><a href="#local-1628017719"><span class="hs-identifier hs-var">bs_needed</span></a><span> </span><a href="#local-1628017720"><span class="hs-identifier hs-var">cs_needed</span></a><span class="hs-special">)</span><span>
</span><a name="line-864"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-865"></a><span>        </span><a name="local-1628017746"><a href="#local-1628017746"><span class="hs-identifier">in_range</span></a></a><span> </span><a name="local-1628017747"><a href="#local-1628017747"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017748"><a href="#local-1628017748"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1628017749"><a href="#local-1628017749"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#inRange_RDR"><span class="hs-identifier hs-var">inRange_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017747"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1628017748"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017749"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Read instances
*                                                                      *
************************************************************************

Example

  infix 4 %%
  data T = Int %% Int
         | T1 { f1 :: Int }
         | T2 T

instance Read T where
  readPrec =
    parens
    ( prec 4 (
        do x &lt;- ReadP.step Read.readPrec
           expectP (Symbol &quot;%%&quot;)
           y &lt;- ReadP.step Read.readPrec
           return (x %% y))
      +++
      prec (appPrec+1) (
        -- Note the &quot;+1&quot; part; &quot;T2 T1 {f1=3}&quot; should parse ok
        -- Record construction binds even more tightly than application
        do expectP (Ident &quot;T1&quot;)
           expectP (Punc '{')
           expectP (Ident &quot;f1&quot;)
           expectP (Punc '=')
           x          &lt;- ReadP.reset Read.readPrec
           expectP (Punc '}')
           return (T1 { f1 = x }))
      +++
      prec appPrec (
        do expectP (Ident &quot;T2&quot;)
           x &lt;- ReadP.step Read.readPrec
           return (T2 x))
    )

  readListPrec = readListPrecDefault
  readList     = readListDefault


Note [Use expectP]
~~~~~~~~~~~~~~~~~~
Note that we use
   expectP (Ident &quot;T1&quot;)
rather than
   Ident &quot;T1&quot; &lt;- lexP
The latter desugares to inline code for matching the Ident and the
string, and this can be very voluminous. The former is much more
compact.  Cf Trac #7258, although that also concerned non-linearity in
the occurrence analyser, a separate issue.

Note [Read for empty data types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
What should we get for this?  (Trac #7931)
   data Emp deriving( Read )   -- No data constructors

Here we want
  read &quot;[]&quot; :: [Emp]   to succeed, returning []
So we do NOT want
   instance Read Emp where
     readPrec = error &quot;urk&quot;
Rather we want
   instance Read Emp where
     readPred = pfail   -- Same as choose []

Because 'pfail' allows the parser to backtrack, but 'error' doesn't.
These instances are also useful for Read (Either Int Emp), where
we want to be able to parse (Left 3) just fine.
-}</span><span>
</span><a name="line-940"></a><span>
</span><a name="line-941"></a><span class="hs-identifier">gen_Read_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>
</span><a name="line-943"></a><a name="gen_Read_binds"><a href="TcGenDeriv.html#gen_Read_binds"><span class="hs-identifier">gen_Read_binds</span></a></a><span> </span><a name="local-1628017750"><a href="#local-1628017750"><span class="hs-identifier">get_fixity</span></a></a><span> </span><a name="local-1628017751"><a href="#local-1628017751"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017752"><a href="#local-1628017752"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-944"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017758"><span class="hs-identifier hs-var">read_prec</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017753"><span class="hs-identifier hs-var">default_readlist</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017754"><span class="hs-identifier hs-var">default_readlistprec</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-946"></a><span>    </span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-947"></a><span>    </span><a name="local-1628017753"><a href="#local-1628017753"><span class="hs-identifier">default_readlist</span></a></a><span>
</span><a name="line-948"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017751"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#readList_RDR"><span class="hs-identifier hs-var">readList_RDR</span></a><span>     </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#readListDefault_RDR"><span class="hs-identifier hs-var">readListDefault_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>
</span><a name="line-950"></a><span>    </span><a name="local-1628017754"><a href="#local-1628017754"><span class="hs-identifier">default_readlistprec</span></a></a><span>
</span><a name="line-951"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017751"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#readListPrec_RDR"><span class="hs-identifier hs-var">readListPrec_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#readListPrecDefault_RDR"><span class="hs-identifier hs-var">readListPrecDefault_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>    </span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-953"></a><span>
</span><a name="line-954"></a><span>    </span><a name="local-1628017755"><a href="#local-1628017755"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017752"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-955"></a><span>    </span><span class="hs-special">(</span><a name="local-1628017756"><a href="#local-1628017756"><span class="hs-identifier">nullary_cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628017757"><a href="#local-1628017757"><span class="hs-identifier">non_nullary_cons</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="DataCon.html#isNullarySrcDataCon"><span class="hs-identifier hs-var">isNullarySrcDataCon</span></a><span> </span><a href="#local-1628017755"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span>    </span><a name="local-1628017758"><a href="#local-1628017758"><span class="hs-identifier">read_prec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017751"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#readPrec_RDR"><span class="hs-identifier hs-var">readPrec_RDR</span></a><span>
</span><a name="line-958"></a><span>                              </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#parens_RDR"><span class="hs-identifier hs-var">parens_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017759"><span class="hs-identifier hs-var">read_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span>
</span><a name="line-960"></a><span>    </span><a name="local-1628017759"><a href="#local-1628017759"><span class="hs-identifier">read_cons</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017755"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#pfail_RDR"><span class="hs-identifier hs-var">pfail_RDR</span></a><span>  </span><span class="hs-comment">-- See Note [Read for empty data types]</span><span>
</span><a name="line-961"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span> </span><a href="#local-1628017765"><span class="hs-identifier hs-var">mk_alt</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017761"><span class="hs-identifier hs-var">read_nullary_cons</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017760"><span class="hs-identifier hs-var">read_non_nullary_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span>    </span><a name="local-1628017760"><a href="#local-1628017760"><span class="hs-identifier">read_non_nullary_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017764"><span class="hs-identifier hs-var">read_non_nullary_con</span></a><span> </span><a href="#local-1628017757"><span class="hs-identifier hs-var">non_nullary_cons</span></a><span>
</span><a name="line-963"></a><span>
</span><a name="line-964"></a><span>    </span><a name="local-1628017761"><a href="#local-1628017761"><span class="hs-identifier">read_nullary_cons</span></a></a><span>
</span><a name="line-965"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628017756"><span class="hs-identifier hs-var">nullary_cons</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-966"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-967"></a><span>            </span><span class="hs-special">[</span><a name="local-1628017778"><a href="#local-1628017778"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsDo"><span class="hs-identifier hs-var">nlHsDo</span></a><span> </span><a href="HsExpr.html#DoExpr"><span class="hs-identifier hs-var">DoExpr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017762"><span class="hs-identifier hs-var">match_con</span></a><span> </span><a href="#local-1628017778"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017768"><span class="hs-identifier hs-var">result_expr</span></a><span> </span><a href="#local-1628017778"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-968"></a><span>            </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#choose_RDR"><span class="hs-identifier hs-var">choose_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-969"></a><span>                              </span><span class="hs-special">(</span><a href="HsUtils.html#nlList"><span class="hs-identifier hs-var">nlList</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017763"><span class="hs-identifier hs-var">mk_pair</span></a><span> </span><a href="#local-1628017756"><span class="hs-identifier hs-var">nullary_cons</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-970"></a><span>        </span><span class="hs-comment">-- NB For operators the parens around (:=:) are matched by the</span><span>
</span><a name="line-971"></a><span>        </span><span class="hs-comment">-- enclosing &quot;parens&quot; call, so here we must match the naked</span><span>
</span><a name="line-972"></a><span>        </span><span class="hs-comment">-- data_con_str con</span><span>
</span><a name="line-973"></a><span>
</span><a name="line-974"></a><span>    </span><a name="local-1628017762"><a href="#local-1628017762"><span class="hs-identifier">match_con</span></a></a><span> </span><a name="local-1628017779"><a href="#local-1628017779"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017780"><span class="hs-identifier hs-var">con_str</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017772"><span class="hs-identifier hs-var">symbol_pat</span></a><span> </span><a href="#local-1628017780"><span class="hs-identifier hs-var">con_str</span></a><span class="hs-special">]</span><span>
</span><a name="line-975"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017769"><span class="hs-identifier hs-var">ident_h_pat</span></a><span>  </span><a href="#local-1628017780"><span class="hs-identifier hs-var">con_str</span></a><span>
</span><a name="line-976"></a><span>                  </span><span class="hs-keyword">where</span><span>
</span><a name="line-977"></a><span>                    </span><a name="local-1628017780"><a href="#local-1628017780"><span class="hs-identifier">con_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017774"><span class="hs-identifier hs-var">data_con_str</span></a><span> </span><a href="#local-1628017779"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-978"></a><span>        </span><span class="hs-comment">-- For nullary constructors we must match Ident s for normal constrs</span><span>
</span><a name="line-979"></a><span>        </span><span class="hs-comment">-- and   Symbol s   for operators</span><span>
</span><a name="line-980"></a><span>
</span><a name="line-981"></a><span>    </span><a name="local-1628017763"><a href="#local-1628017763"><span class="hs-identifier">mk_pair</span></a></a><span> </span><a name="local-1628017781"><a href="#local-1628017781"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017774"><span class="hs-identifier hs-var">data_con_str</span></a><span> </span><a href="#local-1628017781"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-982"></a><span>                                  </span><a href="#local-1628017768"><span class="hs-identifier hs-var">result_expr</span></a><span> </span><a href="#local-1628017781"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-983"></a><span>
</span><a name="line-984"></a><span>    </span><a name="local-1628017764"><a href="#local-1628017764"><span class="hs-identifier">read_non_nullary_con</span></a></a><span> </span><a name="local-1628017782"><a href="#local-1628017782"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-985"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017795"><span class="hs-identifier hs-var">is_infix</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017766"><span class="hs-identifier hs-var">mk_parser</span></a><span> </span><a href="#local-1628017802"><span class="hs-identifier hs-var">infix_prec</span></a><span>  </span><a href="#local-1628017789"><span class="hs-identifier hs-var">infix_stmts</span></a><span>  </span><a href="#local-1628017783"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-986"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017796"><span class="hs-identifier hs-var">is_record</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017766"><span class="hs-identifier hs-var">mk_parser</span></a><span> </span><a href="#local-1628017803"><span class="hs-identifier hs-var">record_prec</span></a><span> </span><a href="#local-1628017790"><span class="hs-identifier hs-var">record_stmts</span></a><span> </span><a href="#local-1628017783"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-987"></a><span class="hs-comment">--              Using these two lines instead allows the derived</span><span>
</span><a name="line-988"></a><span class="hs-comment">--              read for infix and record bindings to read the prefix form</span><span>
</span><a name="line-989"></a><span class="hs-comment">--      | is_infix  = mk_alt prefix_parser (mk_parser infix_prec  infix_stmts  body)</span><span>
</span><a name="line-990"></a><span class="hs-comment">--      | is_record = mk_alt prefix_parser (mk_parser record_prec record_stmts body)</span><span>
</span><a name="line-991"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017785"><span class="hs-identifier hs-var">prefix_parser</span></a><span>
</span><a name="line-992"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-993"></a><span>        </span><a name="local-1628017783"><a href="#local-1628017783"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017768"><span class="hs-identifier hs-var">result_expr</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span> </span><a href="#local-1628017797"><span class="hs-identifier hs-var">as_needed</span></a><span>
</span><a name="line-994"></a><span>        </span><a name="local-1628017784"><a href="#local-1628017784"><span class="hs-identifier">con_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017774"><span class="hs-identifier hs-var">data_con_str</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span>        </span><a name="local-1628017785"><a href="#local-1628017785"><span class="hs-identifier">prefix_parser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017766"><span class="hs-identifier hs-var">mk_parser</span></a><span> </span><a href="#local-1628017801"><span class="hs-identifier hs-var">prefix_prec</span></a><span> </span><a href="#local-1628017788"><span class="hs-identifier hs-var">prefix_stmts</span></a><span> </span><a href="#local-1628017783"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-997"></a><span>
</span><a name="line-998"></a><span>        </span><a name="local-1628017786"><a href="#local-1628017786"><span class="hs-identifier">read_prefix_con</span></a></a><span>
</span><a name="line-999"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-1628017772"><span class="hs-identifier hs-var">symbol_pat</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1000"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017769"><span class="hs-identifier hs-var">ident_h_pat</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span>
</span><a name="line-1001"></a><span>
</span><a name="line-1002"></a><span>        </span><a name="local-1628017787"><a href="#local-1628017787"><span class="hs-identifier">read_infix_con</span></a></a><span>
</span><a name="line-1003"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017772"><span class="hs-identifier hs-var">symbol_pat</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span class="hs-special">]</span><span>
</span><a name="line-1004"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;`&quot;</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017769"><span class="hs-identifier hs-var">ident_h_pat</span></a><span> </span><a href="#local-1628017784"><span class="hs-identifier hs-var">con_str</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;`&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1005"></a><span>
</span><a name="line-1006"></a><span>        </span><a name="local-1628017788"><a href="#local-1628017788"><span class="hs-identifier">prefix_stmts</span></a></a><span>            </span><span class="hs-comment">-- T a b c</span><span>
</span><a name="line-1007"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017786"><span class="hs-identifier hs-var">read_prefix_con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017798"><span class="hs-identifier hs-var">read_args</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span>        </span><a name="local-1628017789"><a href="#local-1628017789"><span class="hs-identifier">infix_stmts</span></a></a><span>             </span><span class="hs-comment">-- a %% b, or  a `T` b</span><span>
</span><a name="line-1010"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017799"><span class="hs-identifier hs-var">read_a1</span></a><span class="hs-special">]</span><span>
</span><a name="line-1011"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017787"><span class="hs-identifier hs-var">read_infix_con</span></a><span>
</span><a name="line-1012"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017800"><span class="hs-identifier hs-var">read_a2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1013"></a><span>
</span><a name="line-1014"></a><span>        </span><a name="local-1628017790"><a href="#local-1628017790"><span class="hs-identifier">record_stmts</span></a></a><span>            </span><span class="hs-comment">-- T { f1 = a, f2 = b }</span><span>
</span><a name="line-1015"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017786"><span class="hs-identifier hs-var">read_prefix_con</span></a><span>
</span><a name="line-1016"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1017"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">]</span><span> </span><a href="#local-1628017791"><span class="hs-identifier hs-var">field_stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1019"></a><span>
</span><a name="line-1020"></a><span>        </span><a name="local-1628017791"><a href="#local-1628017791"><span class="hs-identifier">field_stmts</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a><span> </span><span class="hs-string">&quot;lbl_stmts&quot;</span><span> </span><a href="#local-1628017776"><span class="hs-identifier hs-var">read_field</span></a><span> </span><a href="#local-1628017793"><span class="hs-identifier hs-var">labels</span></a><span> </span><a href="#local-1628017797"><span class="hs-identifier hs-var">as_needed</span></a><span>
</span><a name="line-1021"></a><span>
</span><a name="line-1022"></a><span>        </span><a name="local-1628017792"><a href="#local-1628017792"><span class="hs-identifier">con_arity</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1023"></a><span>        </span><a name="local-1628017793"><a href="#local-1628017793"><span class="hs-identifier">labels</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">flLabel</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1024"></a><span>        </span><a name="local-1628017794"><a href="#local-1628017794"><span class="hs-identifier">dc_nm</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1025"></a><span>        </span><a name="local-1628017795"><a href="#local-1628017795"><span class="hs-identifier">is_infix</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConIsInfix"><span class="hs-identifier hs-var">dataConIsInfix</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1026"></a><span>        </span><a name="local-1628017796"><a href="#local-1628017796"><span class="hs-identifier">is_record</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628017793"><span class="hs-identifier hs-var">labels</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1027"></a><span>        </span><a name="local-1628017797"><a href="#local-1628017797"><span class="hs-identifier">as_needed</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017792"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-1028"></a><span>        </span><a name="local-1628017798"><a href="#local-1628017798"><span class="hs-identifier">read_args</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a><span> </span><span class="hs-string">&quot;gen_Read_binds&quot;</span><span> </span><a href="#local-1628017775"><span class="hs-identifier hs-var">read_arg</span></a><span> </span><a href="#local-1628017797"><span class="hs-identifier hs-var">as_needed</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628017782"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span>
</span><a name="line-1029"></a><span>        </span><span class="hs-special">(</span><a name="local-1628017799"><a href="#local-1628017799"><span class="hs-identifier">read_a1</span></a></a><span class="hs-glyph">:</span><a name="local-1628017800"><a href="#local-1628017800"><span class="hs-identifier">read_a2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017798"><span class="hs-identifier hs-var">read_args</span></a><span>
</span><a name="line-1030"></a><span>
</span><a name="line-1031"></a><span>        </span><a name="local-1628017801"><a href="#local-1628017801"><span class="hs-identifier">prefix_prec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#appPrecedence"><span class="hs-identifier hs-var">appPrecedence</span></a><span>
</span><a name="line-1032"></a><span>        </span><a name="local-1628017802"><a href="#local-1628017802"><span class="hs-identifier">infix_prec</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#getPrecedence"><span class="hs-identifier hs-var">getPrecedence</span></a><span> </span><a href="#local-1628017750"><span class="hs-identifier hs-var">get_fixity</span></a><span> </span><a href="#local-1628017794"><span class="hs-identifier hs-var">dc_nm</span></a><span>
</span><a name="line-1033"></a><span>        </span><a name="local-1628017803"><a href="#local-1628017803"><span class="hs-identifier">record_prec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#appPrecedence"><span class="hs-identifier hs-var">appPrecedence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- Record construction binds even more tightly</span><span>
</span><a name="line-1034"></a><span>                                        </span><span class="hs-comment">-- than application; e.g. T2 T1 {x=2} means T2 (T1 {x=2})</span><span>
</span><a name="line-1035"></a><span>
</span><a name="line-1036"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1037"></a><span>    </span><span class="hs-comment">--          Helpers</span><span>
</span><a name="line-1038"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1039"></a><span>    </span><a name="local-1628017765"><a href="#local-1628017765"><span class="hs-identifier">mk_alt</span></a></a><span> </span><a name="local-1628017804"><a href="#local-1628017804"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628017805"><a href="#local-1628017805"><span class="hs-identifier">e2</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><a href="#local-1628017804"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="PrelNames.html#alt_RDR"><span class="hs-identifier hs-var">alt_RDR</span></a><span> </span><a href="#local-1628017805"><span class="hs-identifier hs-var">e2</span></a><span>                         </span><span class="hs-comment">-- e1 +++ e2</span><span>
</span><a name="line-1040"></a><span>    </span><a name="local-1628017766"><a href="#local-1628017766"><span class="hs-identifier">mk_parser</span></a></a><span> </span><a name="local-1628017806"><a href="#local-1628017806"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1628017807"><a href="#local-1628017807"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-1628017808"><a href="#local-1628017808"><span class="hs-identifier">b</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#prec_RDR"><span class="hs-identifier hs-var">prec_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><a href="#local-1628017806"><span class="hs-identifier hs-var">p</span></a><span>                </span><span class="hs-comment">-- prec p (do { ss ; b })</span><span>
</span><a name="line-1041"></a><span>                                           </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsDo"><span class="hs-identifier hs-var">nlHsDo</span></a><span> </span><a href="HsExpr.html#DoExpr"><span class="hs-identifier hs-var">DoExpr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017807"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span> </span><a href="#local-1628017808"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1042"></a><span>    </span><a name="local-1628017767"><a href="#local-1628017767"><span class="hs-identifier">con_app</span></a></a><span> </span><a name="local-1628017809"><a href="#local-1628017809"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-keyword">as</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017809"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>                </span><span class="hs-comment">-- con as</span><span>
</span><a name="line-1043"></a><span>    </span><a name="local-1628017768"><a href="#local-1628017768"><span class="hs-identifier">result_expr</span></a></a><span> </span><a name="local-1628017811"><a href="#local-1628017811"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#returnM_RDR"><span class="hs-identifier hs-var">returnM_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628017767"><span class="hs-identifier hs-var">con_app</span></a><span> </span><a href="#local-1628017811"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- return (con as)</span><span>
</span><a name="line-1044"></a><span>
</span><a name="line-1045"></a><span>    </span><span class="hs-comment">-- For constructors and field labels ending in '#', we hackily</span><span>
</span><a name="line-1046"></a><span>    </span><span class="hs-comment">-- let the lexer generate two tokens, and look for both in sequence</span><span>
</span><a name="line-1047"></a><span>    </span><span class="hs-comment">-- Thus [Ident &quot;I&quot;; Symbol &quot;#&quot;].  See Trac #5041</span><span>
</span><a name="line-1048"></a><span>    </span><a name="local-1628017769"><a href="#local-1628017769"><span class="hs-identifier">ident_h_pat</span></a></a><span> </span><a name="local-1628017813"><a href="#local-1628017813"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628017814"><a href="#local-1628017814"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-char">'#'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-1628017813"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017771"><span class="hs-identifier hs-var">ident_pat</span></a><span> </span><a href="#local-1628017814"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017772"><span class="hs-identifier hs-var">symbol_pat</span></a><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1049"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628017771"><span class="hs-identifier hs-var">ident_pat</span></a><span> </span><a href="#local-1628017813"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span>    </span><a name="local-1628017770"><a href="#local-1628017770"><span class="hs-identifier">bindLex</span></a></a><span> </span><a name="local-1628017815"><a href="#local-1628017815"><span class="hs-identifier">pat</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkBodyStmt"><span class="hs-identifier hs-var">mkBodyStmt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#expectP_RDR"><span class="hs-identifier hs-var">expectP_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017815"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- expectP p</span><span>
</span><a name="line-1052"></a><span>                   </span><span class="hs-comment">-- See Note [Use expectP]</span><span>
</span><a name="line-1053"></a><span>    </span><a name="local-1628017771"><a href="#local-1628017771"><span class="hs-identifier">ident_pat</span></a></a><span>  </span><a name="local-1628017816"><a href="#local-1628017816"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017770"><span class="hs-identifier hs-var">bindLex</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#ident_RDR"><span class="hs-identifier hs-var">ident_RDR</span></a><span>  </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="#local-1628017816"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- expectP (Ident &quot;foo&quot;)</span><span>
</span><a name="line-1054"></a><span>    </span><a name="local-1628017772"><a href="#local-1628017772"><span class="hs-identifier">symbol_pat</span></a></a><span> </span><a name="local-1628017817"><a href="#local-1628017817"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017770"><span class="hs-identifier hs-var">bindLex</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#symbol_RDR"><span class="hs-identifier hs-var">symbol_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="#local-1628017817"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- expectP (Symbol &quot;&gt;&gt;&quot;)</span><span>
</span><a name="line-1055"></a><span>    </span><a name="local-1628017773"><a href="#local-1628017773"><span class="hs-identifier">read_punc</span></a></a><span> </span><a name="local-1628017818"><a href="#local-1628017818"><span class="hs-identifier">c</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017770"><span class="hs-identifier hs-var">bindLex</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#punc_RDR"><span class="hs-identifier hs-var">punc_RDR</span></a><span>   </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="#local-1628017818"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- expectP (Punc &quot;&lt;&quot;)</span><span>
</span><a name="line-1056"></a><span>
</span><a name="line-1057"></a><span>    </span><a name="local-1628017774"><a href="#local-1628017774"><span class="hs-identifier">data_con_str</span></a></a><span> </span><a name="local-1628017819"><a href="#local-1628017819"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1628017819"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-1058"></a><span>
</span><a name="line-1059"></a><span>    </span><a name="local-1628017775"><a href="#local-1628017775"><span class="hs-identifier">read_arg</span></a></a><span> </span><a name="local-1628017820"><a href="#local-1628017820"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628017821"><a href="#local-1628017821"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isUnliftedType</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1060"></a><span>                    </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier hs-var">mkBindStmt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628017820"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="PrelNames.html#step_RDR"><span class="hs-identifier hs-var">step_RDR</span></a><span> </span><span class="hs-special">[</span><a href="PrelNames.html#readPrec_RDR"><span class="hs-identifier hs-var">readPrec_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span>    </span><a name="local-1628017776"><a href="#local-1628017776"><span class="hs-identifier">read_field</span></a></a><span> </span><a name="local-1628017822"><a href="#local-1628017822"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-1628017823"><a href="#local-1628017823"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017777"><span class="hs-identifier hs-var">read_lbl</span></a><span> </span><a href="#local-1628017822"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-1063"></a><span>                       </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1064"></a><span>                        </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier hs-var">mkBindStmt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628017823"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><a href="PrelNames.html#reset_RDR"><span class="hs-identifier hs-var">reset_RDR</span></a><span> </span><span class="hs-special">[</span><a href="PrelNames.html#readPrec_RDR"><span class="hs-identifier hs-var">readPrec_RDR</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1065"></a><span>
</span><a name="line-1066"></a><span>        </span><span class="hs-comment">-- When reading field labels we might encounter</span><span>
</span><a name="line-1067"></a><span>        </span><span class="hs-comment">--      a  = 3</span><span>
</span><a name="line-1068"></a><span>        </span><span class="hs-comment">--      _a = 3</span><span>
</span><a name="line-1069"></a><span>        </span><span class="hs-comment">-- or   (#) = 4</span><span>
</span><a name="line-1070"></a><span>        </span><span class="hs-comment">-- Note the parens!</span><span>
</span><a name="line-1071"></a><span>    </span><a name="local-1628017777"><a href="#local-1628017777"><span class="hs-identifier">read_lbl</span></a></a><span> </span><a name="local-1628017824"><a href="#local-1628017824"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017825"><span class="hs-identifier hs-var">lbl_str</span></a><span>
</span><a name="line-1072"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-1628017772"><span class="hs-identifier hs-var">symbol_pat</span></a><span> </span><a href="#local-1628017825"><span class="hs-identifier hs-var">lbl_str</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017773"><span class="hs-identifier hs-var">read_punc</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1073"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1074"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017769"><span class="hs-identifier hs-var">ident_h_pat</span></a><span> </span><a href="#local-1628017825"><span class="hs-identifier hs-var">lbl_str</span></a><span>
</span><a name="line-1075"></a><span>                 </span><span class="hs-keyword">where</span><span>
</span><a name="line-1076"></a><span>                   </span><a name="local-1628017825"><a href="#local-1628017825"><span class="hs-identifier">lbl_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1628017824"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-1077"></a><span>
</span><a name="line-1078"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Show instances
*                                                                      *
************************************************************************

Example

    infixr 5 :^:

    data Tree a =  Leaf a  |  Tree a :^: Tree a

    instance (Show a) =&gt; Show (Tree a) where

        showsPrec d (Leaf m) = showParen (d &gt; app_prec) showStr
          where
             showStr = showString &quot;Leaf &quot; . showsPrec (app_prec+1) m

        showsPrec d (u :^: v) = showParen (d &gt; up_prec) showStr
          where
             showStr = showsPrec (up_prec+1) u .
                       showString &quot; :^: &quot;      .
                       showsPrec (up_prec+1) v
                -- Note: right-associativity of :^: ignored

    up_prec  = 5    -- Precedence of :^:
    app_prec = 10   -- Application has precedence one more than
                    -- the most tightly-binding operator
-}</span><span>
</span><a name="line-1108"></a><span>
</span><a name="line-1109"></a><span class="hs-identifier">gen_Show_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><a name="gen_Show_binds"><a href="TcGenDeriv.html#gen_Show_binds"><span class="hs-identifier">gen_Show_binds</span></a></a><span> </span><a name="local-1628017826"><a href="#local-1628017826"><span class="hs-identifier">get_fixity</span></a></a><span> </span><a name="local-1628017827"><a href="#local-1628017827"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017828"><a href="#local-1628017828"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1112"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017831"><span class="hs-identifier hs-var">shows_prec</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017829"><span class="hs-identifier hs-var">show_list</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-1113"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1114"></a><span>    </span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-1115"></a><span>    </span><a name="local-1628017829"><a href="#local-1628017829"><span class="hs-identifier">show_list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017827"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#showList_RDR"><span class="hs-identifier hs-var">showList_RDR</span></a><span>
</span><a name="line-1116"></a><span>                  </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showList___RDR"><span class="hs-identifier hs-var">showList___RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showsPrec_RDR"><span class="hs-identifier hs-var">showsPrec_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><span>    </span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-1118"></a><span>    </span><a name="local-1628017830"><a href="#local-1628017830"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017828"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1119"></a><span>    </span><a name="local-1628017831"><a href="#local-1628017831"><span class="hs-identifier">shows_prec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628017827"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#showsPrec_RDR"><span class="hs-identifier hs-var">showsPrec_RDR</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017832"><span class="hs-identifier hs-var">pats_etc</span></a><span> </span><a href="#local-1628017830"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>
</span><a name="line-1121"></a><span>    </span><a name="local-1628017832"><a href="#local-1628017832"><span class="hs-identifier">pats_etc</span></a></a><span> </span><a name="local-1628017833"><a href="#local-1628017833"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-1122"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017839"><span class="hs-identifier hs-var">nullary_con</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- skip the showParen junk...</span><span>
</span><a name="line-1123"></a><span>         </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">bs_needed</span><span class="hs-special">)</span><span>
</span><a name="line-1124"></a><span>         </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017838"><span class="hs-identifier hs-var">con_pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><a href="#local-1628017846"><span class="hs-identifier hs-var">op_con_str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1125"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span>
</span><a name="line-1126"></a><span>         </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier hs-var">a_Pat</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017838"><span class="hs-identifier hs-var">con_pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1127"></a><span>          </span><a href="TcGenDeriv.html#showParen_Expr"><span class="hs-identifier hs-var">showParen_Expr</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><a href="TcGenDeriv.html#a_Expr"><span class="hs-identifier hs-var">a_Expr</span></a><span> </span><a href="PrelNames.html#ge_RDR"><span class="hs-identifier hs-var">ge_RDR</span></a><span>
</span><a name="line-1128"></a><span>                              </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-1628017857"><span class="hs-identifier hs-var">con_prec_plus_one</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1129"></a><span>                         </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#nested_compose_Expr"><span class="hs-identifier hs-var">nested_compose_Expr</span></a><span> </span><a href="#local-1628017848"><span class="hs-identifier hs-var">show_thingies</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1130"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1131"></a><span>             </span><a name="local-1628017834"><a href="#local-1628017834"><span class="hs-identifier">data_con_RDR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1132"></a><span>             </span><a name="local-1628017835"><a href="#local-1628017835"><span class="hs-identifier">con_arity</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1133"></a><span>             </span><a name="local-1628017836"><a href="#local-1628017836"><span class="hs-identifier">bs_needed</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628017835"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1134"></a><span>             </span><a name="local-1628017837"><a href="#local-1628017837"><span class="hs-identifier">arg_tys</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>         </span><span class="hs-comment">-- Correspond 1-1 with bs_needed</span><span>
</span><a name="line-1135"></a><span>             </span><a name="local-1628017838"><a href="#local-1628017838"><span class="hs-identifier">con_pat</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017834"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628017836"><span class="hs-identifier hs-var">bs_needed</span></a><span>
</span><a name="line-1136"></a><span>             </span><a name="local-1628017839"><a href="#local-1628017839"><span class="hs-identifier">nullary_con</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017835"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1137"></a><span>             </span><a name="local-1628017840"><a href="#local-1628017840"><span class="hs-identifier">labels</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">flLabel</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1138"></a><span>             </span><a name="local-1628017841"><a href="#local-1628017841"><span class="hs-identifier">lab_fields</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628017840"><span class="hs-identifier hs-var">labels</span></a><span>
</span><a name="line-1139"></a><span>             </span><a name="local-1628017842"><a href="#local-1628017842"><span class="hs-identifier">record_syntax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017841"><span class="hs-identifier hs-var">lab_fields</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1140"></a><span>
</span><a name="line-1141"></a><span>             </span><a name="local-1628017843"><a href="#local-1628017843"><span class="hs-identifier">dc_nm</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1142"></a><span>             </span><a name="local-1628017844"><a href="#local-1628017844"><span class="hs-identifier">dc_occ_nm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1143"></a><span>             </span><a name="local-1628017845"><a href="#local-1628017845"><span class="hs-identifier">con_str</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1628017844"><span class="hs-identifier hs-var">dc_occ_nm</span></a><span>
</span><a name="line-1144"></a><span>             </span><a name="local-1628017846"><a href="#local-1628017846"><span class="hs-identifier">op_con_str</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#wrapOpParens"><span class="hs-identifier hs-var">wrapOpParens</span></a><span> </span><a href="#local-1628017845"><span class="hs-identifier hs-var">con_str</span></a><span>
</span><a name="line-1145"></a><span>             </span><a name="local-1628017847"><a href="#local-1628017847"><span class="hs-identifier">backquote_str</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#wrapOpBackquotes"><span class="hs-identifier hs-var">wrapOpBackquotes</span></a><span> </span><a href="#local-1628017845"><span class="hs-identifier hs-var">con_str</span></a><span>
</span><a name="line-1146"></a><span>
</span><a name="line-1147"></a><span>             </span><a name="local-1628017848"><a href="#local-1628017848"><span class="hs-identifier">show_thingies</span></a></a><span>
</span><a name="line-1148"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017856"><span class="hs-identifier hs-var">is_infix</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628017851"><span class="hs-identifier hs-var">show_arg1</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot; &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628017847"><span class="hs-identifier hs-var">backquote_str</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628017852"><span class="hs-identifier hs-var">show_arg2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1149"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017842"><span class="hs-identifier hs-var">record_syntax</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017846"><span class="hs-identifier hs-var">op_con_str</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot; {&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-1150"></a><span>                                  </span><a href="#local-1628017854"><span class="hs-identifier hs-var">show_record_args</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1151"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017846"><span class="hs-identifier hs-var">op_con_str</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628017853"><span class="hs-identifier hs-var">show_prefix_args</span></a><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span>             </span><a name="local-1628017849"><a href="#local-1628017849"><span class="hs-identifier">show_label</span></a></a><span> </span><a name="local-1628017859"><a href="#local-1628017859"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017860"><span class="hs-identifier hs-var">nm</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot; = &quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1154"></a><span>                        </span><span class="hs-comment">-- Note the spaces around the &quot;=&quot; sign.  If we</span><span>
</span><a name="line-1155"></a><span>                        </span><span class="hs-comment">-- don't have them then we get Foo { x=-1 } and</span><span>
</span><a name="line-1156"></a><span>                        </span><span class="hs-comment">-- the &quot;=-&quot; parses as a single lexeme.  Only the</span><span>
</span><a name="line-1157"></a><span>                        </span><span class="hs-comment">-- space after the '=' is necessary, but it</span><span>
</span><a name="line-1158"></a><span>                        </span><span class="hs-comment">-- seems tidier to have them both sides.</span><span>
</span><a name="line-1159"></a><span>                 </span><span class="hs-keyword">where</span><span>
</span><a name="line-1160"></a><span>                   </span><a name="local-1628017860"><a href="#local-1628017860"><span class="hs-identifier">nm</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#wrapOpParens"><span class="hs-identifier hs-var">wrapOpParens</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-1628017859"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span>
</span><a name="line-1162"></a><span>             </span><a name="local-1628017850"><a href="#local-1628017850"><span class="hs-identifier">show_args</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="#local-1628017855"><span class="hs-identifier hs-var">show_arg</span></a><span> </span><a href="#local-1628017836"><span class="hs-identifier hs-var">bs_needed</span></a><span> </span><a href="#local-1628017837"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-1163"></a><span>             </span><span class="hs-special">(</span><a name="local-1628017851"><a href="#local-1628017851"><span class="hs-identifier">show_arg1</span></a></a><span class="hs-glyph">:</span><a name="local-1628017852"><a href="#local-1628017852"><span class="hs-identifier">show_arg2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017850"><span class="hs-identifier hs-var">show_args</span></a><span>
</span><a name="line-1164"></a><span>             </span><a name="local-1628017853"><a href="#local-1628017853"><span class="hs-identifier">show_prefix_args</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showSpace_RDR"><span class="hs-identifier hs-var">showSpace_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017850"><span class="hs-identifier hs-var">show_args</span></a><span>
</span><a name="line-1165"></a><span>
</span><a name="line-1166"></a><span>                </span><span class="hs-comment">-- Assumption for record syntax: no of fields == no of</span><span>
</span><a name="line-1167"></a><span>                </span><span class="hs-comment">-- labelled fields (and in same order)</span><span>
</span><a name="line-1168"></a><span>             </span><a name="local-1628017854"><a href="#local-1628017854"><span class="hs-identifier">show_record_args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1169"></a><span>                                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><span class="hs-string">&quot;, &quot;</span><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1170"></a><span>                                </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><a href="#local-1628017849"><span class="hs-identifier hs-var">show_label</span></a><span> </span><a href="#local-1628017861"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017862"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1171"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628017861"><a href="#local-1628017861"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">,</span><a name="local-1628017862"><a href="#local-1628017862"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#zipEqual"><span class="hs-identifier hs-var">zipEqual</span></a><span> </span><span class="hs-string">&quot;gen_Show_binds&quot;</span><span>
</span><a name="line-1172"></a><span>                                                        </span><a href="#local-1628017840"><span class="hs-identifier hs-var">labels</span></a><span> </span><a href="#local-1628017850"><span class="hs-identifier hs-var">show_args</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1173"></a><span>
</span><a name="line-1174"></a><span>             </span><span class="hs-identifier">show_arg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1175"></a><span>             </span><a name="local-1628017855"><a href="#local-1628017855"><span class="hs-identifier">show_arg</span></a></a><span> </span><a name="local-1628017863"><a href="#local-1628017863"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1628017864"><a href="#local-1628017864"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-1176"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628017864"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-1177"></a><span>               </span><span class="hs-comment">-- See Note [Deriving and unboxed types] in TcDeriv</span><span>
</span><a name="line-1178"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#compose_RDR"><span class="hs-identifier hs-var">compose_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#mk_shows_app"><span class="hs-identifier hs-var">mk_shows_app</span></a><span> </span><a href="#local-1628017866"><span class="hs-identifier hs-var">boxed_arg</span></a><span class="hs-special">,</span><span>
</span><a name="line-1179"></a><span>                                       </span><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier hs-var">mk_showString_app</span></a><span> </span><a href="#local-1628017867"><span class="hs-identifier hs-var">postfixMod</span></a><span class="hs-special">]</span><span>
</span><a name="line-1180"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1181"></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_showsPrec_app"><span class="hs-identifier hs-var">mk_showsPrec_app</span></a><span> </span><a href="#local-1628017858"><span class="hs-identifier hs-var">arg_prec</span></a><span> </span><a href="#local-1628017865"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1182"></a><span>                 </span><span class="hs-keyword">where</span><span>
</span><a name="line-1183"></a><span>                   </span><a name="local-1628017865"><a href="#local-1628017865"><span class="hs-identifier">arg</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017863"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1184"></a><span>                   </span><a name="local-1628017866"><a href="#local-1628017866"><span class="hs-identifier">boxed_arg</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#box"><span class="hs-identifier hs-var">box</span></a><span> </span><span class="hs-string">&quot;Show&quot;</span><span> </span><a href="#local-1628017828"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628017865"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-1628017864"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-1185"></a><span>                   </span><a name="local-1628017867"><a href="#local-1628017867"><span class="hs-identifier">postfixMod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier hs-var">assoc_ty_id</span></a><span> </span><span class="hs-string">&quot;Show&quot;</span><span> </span><a href="#local-1628017828"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TcGenDeriv.html#postfixModTbl"><span class="hs-identifier hs-var">postfixModTbl</span></a><span> </span><a href="#local-1628017864"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-1186"></a><span>
</span><a name="line-1187"></a><span>                </span><span class="hs-comment">-- Fixity stuff</span><span>
</span><a name="line-1188"></a><span>             </span><a name="local-1628017856"><a href="#local-1628017856"><span class="hs-identifier">is_infix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConIsInfix"><span class="hs-identifier hs-var">dataConIsInfix</span></a><span> </span><a href="#local-1628017833"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-1189"></a><span>             </span><a name="local-1628017857"><a href="#local-1628017857"><span class="hs-identifier">con_prec_plus_one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="TcGenDeriv.html#getPrec"><span class="hs-identifier hs-var">getPrec</span></a><span> </span><a href="#local-1628017856"><span class="hs-identifier hs-var">is_infix</span></a><span> </span><a href="#local-1628017826"><span class="hs-identifier hs-var">get_fixity</span></a><span> </span><a href="#local-1628017843"><span class="hs-identifier hs-var">dc_nm</span></a><span>
</span><a name="line-1190"></a><span>             </span><a name="local-1628017858"><a href="#local-1628017858"><span class="hs-identifier">arg_prec</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017842"><span class="hs-identifier hs-var">record_syntax</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-comment">-- Record fields don't need parens</span><span>
</span><a name="line-1191"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017857"><span class="hs-identifier hs-var">con_prec_plus_one</span></a><span>
</span><a name="line-1192"></a><span>
</span><a name="line-1193"></a><span class="hs-identifier">wrapOpParens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1194"></a><a name="wrapOpParens"><a href="TcGenDeriv.html#wrapOpParens"><span class="hs-identifier">wrapOpParens</span></a></a><span> </span><a name="local-1628017868"><a href="#local-1628017868"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017868"><span class="hs-identifier hs-var">s</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628017868"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-1195"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017868"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-identifier">wrapOpBackquotes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1198"></a><a name="wrapOpBackquotes"><a href="TcGenDeriv.html#wrapOpBackquotes"><span class="hs-identifier">wrapOpBackquotes</span></a></a><span> </span><a name="local-1628017869"><a href="#local-1628017869"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcGenDeriv.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-1628017869"><span class="hs-identifier hs-var">s</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017869"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1199"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'`'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628017869"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;`&quot;</span><span>
</span><a name="line-1200"></a><span>
</span><a name="line-1201"></a><span class="hs-identifier">isSym</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1202"></a><a name="isSym"><a href="TcGenDeriv.html#isSym"><span class="hs-identifier">isSym</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1203"></a><span class="hs-identifier">isSym</span><span> </span><span class="hs-special">(</span><a name="local-1628017870"><a href="#local-1628017870"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.Lexeme.html#startsVarSym"><span class="hs-identifier hs-var">startsVarSym</span></a><span> </span><a href="#local-1628017870"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.Lexeme.html#startsConSym"><span class="hs-identifier hs-var">startsConSym</span></a><span> </span><a href="#local-1628017870"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1204"></a><span>
</span><a name="line-1205"></a><span class="hs-comment">-- | showString :: String -&gt; ShowS</span><span>
</span><a name="line-1206"></a><span class="hs-identifier">mk_showString_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1207"></a><a name="mk_showString_app"><a href="TcGenDeriv.html#mk_showString_app"><span class="hs-identifier">mk_showString_app</span></a></a><span> </span><a name="local-1628017871"><a href="#local-1628017871"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showString_RDR"><span class="hs-identifier hs-var">showString_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="#local-1628017871"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>
</span><a name="line-1209"></a><span class="hs-comment">-- | showsPrec :: Show a =&gt; Int -&gt; a -&gt; ShowS</span><span>
</span><a name="line-1210"></a><span class="hs-identifier">mk_showsPrec_app</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1211"></a><a name="mk_showsPrec_app"><a href="TcGenDeriv.html#mk_showsPrec_app"><span class="hs-identifier">mk_showsPrec_app</span></a></a><span> </span><a name="local-1628017872"><a href="#local-1628017872"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1628017873"><a href="#local-1628017873"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#showsPrec_RDR"><span class="hs-identifier hs-var">showsPrec_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-1628017872"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628017873"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-1212"></a><span>
</span><a name="line-1213"></a><span class="hs-comment">-- | shows :: Show a =&gt; a -&gt; ShowS</span><span>
</span><a name="line-1214"></a><span class="hs-identifier">mk_shows_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1215"></a><a name="mk_shows_app"><a href="TcGenDeriv.html#mk_shows_app"><span class="hs-identifier">mk_shows_app</span></a></a><span> </span><a name="local-1628017874"><a href="#local-1628017874"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#shows_RDR"><span class="hs-identifier hs-var">shows_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017874"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1216"></a><span>
</span><a name="line-1217"></a><span class="hs-identifier">getPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-1218"></a><a name="getPrec"><a href="TcGenDeriv.html#getPrec"><span class="hs-identifier">getPrec</span></a></a><span> </span><a name="local-1628017875"><a href="#local-1628017875"><span class="hs-identifier">is_infix</span></a></a><span> </span><a name="local-1628017876"><a href="#local-1628017876"><span class="hs-identifier">get_fixity</span></a></a><span> </span><a name="local-1628017877"><a href="#local-1628017877"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-1219"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628017875"><span class="hs-identifier hs-var">is_infix</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#appPrecedence"><span class="hs-identifier hs-var">appPrecedence</span></a><span>
</span><a name="line-1220"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#getPrecedence"><span class="hs-identifier hs-var">getPrecedence</span></a><span> </span><a href="#local-1628017876"><span class="hs-identifier hs-var">get_fixity</span></a><span> </span><a href="#local-1628017877"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1221"></a><span>
</span><a name="line-1222"></a><span class="hs-identifier">appPrecedence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-1223"></a><a name="appPrecedence"><a href="TcGenDeriv.html#appPrecedence"><span class="hs-identifier">appPrecedence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="BasicTypes.html#maxPrecedence"><span class="hs-identifier hs-var">maxPrecedence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1224"></a><span>  </span><span class="hs-comment">-- One more than the precedence of the most</span><span>
</span><a name="line-1225"></a><span>  </span><span class="hs-comment">-- tightly-binding operator</span><span>
</span><a name="line-1226"></a><span>
</span><a name="line-1227"></a><span class="hs-identifier">getPrecedence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-1228"></a><a name="getPrecedence"><a href="TcGenDeriv.html#getPrecedence"><span class="hs-identifier">getPrecedence</span></a></a><span> </span><a name="local-1628017878"><a href="#local-1628017878"><span class="hs-identifier">get_fixity</span></a></a><span> </span><a name="local-1628017879"><a href="#local-1628017879"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-1229"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628017878"><span class="hs-identifier hs-var">get_fixity</span></a><span> </span><a href="#local-1628017879"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1230"></a><span>        </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628017880"><a href="#local-1628017880"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628017881"><a href="#local-1628017881"><span class="hs-identifier">_assoc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-1628017880"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1231"></a><span>          </span><span class="hs-comment">-- NB: the Report says that associativity is not taken</span><span>
</span><a name="line-1232"></a><span>          </span><span class="hs-comment">--     into account for either Read or Show; hence we</span><span>
</span><a name="line-1233"></a><span>          </span><span class="hs-comment">--     ignore associativity here</span><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Data instances
*                                                                      *
************************************************************************

From the data type

  data T a b = T1 a b | T2

we generate

  $cT1 = mkDataCon $dT &quot;T1&quot; Prefix
  $cT2 = mkDataCon $dT &quot;T2&quot; Prefix
  $dT  = mkDataType &quot;Module.T&quot; [] [$con_T1, $con_T2]
  -- the [] is for field labels.

  instance (Data a, Data b) =&gt; Data (T a b) where
    gfoldl k z (T1 a b) = z T `k` a `k` b
    gfoldl k z T2           = z T2
    -- ToDo: add gmapT,Q,M, gfoldr

    gunfold k z c = case conIndex c of
                        I# 1# -&gt; k (k (z T1))
                        I# 2# -&gt; z T2

    toConstr (T1 _ _) = $cT1
    toConstr T2       = $cT2

    dataTypeOf _ = $dT

    dataCast1 = gcast1   -- If T :: * -&gt; *
    dataCast2 = gcast2   -- if T :: * -&gt; * -&gt; *
-}</span><span>
</span><a name="line-1270"></a><span>
</span><a name="line-1271"></a><span class="hs-identifier">gen_Data_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-1272"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-1273"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>                 </span><span class="hs-comment">-- For data families, this is the</span><span>
</span><a name="line-1274"></a><span>                                        </span><span class="hs-comment">--  *representation* TyCon</span><span>
</span><a name="line-1275"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- The method bindings</span><span>
</span><a name="line-1276"></a><span>                   </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Auxiliary bindings</span><span>
</span><a name="line-1277"></a><a name="gen_Data_binds"><a href="TcGenDeriv.html#gen_Data_binds"><span class="hs-identifier">gen_Data_binds</span></a></a><span> </span><a name="local-1628017882"><a href="#local-1628017882"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628017883"><a href="#local-1628017883"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017884"><a href="#local-1628017884"><span class="hs-identifier">rep_tc</span></a></a><span>
</span><a name="line-1278"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628017890"><span class="hs-identifier hs-var">gfoldl_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017892"><span class="hs-identifier hs-var">gunfold_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017897"><span class="hs-identifier hs-var">toCon_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628017899"><span class="hs-identifier hs-var">dataTypeOf_bind</span></a><span class="hs-special">]</span><span>
</span><a name="line-1279"></a><span>     </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628017901"><span class="hs-identifier hs-var">gcast_binds</span></a><span class="hs-special">,</span><span>
</span><a name="line-1280"></a><span>                </span><span class="hs-comment">-- Auxiliary definitions: the data type and constructors</span><span>
</span><a name="line-1281"></a><span>     </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TcGenDeriv.html#DerivHsBind"><span class="hs-identifier hs-var">DerivHsBind</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017888"><span class="hs-identifier hs-var">genDataTyCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>               </span><span class="hs-glyph">:</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivHsBind"><span class="hs-identifier hs-var">DerivHsBind</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1628017889"><span class="hs-identifier hs-var">genDataDataCon</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1284"></a><span>    </span><a name="local-1628017885"><a href="#local-1628017885"><span class="hs-identifier">data_cons</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span>
</span><a name="line-1285"></a><span>    </span><a name="local-1628017886"><a href="#local-1628017886"><span class="hs-identifier">n_cons</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-1286"></a><span>    </span><a name="local-1628017887"><a href="#local-1628017887"><span class="hs-identifier">one_constr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017886"><span class="hs-identifier hs-var">n_cons</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1287"></a><span>
</span><a name="line-1288"></a><span>    </span><span class="hs-identifier">genDataTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1289"></a><span>    </span><a name="local-1628017888"><a href="#local-1628017888"><span class="hs-identifier">genDataTyCon</span></a></a><span>        </span><span class="hs-comment">--  $dT</span><span>
</span><a name="line-1290"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628017903"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628017906"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1291"></a><span>         </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628017903"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628017904"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1292"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1293"></a><span>        </span><a name="local-1628017903"><a href="#local-1628017903"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_data_type_name"><span class="hs-identifier hs-var">mk_data_type_name</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span>
</span><a name="line-1294"></a><span>        </span><a name="local-1628017904"><a href="#local-1628017904"><span class="hs-identifier">sig_ty</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><a href="TcGenDeriv.html#dataType_RDR"><span class="hs-identifier hs-var">dataType_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span>        </span><a name="local-1628017905"><a href="#local-1628017905"><span class="hs-identifier">constrs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_constr_name"><span class="hs-identifier hs-var">mk_constr_name</span></a><span> </span><a href="#local-1628017907"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628017907"><a href="#local-1628017907"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span class="hs-special">]</span><span>
</span><a name="line-1296"></a><span>        </span><a name="local-1628017906"><a href="#local-1628017906"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#mkDataType_RDR"><span class="hs-identifier hs-var">mkDataType_RDR</span></a><span>
</span><a name="line-1297"></a><span>              </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#showSDocOneLine"><span class="hs-identifier hs-var">showSDocOneLine</span></a><span> </span><a href="#local-1628017882"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>              </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlList"><span class="hs-identifier hs-var">nlList</span></a><span> </span><a href="#local-1628017905"><span class="hs-identifier hs-var">constrs</span></a><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span>    </span><span class="hs-identifier">genDataDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1301"></a><span>    </span><a name="local-1628017889"><a href="#local-1628017889"><span class="hs-identifier">genDataDataCon</span></a></a><span> </span><a name="local-1628017908"><a href="#local-1628017908"><span class="hs-identifier">dc</span></a></a><span>       </span><span class="hs-comment">--  $cT1 etc</span><span>
</span><a name="line-1302"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628017909"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628017911"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1303"></a><span>         </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628017909"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628017910"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1304"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1305"></a><span>        </span><a name="local-1628017909"><a href="#local-1628017909"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_constr_name"><span class="hs-identifier hs-var">mk_constr_name</span></a><span> </span><a href="#local-1628017908"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1306"></a><span>        </span><a name="local-1628017910"><a href="#local-1628017910"><span class="hs-identifier">sig_ty</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><a href="TcGenDeriv.html#constr_RDR"><span class="hs-identifier hs-var">constr_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-1307"></a><span>        </span><a name="local-1628017911"><a href="#local-1628017911"><span class="hs-identifier">rhs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="TcGenDeriv.html#mkConstr_RDR"><span class="hs-identifier hs-var">mkConstr_RDR</span></a><span> </span><a href="#local-1628017912"><span class="hs-identifier hs-var">constr_args</span></a><span>
</span><a name="line-1308"></a><span>
</span><a name="line-1309"></a><span>        </span><a name="local-1628017912"><a href="#local-1628017912"><span class="hs-identifier">constr_args</span></a></a><span>
</span><a name="line-1310"></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- nlHsIntLit (toInteger (dataConTag dc)), -- Tag</span><span>
</span><a name="line-1311"></a><span>           </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_data_type_name"><span class="hs-identifier hs-var">mk_data_type_name</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-1628017908"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- DataType</span><span>
</span><a name="line-1312"></a><span>           </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-1628017914"><span class="hs-identifier hs-var">dc_occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- String name</span><span>
</span><a name="line-1313"></a><span>               </span><a href="HsUtils.html#nlList"><span class="hs-identifier hs-var">nlList</span></a><span>  </span><a href="#local-1628017913"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">,</span><span>                            </span><span class="hs-comment">-- Field labels</span><span>
</span><a name="line-1314"></a><span>           </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017916"><span class="hs-identifier hs-var">fixity</span></a><span class="hs-special">]</span><span>                                </span><span class="hs-comment">-- Fixity</span><span>
</span><a name="line-1315"></a><span>
</span><a name="line-1316"></a><span>        </span><a name="local-1628017913"><a href="#local-1628017913"><span class="hs-identifier">labels</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">flLabel</span><span class="hs-special">)</span><span>
</span><a name="line-1317"></a><span>                       </span><span class="hs-special">(</span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span> </span><a href="#local-1628017908"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1318"></a><span>        </span><a name="local-1628017914"><a href="#local-1628017914"><span class="hs-identifier">dc_occ</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1628017908"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1319"></a><span>        </span><a name="local-1628017915"><a href="#local-1628017915"><span class="hs-identifier">is_infix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isDataSymOcc"><span class="hs-identifier hs-var">isDataSymOcc</span></a><span> </span><a href="#local-1628017914"><span class="hs-identifier hs-var">dc_occ</span></a><span>
</span><a name="line-1320"></a><span>        </span><a name="local-1628017916"><a href="#local-1628017916"><span class="hs-identifier">fixity</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017915"><span class="hs-identifier hs-var">is_infix</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#infix_RDR"><span class="hs-identifier hs-var">infix_RDR</span></a><span>
</span><a name="line-1321"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#prefix_RDR"><span class="hs-identifier hs-var">prefix_RDR</span></a><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span>        </span><span class="hs-comment">------------ gfoldl</span><span>
</span><a name="line-1324"></a><span>    </span><a name="local-1628017890"><a href="#local-1628017890"><span class="hs-identifier">gfoldl_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_HRFunBind"><span class="hs-identifier hs-var">mk_HRFunBind</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="TcGenDeriv.html#gfoldl_RDR"><span class="hs-identifier hs-var">gfoldl_RDR</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017891"><span class="hs-identifier hs-var">gfoldl_eqn</span></a><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span>    </span><a name="local-1628017891"><a href="#local-1628017891"><span class="hs-identifier">gfoldl_eqn</span></a></a><span> </span><a name="local-1628017917"><a href="#local-1628017917"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1327"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#k_RDR"><span class="hs-identifier hs-var">k_RDR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier hs-var">z_RDR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628017918"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="#local-1628017919"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1328"></a><span>                       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-1628017920"><span class="hs-identifier hs-var">mk_k_app</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier hs-var">z_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017918"><span class="hs-identifier hs-var">con_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017919"><span class="hs-identifier hs-var">as_needed</span></a><span class="hs-special">)</span><span>
</span><a name="line-1329"></a><span>                   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1330"></a><span>                     </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1331"></a><span>                     </span><a name="local-1628017918"><a href="#local-1628017918"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017917"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1332"></a><span>                     </span><a name="local-1628017919"><a href="#local-1628017919"><span class="hs-identifier">as_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017917"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-1333"></a><span>                     </span><a name="local-1628017920"><a href="#local-1628017920"><span class="hs-identifier">mk_k_app</span></a></a><span> </span><a name="local-1628017921"><a href="#local-1628017921"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628017922"><a href="#local-1628017922"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier hs-var">nlHsOpApp</span></a><span> </span><a href="#local-1628017921"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="TcGenDeriv.html#k_RDR"><span class="hs-identifier hs-var">k_RDR</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017922"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><span>
</span><a name="line-1335"></a><span>        </span><span class="hs-comment">------------ gunfold</span><span>
</span><a name="line-1336"></a><span>    </span><a name="local-1628017892"><a href="#local-1628017892"><span class="hs-identifier">gunfold_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_HRFunBind"><span class="hs-identifier hs-var">mk_HRFunBind</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1337"></a><span>                     </span><a href="TcGenDeriv.html#gunfold_RDR"><span class="hs-identifier hs-var">gunfold_RDR</span></a><span>
</span><a name="line-1338"></a><span>                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcGenDeriv.html#k_Pat"><span class="hs-identifier hs-var">k_Pat</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#z_Pat"><span class="hs-identifier hs-var">z_Pat</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628017887"><span class="hs-identifier hs-var">one_constr</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="TcGenDeriv.html#c_Pat"><span class="hs-identifier hs-var">c_Pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1339"></a><span>                       </span><a href="#local-1628017893"><span class="hs-identifier hs-var">gunfold_rhs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1340"></a><span>
</span><a name="line-1341"></a><span>    </span><a name="local-1628017893"><a href="#local-1628017893"><span class="hs-identifier">gunfold_rhs</span></a></a><span>
</span><a name="line-1342"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017887"><span class="hs-identifier hs-var">one_constr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017895"><span class="hs-identifier hs-var">mk_unfold_rhs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- No need for case</span><span>
</span><a name="line-1343"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#conIndex_RDR"><span class="hs-identifier hs-var">conIndex_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="TcGenDeriv.html#c_Expr"><span class="hs-identifier hs-var">c_Expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span>                                </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017894"><span class="hs-identifier hs-var">gunfold_alt</span></a><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1345"></a><span>
</span><a name="line-1346"></a><span>    </span><a name="local-1628017894"><a href="#local-1628017894"><span class="hs-identifier">gunfold_alt</span></a></a><span> </span><a name="local-1628017923"><a href="#local-1628017923"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017896"><span class="hs-identifier hs-var">mk_unfold_pat</span></a><span> </span><a href="#local-1628017923"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628017895"><span class="hs-identifier hs-var">mk_unfold_rhs</span></a><span> </span><a href="#local-1628017923"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><span>    </span><a name="local-1628017895"><a href="#local-1628017895"><span class="hs-identifier">mk_unfold_rhs</span></a></a><span> </span><a name="local-1628017924"><a href="#local-1628017924"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span>
</span><a name="line-1348"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier hs-var">z_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628017924"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span>                           </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628017924"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#k_RDR"><span class="hs-identifier hs-var">k_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1350"></a><span>
</span><a name="line-1351"></a><span>    </span><a name="local-1628017896"><a href="#local-1628017896"><span class="hs-identifier">mk_unfold_pat</span></a></a><span> </span><a name="local-1628017925"><a href="#local-1628017925"><span class="hs-identifier">dc</span></a></a><span>    </span><span class="hs-comment">-- Last one is a wild-pat, to avoid</span><span>
</span><a name="line-1352"></a><span>                        </span><span class="hs-comment">-- redundant test, and annoying warning</span><span>
</span><a name="line-1353"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017926"><span class="hs-identifier hs-var">tag</span></a><span class="hs-glyph">-</span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017886"><span class="hs-identifier hs-var">n_cons</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span>   </span><span class="hs-comment">-- Last constructor</span><span>
</span><a name="line-1354"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span>
</span><a name="line-1355"></a><span>                             </span><span class="hs-special">[</span><a href="HsUtils.html#nlLitPat"><span class="hs-identifier hs-var">nlLitPat</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><a href="#local-1628017926"><span class="hs-identifier hs-var">tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1356"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1357"></a><span>        </span><a name="local-1628017926"><a href="#local-1628017926"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a><span> </span><a href="#local-1628017925"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span>        </span><span class="hs-comment">------------ toConstr</span><span>
</span><a name="line-1360"></a><span>    </span><a name="local-1628017897"><a href="#local-1628017897"><span class="hs-identifier">toCon_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="TcGenDeriv.html#toConstr_RDR"><span class="hs-identifier hs-var">toConstr_RDR</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017898"><span class="hs-identifier hs-var">to_con_eqn</span></a><span> </span><a href="#local-1628017885"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1361"></a><span>    </span><a name="local-1628017898"><a href="#local-1628017898"><span class="hs-identifier">to_con_eqn</span></a></a><span> </span><a name="local-1628017927"><a href="#local-1628017927"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier hs-var">nlWildConPat</span></a><span> </span><a href="#local-1628017927"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_constr_name"><span class="hs-identifier hs-var">mk_constr_name</span></a><span> </span><a href="#local-1628017927"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1362"></a><span>
</span><a name="line-1363"></a><span>        </span><span class="hs-comment">------------ dataTypeOf</span><span>
</span><a name="line-1364"></a><span>    </span><a name="local-1628017899"><a href="#local-1628017899"><span class="hs-identifier">dataTypeOf_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span>
</span><a name="line-1365"></a><span>                        </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1366"></a><span>                        </span><a href="TcGenDeriv.html#dataTypeOf_RDR"><span class="hs-identifier hs-var">dataTypeOf_RDR</span></a><span>
</span><a name="line-1367"></a><span>                        </span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">]</span><span>
</span><a name="line-1368"></a><span>                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_data_type_name"><span class="hs-identifier hs-var">mk_data_type_name</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><span>        </span><span class="hs-comment">------------ gcast1/2</span><span>
</span><a name="line-1371"></a><span>        </span><span class="hs-comment">-- Make the binding    dataCast1 x = gcast1 x  -- if T :: * -&gt; *</span><span>
</span><a name="line-1372"></a><span>        </span><span class="hs-comment">--               or    dataCast2 x = gcast2 s  -- if T :: * -&gt; * -&gt; *</span><span>
</span><a name="line-1373"></a><span>        </span><span class="hs-comment">-- (or nothing if T has neither of these two types)</span><span>
</span><a name="line-1374"></a><span>
</span><a name="line-1375"></a><span>        </span><span class="hs-comment">-- But care is needed for data families:</span><span>
</span><a name="line-1376"></a><span>        </span><span class="hs-comment">-- If we have   data family D a</span><span>
</span><a name="line-1377"></a><span>        </span><span class="hs-comment">--              data instance D (a,b,c) = A | B deriving( Data )</span><span>
</span><a name="line-1378"></a><span>        </span><span class="hs-comment">-- and we want  instance ... =&gt; Data (D [(a,b,c)]) where ...</span><span>
</span><a name="line-1379"></a><span>        </span><span class="hs-comment">-- then we need     dataCast1 x = gcast1 x</span><span>
</span><a name="line-1380"></a><span>        </span><span class="hs-comment">-- because D :: * -&gt; *</span><span>
</span><a name="line-1381"></a><span>        </span><span class="hs-comment">-- even though rep_tc has kind * -&gt; * -&gt; * -&gt; *</span><span>
</span><a name="line-1382"></a><span>        </span><span class="hs-comment">-- Hence looking for the kind of fam_tc not rep_tc</span><span>
</span><a name="line-1383"></a><span>        </span><span class="hs-comment">-- See Trac #4896</span><span>
</span><a name="line-1384"></a><span>    </span><a name="local-1628017900"><a href="#local-1628017900"><span class="hs-identifier">tycon_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1385"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628017928"><a href="#local-1628017928"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1628017928"><span class="hs-identifier hs-var">fam_tc</span></a><span>
</span><a name="line-1386"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1628017884"><span class="hs-identifier hs-var">rep_tc</span></a><span>
</span><a name="line-1387"></a><span>    </span><a name="local-1628017901"><a href="#local-1628017901"><span class="hs-identifier">gcast_binds</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017900"><span class="hs-identifier hs-var">tycon_kind</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#tcEqKind"><span class="hs-identifier hs-var">tcEqKind</span></a><span class="hs-special">`</span><span> </span><a href="TcGenDeriv.html#kind1"><span class="hs-identifier hs-var">kind1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017902"><span class="hs-identifier hs-var">mk_gcast</span></a><span> </span><a href="TcGenDeriv.html#dataCast1_RDR"><span class="hs-identifier hs-var">dataCast1_RDR</span></a><span> </span><a href="TcGenDeriv.html#gcast1_RDR"><span class="hs-identifier hs-var">gcast1_RDR</span></a><span>
</span><a name="line-1388"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017900"><span class="hs-identifier hs-var">tycon_kind</span></a><span> </span><span class="hs-special">`</span><a href="TcType.html#tcEqKind"><span class="hs-identifier hs-var">tcEqKind</span></a><span class="hs-special">`</span><span> </span><a href="TcGenDeriv.html#kind2"><span class="hs-identifier hs-var">kind2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017902"><span class="hs-identifier hs-var">mk_gcast</span></a><span> </span><a href="TcGenDeriv.html#dataCast2_RDR"><span class="hs-identifier hs-var">dataCast2_RDR</span></a><span> </span><a href="TcGenDeriv.html#gcast2_RDR"><span class="hs-identifier hs-var">gcast2_RDR</span></a><span>
</span><a name="line-1389"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1390"></a><span>    </span><a name="local-1628017902"><a href="#local-1628017902"><span class="hs-identifier">mk_gcast</span></a></a><span> </span><a name="local-1628017929"><a href="#local-1628017929"><span class="hs-identifier">dataCast_RDR</span></a></a><span> </span><a name="local-1628017930"><a href="#local-1628017930"><span class="hs-identifier">gcast_RDR</span></a></a><span>
</span><a name="line-1391"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-1628017883"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628017929"><span class="hs-identifier hs-var">dataCast_RDR</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#f_RDR"><span class="hs-identifier hs-var">f_RDR</span></a><span class="hs-special">]</span><span>
</span><a name="line-1392"></a><span>                                 </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628017930"><span class="hs-identifier hs-var">gcast_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#f_RDR"><span class="hs-identifier hs-var">f_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1393"></a><span>
</span><a name="line-1394"></a><span>
</span><a name="line-1395"></a><span class="hs-identifier">kind1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">kind2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-1396"></a><a name="kind1"><a href="TcGenDeriv.html#kind1"><span class="hs-identifier">kind1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">`</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-1397"></a><a name="kind2"><a href="TcGenDeriv.html#kind2"><span class="hs-identifier">kind2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">`</span><span> </span><a href="TcGenDeriv.html#kind1"><span class="hs-identifier hs-var">kind1</span></a><span>
</span><a name="line-1398"></a><span>
</span><a name="line-1399"></a><span class="hs-identifier">gfoldl_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gunfold_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">toConstr_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dataTypeOf_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkConstr_RDR</span><span class="hs-special">,</span><span>
</span><a name="line-1400"></a><span>    </span><span class="hs-identifier">mkDataType_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">conIndex_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">prefix_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">infix_RDR</span><span class="hs-special">,</span><span>
</span><a name="line-1401"></a><span>    </span><span class="hs-identifier">dataCast1_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dataCast2_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gcast1_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gcast2_RDR</span><span class="hs-special">,</span><span>
</span><a name="line-1402"></a><span>    </span><span class="hs-identifier">constr_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dataType_RDR</span><span class="hs-special">,</span><span>
</span><a name="line-1403"></a><span>    </span><span class="hs-identifier">eqChar_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltChar_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geChar_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtChar_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leChar_RDR</span><span>  </span><span class="hs-special">,</span><span>
</span><a name="line-1404"></a><span>    </span><span class="hs-identifier">eqInt_RDR</span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltInt_RDR</span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geInt_RDR</span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtInt_RDR</span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leInt_RDR</span><span>   </span><span class="hs-special">,</span><span>
</span><a name="line-1405"></a><span>    </span><span class="hs-identifier">eqWord_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltWord_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geWord_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtWord_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leWord_RDR</span><span>  </span><span class="hs-special">,</span><span>
</span><a name="line-1406"></a><span>    </span><span class="hs-identifier">eqAddr_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltAddr_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geAddr_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtAddr_RDR</span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leAddr_RDR</span><span>  </span><span class="hs-special">,</span><span>
</span><a name="line-1407"></a><span>    </span><span class="hs-identifier">eqFloat_RDR</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltFloat_RDR</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geFloat_RDR</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtFloat_RDR</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leFloat_RDR</span><span> </span><span class="hs-special">,</span><span>
</span><a name="line-1408"></a><span>    </span><span class="hs-identifier">eqDouble_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltDouble_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geDouble_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtDouble_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leDouble_RDR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1409"></a><a name="gfoldl_RDR"><a href="TcGenDeriv.html#gfoldl_RDR"><span class="hs-identifier">gfoldl_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gfoldl&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1410"></a><a name="gunfold_RDR"><a href="TcGenDeriv.html#gunfold_RDR"><span class="hs-identifier">gunfold_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1411"></a><a name="toConstr_RDR"><a href="TcGenDeriv.html#toConstr_RDR"><span class="hs-identifier">toConstr_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;toConstr&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><a name="dataTypeOf_RDR"><a href="TcGenDeriv.html#dataTypeOf_RDR"><span class="hs-identifier">dataTypeOf_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;dataTypeOf&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><a name="dataCast1_RDR"><a href="TcGenDeriv.html#dataCast1_RDR"><span class="hs-identifier">dataCast1_RDR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;dataCast1&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><a name="dataCast2_RDR"><a href="TcGenDeriv.html#dataCast2_RDR"><span class="hs-identifier">dataCast2_RDR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;dataCast2&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1415"></a><a name="gcast1_RDR"><a href="TcGenDeriv.html#gcast1_RDR"><span class="hs-identifier">gcast1_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#tYPEABLE"><span class="hs-identifier hs-var">tYPEABLE</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gcast1&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1416"></a><a name="gcast2_RDR"><a href="TcGenDeriv.html#gcast2_RDR"><span class="hs-identifier">gcast2_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#tYPEABLE"><span class="hs-identifier hs-var">tYPEABLE</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gcast2&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><a name="mkConstr_RDR"><a href="TcGenDeriv.html#mkConstr_RDR"><span class="hs-identifier">mkConstr_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;mkConstr&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><a name="constr_RDR"><a href="TcGenDeriv.html#constr_RDR"><span class="hs-identifier">constr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#tcQual_RDR"><span class="hs-identifier hs-var">tcQual_RDR</span></a><span>   </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;Constr&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><a name="mkDataType_RDR"><a href="TcGenDeriv.html#mkDataType_RDR"><span class="hs-identifier">mkDataType_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;mkDataType&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1420"></a><a name="dataType_RDR"><a href="TcGenDeriv.html#dataType_RDR"><span class="hs-identifier">dataType_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#tcQual_RDR"><span class="hs-identifier hs-var">tcQual_RDR</span></a><span>   </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;DataType&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1421"></a><a name="conIndex_RDR"><a href="TcGenDeriv.html#conIndex_RDR"><span class="hs-identifier">conIndex_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;constrIndex&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1422"></a><a name="prefix_RDR"><a href="TcGenDeriv.html#prefix_RDR"><span class="hs-identifier">prefix_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#dataQual_RDR"><span class="hs-identifier hs-var">dataQual_RDR</span></a><span> </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;Prefix&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1423"></a><a name="infix_RDR"><a href="TcGenDeriv.html#infix_RDR"><span class="hs-identifier">infix_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#dataQual_RDR"><span class="hs-identifier hs-var">dataQual_RDR</span></a><span> </span><a href="PrelNames.html#gENERICS"><span class="hs-identifier hs-var">gENERICS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;Infix&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><span>
</span><a name="line-1425"></a><a name="eqChar_RDR"><a href="TcGenDeriv.html#eqChar_RDR"><span class="hs-identifier">eqChar_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;eqChar#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1426"></a><a name="ltChar_RDR"><a href="TcGenDeriv.html#ltChar_RDR"><span class="hs-identifier">ltChar_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ltChar#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><a name="leChar_RDR"><a href="TcGenDeriv.html#leChar_RDR"><span class="hs-identifier">leChar_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;leChar#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1428"></a><a name="gtChar_RDR"><a href="TcGenDeriv.html#gtChar_RDR"><span class="hs-identifier">gtChar_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gtChar#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1429"></a><a name="geChar_RDR"><a href="TcGenDeriv.html#geChar_RDR"><span class="hs-identifier">geChar_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;geChar#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1430"></a><span>
</span><a name="line-1431"></a><a name="eqInt_RDR"><a href="TcGenDeriv.html#eqInt_RDR"><span class="hs-identifier">eqInt_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;==#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1432"></a><a name="ltInt_RDR"><a href="TcGenDeriv.html#ltInt_RDR"><span class="hs-identifier">ltInt_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&lt;#&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1433"></a><a name="leInt_RDR"><a href="TcGenDeriv.html#leInt_RDR"><span class="hs-identifier">leInt_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&lt;=#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1434"></a><a name="gtInt_RDR"><a href="TcGenDeriv.html#gtInt_RDR"><span class="hs-identifier">gtInt_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&gt;#&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1435"></a><a name="geInt_RDR"><a href="TcGenDeriv.html#geInt_RDR"><span class="hs-identifier">geInt_RDR</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&gt;=#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1436"></a><span>
</span><a name="line-1437"></a><a name="eqWord_RDR"><a href="TcGenDeriv.html#eqWord_RDR"><span class="hs-identifier">eqWord_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;eqWord#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1438"></a><a name="ltWord_RDR"><a href="TcGenDeriv.html#ltWord_RDR"><span class="hs-identifier">ltWord_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ltWord#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><a name="leWord_RDR"><a href="TcGenDeriv.html#leWord_RDR"><span class="hs-identifier">leWord_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;leWord#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><a name="gtWord_RDR"><a href="TcGenDeriv.html#gtWord_RDR"><span class="hs-identifier">gtWord_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gtWord#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><a name="geWord_RDR"><a href="TcGenDeriv.html#geWord_RDR"><span class="hs-identifier">geWord_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;geWord#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1442"></a><span>
</span><a name="line-1443"></a><a name="eqAddr_RDR"><a href="TcGenDeriv.html#eqAddr_RDR"><span class="hs-identifier">eqAddr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;eqAddr#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><a name="ltAddr_RDR"><a href="TcGenDeriv.html#ltAddr_RDR"><span class="hs-identifier">ltAddr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ltAddr#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><a name="leAddr_RDR"><a href="TcGenDeriv.html#leAddr_RDR"><span class="hs-identifier">leAddr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;leAddr#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1446"></a><a name="gtAddr_RDR"><a href="TcGenDeriv.html#gtAddr_RDR"><span class="hs-identifier">gtAddr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gtAddr#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><a name="geAddr_RDR"><a href="TcGenDeriv.html#geAddr_RDR"><span class="hs-identifier">geAddr_RDR</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;geAddr#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>
</span><a name="line-1449"></a><a name="eqFloat_RDR"><a href="TcGenDeriv.html#eqFloat_RDR"><span class="hs-identifier">eqFloat_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;eqFloat#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><a name="ltFloat_RDR"><a href="TcGenDeriv.html#ltFloat_RDR"><span class="hs-identifier">ltFloat_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ltFloat#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><a name="leFloat_RDR"><a href="TcGenDeriv.html#leFloat_RDR"><span class="hs-identifier">leFloat_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;leFloat#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><a name="gtFloat_RDR"><a href="TcGenDeriv.html#gtFloat_RDR"><span class="hs-identifier">gtFloat_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;gtFloat#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><a name="geFloat_RDR"><a href="TcGenDeriv.html#geFloat_RDR"><span class="hs-identifier">geFloat_RDR</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;geFloat#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1454"></a><span>
</span><a name="line-1455"></a><a name="eqDouble_RDR"><a href="TcGenDeriv.html#eqDouble_RDR"><span class="hs-identifier">eqDouble_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;==##&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><a name="ltDouble_RDR"><a href="TcGenDeriv.html#ltDouble_RDR"><span class="hs-identifier">ltDouble_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&lt;##&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1457"></a><a name="leDouble_RDR"><a href="TcGenDeriv.html#leDouble_RDR"><span class="hs-identifier">leDouble_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&lt;=##&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><a name="gtDouble_RDR"><a href="TcGenDeriv.html#gtDouble_RDR"><span class="hs-identifier">gtDouble_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&gt;##&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><a name="geDouble_RDR"><a href="TcGenDeriv.html#geDouble_RDR"><span class="hs-identifier">geDouble_RDR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#varQual_RDR"><span class="hs-identifier hs-var">varQual_RDR</span></a><span>  </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&gt;=##&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1460"></a><span>
</span><a name="line-1461"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                        Functor instances

 see http://www.mail-archive.com/haskell-prime@haskell.org/msg02116.html

*                                                                      *
************************************************************************

For the data type:

  data T a = T1 Int a | T2 (T a)

We generate the instance:

  instance Functor T where
      fmap f (T1 b1 a) = T1 b1 (f a)
      fmap f (T2 ta)   = T2 (fmap f ta)

Notice that we don't simply apply 'fmap' to the constructor arguments.
Rather
  - Do nothing to an argument whose type doesn't mention 'a'
  - Apply 'f' to an argument of type 'a'
  - Apply 'fmap f' to other arguments
That's why we have to recurse deeply into the constructor argument types,
rather than just one level, as we typically do.

What about types with more than one type parameter?  In general, we only
derive Functor for the last position:

  data S a b = S1 [b] | S2 (a, T a b)
  instance Functor (S a) where
    fmap f (S1 bs)    = S1 (fmap f bs)
    fmap f (S2 (p,q)) = S2 (a, fmap f q)

However, we have special cases for
         - tuples
         - functions

More formally, we write the derivation of fmap code over type variable
'a for type 'b as ($fmap 'a 'b).  In this general notation the derived
instance for T is:

  instance Functor T where
      fmap f (T1 x1 x2) = T1 ($(fmap 'a 'b1) x1) ($(fmap 'a 'a) x2)
      fmap f (T2 x1)    = T2 ($(fmap 'a '(T a)) x1)

  $(fmap 'a 'b)          =  \x -&gt; x     -- when b does not contain a
  $(fmap 'a 'a)          =  f
  $(fmap 'a '(b1,b2))    =  \x -&gt; case x of (x1,x2) -&gt; ($(fmap 'a 'b1) x1, $(fmap 'a 'b2) x2)
  $(fmap 'a '(T b1 b2))  =  fmap $(fmap 'a 'b2)   -- when a only occurs in the last parameter, b2
  $(fmap 'a '(b -&gt; c))   =  \x b -&gt; $(fmap 'a' 'c) (x ($(cofmap 'a 'b) b))

For functions, the type parameter 'a can occur in a contravariant position,
which means we need to derive a function like:

  cofmap :: (a -&gt; b) -&gt; (f b -&gt; f a)

This is pretty much the same as $fmap, only without the $(cofmap 'a 'a) case:

  $(cofmap 'a 'b)          =  \x -&gt; x     -- when b does not contain a
  $(cofmap 'a 'a)          =  error &quot;type variable in contravariant position&quot;
  $(cofmap 'a '(b1,b2))    =  \x -&gt; case x of (x1,x2) -&gt; ($(cofmap 'a 'b1) x1, $(cofmap 'a 'b2) x2)
  $(cofmap 'a '[b])        =  map $(cofmap 'a 'b)
  $(cofmap 'a '(T b1 b2))  =  fmap $(cofmap 'a 'b2)   -- when a only occurs in the last parameter, b2
  $(cofmap 'a '(b -&gt; c))   =  \x b -&gt; $(cofmap 'a' 'c) (x ($(fmap 'a 'c) b))

Note that the code produced by $(fmap _ _) is always a higher order function,
with type `(a -&gt; b) -&gt; (g a -&gt; g b)` for some g. When we need to do pattern
matching on the type, this means create a lambda function (see the (,) case above).
The resulting code for fmap can look a bit weird, for example:

  data X a = X (a,Int)
  -- generated instance
  instance Functor X where
      fmap f (X x) = (\y -&gt; case y of (x1,x2) -&gt; X (f x1, (\z -&gt; z) x2)) x

The optimizer should be able to simplify this code by simple inlining.

An older version of the deriving code tried to avoid these applied
lambda functions by producing a meta level function. But the function to
be mapped, `f`, is a function on the code level, not on the meta level,
so it was eta expanded to `\x -&gt; [| f $x |]`. This resulted in too much eta expansion.
It is better to produce too many lambdas than to eta expand, see ticket #7436.
-}</span><span>
</span><a name="line-1547"></a><span>
</span><a name="line-1548"></a><span class="hs-identifier">gen_Functor_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-1549"></a><a name="gen_Functor_binds"><a href="TcGenDeriv.html#gen_Functor_binds"><span class="hs-identifier">gen_Functor_binds</span></a></a><span> </span><a name="local-1628017931"><a href="#local-1628017931"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628017932"><a href="#local-1628017932"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1550"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="#local-1628017934"><span class="hs-identifier hs-var">fmap_bind</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-1551"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1552"></a><span>    </span><a name="local-1628017933"><a href="#local-1628017933"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628017932"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1553"></a><span>    </span><a name="local-1628017934"><a href="#local-1628017934"><span class="hs-identifier">fmap_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628017931"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#fmap_RDR"><span class="hs-identifier hs-var">fmap_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017936"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-1554"></a><span>
</span><a name="line-1555"></a><span>    </span><a name="local-1628017935"><a href="#local-1628017935"><span class="hs-identifier">fmap_eqn</span></a></a><span> </span><a name="local-1628017939"><a href="#local-1628017939"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="State.html#evalState"><span class="hs-identifier hs-var">evalState</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017938"><span class="hs-identifier hs-var">match_for_con</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#f_Pat"><span class="hs-identifier hs-var">f_Pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628017939"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="#local-1628017940"><span class="hs-identifier hs-var">parts</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1556"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1557"></a><span>        </span><a name="local-1628017940"><a href="#local-1628017940"><span class="hs-identifier">parts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a><span> </span><a href="#local-1628017937"><span class="hs-identifier hs-var">ft_fmap</span></a><span> </span><a href="#local-1628017939"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1558"></a><span>
</span><a name="line-1559"></a><span>    </span><a name="local-1628017936"><a href="#local-1628017936"><span class="hs-identifier">eqns</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628017933"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">]</span><span>
</span><a name="line-1560"></a><span>                                           </span><span class="hs-special">(</span><a href="TcGenDeriv.html#error_Expr"><span class="hs-identifier hs-var">error_Expr</span></a><span> </span><span class="hs-string">&quot;Void fmap&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1561"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628017935"><span class="hs-identifier hs-var">fmap_eqn</span></a><span> </span><a href="#local-1628017933"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-1562"></a><span>
</span><a name="line-1563"></a><span>    </span><span class="hs-identifier">ft_fmap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><span class="hs-special">(</span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><span>    </span><a name="local-1628017937"><a href="#local-1628017937"><span class="hs-identifier">ft_fmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628017941"><a href="#local-1628017941"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628017941"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1565"></a><span>                   </span><span class="hs-comment">-- fmap f = \x -&gt; x</span><span>
</span><a name="line-1566"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TcGenDeriv.html#f_Expr"><span class="hs-identifier hs-var">f_Expr</span></a><span>
</span><a name="line-1567"></a><span>                   </span><span class="hs-comment">-- fmap f = f</span><span>
</span><a name="line-1568"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_fun</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628017942"><a href="#local-1628017942"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1628017943"><a href="#local-1628017943"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1569"></a><span>                     </span><a name="local-1628017944"><a href="#local-1628017944"><span class="hs-identifier">gg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628017942"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1570"></a><span>                     </span><a name="local-1628017945"><a href="#local-1628017945"><span class="hs-identifier">hh</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628017943"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-1571"></a><span>                     </span><a href="TcGenDeriv.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628017946"><a href="#local-1628017946"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628017947"><a href="#local-1628017947"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1572"></a><span>                       </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="#local-1628017945"><span class="hs-identifier hs-var">hh</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="#local-1628017946"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="#local-1628017944"><span class="hs-identifier hs-var">gg</span></a><span> </span><a href="#local-1628017947"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1573"></a><span>                   </span><span class="hs-comment">-- fmap f = \x b -&gt; h (x (g b))</span><span>
</span><a name="line-1574"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628017948"><a href="#local-1628017948"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628017949"><a href="#local-1628017949"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1575"></a><span>                     </span><a name="local-1628017950"><a href="#local-1628017950"><span class="hs-identifier">gg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="#local-1628017949"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-1576"></a><span>                     </span><a href="TcGenDeriv.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a><span> </span><a href="#local-1628017938"><span class="hs-identifier hs-var">match_for_con</span></a><span> </span><a href="#local-1628017948"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1628017950"><span class="hs-identifier hs-var">gg</span></a><span>
</span><a name="line-1577"></a><span>                   </span><span class="hs-comment">-- fmap f = \x -&gt; case x of (a1,a2,..) -&gt; (g1 a1,g2 a2,..)</span><span>
</span><a name="line-1578"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_ty_app</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628017951"><a href="#local-1628017951"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="TcGenDeriv.html#fmap_Expr"><span class="hs-identifier hs-var">fmap_Expr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628017951"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1579"></a><span>                   </span><span class="hs-comment">-- fmap f = fmap g</span><span>
</span><a name="line-1580"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628017952"><a href="#local-1628017952"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017952"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1581"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;in other argument&quot;</span><span>
</span><a name="line-1582"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;contravariant&quot;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span>    </span><span class="hs-comment">-- Con a1 a2 ... -&gt; Con (f1 a1) (f2 a2) ...</span><span>
</span><a name="line-1585"></a><span>    </span><span class="hs-identifier">match_for_con</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1586"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1587"></a><span>    </span><a name="local-1628017938"><a href="#local-1628017938"><span class="hs-identifier">match_for_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkSimpleConMatch"><span class="hs-identifier hs-var">mkSimpleConMatch</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1588"></a><span>        </span><span class="hs-glyph">\</span><a name="local-1628017953"><a href="#local-1628017953"><span class="hs-identifier">con_name</span></a></a><span> </span><a name="local-1628017954"><a href="#local-1628017954"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="#local-1628017953"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="#local-1628017954"><span class="hs-identifier hs-var">xs</span></a><span>  </span><span class="hs-comment">-- Con x1 x2 ..</span><span>
</span><a name="line-1589"></a><span>
</span><a name="line-1590"></a><span class="hs-comment">{-
Utility functions related to Functor deriving.

Since several things use the same pattern of traversal, this is abstracted into functorLikeTraverse.
This function works like a fold: it makes a value of type 'a' in a bottom up way.
-}</span><span>
</span><a name="line-1596"></a><span>
</span><a name="line-1597"></a><span class="hs-comment">-- Generic traversal for Functor deriving</span><span>
</span><a name="line-1598"></a><span class="hs-comment">-- See Note [FFoldType and functorLikeTraverse]</span><span>
</span><a name="line-1599"></a><span class="hs-keyword">data</span><span> </span><a name="FFoldType"><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier">FFoldType</span></a></a><span> </span><a name="local-1628017561"><a href="#local-1628017561"><span class="hs-identifier">a</span></a></a><span>      </span><span class="hs-comment">-- Describes how to fold over a Type in a functor like way</span><span>
</span><a name="line-1600"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="FT"><a href="TcGenDeriv.html#FT"><span class="hs-identifier">FT</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="ft_triv"><a href="TcGenDeriv.html#ft_triv"><span class="hs-identifier">ft_triv</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1601"></a><span>          </span><span class="hs-comment">-- ^ Does not contain variable</span><span>
</span><a name="line-1602"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_var"><a href="TcGenDeriv.html#ft_var"><span class="hs-identifier">ft_var</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1603"></a><span>          </span><span class="hs-comment">-- ^ The variable itself</span><span>
</span><a name="line-1604"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_co_var"><a href="TcGenDeriv.html#ft_co_var"><span class="hs-identifier">ft_co_var</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1605"></a><span>          </span><span class="hs-comment">-- ^ The variable itself, contravariantly</span><span>
</span><a name="line-1606"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_fun"><a href="TcGenDeriv.html#ft_fun"><span class="hs-identifier">ft_fun</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1607"></a><span>          </span><span class="hs-comment">-- ^ Function type</span><span>
</span><a name="line-1608"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_tup"><a href="TcGenDeriv.html#ft_tup"><span class="hs-identifier">ft_tup</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1609"></a><span>          </span><span class="hs-comment">-- ^ Tuple type</span><span>
</span><a name="line-1610"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_ty_app"><a href="TcGenDeriv.html#ft_ty_app"><span class="hs-identifier">ft_ty_app</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1611"></a><span>          </span><span class="hs-comment">-- ^ Type app, variable only in last argument</span><span>
</span><a name="line-1612"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_bad_app"><a href="TcGenDeriv.html#ft_bad_app"><span class="hs-identifier">ft_bad_app</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1613"></a><span>          </span><span class="hs-comment">-- ^ Type app, variable other than in last argument</span><span>
</span><a name="line-1614"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ft_forall"><a href="TcGenDeriv.html#ft_forall"><span class="hs-identifier">ft_forall</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017561"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1615"></a><span>          </span><span class="hs-comment">-- ^ Forall type</span><span>
</span><a name="line-1616"></a><span>     </span><span class="hs-special">}</span><span>
</span><a name="line-1617"></a><span>
</span><a name="line-1618"></a><span class="hs-identifier">functorLikeTraverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1628017568"><a href="#local-1628017568"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-1619"></a><span>                       </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>         </span><span class="hs-comment">-- ^ Variable to look for</span><span>
</span><a name="line-1620"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><a href="#local-1628017568"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^ How to fold</span><span>
</span><a name="line-1621"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>          </span><span class="hs-comment">-- ^ Type to process</span><span>
</span><a name="line-1622"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017568"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1623"></a><a name="functorLikeTraverse"><a href="TcGenDeriv.html#functorLikeTraverse"><span class="hs-identifier">functorLikeTraverse</span></a></a><span> </span><a name="local-1628017955"><a href="#local-1628017955"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017956"><a href="#local-1628017956"><span class="hs-identifier">caseTrivial</span></a></a><span class="hs-special">,</span><span>     </span><span class="hs-identifier">ft_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017957"><a href="#local-1628017957"><span class="hs-identifier">caseVar</span></a></a><span>
</span><a name="line-1624"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017958"><a href="#local-1628017958"><span class="hs-identifier">caseCoVar</span></a></a><span class="hs-special">,</span><span>     </span><span class="hs-identifier">ft_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017959"><a href="#local-1628017959"><span class="hs-identifier">caseFun</span></a></a><span>
</span><a name="line-1625"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017960"><a href="#local-1628017960"><span class="hs-identifier">caseTuple</span></a></a><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ft_ty_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017961"><a href="#local-1628017961"><span class="hs-identifier">caseTyApp</span></a></a><span>
</span><a name="line-1626"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017962"><a href="#local-1628017962"><span class="hs-identifier">caseWrongArg</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628017963"><a href="#local-1628017963"><span class="hs-identifier">caseForAll</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span>                    </span><a name="local-1628017964"><a href="#local-1628017964"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1628"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-1628017964"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1630"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>        </span><span class="hs-comment">-- Covariant or contravariant context</span><span>
</span><a name="line-1631"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1632"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628017568"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- (result of type a, does type contain var)</span><span>
</span><a name="line-1633"></a><span>
</span><a name="line-1634"></a><span>    </span><a name="local-1628017965"><a href="#local-1628017965"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1628017966"><a href="#local-1628017966"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628017967"><a href="#local-1628017967"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628017968"><a href="#local-1628017968"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1628017967"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017966"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628017968"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1635"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628017969"><a href="#local-1628017969"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span>    </span><a name="local-1628017970"><a href="#local-1628017970"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017970"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628017955"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-1628017969"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628017958"><span class="hs-identifier hs-var">caseCoVar</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-1628017957"><span class="hs-identifier hs-var">caseVar</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628017971"><a href="#local-1628017971"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628017972"><a href="#local-1628017972"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628017973"><a href="#local-1628017973"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-1628017972"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017971"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628017973"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1637"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017975"><span class="hs-identifier hs-var">xc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1628017977"><span class="hs-identifier hs-var">yc</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017959"><span class="hs-identifier hs-var">caseFun</span></a><span> </span><a href="#local-1628017974"><span class="hs-identifier hs-var">xr</span></a><span> </span><a href="#local-1628017976"><span class="hs-identifier hs-var">yr</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1638"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-1628017974"><a href="#local-1628017974"><span class="hs-identifier">xr</span></a></a><span class="hs-special">,</span><a name="local-1628017975"><a href="#local-1628017975"><span class="hs-identifier">xc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628017971"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017972"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1639"></a><span>              </span><span class="hs-special">(</span><a name="local-1628017976"><a href="#local-1628017976"><span class="hs-identifier">yr</span></a></a><span class="hs-special">,</span><a name="local-1628017977"><a href="#local-1628017977"><span class="hs-identifier">yc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017971"><span class="hs-identifier hs-var">co</span></a><span>       </span><a href="#local-1628017973"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1640"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628017978"><a href="#local-1628017978"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span>    </span><a name="local-1628017979"><a href="#local-1628017979"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628017980"><a href="#local-1628017980"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017981"><span class="hs-identifier hs-var">xc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017962"><span class="hs-identifier hs-var">caseWrongArg</span></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1641"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017983"><span class="hs-identifier hs-var">yc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017961"><span class="hs-identifier hs-var">caseTyApp</span></a><span> </span><a href="#local-1628017979"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1628017982"><span class="hs-identifier hs-var">yr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1642"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628017981"><a href="#local-1628017981"><span class="hs-identifier">xc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017978"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628017979"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1643"></a><span>              </span><span class="hs-special">(</span><a name="local-1628017982"><a href="#local-1628017982"><span class="hs-identifier">yr</span></a></a><span class="hs-special">,</span><a name="local-1628017983"><a href="#local-1628017983"><span class="hs-identifier">yc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017978"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628017980"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1644"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628017984"><a href="#local-1628017984"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1628017985"><a href="#local-1628017985"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1628017986"><a href="#local-1628017986"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628017987"><a href="#local-1628017987"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1645"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#or"><span class="hs-identifier hs-var">or</span></a><span> </span><a href="#local-1628017989"><span class="hs-identifier hs-var">xcs</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017956"><span class="hs-identifier hs-var">caseTrivial</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Variable does not occur</span><span>
</span><a name="line-1646"></a><span>       </span><span class="hs-comment">-- At this point we know that xrs, xcs is not empty,</span><span>
</span><a name="line-1647"></a><span>       </span><span class="hs-comment">-- and at least one xr is True</span><span>
</span><a name="line-1648"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-1628017986"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017960"><span class="hs-identifier hs-var">caseTuple</span></a><span> </span><a href="#local-1628017986"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628017988"><span class="hs-identifier hs-var">xrs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#or"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#init"><span class="hs-identifier hs-var">init</span></a><span> </span><a href="#local-1628017989"><span class="hs-identifier hs-var">xcs</span></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017962"><span class="hs-identifier hs-var">caseWrongArg</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- T (..var..)    ty</span><span>
</span><a name="line-1650"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628017990"><a href="#local-1628017990"><span class="hs-identifier">fun_ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-1628017985"><span class="hs-identifier hs-var">ty</span></a><span>         </span><span class="hs-comment">-- T (..no var..) ty</span><span>
</span><a name="line-1651"></a><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017961"><span class="hs-identifier hs-var">caseTyApp</span></a><span> </span><a href="#local-1628017990"><span class="hs-identifier hs-var">fun_ty</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span> </span><a href="#local-1628017988"><span class="hs-identifier hs-var">xrs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1652"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017962"><span class="hs-identifier hs-var">caseWrongArg</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Non-decomposable (eg type function)</span><span>
</span><a name="line-1653"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-1654"></a><span>         </span><span class="hs-special">(</span><a name="local-1628017988"><a href="#local-1628017988"><span class="hs-identifier">xrs</span></a></a><span class="hs-special">,</span><a name="local-1628017989"><a href="#local-1628017989"><span class="hs-identifier">xcs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017984"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017987"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1655"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="TyCoRep.html#Visible"><span class="hs-identifier hs-var">Visible</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;unexpected visible binder&quot;</span><span>
</span><a name="line-1656"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628017991"><a href="#local-1628017991"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628017992"><a href="#local-1628017992"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><a name="local-1628017993"><a href="#local-1628017993"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628017992"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-1628017955"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628017995"><span class="hs-identifier hs-var">xc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017963"><span class="hs-identifier hs-var">caseForAll</span></a><span> </span><a href="#local-1628017992"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-1628017994"><span class="hs-identifier hs-var">xr</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1657"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-1628017994"><a href="#local-1628017994"><span class="hs-identifier">xr</span></a></a><span class="hs-special">,</span><a name="local-1628017995"><a href="#local-1628017995"><span class="hs-identifier">xc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628017965"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628017991"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628017993"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1658"></a><span>
</span><a name="line-1659"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628017956"><span class="hs-identifier hs-var">caseTrivial</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-1660"></a><span>
</span><a name="line-1661"></a><span class="hs-comment">-- Return all syntactic subterms of ty that contain var somewhere</span><span>
</span><a name="line-1662"></a><span class="hs-comment">-- These are the things that should appear in instance constraints</span><span>
</span><a name="line-1663"></a><span class="hs-identifier">deepSubtypesContaining</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span>
</span><a name="line-1664"></a><a name="deepSubtypesContaining"><a href="TcGenDeriv.html#deepSubtypesContaining"><span class="hs-identifier">deepSubtypesContaining</span></a></a><span> </span><a name="local-1628017996"><a href="#local-1628017996"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1665"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#functorLikeTraverse"><span class="hs-identifier hs-var">functorLikeTraverse</span></a><span> </span><a href="#local-1628017996"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1666"></a><span>        </span><span class="hs-special">(</span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1667"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_var</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1668"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span>
</span><a name="line-1669"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628017997"><a href="#local-1628017997"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="#local-1628017997"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1670"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_ty_app</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-1671"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;in other argument&quot;</span><span>
</span><a name="line-1672"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;contravariant&quot;</span><span>
</span><a name="line-1673"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628017998"><a href="#local-1628017998"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-1628017999"><a href="#local-1628017999"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1628017998"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628017999"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1674"></a><span>
</span><a name="line-1675"></a><span>
</span><a name="line-1676"></a><span class="hs-identifier">foldDataConArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><a href="#local-1628017567"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628017567"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1677"></a><span class="hs-comment">-- Fold over the arguments of the datacon</span><span>
</span><a name="line-1678"></a><a name="foldDataConArgs"><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier">foldDataConArgs</span></a></a><span> </span><a name="local-1628018000"><a href="#local-1628018000"><span class="hs-identifier">ft</span></a></a><span> </span><a name="local-1628018001"><a href="#local-1628018001"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1679"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018002"><span class="hs-identifier hs-var">foldArg</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628018001"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-1680"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1681"></a><span>    </span><a name="local-1628018002"><a href="#local-1628018002"><span class="hs-identifier">foldArg</span></a></a><span>
</span><a name="line-1682"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#tyConAppArgs"><span class="hs-identifier hs-var">tyConAppArgs</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConOrigResTy"><span class="hs-identifier hs-var">dataConOrigResTy</span></a><span> </span><a href="#local-1628018001"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1683"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628018003"><a href="#local-1628018003"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#functorLikeTraverse"><span class="hs-identifier hs-var">functorLikeTraverse</span></a><span> </span><a href="#local-1628018003"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1628018000"><span class="hs-identifier hs-var">ft</span></a><span>
</span><a name="line-1684"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ft_triv</span><span> </span><a href="#local-1628018000"><span class="hs-identifier hs-var">ft</span></a><span class="hs-special">)</span><span>
</span><a name="line-1685"></a><span>    </span><span class="hs-comment">-- If we are deriving Foldable for a GADT, there is a chance that the last</span><span>
</span><a name="line-1686"></a><span>    </span><span class="hs-comment">-- type variable in the data type isn't actually a type variable at all.</span><span>
</span><a name="line-1687"></a><span>    </span><span class="hs-comment">-- (for example, this can happen if the last type variable is refined to</span><span>
</span><a name="line-1688"></a><span>    </span><span class="hs-comment">-- be a concrete type such as Int). If the last type variable is refined</span><span>
</span><a name="line-1689"></a><span>    </span><span class="hs-comment">-- to be a specific type, then getTyVar_maybe will return Nothing.</span><span>
</span><a name="line-1690"></a><span>    </span><span class="hs-comment">-- See Note [DeriveFoldable with ExistentialQuantification]</span><span>
</span><a name="line-1691"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1692"></a><span>    </span><span class="hs-comment">-- The kind checks have ensured the last type parameter is of kind *.</span><span>
</span><a name="line-1693"></a><span>
</span><a name="line-1694"></a><span class="hs-comment">-- Make a HsLam using a fresh variable from a State monad</span><span>
</span><a name="line-1695"></a><span class="hs-identifier">mkSimpleLam</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1696"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1697"></a><span class="hs-comment">-- (mkSimpleLam fn) returns (\x. fn(x))</span><span>
</span><a name="line-1698"></a><a name="mkSimpleLam"><a href="TcGenDeriv.html#mkSimpleLam"><span class="hs-identifier">mkSimpleLam</span></a></a><span> </span><a name="local-1628018004"><a href="#local-1628018004"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1699"></a><span>    </span><span class="hs-special">(</span><a name="local-1628018005"><a href="#local-1628018005"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">:</span><a name="local-1628018006"><a href="#local-1628018006"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="State.html#get"><span class="hs-identifier hs-var">get</span></a><span>
</span><a name="line-1700"></a><span>    </span><a href="State.html#put"><span class="hs-identifier hs-var">put</span></a><span> </span><a href="#local-1628018006"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1701"></a><span>    </span><a name="local-1628018007"><a href="#local-1628018007"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018004"><span class="hs-identifier hs-var">lam</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018005"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1702"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628018005"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018007"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-1703"></a><span>
</span><a name="line-1704"></a><span class="hs-identifier">mkSimpleLam2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1705"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1706"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1707"></a><a name="mkSimpleLam2"><a href="TcGenDeriv.html#mkSimpleLam2"><span class="hs-identifier">mkSimpleLam2</span></a></a><span> </span><a name="local-1628018008"><a href="#local-1628018008"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1708"></a><span>    </span><span class="hs-special">(</span><a name="local-1628018009"><a href="#local-1628018009"><span class="hs-identifier">n1</span></a></a><span class="hs-glyph">:</span><a name="local-1628018010"><a href="#local-1628018010"><span class="hs-identifier">n2</span></a></a><span class="hs-glyph">:</span><a name="local-1628018011"><a href="#local-1628018011"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="State.html#get"><span class="hs-identifier hs-var">get</span></a><span>
</span><a name="line-1709"></a><span>    </span><a href="State.html#put"><span class="hs-identifier hs-var">put</span></a><span> </span><a href="#local-1628018011"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1710"></a><span>    </span><a name="local-1628018012"><a href="#local-1628018012"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018008"><span class="hs-identifier hs-var">lam</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018009"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018010"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1711"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628018009"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">,</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628018010"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018012"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-1712"></a><span>
</span><a name="line-1713"></a><span class="hs-comment">-- &quot;Con a1 a2 a3 -&gt; fold [x1 a1, x2 a2, x3 a3]&quot;</span><span>
</span><a name="line-1714"></a><span class="hs-comment">--</span><span>
</span><a name="line-1715"></a><span class="hs-comment">-- @mkSimpleConMatch fold extra_pats con insides@ produces a match clause in</span><span>
</span><a name="line-1716"></a><span class="hs-comment">-- which the LHS pattern-matches on @extra_pats@, followed by a match on the</span><span>
</span><a name="line-1717"></a><span class="hs-comment">-- constructor @con@ and its arguments. The RHS folds (with @fold@) over @con@</span><span>
</span><a name="line-1718"></a><span class="hs-comment">-- and its arguments, applying an expression (from @insides@) to each of the</span><span>
</span><a name="line-1719"></a><span class="hs-comment">-- respective arguments of @con@.</span><span>
</span><a name="line-1720"></a><span class="hs-identifier">mkSimpleConMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-1628017566"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017566"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1721"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1722"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1723"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1724"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017566"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1725"></a><a name="mkSimpleConMatch"><a href="TcGenDeriv.html#mkSimpleConMatch"><span class="hs-identifier">mkSimpleConMatch</span></a></a><span> </span><a name="local-1628018013"><a href="#local-1628018013"><span class="hs-identifier">fold</span></a></a><span> </span><a name="local-1628018014"><a href="#local-1628018014"><span class="hs-identifier">extra_pats</span></a></a><span> </span><a name="local-1628018015"><a href="#local-1628018015"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628018016"><a href="#local-1628018016"><span class="hs-identifier">insides</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1726"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018017"><a href="#local-1628018017"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628018015"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1727"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018018"><a href="#local-1628018018"><span class="hs-identifier">vars_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#takeList"><span class="hs-identifier hs-var">takeList</span></a><span> </span><a href="#local-1628018016"><span class="hs-identifier hs-var">insides</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-1728"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018019"><a href="#local-1628018019"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628018017"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="#local-1628018018"><span class="hs-identifier hs-var">vars_needed</span></a><span>
</span><a name="line-1729"></a><span>    </span><a name="local-1628018020"><a href="#local-1628018020"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018013"><span class="hs-identifier hs-var">fold</span></a><span> </span><a href="#local-1628018017"><span class="hs-identifier hs-var">con_name</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="#local-1628018016"><span class="hs-identifier hs-var">insides</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018018"><span class="hs-identifier hs-var">vars_needed</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1730"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018014"><span class="hs-identifier hs-var">extra_pats</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018019"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1628018020"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1731"></a><span>
</span><a name="line-1732"></a><span class="hs-comment">-- &quot;Con a1 a2 a3 -&gt; fmap (\b2 -&gt; Con a1 b2 a3) (traverse f a2)&quot;</span><span>
</span><a name="line-1733"></a><span class="hs-comment">--</span><span>
</span><a name="line-1734"></a><span class="hs-comment">-- @mkSimpleConMatch2 fold extra_pats con insides@ behaves very similarly to</span><span>
</span><a name="line-1735"></a><span class="hs-comment">-- 'mkSimpleConMatch', with two key differences:</span><span>
</span><a name="line-1736"></a><span class="hs-comment">--</span><span>
</span><a name="line-1737"></a><span class="hs-comment">-- 1. @insides@ is a @[Maybe (LHsExpr RdrName)]@ instead of a</span><span>
</span><a name="line-1738"></a><span class="hs-comment">--    @[LHsExpr RdrName]@. This is because it filters out the expressions</span><span>
</span><a name="line-1739"></a><span class="hs-comment">--    corresponding to arguments whose types do not mention the last type</span><span>
</span><a name="line-1740"></a><span class="hs-comment">--    variable in a derived 'Foldable' or 'Traversable' instance (i.e., the</span><span>
</span><a name="line-1741"></a><span class="hs-comment">--    'Nothing' elements of @insides@).</span><span>
</span><a name="line-1742"></a><span class="hs-comment">--</span><span>
</span><a name="line-1743"></a><span class="hs-comment">-- 2. @fold@ takes an expression as its first argument instead of a</span><span>
</span><a name="line-1744"></a><span class="hs-comment">--    constructor name. This is because it uses a specialized</span><span>
</span><a name="line-1745"></a><span class="hs-comment">--    constructor function expression that only takes as many parameters as</span><span>
</span><a name="line-1746"></a><span class="hs-comment">--    there are argument types that mention the last type variable.</span><span>
</span><a name="line-1747"></a><span class="hs-comment">--</span><span>
</span><a name="line-1748"></a><span class="hs-comment">-- See Note [Generated code for DeriveFoldable and DeriveTraversable]</span><span>
</span><a name="line-1749"></a><span class="hs-identifier">mkSimpleConMatch2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-1628017565"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-1750"></a><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1751"></a><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017565"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1752"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1753"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1754"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1755"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017565"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1756"></a><a name="mkSimpleConMatch2"><a href="TcGenDeriv.html#mkSimpleConMatch2"><span class="hs-identifier">mkSimpleConMatch2</span></a></a><span> </span><a name="local-1628018021"><a href="#local-1628018021"><span class="hs-identifier">fold</span></a></a><span> </span><a name="local-1628018022"><a href="#local-1628018022"><span class="hs-identifier">extra_pats</span></a></a><span> </span><a name="local-1628018023"><a href="#local-1628018023"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628018024"><a href="#local-1628018024"><span class="hs-identifier">insides</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1757"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018025"><a href="#local-1628018025"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628018023"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1758"></a><span>        </span><a name="local-1628018026"><a href="#local-1628018026"><span class="hs-identifier">vars_needed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#takeList"><span class="hs-identifier hs-var">takeList</span></a><span> </span><a href="#local-1628018024"><span class="hs-identifier hs-var">insides</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-1759"></a><span>        </span><a name="local-1628018027"><a href="#local-1628018027"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628018025"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="#local-1628018026"><span class="hs-identifier hs-var">vars_needed</span></a><span>
</span><a name="line-1760"></a><span>        </span><span class="hs-comment">-- Make sure to zip BEFORE invoking catMaybes. We want the variable</span><span>
</span><a name="line-1761"></a><span>        </span><span class="hs-comment">-- indicies in each expression to match up with the argument indices</span><span>
</span><a name="line-1762"></a><span>        </span><span class="hs-comment">-- in con_expr (defined below).</span><span>
</span><a name="line-1763"></a><span>        </span><a name="local-1628018028"><a href="#local-1628018028"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628018033"><a href="#local-1628018033"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-1628018034"><a href="#local-1628018034"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018034"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628018033"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-1764"></a><span>                                   </span><a href="#local-1628018024"><span class="hs-identifier hs-var">insides</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018026"><span class="hs-identifier hs-var">vars_needed</span></a><span class="hs-special">)</span><span>
</span><a name="line-1765"></a><span>        </span><span class="hs-comment">-- An element of argTysTyVarInfo is True if the constructor argument</span><span>
</span><a name="line-1766"></a><span>        </span><span class="hs-comment">-- with the same index has a type which mentions the last type</span><span>
</span><a name="line-1767"></a><span>        </span><span class="hs-comment">-- variable.</span><span>
</span><a name="line-1768"></a><span>        </span><a name="local-1628018029"><a href="#local-1628018029"><span class="hs-identifier">argTysTyVarInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-1628018024"><span class="hs-identifier hs-var">insides</span></a><span>
</span><a name="line-1769"></a><span>        </span><span class="hs-special">(</span><a name="local-1628018030"><a href="#local-1628018030"><span class="hs-identifier">asWithTyVar</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628018031"><a href="#local-1628018031"><span class="hs-identifier">asWithoutTyVar</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#partitionByList"><span class="hs-identifier hs-var">partitionByList</span></a><span> </span><a href="#local-1628018029"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-1770"></a><span>
</span><a name="line-1771"></a><span>        </span><a name="local-1628018032"><a href="#local-1628018032"><span class="hs-identifier">con_expr</span></a></a><span>
</span><a name="line-1772"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628018030"><span class="hs-identifier hs-var">asWithTyVar</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="#local-1628018025"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018031"><span class="hs-identifier hs-var">asWithoutTyVar</span></a><span>
</span><a name="line-1773"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1774"></a><span>              </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018035"><a href="#local-1628018035"><span class="hs-identifier">bs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a><span>  </span><a href="#local-1628018029"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1775"></a><span>                  </span><a name="local-1628018036"><a href="#local-1628018036"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterByLists"><span class="hs-identifier hs-var">filterByLists</span></a><span> </span><a href="#local-1628018029"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a><span>
</span><a name="line-1776"></a><span>                                       </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1777"></a><span>                                       </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><span>              </span><span class="hs-keyword">in</span><span> </span><a href="HsUtils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628018035"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="#local-1628018025"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="#local-1628018036"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1779"></a><span>
</span><a name="line-1780"></a><span>    </span><a name="local-1628018037"><a href="#local-1628018037"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018021"><span class="hs-identifier hs-var">fold</span></a><span> </span><a href="#local-1628018032"><span class="hs-identifier hs-var">con_expr</span></a><span> </span><a href="#local-1628018028"><span class="hs-identifier hs-var">exps</span></a><span>
</span><a name="line-1781"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018022"><span class="hs-identifier hs-var">extra_pats</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018027"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1628018037"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1782"></a><span>
</span><a name="line-1783"></a><span class="hs-comment">-- &quot;case x of (a1,a2,a3) -&gt; fold [x1 a1, x2 a2, x3 a3]&quot;</span><span>
</span><a name="line-1784"></a><span class="hs-identifier">mkSimpleTupleCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-1628017563"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628017564"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1785"></a><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017563"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1786"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628017564"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017563"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1787"></a><a name="mkSimpleTupleCase"><a href="TcGenDeriv.html#mkSimpleTupleCase"><span class="hs-identifier">mkSimpleTupleCase</span></a></a><span> </span><a name="local-1628018038"><a href="#local-1628018038"><span class="hs-identifier">match_for_con</span></a></a><span> </span><a name="local-1628018039"><a href="#local-1628018039"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1628018040"><a href="#local-1628018040"><span class="hs-identifier">insides</span></a></a><span> </span><a name="local-1628018041"><a href="#local-1628018041"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-1788"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628018042"><a href="#local-1628018042"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConSingleDataCon"><span class="hs-identifier hs-var">tyConSingleDataCon</span></a><span> </span><a href="#local-1628018039"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1789"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628018043"><a href="#local-1628018043"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018038"><span class="hs-identifier hs-var">match_for_con</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1628018042"><span class="hs-identifier hs-var">data_con</span></a><span> </span><a href="#local-1628018040"><span class="hs-identifier hs-var">insides</span></a><span>
</span><a name="line-1790"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><a href="#local-1628018041"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018043"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1791"></a><span>
</span><a name="line-1792"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                        Foldable instances

 see http://www.mail-archive.com/haskell-prime@haskell.org/msg02116.html

*                                                                      *
************************************************************************

Deriving Foldable instances works the same way as Functor instances,
only Foldable instances are not possible for function types at all.
Given (data T a = T a a (T a) deriving Foldable), we get:

  instance Foldable T where
      foldr f z (T x1 x2 x3) =
        $(foldr 'a 'a) x1 ( $(foldr 'a 'a) x2 ( $(foldr 'a '(T a)) x3 z ) )

-XDeriveFoldable is different from -XDeriveFunctor in that it filters out
arguments to the constructor that would produce useless code in a Foldable
instance. For example, the following datatype:

  data Foo a = Foo Int a Int deriving Foldable

would have the following generated Foldable instance:

  instance Foldable Foo where
    foldr f z (Foo x1 x2 x3) = $(foldr 'a 'a) x2

since neither of the two Int arguments are folded over.

The cases are:

  $(foldr 'a 'a)         =  f
  $(foldr 'a '(b1,b2))   =  \x z -&gt; case x of (x1,x2) -&gt; $(foldr 'a 'b1) x1 ( $(foldr 'a 'b2) x2 z )
  $(foldr 'a '(T b1 b2)) =  \x z -&gt; foldr $(foldr 'a 'b2) z x  -- when a only occurs in the last parameter, b2

Note that the arguments to the real foldr function are the wrong way around,
since (f :: a -&gt; b -&gt; b), while (foldr f :: b -&gt; t a -&gt; b).

One can envision a case for types that don't contain the last type variable:

  $(foldr 'a 'b)         =  \x z -&gt; z     -- when b does not contain a

But this case will never materialize, since the aforementioned filtering
removes all such types from consideration.
See Note [Generated code for DeriveFoldable and DeriveTraversable].

Foldable instances differ from Functor and Traversable instances in that
Foldable instances can be derived for data types in which the last type
variable is existentially quantified. In particular, if the last type variable
is refined to a more specific type in a GADT:

  data GADT a where
      G :: a ~ Int =&gt; a -&gt; G Int

then the deriving machinery does not attempt to check that the type a contains
Int, since it is not syntactically equal to a type variable. That is, the
derived Foldable instance for GADT is:

  instance Foldable GADT where
      foldr _ z (GADT _) = z

See Note [DeriveFoldable with ExistentialQuantification].

-}</span><span>
</span><a name="line-1858"></a><span>
</span><a name="line-1859"></a><span class="hs-identifier">gen_Foldable_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-1860"></a><a name="gen_Foldable_binds"><a href="TcGenDeriv.html#gen_Foldable_binds"><span class="hs-identifier">gen_Foldable_binds</span></a></a><span> </span><a name="local-1628018044"><a href="#local-1628018044"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018045"><a href="#local-1628018045"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1861"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018047"><span class="hs-identifier hs-var">foldr_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018050"><span class="hs-identifier hs-var">foldMap_bind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-1862"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1863"></a><span>    </span><a name="local-1628018046"><a href="#local-1628018046"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628018045"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1864"></a><span>
</span><a name="line-1865"></a><span>    </span><a name="local-1628018047"><a href="#local-1628018047"><span class="hs-identifier">foldr_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018044"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#foldable_foldr_RDR"><span class="hs-identifier hs-var">foldable_foldr_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018048"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-1866"></a><span>    </span><a name="local-1628018048"><a href="#local-1628018048"><span class="hs-identifier">eqns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018049"><span class="hs-identifier hs-var">foldr_eqn</span></a><span> </span><a href="#local-1628018046"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-1867"></a><span>    </span><a name="local-1628018049"><a href="#local-1628018049"><span class="hs-identifier">foldr_eqn</span></a></a><span> </span><a name="local-1628018056"><a href="#local-1628018056"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1868"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="State.html#evalState"><span class="hs-identifier hs-var">evalState</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018053"><span class="hs-identifier hs-var">match_foldr</span></a><span> </span><a href="TcGenDeriv.html#z_Expr"><span class="hs-identifier hs-var">z_Expr</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#f_Pat"><span class="hs-identifier hs-var">f_Pat</span></a><span class="hs-special">,</span><a href="TcGenDeriv.html#z_Pat"><span class="hs-identifier hs-var">z_Pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018056"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="#local-1628018057"><span class="hs-identifier hs-var">parts</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1869"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1870"></a><span>        </span><a name="local-1628018057"><a href="#local-1628018057"><span class="hs-identifier">parts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a><span> </span><a href="#local-1628018052"><span class="hs-identifier hs-var">ft_foldr</span></a><span> </span><a href="#local-1628018056"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span>    </span><a name="local-1628018050"><a href="#local-1628018050"><span class="hs-identifier">foldMap_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018044"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#foldMap_RDR"><span class="hs-identifier hs-var">foldMap_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018051"><span class="hs-identifier hs-var">foldMap_eqn</span></a><span> </span><a href="#local-1628018046"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1873"></a><span>    </span><a name="local-1628018051"><a href="#local-1628018051"><span class="hs-identifier">foldMap_eqn</span></a></a><span> </span><a name="local-1628018058"><a href="#local-1628018058"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1874"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="State.html#evalState"><span class="hs-identifier hs-var">evalState</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018055"><span class="hs-identifier hs-var">match_foldMap</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#f_Pat"><span class="hs-identifier hs-var">f_Pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018058"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="#local-1628018059"><span class="hs-identifier hs-var">parts</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1875"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1876"></a><span>        </span><a name="local-1628018059"><a href="#local-1628018059"><span class="hs-identifier">parts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a><span> </span><a href="#local-1628018054"><span class="hs-identifier hs-var">ft_foldMap</span></a><span> </span><a href="#local-1628018058"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1877"></a><span>
</span><a name="line-1878"></a><span>    </span><span class="hs-comment">-- Yields 'Just' an expression if we're folding over a type that mentions</span><span>
</span><a name="line-1879"></a><span>    </span><span class="hs-comment">-- the last type parameter of the datatype. Otherwise, yields 'Nothing'.</span><span>
</span><a name="line-1880"></a><span>    </span><span class="hs-comment">-- See Note [FFoldType and functorLikeTraverse]</span><span>
</span><a name="line-1881"></a><span>    </span><span class="hs-identifier">ft_foldr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><span class="hs-special">(</span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1882"></a><span>    </span><a name="local-1628018052"><a href="#local-1628018052"><span class="hs-identifier">ft_foldr</span></a></a><span>
</span><a name="line-1883"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1884"></a><span>             </span><span class="hs-comment">-- foldr f = \x z -&gt; z</span><span>
</span><a name="line-1885"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_var</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcGenDeriv.html#f_Expr"><span class="hs-identifier hs-var">f_Expr</span></a><span>
</span><a name="line-1886"></a><span>             </span><span class="hs-comment">-- foldr f = f</span><span>
</span><a name="line-1887"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628018060"><a href="#local-1628018060"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628018061"><a href="#local-1628018061"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1888"></a><span>               </span><a name="local-1628018062"><a href="#local-1628018062"><span class="hs-identifier">gg</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="#local-1628018061"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1889"></a><span>               </span><a name="local-1628018065"><a href="#local-1628018065"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcGenDeriv.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628018063"><a href="#local-1628018063"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628018064"><a href="#local-1628018064"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1890"></a><span>                 </span><a href="TcGenDeriv.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018053"><span class="hs-identifier hs-var">match_foldr</span></a><span> </span><a href="#local-1628018064"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018060"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1628018062"><span class="hs-identifier hs-var">gg</span></a><span> </span><a href="#local-1628018063"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1891"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628018065"><span class="hs-identifier hs-var">lam</span></a><span class="hs-special">)</span><span>
</span><a name="line-1892"></a><span>             </span><span class="hs-comment">-- foldr f = (\x z -&gt; case x of ...)</span><span>
</span><a name="line-1893"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_ty_app</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018066"><a href="#local-1628018066"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1894"></a><span>               </span><a name="local-1628018067"><a href="#local-1628018067"><span class="hs-identifier">gg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018066"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1895"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628018068"><a href="#local-1628018068"><span class="hs-identifier">gg'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628018069"><a href="#local-1628018069"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628018070"><a href="#local-1628018070"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1896"></a><span>                 </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#foldable_foldr_RDR"><span class="hs-identifier hs-var">foldable_foldr_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018068"><span class="hs-identifier hs-var">gg'</span></a><span class="hs-special">,</span><a href="#local-1628018070"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><a href="#local-1628018069"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1628018067"><span class="hs-identifier hs-var">gg</span></a><span>
</span><a name="line-1897"></a><span>             </span><span class="hs-comment">-- foldr f = (\x z -&gt; foldr g z x)</span><span>
</span><a name="line-1898"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018071"><a href="#local-1628018071"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628018071"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1899"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;contravariant&quot;</span><span>
</span><a name="line-1900"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_fun</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;function&quot;</span><span>
</span><a name="line-1901"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;in other argument&quot;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1902"></a><span>
</span><a name="line-1903"></a><span>    </span><span class="hs-identifier">match_foldr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1904"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1905"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1906"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1907"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1908"></a><span>    </span><a name="local-1628018053"><a href="#local-1628018053"><span class="hs-identifier">match_foldr</span></a></a><span> </span><a name="local-1628018072"><a href="#local-1628018072"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018074"><a href="#local-1628018074"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018073"><span class="hs-identifier hs-var">mkFoldr</span></a><span> </span><a href="#local-1628018074"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1909"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1910"></a><span>        </span><span class="hs-comment">-- g1 v1 (g2 v2 (.. z))</span><span>
</span><a name="line-1911"></a><span>        </span><span class="hs-identifier">mkFoldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1912"></a><span>        </span><a name="local-1628018073"><a href="#local-1628018073"><span class="hs-identifier">mkFoldr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="#local-1628018072"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1913"></a><span>
</span><a name="line-1914"></a><span>    </span><span class="hs-comment">-- See Note [FFoldType and functorLikeTraverse]</span><span>
</span><a name="line-1915"></a><span>    </span><span class="hs-identifier">ft_foldMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><span class="hs-special">(</span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1916"></a><span>    </span><a name="local-1628018054"><a href="#local-1628018054"><span class="hs-identifier">ft_foldMap</span></a></a><span>
</span><a name="line-1917"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1918"></a><span>             </span><span class="hs-comment">-- foldMap f = \x -&gt; mempty</span><span>
</span><a name="line-1919"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcGenDeriv.html#f_Expr"><span class="hs-identifier hs-var">f_Expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1920"></a><span>             </span><span class="hs-comment">-- foldMap f = f</span><span>
</span><a name="line-1921"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628018075"><a href="#local-1628018075"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628018076"><a href="#local-1628018076"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1922"></a><span>               </span><a name="local-1628018077"><a href="#local-1628018077"><span class="hs-identifier">gg</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="#local-1628018076"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1923"></a><span>               </span><a name="local-1628018078"><a href="#local-1628018078"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcGenDeriv.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a><span> </span><a href="#local-1628018055"><span class="hs-identifier hs-var">match_foldMap</span></a><span> </span><a href="#local-1628018075"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1628018077"><span class="hs-identifier hs-var">gg</span></a><span>
</span><a name="line-1924"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628018078"><span class="hs-identifier hs-var">lam</span></a><span class="hs-special">)</span><span>
</span><a name="line-1925"></a><span>             </span><span class="hs-comment">-- foldMap f = \x -&gt; case x of (..,)</span><span>
</span><a name="line-1926"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_ty_app</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018079"><a href="#local-1628018079"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="TcGenDeriv.html#foldMap_Expr"><span class="hs-identifier hs-var">foldMap_Expr</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628018079"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1927"></a><span>             </span><span class="hs-comment">-- foldMap f = foldMap g</span><span>
</span><a name="line-1928"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018080"><a href="#local-1628018080"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628018080"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-1929"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;contravariant&quot;</span><span>
</span><a name="line-1930"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;function&quot;</span><span>
</span><a name="line-1931"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;in other argument&quot;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span>    </span><span class="hs-identifier">match_foldMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1934"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1935"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1936"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1937"></a><span>    </span><a name="local-1628018055"><a href="#local-1628018055"><span class="hs-identifier">match_foldMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018085"><a href="#local-1628018085"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018081"><span class="hs-identifier hs-var">mkFoldMap</span></a><span> </span><a href="#local-1628018085"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1938"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1939"></a><span>        </span><span class="hs-comment">-- mappend v1 (mappend v2 ..)</span><span>
</span><a name="line-1940"></a><span>        </span><span class="hs-identifier">mkFoldMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1941"></a><span>        </span><a name="local-1628018081"><a href="#local-1628018081"><span class="hs-identifier">mkFoldMap</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mempty_Expr"><span class="hs-identifier hs-var">mempty_Expr</span></a><span>
</span><a name="line-1942"></a><span>        </span><span class="hs-identifier">mkFoldMap</span><span> </span><a name="local-1628018082"><a href="#local-1628018082"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628018083"><a href="#local-1628018083"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628018084"><a href="#local-1628018084"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#mappend_RDR"><span class="hs-identifier hs-var">mappend_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018083"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-1628018084"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1628018082"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1943"></a><span>
</span><a name="line-1944"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                        Traversable instances

 see http://www.mail-archive.com/haskell-prime@haskell.org/msg02116.html
*                                                                      *
************************************************************************

Again, Traversable is much like Functor and Foldable.

The cases are:

  $(traverse 'a 'a)          =  f
  $(traverse 'a '(b1,b2))    =  \x -&gt; case x of (x1,x2) -&gt; (,) &lt;$&gt; $(traverse 'a 'b1) x1 &lt;*&gt; $(traverse 'a 'b2) x2
  $(traverse 'a '(T b1 b2))  =  traverse $(traverse 'a 'b2)  -- when a only occurs in the last parameter, b2

Like -XDeriveFoldable, -XDeriveTraversable filters out arguments whose types
do not mention the last type parameter. Therefore, the following datatype:

  data Foo a = Foo Int a Int

would have the following derived Traversable instance:

  instance Traversable Foo where
    traverse f (Foo x1 x2 x3) =
      fmap (\b2 -&gt; Foo x1 b2 x3) ( $(traverse 'a 'a) x2 )

since the two Int arguments do not produce any effects in a traversal.

One can envision a case for types that do not mention the last type parameter:

  $(traverse 'a 'b)          =  pure     -- when b does not contain a

But this case will never materialize, since the aforementioned filtering
removes all such types from consideration.
See Note [Generated code for DeriveFoldable and DeriveTraversable].
-}</span><span>
</span><a name="line-1982"></a><span>
</span><a name="line-1983"></a><span class="hs-identifier">gen_Traversable_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-1984"></a><a name="gen_Traversable_binds"><a href="TcGenDeriv.html#gen_Traversable_binds"><span class="hs-identifier">gen_Traversable_binds</span></a></a><span> </span><a name="local-1628018086"><a href="#local-1628018086"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018087"><a href="#local-1628018087"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1985"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="#local-1628018089"><span class="hs-identifier hs-var">traverse_bind</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-1986"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1987"></a><span>    </span><a name="local-1628018088"><a href="#local-1628018088"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628018087"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1988"></a><span>
</span><a name="line-1989"></a><span>    </span><a name="local-1628018089"><a href="#local-1628018089"><span class="hs-identifier">traverse_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018086"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="PrelNames.html#traverse_RDR"><span class="hs-identifier hs-var">traverse_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018090"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-1990"></a><span>    </span><a name="local-1628018090"><a href="#local-1628018090"><span class="hs-identifier">eqns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018091"><span class="hs-identifier hs-var">traverse_eqn</span></a><span> </span><a href="#local-1628018088"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-1991"></a><span>    </span><a name="local-1628018091"><a href="#local-1628018091"><span class="hs-identifier">traverse_eqn</span></a></a><span> </span><a name="local-1628018094"><a href="#local-1628018094"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-1992"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="State.html#evalState"><span class="hs-identifier hs-var">evalState</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018093"><span class="hs-identifier hs-var">match_for_con</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#f_Pat"><span class="hs-identifier hs-var">f_Pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018094"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="#local-1628018095"><span class="hs-identifier hs-var">parts</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier hs-var">bs_RDRs</span></a><span>
</span><a name="line-1993"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1994"></a><span>        </span><a name="local-1628018095"><a href="#local-1628018095"><span class="hs-identifier">parts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a><span> </span><a href="#local-1628018092"><span class="hs-identifier hs-var">ft_trav</span></a><span> </span><a href="#local-1628018094"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1995"></a><span>
</span><a name="line-1996"></a><span>    </span><span class="hs-comment">-- Yields 'Just' an expression if we're folding over a type that mentions</span><span>
</span><a name="line-1997"></a><span>    </span><span class="hs-comment">-- the last type parameter of the datatype. Otherwise, yields 'Nothing'.</span><span>
</span><a name="line-1998"></a><span>    </span><span class="hs-comment">-- See Note [FFoldType and functorLikeTraverse]</span><span>
</span><a name="line-1999"></a><span>    </span><span class="hs-identifier">ft_trav</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a><span> </span><span class="hs-special">(</span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2000"></a><span>    </span><a name="local-1628018092"><a href="#local-1628018092"><span class="hs-identifier">ft_trav</span></a></a><span>
</span><a name="line-2001"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#FT"><span class="hs-identifier hs-var">FT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ft_triv</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2002"></a><span>             </span><span class="hs-comment">-- traverse f = pure x</span><span>
</span><a name="line-2003"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_var</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TcGenDeriv.html#f_Expr"><span class="hs-identifier hs-var">f_Expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2004"></a><span>             </span><span class="hs-comment">-- traverse f = f x</span><span>
</span><a name="line-2005"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_tup</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628018096"><a href="#local-1628018096"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628018097"><a href="#local-1628018097"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2006"></a><span>               </span><a name="local-1628018098"><a href="#local-1628018098"><span class="hs-identifier">gg</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><a href="#local-1628018097"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-2007"></a><span>               </span><a name="local-1628018099"><a href="#local-1628018099"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcGenDeriv.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcGenDeriv.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a><span> </span><a href="#local-1628018093"><span class="hs-identifier hs-var">match_for_con</span></a><span> </span><a href="#local-1628018096"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1628018098"><span class="hs-identifier hs-var">gg</span></a><span>
</span><a name="line-2008"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628018099"><span class="hs-identifier hs-var">lam</span></a><span class="hs-special">)</span><span>
</span><a name="line-2009"></a><span>             </span><span class="hs-comment">-- traverse f = \x -&gt; case x of (a1,a2,..) -&gt;</span><span>
</span><a name="line-2010"></a><span>             </span><span class="hs-comment">--                           (,,) &lt;$&gt; g1 a1 &lt;*&gt; g2 a2 &lt;*&gt; ..</span><span>
</span><a name="line-2011"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_ty_app</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018100"><a href="#local-1628018100"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><a href="TcGenDeriv.html#traverse_Expr"><span class="hs-identifier hs-var">traverse_Expr</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628018100"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-2012"></a><span>             </span><span class="hs-comment">-- traverse f = traverse g</span><span>
</span><a name="line-2013"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_forall</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-1628018101"><a href="#local-1628018101"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628018101"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-2014"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_co_var</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;contravariant&quot;</span><span>
</span><a name="line-2015"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_fun</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;function&quot;</span><span>
</span><a name="line-2016"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ft_bad_app</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;in other argument&quot;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2017"></a><span>
</span><a name="line-2018"></a><span>    </span><span class="hs-comment">-- Con a1 a2 ... -&gt; fmap (\b1 b2 ... -&gt; Con b1 b2 ...) (g1 a1)</span><span>
</span><a name="line-2019"></a><span>    </span><span class="hs-comment">--                    &lt;*&gt; g2 a2 &lt;*&gt; ...</span><span>
</span><a name="line-2020"></a><span>    </span><span class="hs-identifier">match_for_con</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-2021"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2022"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2023"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2024"></a><span>    </span><a name="local-1628018093"><a href="#local-1628018093"><span class="hs-identifier">match_for_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1628018110"><a href="#local-1628018110"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628018111"><a href="#local-1628018111"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018102"><span class="hs-identifier hs-var">mkApCon</span></a><span> </span><a href="#local-1628018110"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628018111"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2025"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-2026"></a><span>        </span><span class="hs-comment">-- fmap (\b1 b2 ... -&gt; Con b1 b2 ...) x1 &lt;*&gt; x2 &lt;*&gt; ..</span><span>
</span><a name="line-2027"></a><span>        </span><span class="hs-identifier">mkApCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2028"></a><span>        </span><a name="local-1628018102"><a href="#local-1628018102"><span class="hs-identifier">mkApCon</span></a></a><span> </span><a name="local-1628018103"><a href="#local-1628018103"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#pure_RDR"><span class="hs-identifier hs-var">pure_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018103"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-2029"></a><span>        </span><span class="hs-identifier">mkApCon</span><span> </span><a name="local-1628018104"><a href="#local-1628018104"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628018105"><a href="#local-1628018105"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1628018106"><a href="#local-1628018106"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-1628018107"><span class="hs-identifier hs-var">appAp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#fmap_RDR"><span class="hs-identifier hs-var">fmap_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018104"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><a href="#local-1628018105"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-1628018106"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2030"></a><span>          </span><span class="hs-keyword">where</span><span> </span><a name="local-1628018107"><a href="#local-1628018107"><span class="hs-identifier">appAp</span></a></a><span> </span><a name="local-1628018108"><a href="#local-1628018108"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628018109"><a href="#local-1628018109"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="PrelNames.html#ap_RDR"><span class="hs-identifier hs-var">ap_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018108"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-1628018109"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2031"></a><span>
</span><a name="line-2032"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                        Lift instances
*                                                                      *
************************************************************************

Example:

    data Foo a = Foo a | a :^: a deriving Lift

    ==&gt;

    instance (Lift a) =&gt; Lift (Foo a) where
        lift (Foo a)
          = appE
              (conE
                (mkNameG_d &quot;package-name&quot; &quot;ModuleName&quot; &quot;Foo&quot;))
              (lift a)
        lift (u :^: v)
          = infixApp
              (lift u)
              (conE
                (mkNameG_d &quot;package-name&quot; &quot;ModuleName&quot; &quot;:^:&quot;))
              (lift v)

Note that (mkNameG_d &quot;package-name&quot; &quot;ModuleName&quot; &quot;Foo&quot;) is equivalent to what
'Foo would be when using the -XTemplateHaskell extension. To make sure that
-XDeriveLift can be used on stage-1 compilers, however, we expliticly invoke
makeG_d.
-}</span><span>
</span><a name="line-2063"></a><span>
</span><a name="line-2064"></a><span class="hs-identifier">gen_Lift_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-2065"></a><a name="gen_Lift_binds"><a href="TcGenDeriv.html#gen_Lift_binds"><span class="hs-identifier">gen_Lift_binds</span></a></a><span> </span><a name="local-1628018112"><a href="#local-1628018112"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018113"><a href="#local-1628018113"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-2066"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628018116"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018112"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018112"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="THNames.html#lift_RDR"><span class="hs-identifier hs-var">lift_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2067"></a><span>                       </span><span class="hs-special">[</span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018114"><span class="hs-identifier hs-var">errorMsg_Expr</span></a><span>
</span><a name="line-2068"></a><span>                                            </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2069"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-2070"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="#local-1628018115"><span class="hs-identifier hs-var">lift_bind</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-2071"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2072"></a><span>    </span><a name="local-1628018114"><a href="#local-1628018114"><span class="hs-identifier">errorMsg_Expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#error_RDR"><span class="hs-identifier hs-var">error_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span>
</span><a name="line-2073"></a><span>        </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;Can't lift value of empty datatype &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628018117"><span class="hs-identifier hs-var">tycon_str</span></a><span class="hs-special">)</span><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span>    </span><a name="local-1628018115"><a href="#local-1628018115"><span class="hs-identifier">lift_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628018112"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="THNames.html#lift_RDR"><span class="hs-identifier hs-var">lift_RDR</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018118"><span class="hs-identifier hs-var">pats_etc</span></a><span> </span><a href="#local-1628018116"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-2076"></a><span>    </span><a name="local-1628018116"><a href="#local-1628018116"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628018113"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2077"></a><span>    </span><a name="local-1628018117"><a href="#local-1628018117"><span class="hs-identifier">tycon_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628018113"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2078"></a><span>
</span><a name="line-2079"></a><span>    </span><a name="local-1628018118"><a href="#local-1628018118"><span class="hs-identifier">pats_etc</span></a></a><span> </span><a name="local-1628018119"><a href="#local-1628018119"><span class="hs-identifier">data_con</span></a></a><span>
</span><a name="line-2080"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1628018120"><span class="hs-identifier hs-var">con_pat</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1628018133"><span class="hs-identifier hs-var">lift_Expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2081"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-2082"></a><span>            </span><a name="local-1628018120"><a href="#local-1628018120"><span class="hs-identifier">con_pat</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="#local-1628018121"><span class="hs-identifier hs-var">data_con_RDR</span></a><span> </span><a href="#local-1628018123"><span class="hs-identifier hs-var">as_needed</span></a><span>
</span><a name="line-2083"></a><span>            </span><a name="local-1628018121"><a href="#local-1628018121"><span class="hs-identifier">data_con_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628018119"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-2084"></a><span>            </span><a name="local-1628018122"><a href="#local-1628018122"><span class="hs-identifier">con_arity</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-1628018119"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-2085"></a><span>            </span><a name="local-1628018123"><a href="#local-1628018123"><span class="hs-identifier">as_needed</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1628018122"><span class="hs-identifier hs-var">con_arity</span></a><span> </span><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier hs-var">as_RDRs</span></a><span>
</span><a name="line-2086"></a><span>            </span><a name="local-1628018124"><a href="#local-1628018124"><span class="hs-identifier">lifted_as</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a><span> </span><span class="hs-string">&quot;mk_lift_app&quot;</span><span> </span><a href="#local-1628018128"><span class="hs-identifier hs-var">mk_lift_app</span></a><span>
</span><a name="line-2087"></a><span>                             </span><a href="#local-1628018127"><span class="hs-identifier hs-var">tys_needed</span></a><span> </span><a href="#local-1628018123"><span class="hs-identifier hs-var">as_needed</span></a><span>
</span><a name="line-2088"></a><span>            </span><a name="local-1628018125"><a href="#local-1628018125"><span class="hs-identifier">tycon_name</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628018113"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2089"></a><span>            </span><a name="local-1628018126"><a href="#local-1628018126"><span class="hs-identifier">is_infix</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConIsInfix"><span class="hs-identifier hs-var">dataConIsInfix</span></a><span> </span><a href="#local-1628018119"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-2090"></a><span>            </span><a name="local-1628018127"><a href="#local-1628018127"><span class="hs-identifier">tys_needed</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a><span> </span><a href="#local-1628018119"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-2091"></a><span>
</span><a name="line-2092"></a><span>            </span><a name="local-1628018128"><a href="#local-1628018128"><span class="hs-identifier">mk_lift_app</span></a></a><span> </span><a name="local-1628018136"><a href="#local-1628018136"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628018137"><a href="#local-1628018137"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-2093"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628018136"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#lift_RDR"><span class="hs-identifier hs-var">lift_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2094"></a><span>                                                  </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018137"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2095"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#litE_RDR"><span class="hs-identifier hs-var">litE_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2096"></a><span>                              </span><span class="hs-special">(</span><a href="#local-1628018138"><span class="hs-identifier hs-var">primLitOp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018139"><span class="hs-identifier hs-var">mkBoxExp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018137"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2097"></a><span>              </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-1628018138"><a href="#local-1628018138"><span class="hs-identifier">primLitOp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628018139"><a href="#local-1628018139"><span class="hs-identifier">mkBoxExp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#primLitOps"><span class="hs-identifier hs-var">primLitOps</span></a><span> </span><span class="hs-string">&quot;Lift&quot;</span><span> </span><a href="#local-1628018113"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628018136"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2098"></a><span>
</span><a name="line-2099"></a><span>            </span><a name="local-1628018129"><a href="#local-1628018129"><span class="hs-identifier">pkg_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#unitIdString"><span class="hs-identifier hs-var">unitIdString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">moduleUnitId</span><span>
</span><a name="line-2100"></a><span>                     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628018125"><span class="hs-identifier hs-var">tycon_name</span></a><span>
</span><a name="line-2101"></a><span>            </span><a name="local-1628018130"><a href="#local-1628018130"><span class="hs-identifier">mod_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">moduleName</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628018125"><span class="hs-identifier hs-var">tycon_name</span></a><span>
</span><a name="line-2102"></a><span>            </span><a name="local-1628018131"><a href="#local-1628018131"><span class="hs-identifier">con_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628018119"><span class="hs-identifier hs-var">data_con</span></a><span>
</span><a name="line-2103"></a><span>
</span><a name="line-2104"></a><span>            </span><a name="local-1628018132"><a href="#local-1628018132"><span class="hs-identifier">conE_Expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#conE_RDR"><span class="hs-identifier hs-var">conE_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2105"></a><span>                                </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="THNames.html#mkNameG_dRDR"><span class="hs-identifier hs-var">mkNameG_dRDR</span></a><span>
</span><a name="line-2106"></a><span>                                  </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span class="hs-special">)</span><span>
</span><a name="line-2107"></a><span>                                    </span><span class="hs-special">[</span><a href="#local-1628018129"><span class="hs-identifier hs-var">pkg_name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018130"><span class="hs-identifier hs-var">mod_name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018131"><span class="hs-identifier hs-var">con_name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2108"></a><span>
</span><a name="line-2109"></a><span>            </span><a name="local-1628018133"><a href="#local-1628018133"><span class="hs-identifier">lift_Expr</span></a></a><span>
</span><a name="line-2110"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628018126"><span class="hs-identifier hs-var">is_infix</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="THNames.html#infixApp_RDR"><span class="hs-identifier hs-var">infixApp_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018134"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018132"><span class="hs-identifier hs-var">conE_Expr</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018135"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2111"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="TcGenDeriv.html#mk_appE_app"><span class="hs-identifier hs-var">mk_appE_app</span></a><span> </span><a href="#local-1628018132"><span class="hs-identifier hs-var">conE_Expr</span></a><span> </span><a href="#local-1628018124"><span class="hs-identifier hs-var">lifted_as</span></a><span>
</span><a name="line-2112"></a><span>            </span><span class="hs-special">(</span><a name="local-1628018134"><a href="#local-1628018134"><span class="hs-identifier">a1</span></a></a><span class="hs-glyph">:</span><a name="local-1628018135"><a href="#local-1628018135"><span class="hs-identifier">a2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018124"><span class="hs-identifier hs-var">lifted_as</span></a><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><span class="hs-identifier">mk_appE_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2115"></a><a name="mk_appE_app"><a href="TcGenDeriv.html#mk_appE_app"><span class="hs-identifier">mk_appE_app</span></a></a><span> </span><a name="local-1628018140"><a href="#local-1628018140"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628018141"><a href="#local-1628018141"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="THNames.html#appE_RDR"><span class="hs-identifier hs-var">appE_RDR</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628018140"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018141"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-2116"></a><span>
</span><a name="line-2117"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     Newtype-deriving instances
*                                                                      *
************************************************************************

Note [Newtype-deriving instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We take every method in the original instance and `coerce` it to fit
into the derived instance. We need a type annotation on the argument
to `coerce` to make it obvious what instantiation of the method we're
coercing from.  So from, say,
  class C a b where
    op :: a -&gt; [b] -&gt; Int

  newtype T x = MkT &lt;rep-ty&gt;

  instance C a &lt;rep-ty&gt; =&gt; C a (T x) where
    op = (coerce
             (op :: a -&gt; [&lt;rep-ty&gt;] -&gt; Int)
         ) :: a -&gt; [T x] -&gt; Int

Notice that we give the 'coerce' call two type signatures: one to
fix the of the inner call, and one for the expected type.  The outer
type signature ought to be redundant, but may improve error messages.
The inner one is essential to fix the type at which 'op' is called.

See #8503 for more discussion.

Here's a wrinkle. Supppose 'op' is locally overloaded:

  class C2 b where
    op2 :: forall a. Eq a =&gt; a -&gt; [b] -&gt; Int

Then we could do exactly as above, but it's a bit redundant to
instantiate op, then re-generalise with the inner signature.
(The inner sig is only there to fix the type at which 'op' is
called.)  So we just instantiate the signature, and add

  instance C2 &lt;rep-ty&gt; =&gt; C2 (T x) where
    op2 = (coerce
             (op2 :: a -&gt; [&lt;rep-ty&gt;] -&gt; Int)
          ) :: forall a. Eq a =&gt; a -&gt; [T x] -&gt; Int
-}</span><span>
</span><a name="line-2162"></a><span>
</span><a name="line-2163"></a><span class="hs-identifier">gen_Newtype_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-2164"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>   </span><span class="hs-comment">-- the class being derived</span><span>
</span><a name="line-2165"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- the tvs in the instance head</span><span>
</span><a name="line-2166"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- instance head parameters (incl. newtype)</span><span>
</span><a name="line-2167"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>    </span><span class="hs-comment">-- the representation type (already eta-reduced)</span><span>
</span><a name="line-2168"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2169"></a><span class="hs-comment">-- See Note [Newtype-deriving instances]</span><span>
</span><a name="line-2170"></a><a name="gen_Newtype_binds"><a href="TcGenDeriv.html#gen_Newtype_binds"><span class="hs-identifier">gen_Newtype_binds</span></a></a><span> </span><a name="local-1628018142"><a href="#local-1628018142"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018143"><a href="#local-1628018143"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-1628018144"><a href="#local-1628018144"><span class="hs-identifier">inst_tvs</span></a></a><span> </span><a name="local-1628018145"><a href="#local-1628018145"><span class="hs-identifier">cls_tys</span></a></a><span> </span><a name="local-1628018146"><a href="#local-1628018146"><span class="hs-identifier">rhs_ty</span></a></a><span>
</span><a name="line-2171"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018148"><span class="hs-identifier hs-var">mk_bind</span></a><span> </span><span class="hs-special">(</span><a href="Class.html#classMethods"><span class="hs-identifier hs-var">classMethods</span></a><span> </span><a href="#local-1628018143"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2172"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2173"></a><span>    </span><a name="local-1628018147"><a href="#local-1628018147"><span class="hs-identifier">coerce_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="MkId.html#coerceId"><span class="hs-identifier hs-var">coerceId</span></a><span>
</span><a name="line-2174"></a><span>
</span><a name="line-2175"></a><span>    </span><span class="hs-identifier">mk_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2176"></a><span>    </span><a name="local-1628018148"><a href="#local-1628018148"><span class="hs-identifier">mk_bind</span></a></a><span> </span><a name="local-1628018150"><a href="#local-1628018150"><span class="hs-identifier">meth_id</span></a></a><span>
</span><a name="line-2177"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018142"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018154"><span class="hs-identifier hs-var">meth_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1628018155"><span class="hs-identifier hs-var">rhs_expr</span></a><span class="hs-special">]</span><span>
</span><a name="line-2178"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-2179"></a><span>        </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-1628018151"><a href="#local-1628018151"><span class="hs-identifier">from_ty</span></a></a><span> </span><a name="local-1628018152"><a href="#local-1628018152"><span class="hs-identifier">to_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkCoerceClassMethEqn"><span class="hs-identifier hs-var">mkCoerceClassMethEqn</span></a><span> </span><a href="#local-1628018143"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-1628018144"><span class="hs-identifier hs-var">inst_tvs</span></a><span> </span><a href="#local-1628018145"><span class="hs-identifier hs-var">cls_tys</span></a><span> </span><a href="#local-1628018146"><span class="hs-identifier hs-var">rhs_ty</span></a><span> </span><a href="#local-1628018150"><span class="hs-identifier hs-var">meth_id</span></a><span>
</span><a name="line-2180"></a><span>
</span><a name="line-2181"></a><span>        </span><span class="hs-comment">-- See &quot;wrinkle&quot; in Note [Newtype-deriving instances]</span><span>
</span><a name="line-2182"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628018153"><a href="#local-1628018153"><span class="hs-identifier">from_ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var">tcSplitSigmaTy</span></a><span> </span><a href="#local-1628018151"><span class="hs-identifier hs-var">from_ty</span></a><span>
</span><a name="line-2183"></a><span>
</span><a name="line-2184"></a><span>        </span><a name="local-1628018154"><a href="#local-1628018154"><span class="hs-identifier">meth_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-1628018150"><span class="hs-identifier hs-var">meth_id</span></a><span>
</span><a name="line-2185"></a><span>
</span><a name="line-2186"></a><span>        </span><a name="local-1628018155"><a href="#local-1628018155"><span class="hs-identifier">rhs_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018147"><span class="hs-identifier hs-var">coerce_RDR</span></a><span>
</span><a name="line-2187"></a><span>                      </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span>
</span><a name="line-2188"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018154"><span class="hs-identifier hs-var">meth_RDR</span></a><span> </span><span class="hs-special">`</span><a href="#local-1628018149"><span class="hs-identifier hs-var">nlExprWithTySig</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#toLHsSigWcType"><span class="hs-identifier hs-var">toLHsSigWcType</span></a><span> </span><a href="#local-1628018153"><span class="hs-identifier hs-var">from_ty'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2189"></a><span>                  </span><span class="hs-special">`</span><a href="#local-1628018149"><span class="hs-identifier hs-var">nlExprWithTySig</span></a><span class="hs-special">`</span><span> </span><a href="HsUtils.html#toLHsSigWcType"><span class="hs-identifier hs-var">toLHsSigWcType</span></a><span> </span><a href="#local-1628018152"><span class="hs-identifier hs-var">to_ty</span></a><span>
</span><a name="line-2190"></a><span>
</span><a name="line-2191"></a><span>
</span><a name="line-2192"></a><span>    </span><span class="hs-identifier">nlExprWithTySig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2193"></a><span>    </span><a name="local-1628018149"><a href="#local-1628018149"><span class="hs-identifier">nlExprWithTySig</span></a></a><span> </span><a name="local-1628018156"><a href="#local-1628018156"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628018157"><a href="#local-1628018157"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a><span> </span><a href="#local-1628018156"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-1628018157"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-2194"></a><span>
</span><a name="line-2195"></a><span class="hs-identifier">mkCoerceClassMethEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>   </span><span class="hs-comment">-- the class being derived</span><span>
</span><a name="line-2196"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- the tvs in the instance head</span><span>
</span><a name="line-2197"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- instance head parameters (incl. newtype)</span><span>
</span><a name="line-2198"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>    </span><span class="hs-comment">-- the representation type (already eta-reduced)</span><span>
</span><a name="line-2199"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>      </span><span class="hs-comment">-- the method to look at</span><span>
</span><a name="line-2200"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-2201"></a><span class="hs-comment">-- See Note [Newtype-deriving instances]</span><span>
</span><a name="line-2202"></a><span class="hs-comment">-- The pair is the (from_type, to_type), where to_type is</span><span>
</span><a name="line-2203"></a><span class="hs-comment">-- the type of the method we are tyrying to get</span><span>
</span><a name="line-2204"></a><a name="mkCoerceClassMethEqn"><a href="TcGenDeriv.html#mkCoerceClassMethEqn"><span class="hs-identifier">mkCoerceClassMethEqn</span></a></a><span> </span><a name="local-1628018158"><a href="#local-1628018158"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-1628018159"><a href="#local-1628018159"><span class="hs-identifier">inst_tvs</span></a></a><span> </span><a name="local-1628018160"><a href="#local-1628018160"><span class="hs-identifier">cls_tys</span></a></a><span> </span><a name="local-1628018161"><a href="#local-1628018161"><span class="hs-identifier">rhs_ty</span></a></a><span> </span><a name="local-1628018162"><a href="#local-1628018162"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-2205"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1628018166"><span class="hs-identifier hs-var">rhs_subst</span></a><span> </span><a href="#local-1628018169"><span class="hs-identifier hs-var">user_meth_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2206"></a><span>         </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1628018165"><span class="hs-identifier hs-var">lhs_subst</span></a><span> </span><a href="#local-1628018169"><span class="hs-identifier hs-var">user_meth_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2207"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2208"></a><span>    </span><a name="local-1628018163"><a href="#local-1628018163"><span class="hs-identifier">cls_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">classTyVars</span><span> </span><a href="#local-1628018158"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-2209"></a><span>    </span><a name="local-1628018164"><a href="#local-1628018164"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="VarSet.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a><span> </span><a href="#local-1628018159"><span class="hs-identifier hs-var">inst_tvs</span></a><span>
</span><a name="line-2210"></a><span>    </span><a name="local-1628018165"><a href="#local-1628018165"><span class="hs-identifier">lhs_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a><span> </span><a href="#local-1628018164"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a><span> </span><a href="#local-1628018163"><span class="hs-identifier hs-var">cls_tvs</span></a><span> </span><a href="#local-1628018160"><span class="hs-identifier hs-var">cls_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-2211"></a><span>    </span><a name="local-1628018166"><a href="#local-1628018166"><span class="hs-identifier">rhs_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a><span> </span><a href="#local-1628018164"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a><span> </span><a href="#local-1628018163"><span class="hs-identifier hs-var">cls_tvs</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018170"><span class="hs-identifier hs-var">changeLast</span></a><span> </span><a href="#local-1628018160"><span class="hs-identifier hs-var">cls_tys</span></a><span> </span><a href="#local-1628018161"><span class="hs-identifier hs-var">rhs_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2212"></a><span>    </span><span class="hs-special">(</span><a name="local-1628018167"><a href="#local-1628018167"><span class="hs-identifier">_class_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628018168"><a href="#local-1628018168"><span class="hs-identifier">_class_constraint</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628018169"><a href="#local-1628018169"><span class="hs-identifier">user_meth_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2213"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#tcSplitMethodTy"><span class="hs-identifier hs-var">tcSplitMethodTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628018162"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-2214"></a><span>
</span><a name="line-2215"></a><span>    </span><span class="hs-identifier">changeLast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-1628018171"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628018171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628018171"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-2216"></a><span>    </span><a name="local-1628018170"><a href="#local-1628018170"><span class="hs-identifier">changeLast</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;changeLast&quot;</span><span>
</span><a name="line-2217"></a><span>    </span><span class="hs-identifier">changeLast</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span>    </span><a name="local-1628018172"><a href="#local-1628018172"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628018172"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-2218"></a><span>    </span><span class="hs-identifier">changeLast</span><span> </span><span class="hs-special">(</span><a name="local-1628018173"><a href="#local-1628018173"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1628018174"><a href="#local-1628018174"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628018175"><a href="#local-1628018175"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018173"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628018170"><span class="hs-identifier hs-var">changeLast</span></a><span> </span><a href="#local-1628018174"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-1628018175"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-2219"></a><span>
</span><a name="line-2220"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Generating extra binds (@con2tag@ and @tag2con@)}
*                                                                      *
************************************************************************

\begin{verbatim}
data Foo ... = ...

con2tag_Foo :: Foo ... -&gt; Int#
tag2con_Foo :: Int -&gt; Foo ...   -- easier if Int, not Int#
maxtag_Foo  :: Int              -- ditto (NB: not unlifted)
\end{verbatim}

The `tags' here start at zero, hence the @fIRST_TAG@ (currently one)
fiddling around.
-}</span><span>
</span><a name="line-2238"></a><span>
</span><a name="line-2239"></a><span class="hs-identifier">genAuxBindSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#AuxBindSpec"><span class="hs-identifier hs-type">AuxBindSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2240"></a><a name="genAuxBindSpec"><a href="TcGenDeriv.html#genAuxBindSpec"><span class="hs-identifier">genAuxBindSpec</span></a></a><span> </span><a name="local-1628018176"><a href="#local-1628018176"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivCon2Tag"><span class="hs-identifier hs-var">DerivCon2Tag</span></a><span> </span><a name="local-1628018177"><a href="#local-1628018177"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628018176"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018178"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628018181"><span class="hs-identifier hs-var">eqns</span></a><span class="hs-special">,</span><span>
</span><a name="line-2242"></a><span>     </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018176"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018176"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018178"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018179"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2243"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2244"></a><span>    </span><a name="local-1628018178"><a href="#local-1628018178"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#con2tag_RDR"><span class="hs-identifier hs-var">con2tag_RDR</span></a><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2245"></a><span>
</span><a name="line-2246"></a><span>    </span><a name="local-1628018179"><a href="#local-1628018179"><span class="hs-identifier">sig_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018176"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2247"></a><span>             </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConStupidTheta"><span class="hs-identifier hs-var">tyConStupidTheta</span></a><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2248"></a><span>             </span><a href="TcGenDeriv.html#mkParentType"><span class="hs-identifier hs-var">mkParentType</span></a><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">`</span><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>
</span><a name="line-2249"></a><span>
</span><a name="line-2250"></a><span>    </span><a name="local-1628018180"><a href="#local-1628018180"><span class="hs-identifier">lots_of_constructors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConFamilySize"><span class="hs-identifier hs-var">tyConFamilySize</span></a><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-2251"></a><span>                        </span><span class="hs-comment">-- was: mAX_FAMILY_SIZE_FOR_VEC_RETURNS</span><span>
</span><a name="line-2252"></a><span>                        </span><span class="hs-comment">-- but we don't do vectored returns any more.</span><span>
</span><a name="line-2253"></a><span>
</span><a name="line-2254"></a><span>    </span><a name="local-1628018181"><a href="#local-1628018181"><span class="hs-identifier">eqns</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628018180"><span class="hs-identifier hs-var">lots_of_constructors</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628018182"><span class="hs-identifier hs-var">get_tag_eqn</span></a><span class="hs-special">]</span><span>
</span><a name="line-2255"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628018183"><span class="hs-identifier hs-var">mk_eqn</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628018177"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2256"></a><span>
</span><a name="line-2257"></a><span>    </span><a name="local-1628018182"><a href="#local-1628018182"><span class="hs-identifier">get_tag_eqn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#getTag_RDR"><span class="hs-identifier hs-var">getTag_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#a_Expr"><span class="hs-identifier hs-var">a_Expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2258"></a><span>
</span><a name="line-2259"></a><span>    </span><span class="hs-identifier">mk_eqn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2260"></a><span>    </span><a name="local-1628018183"><a href="#local-1628018183"><span class="hs-identifier">mk_eqn</span></a></a><span> </span><a name="local-1628018184"><a href="#local-1628018184"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier hs-var">nlWildConPat</span></a><span> </span><a href="#local-1628018184"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-2261"></a><span>                  </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-2262"></a><span>                                    </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a><span> </span><a href="#local-1628018184"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2263"></a><span>
</span><a name="line-2264"></a><span class="hs-identifier">genAuxBindSpec</span><span> </span><a name="local-1628018185"><a href="#local-1628018185"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivTag2Con"><span class="hs-identifier hs-var">DerivTag2Con</span></a><span> </span><a name="local-1628018186"><a href="#local-1628018186"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2265"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier hs-var">mk_FunBind</span></a><span> </span><a href="#local-1628018185"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018188"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-2266"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span> </span><span class="hs-special">[</span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-2267"></a><span>           </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#tagToEnum_RDR"><span class="hs-identifier hs-var">tagToEnum_RDR</span></a><span class="hs-special">)</span><span> </span><a href="TcGenDeriv.html#a_Expr"><span class="hs-identifier hs-var">a_Expr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-2268"></a><span>     </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018185"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018185"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018188"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018187"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2269"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2270"></a><span>    </span><a name="local-1628018187"><a href="#local-1628018187"><span class="hs-identifier">sig_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018185"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2271"></a><span>             </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-1628018186"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2272"></a><span>             </span><a href="TysWiredIn.html#intTy"><span class="hs-identifier hs-var">intTy</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">`</span><span> </span><a href="TcGenDeriv.html#mkParentType"><span class="hs-identifier hs-var">mkParentType</span></a><span> </span><a href="#local-1628018186"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2273"></a><span>
</span><a name="line-2274"></a><span>    </span><a name="local-1628018188"><a href="#local-1628018188"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier hs-var">tag2con_RDR</span></a><span> </span><a href="#local-1628018186"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2275"></a><span>
</span><a name="line-2276"></a><span class="hs-identifier">genAuxBindSpec</span><span> </span><a name="local-1628018189"><a href="#local-1628018189"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivMaxTag"><span class="hs-identifier hs-var">DerivMaxTag</span></a><span> </span><a name="local-1628018190"><a href="#local-1628018190"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2277"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span> </span><a href="#local-1628018189"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018191"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628018193"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-2278"></a><span>     </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018189"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018189"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018191"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628018192"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2279"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2280"></a><span>    </span><a name="local-1628018191"><a href="#local-1628018191"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier hs-var">maxtag_RDR</span></a><span> </span><a href="#local-1628018190"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-2281"></a><span>    </span><a name="local-1628018192"><a href="#local-1628018192"><span class="hs-identifier">sig_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018189"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a href="TysWiredIn.html#intTy"><span class="hs-identifier hs-var">intTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2282"></a><span>    </span><a name="local-1628018193"><a href="#local-1628018193"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TysWiredIn.html#intDataCon_RDR"><span class="hs-identifier hs-var">intDataCon_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-1628018194"><span class="hs-identifier hs-var">max_tag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2283"></a><span>    </span><a name="local-1628018194"><a href="#local-1628018194"><span class="hs-identifier">max_tag</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628018190"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2284"></a><span>                 </span><a name="local-1628018195"><a href="#local-1628018195"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628018195"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span class="hs-special">)</span><span>
</span><a name="line-2285"></a><span>
</span><a name="line-2286"></a><span class="hs-keyword">type</span><span> </span><a name="SeparateBagsDerivStuff"><a href="TcGenDeriv.html#SeparateBagsDerivStuff"><span class="hs-identifier">SeparateBagsDerivStuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- AuxBinds and SYB bindings</span><span>
</span><a name="line-2287"></a><span>                              </span><span class="hs-special">(</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2288"></a><span>                                </span><span class="hs-comment">-- Extra bindings (used by Generic only)</span><span>
</span><a name="line-2289"></a><span>                              </span><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><span class="hs-special">(</span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- Extra family instances</span><span>
</span><a name="line-2290"></a><span>                              </span><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><span class="hs-special">(</span><a href="TcEnv.html#InstInfo"><span class="hs-identifier hs-type">InstInfo</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Extra instances</span><span>
</span><a name="line-2291"></a><span>
</span><a name="line-2292"></a><span class="hs-identifier">genAuxBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#SeparateBagsDerivStuff"><span class="hs-identifier hs-type">SeparateBagsDerivStuff</span></a><span>
</span><a name="line-2293"></a><a name="genAuxBinds"><a href="TcGenDeriv.html#genAuxBinds"><span class="hs-identifier">genAuxBinds</span></a></a><span> </span><a name="local-1628018196"><a href="#local-1628018196"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018197"><a href="#local-1628018197"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018203"><span class="hs-identifier hs-var">genAuxBinds'</span></a><span> </span><a href="#local-1628018199"><span class="hs-identifier hs-var">b2</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2294"></a><span>  </span><span class="hs-special">(</span><a name="local-1628018198"><a href="#local-1628018198"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><a name="local-1628018199"><a href="#local-1628018199"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#partitionBagWith"><span class="hs-identifier hs-var">partitionBagWith</span></a><span> </span><a href="#local-1628018200"><span class="hs-identifier hs-var">splitDerivAuxBind</span></a><span> </span><a href="#local-1628018197"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2295"></a><span>  </span><a name="local-1628018200"><a href="#local-1628018200"><span class="hs-identifier">splitDerivAuxBind</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span> </span><a name="local-1628018208"><a href="#local-1628018208"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628018208"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2296"></a><span>  </span><span class="hs-identifier">splitDerivAuxBind</span><span>  </span><a name="local-1628018209"><a href="#local-1628018209"><span class="hs-identifier">x</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628018209"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2297"></a><span>
</span><a name="line-2298"></a><span>  </span><a name="local-1628018201"><a href="#local-1628018201"><span class="hs-identifier">rm_dups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="#local-1628018202"><span class="hs-identifier hs-var">dup_check</span></a><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-2299"></a><span>  </span><a name="local-1628018202"><a href="#local-1628018202"><span class="hs-identifier">dup_check</span></a></a><span> </span><a name="local-1628018210"><a href="#local-1628018210"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628018211"><a href="#local-1628018211"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Bag.html#anyBag"><span class="hs-identifier hs-var">anyBag</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628018210"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018211"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-1628018211"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span> </span><a href="#local-1628018210"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1628018211"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2300"></a><span>
</span><a name="line-2301"></a><span>  </span><span class="hs-identifier">genAuxBinds'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#BagDerivStuff"><span class="hs-identifier hs-type">BagDerivStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#SeparateBagsDerivStuff"><span class="hs-identifier hs-type">SeparateBagsDerivStuff</span></a><span>
</span><a name="line-2302"></a><span>  </span><a name="local-1628018203"><a href="#local-1628018203"><span class="hs-identifier">genAuxBinds'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="#local-1628018204"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#genAuxBindSpec"><span class="hs-identifier hs-var">genAuxBindSpec</span></a><span> </span><a href="#local-1628018196"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628018201"><span class="hs-identifier hs-var">rm_dups</span></a><span> </span><a href="#local-1628018198"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span>
</span><a name="line-2303"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span>
</span><a name="line-2304"></a><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcGenDeriv.html#DerivStuff"><span class="hs-identifier hs-type">DerivStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#SeparateBagsDerivStuff"><span class="hs-identifier hs-type">SeparateBagsDerivStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcGenDeriv.html#SeparateBagsDerivStuff"><span class="hs-identifier hs-type">SeparateBagsDerivStuff</span></a><span>
</span><a name="line-2305"></a><span>  </span><a name="local-1628018204"><a href="#local-1628018204"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivAuxBind"><span class="hs-identifier hs-var">DerivAuxBind</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;genAuxBinds'&quot;</span><span> </span><span class="hs-comment">-- We have removed these before</span><span>
</span><a name="line-2306"></a><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivHsBind"><span class="hs-identifier hs-var">DerivHsBind</span></a><span>  </span><a name="local-1628018212"><a href="#local-1628018212"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018205"><span class="hs-identifier hs-var">add1</span></a><span> </span><a href="#local-1628018212"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2307"></a><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivFamInst"><span class="hs-identifier hs-var">DerivFamInst</span></a><span> </span><a name="local-1628018213"><a href="#local-1628018213"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018206"><span class="hs-identifier hs-var">add2</span></a><span> </span><a href="#local-1628018213"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-2308"></a><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#DerivInst"><span class="hs-identifier hs-var">DerivInst</span></a><span>    </span><a name="local-1628018214"><a href="#local-1628018214"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018207"><span class="hs-identifier hs-var">add3</span></a><span> </span><a href="#local-1628018214"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-2309"></a><span>
</span><a name="line-2310"></a><span>  </span><a name="local-1628018205"><a href="#local-1628018205"><span class="hs-identifier">add1</span></a></a><span> </span><a name="local-1628018215"><a href="#local-1628018215"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628018216"><a href="#local-1628018216"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-1628018217"><a href="#local-1628018217"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-1628018218"><a href="#local-1628018218"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628018215"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018216"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1628018217"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-1628018218"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2311"></a><span>  </span><a name="local-1628018206"><a href="#local-1628018206"><span class="hs-identifier">add2</span></a></a><span> </span><a name="local-1628018219"><a href="#local-1628018219"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628018220"><a href="#local-1628018220"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-1628018221"><a href="#local-1628018221"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-1628018222"><a href="#local-1628018222"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628018220"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1628018219"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018221"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-1628018222"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2312"></a><span>  </span><a name="local-1628018207"><a href="#local-1628018207"><span class="hs-identifier">add3</span></a></a><span> </span><a name="local-1628018223"><a href="#local-1628018223"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628018224"><a href="#local-1628018224"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-1628018225"><a href="#local-1628018225"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-1628018226"><a href="#local-1628018226"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628018224"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1628018225"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-1628018223"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018226"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2313"></a><span>
</span><a name="line-2314"></a><span class="hs-identifier">mk_data_type_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>   </span><span class="hs-comment">-- &quot;$tT&quot;</span><span>
</span><a name="line-2315"></a><a name="mk_data_type_name"><a href="TcGenDeriv.html#mk_data_type_name"><span class="hs-identifier">mk_data_type_name</span></a></a><span> </span><a name="local-1628018227"><a href="#local-1628018227"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkAuxBinderName"><span class="hs-identifier hs-var">mkAuxBinderName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628018227"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="OccName.html#mkDataTOcc"><span class="hs-identifier hs-var">mkDataTOcc</span></a><span>
</span><a name="line-2316"></a><span>
</span><a name="line-2317"></a><span class="hs-identifier">mk_constr_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>    </span><span class="hs-comment">-- &quot;$cC&quot;</span><span>
</span><a name="line-2318"></a><a name="mk_constr_name"><a href="TcGenDeriv.html#mk_constr_name"><span class="hs-identifier">mk_constr_name</span></a></a><span> </span><a name="local-1628018228"><a href="#local-1628018228"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkAuxBinderName"><span class="hs-identifier hs-var">mkAuxBinderName</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1628018228"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="OccName.html#mkDataCOcc"><span class="hs-identifier hs-var">mkDataCOcc</span></a><span>
</span><a name="line-2319"></a><span>
</span><a name="line-2320"></a><span class="hs-identifier">mkParentType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-2321"></a><span class="hs-comment">-- Turn the representation tycon of a family into</span><span>
</span><a name="line-2322"></a><span class="hs-comment">-- a use of its family constructor</span><span>
</span><a name="line-2323"></a><a name="mkParentType"><a href="TcGenDeriv.html#mkParentType"><span class="hs-identifier">mkParentType</span></a></a><span> </span><a name="local-1628018229"><a href="#local-1628018229"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-2324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-1628018229"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2325"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1628018229"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-1628018229"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2326"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628018230"><a href="#local-1628018230"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><a name="local-1628018231"><a href="#local-1628018231"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1628018230"><span class="hs-identifier hs-var">fam_tc</span></a><span> </span><a href="#local-1628018231"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2327"></a><span>
</span><a name="line-2328"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Utility bits for generating bindings}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2335"></a><span>
</span><a name="line-2336"></a><span class="hs-identifier">mk_FunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2337"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2338"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2339"></a><a name="mk_FunBind"><a href="TcGenDeriv.html#mk_FunBind"><span class="hs-identifier">mk_FunBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_HRFunBind"><span class="hs-identifier hs-var">mk_HRFunBind</span></a><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-comment">-- by using mk_FunBind and not mk_HRFunBind,</span><span>
</span><a name="line-2340"></a><span>                              </span><span class="hs-comment">-- the caller says that the Void case needs no</span><span>
</span><a name="line-2341"></a><span>                              </span><span class="hs-comment">-- patterns</span><span>
</span><a name="line-2342"></a><span>
</span><a name="line-2343"></a><span class="hs-comment">-- | This variant of 'mk_FunBind' puts an 'Arity' number of wildcards before</span><span>
</span><a name="line-2344"></a><span class="hs-comment">-- the &quot;=&quot; in the empty-data-decl case. This is necessary if the function</span><span>
</span><a name="line-2345"></a><span class="hs-comment">-- has a higher-rank type, like foldl. (See deriving/should_compile/T4302)</span><span>
</span><a name="line-2346"></a><span class="hs-identifier">mk_HRFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2347"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2348"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2349"></a><a name="mk_HRFunBind"><a href="TcGenDeriv.html#mk_HRFunBind"><span class="hs-identifier">mk_HRFunBind</span></a></a><span> </span><a name="local-1628018232"><a href="#local-1628018232"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-1628018233"><a href="#local-1628018233"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018234"><a href="#local-1628018234"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1628018235"><a href="#local-1628018235"><span class="hs-identifier">pats_and_exprs</span></a></a><span>
</span><a name="line-2350"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkHRRdrFunBind"><span class="hs-identifier hs-var">mkHRRdrFunBind</span></a><span> </span><a href="#local-1628018232"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018233"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628018234"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018236"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-2351"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2352"></a><span>    </span><a name="local-1628018236"><a href="#local-1628018236"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><a href="#local-1628018237"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1628018238"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628018237"><a href="#local-1628018237"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-1628018238"><a href="#local-1628018238"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><a href="#local-1628018235"><span class="hs-identifier hs-var">pats_and_exprs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2353"></a><span>
</span><a name="line-2354"></a><span class="hs-identifier">mkRdrFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2355"></a><a name="mkRdrFunBind"><a href="TcGenDeriv.html#mkRdrFunBind"><span class="hs-identifier">mkRdrFunBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkHRRdrFunBind"><span class="hs-identifier hs-var">mkHRRdrFunBind</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2356"></a><span>
</span><a name="line-2357"></a><span class="hs-identifier">mkHRRdrFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2358"></a><a name="mkHRRdrFunBind"><a href="TcGenDeriv.html#mkHRRdrFunBind"><span class="hs-identifier">mkHRRdrFunBind</span></a></a><span> </span><a name="local-1628018239"><a href="#local-1628018239"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-1628018240"><a href="#local-1628018240"><span class="hs-identifier">fun</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628018241"><a href="#local-1628018241"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628018242"><a href="#local-1628018242"><span class="hs-identifier">fun_rdr</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628018243"><a href="#local-1628018243"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628018241"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span> </span><a href="#local-1628018240"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-1628018244"><span class="hs-identifier hs-var">matches'</span></a><span class="hs-special">)</span><span>
</span><a name="line-2359"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2360"></a><span>   </span><span class="hs-comment">-- Catch-all eqn looks like</span><span>
</span><a name="line-2361"></a><span>   </span><span class="hs-comment">--     fmap = error &quot;Void fmap&quot;</span><span>
</span><a name="line-2362"></a><span>   </span><span class="hs-comment">-- It's needed if there no data cons at all,</span><span>
</span><a name="line-2363"></a><span>   </span><span class="hs-comment">-- which can happen with -XEmptyDataDecls</span><span>
</span><a name="line-2364"></a><span>   </span><span class="hs-comment">-- See Trac #4302</span><span>
</span><a name="line-2365"></a><span>   </span><a name="local-1628018244"><a href="#local-1628018244"><span class="hs-identifier">matches'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628018243"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-2366"></a><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><a href="#local-1628018239"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">)</span><span>
</span><a name="line-2367"></a><span>                            </span><span class="hs-special">(</span><a href="TcGenDeriv.html#error_Expr"><span class="hs-identifier hs-var">error_Expr</span></a><span> </span><a href="#local-1628018245"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2368"></a><span>              </span><span class="hs-keyword">else</span><span> </span><a href="#local-1628018243"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-2369"></a><span>   </span><a name="local-1628018245"><a href="#local-1628018245"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Void &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628018242"><span class="hs-identifier hs-var">fun_rdr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2370"></a><span>
</span><a name="line-2371"></a><span class="hs-identifier">box</span><span> </span><span class="hs-glyph">::</span><span>         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>           </span><span class="hs-comment">-- The class involved</span><span>
</span><a name="line-2372"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>            </span><span class="hs-comment">-- The tycon involved</span><span>
</span><a name="line-2373"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>  </span><span class="hs-comment">-- The argument</span><span>
</span><a name="line-2374"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>             </span><span class="hs-comment">-- The argument type</span><span>
</span><a name="line-2375"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>  </span><span class="hs-comment">-- Boxed version of the arg</span><span>
</span><a name="line-2376"></a><span class="hs-comment">-- See Note [Deriving and unboxed types] in TcDeriv</span><span>
</span><a name="line-2377"></a><a name="box"><a href="TcGenDeriv.html#box"><span class="hs-identifier">box</span></a></a><span> </span><a name="local-1628018246"><a href="#local-1628018246"><span class="hs-identifier">cls_str</span></a></a><span> </span><a name="local-1628018247"><a href="#local-1628018247"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628018248"><a href="#local-1628018248"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-1628018249"><a href="#local-1628018249"><span class="hs-identifier">arg_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018250"><span class="hs-identifier hs-var">box_con</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018248"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2378"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2379"></a><span>    </span><a name="local-1628018250"><a href="#local-1628018250"><span class="hs-identifier">box_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier hs-var">assoc_ty_id</span></a><span> </span><a href="#local-1628018246"><span class="hs-identifier hs-var">cls_str</span></a><span> </span><a href="#local-1628018247"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TcGenDeriv.html#boxConTbl"><span class="hs-identifier hs-var">boxConTbl</span></a><span> </span><a href="#local-1628018249"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-2380"></a><span>
</span><a name="line-2381"></a><span class="hs-comment">---------------------</span><span>
</span><a name="line-2382"></a><span class="hs-identifier">primOrdOps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>    </span><span class="hs-comment">-- The class involved</span><span>
</span><a name="line-2383"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>     </span><span class="hs-comment">-- The tycon involved</span><span>
</span><a name="line-2384"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>      </span><span class="hs-comment">-- The type</span><span>
</span><a name="line-2385"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- (lt,le,eq,ge,gt)</span><span>
</span><a name="line-2386"></a><span class="hs-comment">-- See Note [Deriving and unboxed types] in TcDeriv</span><span>
</span><a name="line-2387"></a><a name="primOrdOps"><a href="TcGenDeriv.html#primOrdOps"><span class="hs-identifier">primOrdOps</span></a></a><span> </span><a name="local-1628018251"><a href="#local-1628018251"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-1628018252"><a href="#local-1628018252"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628018253"><a href="#local-1628018253"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier hs-var">assoc_ty_id</span></a><span> </span><a href="#local-1628018251"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="#local-1628018252"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TcGenDeriv.html#ordOpTbl"><span class="hs-identifier hs-var">ordOpTbl</span></a><span> </span><a href="#local-1628018253"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2388"></a><span>
</span><a name="line-2389"></a><span class="hs-identifier">primLitOps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-comment">-- The class involved</span><span>
</span><a name="line-2390"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- The tycon involved</span><span>
</span><a name="line-2391"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>   </span><span class="hs-comment">-- The type</span><span>
</span><a name="line-2392"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-comment">-- Constructs a Q Exp value</span><span>
</span><a name="line-2393"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-comment">-- Constructs a boxed value</span><span>
</span><a name="line-2394"></a><span>              </span><span class="hs-special">)</span><span>
</span><a name="line-2395"></a><a name="primLitOps"><a href="TcGenDeriv.html#primLitOps"><span class="hs-identifier">primLitOps</span></a></a><span> </span><a name="local-1628018254"><a href="#local-1628018254"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-1628018255"><a href="#local-1628018255"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628018256"><a href="#local-1628018256"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier hs-var">assoc_ty_id</span></a><span> </span><a href="#local-1628018254"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="#local-1628018255"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TcGenDeriv.html#litConTbl"><span class="hs-identifier hs-var">litConTbl</span></a><span> </span><a href="#local-1628018256"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2396"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-1628018258"><a href="#local-1628018258"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018257"><span class="hs-identifier hs-var">boxRDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018258"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2397"></a><span>                          </span><span class="hs-special">)</span><span>
</span><a name="line-2398"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2399"></a><span>    </span><a name="local-1628018257"><a href="#local-1628018257"><span class="hs-identifier">boxRDR</span></a></a><span>
</span><a name="line-2400"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628018256"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#unpackCString_RDR"><span class="hs-identifier hs-var">unpackCString_RDR</span></a><span>
</span><a name="line-2401"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier hs-var">assoc_ty_id</span></a><span> </span><a href="#local-1628018254"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="#local-1628018255"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="TcGenDeriv.html#boxConTbl"><span class="hs-identifier hs-var">boxConTbl</span></a><span> </span><a href="#local-1628018256"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2402"></a><span>
</span><a name="line-2403"></a><span class="hs-identifier">ordOpTbl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2404"></a><a name="ordOpTbl"><a href="TcGenDeriv.html#ordOpTbl"><span class="hs-identifier">ordOpTbl</span></a></a><span>
</span><a name="line-2405"></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltChar_RDR"><span class="hs-identifier hs-var">ltChar_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leChar_RDR"><span class="hs-identifier hs-var">leChar_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqChar_RDR"><span class="hs-identifier hs-var">eqChar_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geChar_RDR"><span class="hs-identifier hs-var">geChar_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtChar_RDR"><span class="hs-identifier hs-var">gtChar_RDR</span></a><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2406"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltInt_RDR"><span class="hs-identifier hs-var">ltInt_RDR</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leInt_RDR"><span class="hs-identifier hs-var">leInt_RDR</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqInt_RDR"><span class="hs-identifier hs-var">eqInt_RDR</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geInt_RDR"><span class="hs-identifier hs-var">geInt_RDR</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtInt_RDR"><span class="hs-identifier hs-var">gtInt_RDR</span></a><span>   </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2407"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltWord_RDR"><span class="hs-identifier hs-var">ltWord_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leWord_RDR"><span class="hs-identifier hs-var">leWord_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqWord_RDR"><span class="hs-identifier hs-var">eqWord_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geWord_RDR"><span class="hs-identifier hs-var">geWord_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtWord_RDR"><span class="hs-identifier hs-var">gtWord_RDR</span></a><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2408"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltAddr_RDR"><span class="hs-identifier hs-var">ltAddr_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leAddr_RDR"><span class="hs-identifier hs-var">leAddr_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqAddr_RDR"><span class="hs-identifier hs-var">eqAddr_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geAddr_RDR"><span class="hs-identifier hs-var">geAddr_RDR</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtAddr_RDR"><span class="hs-identifier hs-var">gtAddr_RDR</span></a><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2409"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltFloat_RDR"><span class="hs-identifier hs-var">ltFloat_RDR</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leFloat_RDR"><span class="hs-identifier hs-var">leFloat_RDR</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqFloat_RDR"><span class="hs-identifier hs-var">eqFloat_RDR</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geFloat_RDR"><span class="hs-identifier hs-var">geFloat_RDR</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtFloat_RDR"><span class="hs-identifier hs-var">gtFloat_RDR</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2410"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#ltDouble_RDR"><span class="hs-identifier hs-var">ltDouble_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#leDouble_RDR"><span class="hs-identifier hs-var">leDouble_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#eqDouble_RDR"><span class="hs-identifier hs-var">eqDouble_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#geDouble_RDR"><span class="hs-identifier hs-var">geDouble_RDR</span></a><span class="hs-special">,</span><span> </span><a href="TcGenDeriv.html#gtDouble_RDR"><span class="hs-identifier hs-var">gtDouble_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2411"></a><span>
</span><a name="line-2412"></a><span class="hs-identifier">boxConTbl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2413"></a><a name="boxConTbl"><a href="TcGenDeriv.html#boxConTbl"><span class="hs-identifier">boxConTbl</span></a></a><span>
</span><a name="line-2414"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysWiredIn.html#charDataCon"><span class="hs-identifier hs-var">charDataCon</span></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-2415"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysWiredIn.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-2416"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysWiredIn.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-2417"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysWiredIn.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2418"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysWiredIn.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2419"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-2420"></a><span>
</span><a name="line-2421"></a><span class="hs-comment">-- | A table of postfix modifiers for unboxed values.</span><span>
</span><a name="line-2422"></a><span class="hs-identifier">postfixModTbl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2423"></a><a name="postfixModTbl"><a href="TcGenDeriv.html#postfixModTbl"><span class="hs-identifier">postfixModTbl</span></a></a><span>
</span><a name="line-2424"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2425"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2426"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;##&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2427"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2428"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;##&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2429"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-2430"></a><span>
</span><a name="line-2431"></a><span class="hs-identifier">litConTbl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2432"></a><a name="litConTbl"><a href="TcGenDeriv.html#litConTbl"><span class="hs-identifier">litConTbl</span></a></a><span>
</span><a name="line-2433"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#charPrimL_RDR"><span class="hs-identifier hs-var">charPrimL_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2434"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>   </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#intPrimL_RDR"><span class="hs-identifier hs-var">intPrimL_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2435"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#toInteger_RDR"><span class="hs-identifier hs-var">toInteger_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2436"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#wordPrimL_RDR"><span class="hs-identifier hs-var">wordPrimL_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2437"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#toInteger_RDR"><span class="hs-identifier hs-var">toInteger_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2438"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#stringPrimL_RDR"><span class="hs-identifier hs-var">stringPrimL_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2439"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span>
</span><a name="line-2440"></a><span>                          </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#map_RDR"><span class="hs-identifier hs-var">map_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2441"></a><span>                          </span><span class="hs-special">(</span><a href="PrelNames.html#compose_RDR"><span class="hs-identifier hs-var">compose_RDR</span></a><span> </span><span class="hs-special">`</span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span class="hs-special">`</span><span>
</span><a name="line-2442"></a><span>                            </span><span class="hs-special">[</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#fromIntegral_RDR"><span class="hs-identifier hs-var">fromIntegral_RDR</span></a><span>
</span><a name="line-2443"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#fromEnum_RDR"><span class="hs-identifier hs-var">fromEnum_RDR</span></a><span>
</span><a name="line-2444"></a><span>                            </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2445"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#floatPrimL_RDR"><span class="hs-identifier hs-var">floatPrimL_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2446"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#toRational_RDR"><span class="hs-identifier hs-var">toRational_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2447"></a><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="THNames.html#doublePrimL_RDR"><span class="hs-identifier hs-var">doublePrimL_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2448"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#toRational_RDR"><span class="hs-identifier hs-var">toRational_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2449"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-2450"></a><span>
</span><a name="line-2451"></a><span class="hs-comment">-- | Lookup `Type` in an association list.</span><span>
</span><a name="line-2452"></a><span class="hs-identifier">assoc_ty_id</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>           </span><span class="hs-comment">-- The class involved</span><span>
</span><a name="line-2453"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>            </span><span class="hs-comment">-- The tycon involved</span><span>
</span><a name="line-2454"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="#local-1628017562"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- The table</span><span>
</span><a name="line-2455"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>             </span><span class="hs-comment">-- The type</span><span>
</span><a name="line-2456"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628017562"><span class="hs-identifier hs-type">a</span></a><span>                </span><span class="hs-comment">-- The result of the lookup</span><span>
</span><a name="line-2457"></a><a name="assoc_ty_id"><a href="TcGenDeriv.html#assoc_ty_id"><span class="hs-identifier">assoc_ty_id</span></a></a><span> </span><a name="local-1628018259"><a href="#local-1628018259"><span class="hs-identifier">cls_str</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628018260"><a href="#local-1628018260"><span class="hs-identifier">tbl</span></a></a><span> </span><a name="local-1628018261"><a href="#local-1628018261"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2458"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628018262"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;Error in deriving:&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Can't derive&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1628018259"><span class="hs-identifier hs-var">cls_str</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2459"></a><span>                                              </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;for primitive type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628018261"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2460"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628018262"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-2461"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2462"></a><span>    </span><a name="local-1628018262"><a href="#local-1628018262"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628018264"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628018263"><a href="#local-1628018263"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><a name="local-1628018264"><a href="#local-1628018264"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628018260"><span class="hs-identifier hs-var">tbl</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628018261"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628018263"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">]</span><span>
</span><a name="line-2463"></a><span>
</span><a name="line-2464"></a><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-2465"></a><span>
</span><a name="line-2466"></a><span class="hs-identifier">and_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2467"></a><a name="and_Expr"><a href="TcGenDeriv.html#and_Expr"><span class="hs-identifier">and_Expr</span></a></a><span> </span><a name="local-1628018265"><a href="#local-1628018265"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628018266"><a href="#local-1628018266"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><a href="#local-1628018265"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="PrelNames.html#and_RDR"><span class="hs-identifier hs-var">and_RDR</span></a><span>    </span><a href="#local-1628018266"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2468"></a><span>
</span><a name="line-2469"></a><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><a name="line-2470"></a><span>
</span><a name="line-2471"></a><span class="hs-identifier">eq_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2472"></a><a name="eq_Expr"><a href="TcGenDeriv.html#eq_Expr"><span class="hs-identifier">eq_Expr</span></a></a><span> </span><a name="local-1628018267"><a href="#local-1628018267"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628018268"><a href="#local-1628018268"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628018269"><a href="#local-1628018269"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628018270"><a href="#local-1628018270"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-2473"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628018268"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier hs-var">genOpApp</span></a><span> </span><a href="#local-1628018269"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="PrelNames.html#eq_RDR"><span class="hs-identifier hs-var">eq_RDR</span></a><span> </span><a href="#local-1628018270"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2474"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier hs-var">genPrimOpApp</span></a><span> </span><a href="#local-1628018269"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1628018271"><span class="hs-identifier hs-var">prim_eq</span></a><span> </span><a href="#local-1628018270"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2475"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2476"></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628018271"><a href="#local-1628018271"><span class="hs-identifier">prim_eq</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#primOrdOps"><span class="hs-identifier hs-var">primOrdOps</span></a><span> </span><span class="hs-string">&quot;Eq&quot;</span><span> </span><a href="#local-1628018267"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628018268"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2477"></a><span>
</span><a name="line-2478"></a><span class="hs-identifier">untag_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span>  </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2479"></a><a name="untag_Expr"><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier">untag_Expr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628018272"><a href="#local-1628018272"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018272"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-2480"></a><span class="hs-identifier">untag_Expr</span><span> </span><a name="local-1628018273"><a href="#local-1628018273"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1628018274"><a href="#local-1628018274"><span class="hs-identifier">untag_this</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628018275"><a href="#local-1628018275"><span class="hs-identifier">put_tag_here</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628018276"><a href="#local-1628018276"><span class="hs-identifier">more</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628018277"><a href="#local-1628018277"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-2481"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#con2tag_RDR"><span class="hs-identifier hs-var">con2tag_RDR</span></a><span> </span><a href="#local-1628018273"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-1628018274"><span class="hs-identifier hs-var">untag_this</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">{-of-}</span><span>
</span><a name="line-2482"></a><span>      </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-1628018275"><span class="hs-identifier hs-var">put_tag_here</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#untag_Expr"><span class="hs-identifier hs-var">untag_Expr</span></a><span> </span><a href="#local-1628018273"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1628018276"><span class="hs-identifier hs-var">more</span></a><span> </span><a href="#local-1628018277"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2483"></a><span>
</span><a name="line-2484"></a><span class="hs-identifier">enum_from_to_Expr</span><span>
</span><a name="line-2485"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2486"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2487"></a><span class="hs-identifier">enum_from_then_to_Expr</span><span>
</span><a name="line-2488"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2489"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2490"></a><span>
</span><a name="line-2491"></a><a name="enum_from_to_Expr"><a href="TcGenDeriv.html#enum_from_to_Expr"><span class="hs-identifier">enum_from_to_Expr</span></a></a><span>      </span><a name="local-1628018278"><a href="#local-1628018278"><span class="hs-identifier">f</span></a></a><span>   </span><a name="local-1628018279"><a href="#local-1628018279"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#enumFromTo_RDR"><span class="hs-identifier hs-var">enumFromTo_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018278"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018279"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2492"></a><a name="enum_from_then_to_Expr"><a href="TcGenDeriv.html#enum_from_then_to_Expr"><span class="hs-identifier">enum_from_then_to_Expr</span></a></a><span> </span><a name="local-1628018280"><a href="#local-1628018280"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1628018281"><a href="#local-1628018281"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628018282"><a href="#local-1628018282"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#enumFromThenTo_RDR"><span class="hs-identifier hs-var">enumFromThenTo_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018280"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018281"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018282"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2493"></a><span>
</span><a name="line-2494"></a><span class="hs-identifier">showParen_Expr</span><span>
</span><a name="line-2495"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2496"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2497"></a><span>
</span><a name="line-2498"></a><a name="showParen_Expr"><a href="TcGenDeriv.html#showParen_Expr"><span class="hs-identifier">showParen_Expr</span></a></a><span> </span><a name="local-1628018283"><a href="#local-1628018283"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628018284"><a href="#local-1628018284"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showParen_RDR"><span class="hs-identifier hs-var">showParen_RDR</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018283"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018284"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-2499"></a><span>
</span><a name="line-2500"></a><span class="hs-identifier">nested_compose_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2501"></a><span>
</span><a name="line-2502"></a><a name="nested_compose_Expr"><a href="TcGenDeriv.html#nested_compose_Expr"><span class="hs-identifier">nested_compose_Expr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;nested_compose_expr&quot;</span><span>   </span><span class="hs-comment">-- Arg is always non-empty</span><span>
</span><a name="line-2503"></a><span class="hs-identifier">nested_compose_Expr</span><span> </span><span class="hs-special">[</span><a name="local-1628018285"><a href="#local-1628018285"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#parenify"><span class="hs-identifier hs-var">parenify</span></a><span> </span><a href="#local-1628018285"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2504"></a><span class="hs-identifier">nested_compose_Expr</span><span> </span><span class="hs-special">(</span><a name="local-1628018286"><a href="#local-1628018286"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-1628018287"><a href="#local-1628018287"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2505"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#compose_RDR"><span class="hs-identifier hs-var">compose_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#parenify"><span class="hs-identifier hs-var">parenify</span></a><span> </span><a href="#local-1628018286"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcGenDeriv.html#nested_compose_Expr"><span class="hs-identifier hs-var">nested_compose_Expr</span></a><span> </span><a href="#local-1628018287"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-2506"></a><span>
</span><a name="line-2507"></a><span class="hs-comment">-- impossible_Expr is used in case RHSs that should never happen.</span><span>
</span><a name="line-2508"></a><span class="hs-comment">-- We generate these to keep the desugarer from complaining that they *might* happen!</span><span>
</span><a name="line-2509"></a><span class="hs-identifier">error_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2510"></a><a name="error_Expr"><a href="TcGenDeriv.html#error_Expr"><span class="hs-identifier">error_Expr</span></a></a><span> </span><a name="local-1628018288"><a href="#local-1628018288"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#error_RDR"><span class="hs-identifier hs-var">error_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><a href="#local-1628018288"><span class="hs-identifier hs-var">string</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2511"></a><span>
</span><a name="line-2512"></a><span class="hs-comment">-- illegal_Expr is used when signalling error conditions in the RHS of a derived</span><span>
</span><a name="line-2513"></a><span class="hs-comment">-- method. It is currently only used by Enum.{succ,pred}</span><span>
</span><a name="line-2514"></a><span class="hs-identifier">illegal_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2515"></a><a name="illegal_Expr"><a href="TcGenDeriv.html#illegal_Expr"><span class="hs-identifier">illegal_Expr</span></a></a><span> </span><a name="local-1628018289"><a href="#local-1628018289"><span class="hs-identifier">meth</span></a></a><span> </span><a name="local-1628018290"><a href="#local-1628018290"><span class="hs-identifier">tp</span></a></a><span> </span><a name="local-1628018291"><a href="#local-1628018291"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2516"></a><span>   </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#error_RDR"><span class="hs-identifier hs-var">error_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018289"><span class="hs-identifier hs-var">meth</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-char">'{'</span><span class="hs-glyph">:</span><a href="#local-1628018290"><span class="hs-identifier hs-var">tp</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;}: &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628018291"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2517"></a><span>
</span><a name="line-2518"></a><span class="hs-comment">-- illegal_toEnum_tag is an extended version of illegal_Expr, which also allows you</span><span>
</span><a name="line-2519"></a><span class="hs-comment">-- to include the value of a_RDR in the error string.</span><span>
</span><a name="line-2520"></a><span class="hs-identifier">illegal_toEnum_tag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2521"></a><a name="illegal_toEnum_tag"><a href="TcGenDeriv.html#illegal_toEnum_tag"><span class="hs-identifier">illegal_toEnum_tag</span></a></a><span> </span><a name="local-1628018292"><a href="#local-1628018292"><span class="hs-identifier">tp</span></a></a><span> </span><a name="local-1628018293"><a href="#local-1628018293"><span class="hs-identifier">maxtag</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2522"></a><span>   </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#error_RDR"><span class="hs-identifier hs-var">error_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2523"></a><span>           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#append_RDR"><span class="hs-identifier hs-var">append_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2524"></a><span>                       </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;toEnum{&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628018292"><span class="hs-identifier hs-var">tp</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;}: tag (&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2525"></a><span>                    </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span>
</span><a name="line-2526"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showsPrec_RDR"><span class="hs-identifier hs-var">showsPrec_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2527"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2528"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2529"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span>
</span><a name="line-2530"></a><span>                               </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#append_RDR"><span class="hs-identifier hs-var">append_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2531"></a><span>                               </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-string">&quot;) is outside of enumeration's range (0,&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2532"></a><span>                               </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span>
</span><a name="line-2533"></a><span>                                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#showsPrec_RDR"><span class="hs-identifier hs-var">showsPrec_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-2534"></a><span>                                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2535"></a><span>                                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628018293"><span class="hs-identifier hs-var">maxtag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2536"></a><span>                                        </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2537"></a><span>
</span><a name="line-2538"></a><span class="hs-identifier">parenify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2539"></a><a name="parenify"><a href="TcGenDeriv.html#parenify"><span class="hs-identifier">parenify</span></a></a><span> </span><a name="local-1628018294"><a href="#local-1628018294"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018294"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2540"></a><span class="hs-identifier">parenify</span><span> </span><a name="local-1628018295"><a href="#local-1628018295"><span class="hs-identifier">e</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsPar"><span class="hs-identifier hs-var">mkHsPar</span></a><span> </span><a href="#local-1628018295"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2541"></a><span>
</span><a name="line-2542"></a><span class="hs-comment">-- genOpApp wraps brackets round the operator application, so that the</span><span>
</span><a name="line-2543"></a><span class="hs-comment">-- renamer won't subsequently try to re-associate it.</span><span>
</span><a name="line-2544"></a><span class="hs-identifier">genOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2545"></a><a name="genOpApp"><a href="TcGenDeriv.html#genOpApp"><span class="hs-identifier">genOpApp</span></a></a><span> </span><a name="local-1628018296"><a href="#local-1628018296"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628018297"><a href="#local-1628018297"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628018298"><a href="#local-1628018298"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier hs-var">nlHsOpApp</span></a><span> </span><a href="#local-1628018296"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-1628018297"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628018298"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2546"></a><span>
</span><a name="line-2547"></a><span class="hs-identifier">genPrimOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2548"></a><a name="genPrimOpApp"><a href="TcGenDeriv.html#genPrimOpApp"><span class="hs-identifier">genPrimOpApp</span></a></a><span> </span><a name="local-1628018299"><a href="#local-1628018299"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628018300"><a href="#local-1628018300"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628018301"><a href="#local-1628018301"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#tagToEnum_RDR"><span class="hs-identifier hs-var">tagToEnum_RDR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier hs-var">nlHsOpApp</span></a><span> </span><a href="#local-1628018299"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-1628018300"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-1628018301"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2549"></a><span>
</span><a name="line-2550"></a><span class="hs-identifier">a_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">d_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">f_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">k_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ah_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bh_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ch_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dh_RDR</span><span>
</span><a name="line-2551"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2552"></a><a name="a_RDR"><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier">a_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;a&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2553"></a><a name="b_RDR"><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier">b_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;b&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2554"></a><a name="c_RDR"><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier">c_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;c&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2555"></a><a name="d_RDR"><a href="TcGenDeriv.html#d_RDR"><span class="hs-identifier">d_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;d&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2556"></a><a name="f_RDR"><a href="TcGenDeriv.html#f_RDR"><span class="hs-identifier">f_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2557"></a><a name="k_RDR"><a href="TcGenDeriv.html#k_RDR"><span class="hs-identifier">k_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;k&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2558"></a><a name="z_RDR"><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier">z_RDR</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;z&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2559"></a><a name="ah_RDR"><a href="TcGenDeriv.html#ah_RDR"><span class="hs-identifier">ah_RDR</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;a#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2560"></a><a name="bh_RDR"><a href="TcGenDeriv.html#bh_RDR"><span class="hs-identifier">bh_RDR</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;b#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2561"></a><a name="ch_RDR"><a href="TcGenDeriv.html#ch_RDR"><span class="hs-identifier">ch_RDR</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;c#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2562"></a><a name="dh_RDR"><a href="TcGenDeriv.html#dh_RDR"><span class="hs-identifier">dh_RDR</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;d#&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2563"></a><span>
</span><a name="line-2564"></a><span class="hs-identifier">as_RDRs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bs_RDRs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cs_RDRs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-2565"></a><a name="as_RDRs"><a href="TcGenDeriv.html#as_RDRs"><span class="hs-identifier">as_RDRs</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;a&quot;</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1628018302"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628018302"><a href="#local-1628018302"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2566"></a><a name="bs_RDRs"><a href="TcGenDeriv.html#bs_RDRs"><span class="hs-identifier">bs_RDRs</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;b&quot;</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1628018303"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628018303"><a href="#local-1628018303"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2567"></a><a name="cs_RDRs"><a href="TcGenDeriv.html#cs_RDRs"><span class="hs-identifier">cs_RDRs</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;c&quot;</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1628018304"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628018304"><a href="#local-1628018304"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2568"></a><span>
</span><a name="line-2569"></a><span class="hs-identifier">a_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">f_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltTag_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eqTag_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtTag_Expr</span><span class="hs-special">,</span><span>
</span><a name="line-2570"></a><span>    </span><span class="hs-identifier">false_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">true_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fmap_Expr</span><span class="hs-special">,</span><span>
</span><a name="line-2571"></a><span>    </span><span class="hs-identifier">mempty_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">foldMap_Expr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">traverse_Expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2572"></a><a name="a_Expr"><a href="TcGenDeriv.html#a_Expr"><span class="hs-identifier">a_Expr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span>
</span><a name="line-2573"></a><span class="hs-comment">-- b_Expr       = nlHsVar b_RDR</span><span>
</span><a name="line-2574"></a><a name="c_Expr"><a href="TcGenDeriv.html#c_Expr"><span class="hs-identifier">c_Expr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span>
</span><a name="line-2575"></a><a name="f_Expr"><a href="TcGenDeriv.html#f_Expr"><span class="hs-identifier">f_Expr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#f_RDR"><span class="hs-identifier hs-var">f_RDR</span></a><span>
</span><a name="line-2576"></a><a name="z_Expr"><a href="TcGenDeriv.html#z_Expr"><span class="hs-identifier">z_Expr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier hs-var">z_RDR</span></a><span>
</span><a name="line-2577"></a><a name="ltTag_Expr"><a href="TcGenDeriv.html#ltTag_Expr"><span class="hs-identifier">ltTag_Expr</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#ltTag_RDR"><span class="hs-identifier hs-var">ltTag_RDR</span></a><span>
</span><a name="line-2578"></a><a name="eqTag_Expr"><a href="TcGenDeriv.html#eqTag_Expr"><span class="hs-identifier">eqTag_Expr</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#eqTag_RDR"><span class="hs-identifier hs-var">eqTag_RDR</span></a><span>
</span><a name="line-2579"></a><a name="gtTag_Expr"><a href="TcGenDeriv.html#gtTag_Expr"><span class="hs-identifier">gtTag_Expr</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#gtTag_RDR"><span class="hs-identifier hs-var">gtTag_RDR</span></a><span>
</span><a name="line-2580"></a><a name="false_Expr"><a href="TcGenDeriv.html#false_Expr"><span class="hs-identifier">false_Expr</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TysWiredIn.html#false_RDR"><span class="hs-identifier hs-var">false_RDR</span></a><span>
</span><a name="line-2581"></a><a name="true_Expr"><a href="TcGenDeriv.html#true_Expr"><span class="hs-identifier">true_Expr</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="TysWiredIn.html#true_RDR"><span class="hs-identifier hs-var">true_RDR</span></a><span>
</span><a name="line-2582"></a><a name="fmap_Expr"><a href="TcGenDeriv.html#fmap_Expr"><span class="hs-identifier">fmap_Expr</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#fmap_RDR"><span class="hs-identifier hs-var">fmap_RDR</span></a><span>
</span><a name="line-2583"></a><span class="hs-comment">-- pure_Expr       = nlHsVar pure_RDR</span><span>
</span><a name="line-2584"></a><a name="mempty_Expr"><a href="TcGenDeriv.html#mempty_Expr"><span class="hs-identifier">mempty_Expr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#mempty_RDR"><span class="hs-identifier hs-var">mempty_RDR</span></a><span>
</span><a name="line-2585"></a><a name="foldMap_Expr"><a href="TcGenDeriv.html#foldMap_Expr"><span class="hs-identifier">foldMap_Expr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#foldMap_RDR"><span class="hs-identifier hs-var">foldMap_RDR</span></a><span>
</span><a name="line-2586"></a><a name="traverse_Expr"><a href="TcGenDeriv.html#traverse_Expr"><span class="hs-identifier">traverse_Expr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="PrelNames.html#traverse_RDR"><span class="hs-identifier hs-var">traverse_RDR</span></a><span>
</span><a name="line-2587"></a><span>
</span><a name="line-2588"></a><span class="hs-identifier">a_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">d_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">f_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">k_Pat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z_Pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2589"></a><a name="a_Pat"><a href="TcGenDeriv.html#a_Pat"><span class="hs-identifier">a_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#a_RDR"><span class="hs-identifier hs-var">a_RDR</span></a><span>
</span><a name="line-2590"></a><a name="b_Pat"><a href="TcGenDeriv.html#b_Pat"><span class="hs-identifier">b_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#b_RDR"><span class="hs-identifier hs-var">b_RDR</span></a><span>
</span><a name="line-2591"></a><a name="c_Pat"><a href="TcGenDeriv.html#c_Pat"><span class="hs-identifier">c_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#c_RDR"><span class="hs-identifier hs-var">c_RDR</span></a><span>
</span><a name="line-2592"></a><a name="d_Pat"><a href="TcGenDeriv.html#d_Pat"><span class="hs-identifier">d_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#d_RDR"><span class="hs-identifier hs-var">d_RDR</span></a><span>
</span><a name="line-2593"></a><a name="f_Pat"><a href="TcGenDeriv.html#f_Pat"><span class="hs-identifier">f_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#f_RDR"><span class="hs-identifier hs-var">f_RDR</span></a><span>
</span><a name="line-2594"></a><a name="k_Pat"><a href="TcGenDeriv.html#k_Pat"><span class="hs-identifier">k_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#k_RDR"><span class="hs-identifier hs-var">k_RDR</span></a><span>
</span><a name="line-2595"></a><a name="z_Pat"><a href="TcGenDeriv.html#z_Pat"><span class="hs-identifier">z_Pat</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="TcGenDeriv.html#z_RDR"><span class="hs-identifier hs-var">z_RDR</span></a><span>
</span><a name="line-2596"></a><span>
</span><a name="line-2597"></a><span class="hs-identifier">minusInt_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tagToEnum_RDR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2598"></a><a name="minusInt_RDR"><a href="TcGenDeriv.html#minusInt_RDR"><span class="hs-identifier">minusInt_RDR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><span class="hs-special">(</span><a href="PrelInfo.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a><span> </span><a href="PrimOp.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-2599"></a><a name="tagToEnum_RDR"><a href="TcGenDeriv.html#tagToEnum_RDR"><span class="hs-identifier">tagToEnum_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><span class="hs-special">(</span><a href="PrelInfo.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a><span> </span><a href="PrimOp.html#TagToEnumOp"><span class="hs-identifier hs-var">TagToEnumOp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2600"></a><span>
</span><a name="line-2601"></a><span class="hs-identifier">con2tag_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tag2con_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">maxtag_RDR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2602"></a><span class="hs-comment">-- Generates Orig s RdrName, for the binding positions</span><span>
</span><a name="line-2603"></a><a name="con2tag_RDR"><a href="TcGenDeriv.html#con2tag_RDR"><span class="hs-identifier">con2tag_RDR</span></a></a><span> </span><a name="local-1628018305"><a href="#local-1628018305"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_tc_deriv_name"><span class="hs-identifier hs-var">mk_tc_deriv_name</span></a><span> </span><a href="#local-1628018305"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="OccName.html#mkCon2TagOcc"><span class="hs-identifier hs-var">mkCon2TagOcc</span></a><span>
</span><a name="line-2604"></a><a name="tag2con_RDR"><a href="TcGenDeriv.html#tag2con_RDR"><span class="hs-identifier">tag2con_RDR</span></a></a><span> </span><a name="local-1628018306"><a href="#local-1628018306"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_tc_deriv_name"><span class="hs-identifier hs-var">mk_tc_deriv_name</span></a><span> </span><a href="#local-1628018306"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="OccName.html#mkTag2ConOcc"><span class="hs-identifier hs-var">mkTag2ConOcc</span></a><span>
</span><a name="line-2605"></a><a name="maxtag_RDR"><a href="TcGenDeriv.html#maxtag_RDR"><span class="hs-identifier">maxtag_RDR</span></a></a><span>  </span><a name="local-1628018307"><a href="#local-1628018307"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mk_tc_deriv_name"><span class="hs-identifier hs-var">mk_tc_deriv_name</span></a><span> </span><a href="#local-1628018307"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="OccName.html#mkMaxTagOcc"><span class="hs-identifier hs-var">mkMaxTagOcc</span></a><span>
</span><a name="line-2606"></a><span>
</span><a name="line-2607"></a><span class="hs-identifier">mk_tc_deriv_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2608"></a><a name="mk_tc_deriv_name"><a href="TcGenDeriv.html#mk_tc_deriv_name"><span class="hs-identifier">mk_tc_deriv_name</span></a></a><span> </span><a name="local-1628018308"><a href="#local-1628018308"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1628018309"><a href="#local-1628018309"><span class="hs-identifier">occ_fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcGenDeriv.html#mkAuxBinderName"><span class="hs-identifier hs-var">mkAuxBinderName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1628018308"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018309"><span class="hs-identifier hs-var">occ_fun</span></a><span>
</span><a name="line-2609"></a><span>
</span><a name="line-2610"></a><span class="hs-identifier">mkAuxBinderName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-2611"></a><span class="hs-comment">-- ^ Make a top-level binder name for an auxiliary binding for a parent name</span><span>
</span><a name="line-2612"></a><span class="hs-comment">-- See Note [Auxiliary binders]</span><span>
</span><a name="line-2613"></a><a name="mkAuxBinderName"><a href="TcGenDeriv.html#mkAuxBinderName"><span class="hs-identifier">mkAuxBinderName</span></a></a><span> </span><a name="local-1628018310"><a href="#local-1628018310"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-1628018311"><a href="#local-1628018311"><span class="hs-identifier">occ_fun</span></a></a><span>
</span><a name="line-2614"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628018311"><span class="hs-identifier hs-var">occ_fun</span></a><span> </span><a href="#local-1628018312"><span class="hs-identifier hs-var">stable_parent_occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-2615"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2616"></a><span>    </span><a name="local-1628018312"><a href="#local-1628018312"><span class="hs-identifier">stable_parent_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-1628018316"><span class="hs-identifier hs-var">parent_occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628018313"><span class="hs-identifier hs-var">stable_string</span></a><span>
</span><a name="line-2617"></a><span>    </span><a name="local-1628018313"><a href="#local-1628018313"><span class="hs-identifier">stable_string</span></a></a><span>
</span><a name="line-2618"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="StaticFlags.html#opt_PprStyle_Debug"><span class="hs-identifier hs-var">opt_PprStyle_Debug</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018314"><span class="hs-identifier hs-var">parent_stable</span></a><span>
</span><a name="line-2619"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628018315"><span class="hs-identifier hs-var">parent_stable_hash</span></a><span>
</span><a name="line-2620"></a><span>    </span><a name="local-1628018314"><a href="#local-1628018314"><span class="hs-identifier">parent_stable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameStableString"><span class="hs-identifier hs-var">nameStableString</span></a><span> </span><a href="#local-1628018310"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2621"></a><span>    </span><a name="local-1628018315"><a href="#local-1628018315"><span class="hs-identifier">parent_stable_hash</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2622"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-var">Fingerprint</span></a><span> </span><a name="local-1628018317"><a href="#local-1628018317"><span class="hs-identifier">high</span></a></a><span> </span><a name="local-1628018318"><a href="#local-1628018318"><span class="hs-identifier">low</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.html#fingerprintString"><span class="hs-identifier hs-var">fingerprintString</span></a><span> </span><a href="#local-1628018314"><span class="hs-identifier hs-var">parent_stable</span></a><span>
</span><a name="line-2623"></a><span>      </span><span class="hs-keyword">in</span><span> </span><a href="Encoding.html#toBase62"><span class="hs-identifier hs-var">toBase62</span></a><span> </span><a href="#local-1628018317"><span class="hs-identifier hs-var">high</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="Encoding.html#toBase62Padded"><span class="hs-identifier hs-var">toBase62Padded</span></a><span> </span><a href="#local-1628018318"><span class="hs-identifier hs-var">low</span></a><span>
</span><a name="line-2624"></a><span>      </span><span class="hs-comment">-- See Note [Base 62 encoding 128-bit integers]</span><span>
</span><a name="line-2625"></a><span>    </span><a name="local-1628018316"><a href="#local-1628018316"><span class="hs-identifier">parent_occ</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628018310"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2626"></a><span>
</span><a name="line-2627"></a><span>
</span><a name="line-2628"></a><span class="hs-comment">{-
Note [Auxiliary binders]
~~~~~~~~~~~~~~~~~~~~~~~~
We often want to make a top-level auxiliary binding.  E.g. for comparison we haev

  instance Ord T where
    compare a b = $con2tag a `compare` $con2tag b

  $con2tag :: T -&gt; Int
  $con2tag = ...code....

Of course these top-level bindings should all have distinct name, and we are
generating RdrNames here.  We can't just use the TyCon or DataCon to distinguish
because with standalone deriving two imported TyCons might both be called T!
(See Trac #7947.)

So we use package name, module name and the name of the parent
(T in this example) as part of the OccName we generate for the new binding.
To make the symbol names short we take a base62 hash of the full name.

In the past we used the *unique* from the parent, but that's not stable across
recompilations as uniques are nondeterministic.

Note [DeriveFoldable with ExistentialQuantification]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Functor and Traversable instances can only be derived for data types whose
last type parameter is truly universally polymorphic. For example:

  data T a b where
    T1 ::                 b   -&gt; T a b   -- YES, b is unconstrained
    T2 :: Ord b   =&gt;      b   -&gt; T a b   -- NO, b is constrained by (Ord b)
    T3 :: b ~ Int =&gt;      b   -&gt; T a b   -- NO, b is constrained by (b ~ Int)
    T4 ::                 Int -&gt; T a Int -- NO, this is just like T3
    T5 :: Ord a   =&gt; a -&gt; b   -&gt; T a b   -- YES, b is unconstrained, even
                                         -- though a is existential
    T6 ::                 Int -&gt; T Int b -- YES, b is unconstrained

For Foldable instances, however, we can completely lift the constraint that
the last type parameter be truly universally polymorphic. This means that T
(as defined above) can have a derived Foldable instance:

  instance Foldable (T a) where
    foldr f z (T1 b)   = f b z
    foldr f z (T2 b)   = f b z
    foldr f z (T3 b)   = f b z
    foldr f z (T4 b)   = z
    foldr f z (T5 a b) = f b z
    foldr f z (T6 a)   = z

    foldMap f (T1 b)   = f b
    foldMap f (T2 b)   = f b
    foldMap f (T3 b)   = f b
    foldMap f (T4 b)   = mempty
    foldMap f (T5 a b) = f b
    foldMap f (T6 a)   = mempty

In a Foldable instance, it is safe to fold over an occurrence of the last type
parameter that is not truly universally polymorphic. However, there is a bit
of subtlety in determining what is actually an occurrence of a type parameter.
T3 and T4, as defined above, provide one example:

  data T a b where
    ...
    T3 :: b ~ Int =&gt; b   -&gt; T a b
    T4 ::            Int -&gt; T a Int
    ...

  instance Foldable (T a) where
    ...
    foldr f z (T3 b) = f b z
    foldr f z (T4 b) = z
    ...
    foldMap f (T3 b) = f b
    foldMap f (T4 b) = mempty
    ...

Notice that the argument of T3 is folded over, whereas the argument of T4 is
not. This is because we only fold over constructor arguments that
syntactically mention the universally quantified type parameter of that
particular data constructor. See foldDataConArgs for how this is implemented.

As another example, consider the following data type. The argument of each
constructor has the same type as the last type parameter:

  data E a where
    E1 :: (a ~ Int) =&gt; a   -&gt; E a
    E2 ::              Int -&gt; E Int
    E3 :: (a ~ Int) =&gt; a   -&gt; E Int
    E4 :: (a ~ Int) =&gt; Int -&gt; E a

Only E1's argument is an occurrence of a universally quantified type variable
that is syntactically equivalent to the last type parameter, so only E1's
argument will be be folded over in a derived Foldable instance.

See Trac #10447 for the original discussion on this feature. Also see
https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/DeriveFunctor
for a more in-depth explanation.

Note [FFoldType and functorLikeTraverse]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Deriving Functor, Foldable, and Traversable all require generating expressions
which perform an operation on each argument of a data constructor depending
on the argument's type. In particular, a generated operation can be different
depending on whether the type mentions the last type variable of the datatype
(e.g., if you have data T a = MkT a Int, then a generated foldr expresion would
fold over the first argument of MkT, but not the second).

This pattern is abstracted with the FFoldType datatype, which provides hooks
for the user to specify how a constructor argument should be folded when it
has a type with a particular &quot;shape&quot;. The shapes are as follows (assume that
a is the last type variable in a given datatype):

* ft_triv:    The type does not mention the last type variable at all.
              Examples: Int, b

* ft_var:     The type is syntactically equal to the last type variable.
              Moreover, the type appears in a covariant position (see
              the Deriving Functor instances section of the users' guide
              for an in-depth explanation of covariance vs. contravariance).
              Example: a (covariantly)

* ft_co_var:  The type is syntactically equal to the last type variable.
              Moreover, the type appears in a contravariant position.
              Example: a (contravariantly)

* ft_fun:     A function type which mentions the last type variable in
              the argument position, result position or both.
              Examples: a -&gt; Int, Int -&gt; a, Maybe a -&gt; [a]

* ft_tup:     A tuple type which mentions the last type variable in at least
              one of its fields. The TyCon argument of ft_tup represents the
              particular tuple's type constructor.
              Examples: (a, Int), (Maybe a, [a], Either a Int)

* ft_ty_app:  A type is being applied to the last type parameter, where the
              applied type does not mention the last type parameter (if it
              did, it would fall under ft_bad_app). The Type argument to
              ft_ty_app represents the applied type.

              Note that functions, tuples, and foralls are distinct cases
              and take precedence of ft_ty_app. (For example, (Int -&gt; a) would
              fall under (ft_fun Int a), not (ft_ty_app ((-&gt;) Int) a).
              Examples: Maybe a, Either b a

* ft_bad_app: A type application uses the last type parameter in a position
              other than the last argument. This case is singled out because
              Functor, Foldable, and Traversable instances cannot be derived
              for datatypes containing arguments with such types.
              Examples: Either a Int, Const a b

* ft_forall:  A forall'd type mentions the last type parameter on its right-
              hand side (and is not quantified on the left-hand side). This
              case is present mostly for plumbing purposes.
              Example: forall b. Either b a

If FFoldType describes a strategy for folding subcomponents of a Type, then
functorLikeTraverse is the function that applies that strategy to the entirety
of a Type, returning the final folded-up result.

foldDataConArgs applies functorLikeTraverse to every argument type of a
constructor, returning a list of the fold results. This makes foldDataConArgs
a natural way to generate the subexpressions in a generated fmap, foldr,
foldMap, or traverse definition (the subexpressions must then be combined in
a method-specific fashion to form the final generated expression).

Deriving Generic1 also does validity checking by looking for the last type
variable in certain positions of a constructor's argument types, so it also
uses foldDataConArgs. See Note [degenerate use of FFoldType] in TcGenGenerics.

Note [Generated code for DeriveFoldable and DeriveTraversable]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We adapt the algorithms for -XDeriveFoldable and -XDeriveTraversable based on
that of -XDeriveFunctor. However, there an important difference between deriving
the former two typeclasses and the latter one, which is best illustrated by the
following scenario:

  data WithInt a = WithInt a Int# deriving (Functor, Foldable, Traversable)

The generated code for the Functor instance is straightforward:

  instance Functor WithInt where
    fmap f (WithInt a i) = WithInt (f a) i

But if we use too similar of a strategy for deriving the Foldable and
Traversable instances, we end up with this code:

  instance Foldable WithInt where
    foldMap f (WithInt a i) = f a &lt;&gt; mempty

  instance Traversable WithInt where
    traverse f (WithInt a i) = fmap WithInt (f a) &lt;*&gt; pure i

This is unsatisfying for two reasons:

1. The Traversable instance doesn't typecheck! Int# is of kind #, but pure
   expects an argument whose type is of kind *. This effectively prevents
   Traversable from being derived for any datatype with an unlifted argument
   type (Trac #11174).

2. The generated code contains superfluous expressions. By the Monoid laws,
   we can reduce (f a &lt;&gt; mempty) to (f a), and by the Applicative laws, we can
   reduce (fmap WithInt (f a) &lt;*&gt; pure i) to (fmap (\b -&gt; WithInt b i) (f a)).

We can fix both of these issues by incorporating a slight twist to the usual
algorithm that we use for -XDeriveFunctor. The differences can be summarized
as follows:

1. In the generated expression, we only fold over arguments whose types
   mention the last type parameter. Any other argument types will simply
   produce useless 'mempty's or 'pure's, so they can be safely ignored.

2. In the case of -XDeriveTraversable, instead of applying ConName,
   we apply (\b_i ... b_k -&gt; ConName a_1 ... a_n), where

   * ConName has n arguments
   * {b_i, ..., b_k} is a subset of {a_1, ..., a_n} whose indices correspond
     to the arguments whose types mention the last type parameter. As a
     consequence, taking the difference of {a_1, ..., a_n} and
     {b_i, ..., b_k} yields the all the argument values of ConName whose types
     do not mention the last type parameter. Note that [i, ..., k] is a
     strictly increasing&#8212;but not necessarily consecutive&#8212;integer sequence.

     For example, the datatype

       data Foo a = Foo Int a Int a

     would generate the following Traversable instance:

       instance Traversable Foo where
         traverse f (Foo a1 a2 a3 a4) =
           fmap (\b2 b4 -&gt; Foo a1 b2 a3 b4) (f a2) &lt;*&gt; f a4

Technically, this approach would also work for -XDeriveFunctor as well, but we
decide not to do so because:

1. There's not much benefit to generating, e.g., ((\b -&gt; WithInt b i) (f a))
   instead of (WithInt (f a) i).

2. There would be certain datatypes for which the above strategy would
   generate Functor code that would fail to typecheck. For example:

     data Bar f a = Bar (forall f. Functor f =&gt; f a) deriving Functor

   With the conventional algorithm, it would generate something like:

     fmap f (Bar a) = Bar (fmap f a)

   which typechecks. But with the strategy mentioned above, it would generate:

     fmap f (Bar a) = (\b -&gt; Bar b) (fmap f a)

   which does not typecheck, since GHC cannot unify the rank-2 type variables
   in the types of b and (fmap f a).
-}</span><span>
</span><a name="line-2882"></a></pre></body></html>