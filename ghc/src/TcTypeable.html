<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1999
-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcTypeable</span><span class="hs-special">(</span><a href="TcTypeable.html#mkTypeableBinds"><span class="hs-identifier hs-var">mkTypeableBinds</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="TcBinds.html"><span class="hs-identifier">TcBinds</span></a><span class="hs-special">(</span><span> </span><a href="TcBinds.html#addTypecheckedBinds"><span class="hs-identifier hs-var">addTypecheckedBinds</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="IfaceEnv.html"><span class="hs-identifier">IfaceEnv</span></a><span class="hs-special">(</span><span> </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="TcEnv.html"><span class="hs-identifier">TcEnv</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysPrim.html#primTyCons"><span class="hs-identifier hs-var">primTyCons</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span class="hs-special">(</span><span> </span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="OccName.html"><span class="hs-identifier">OccName</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Fingerprint.html"><span class="hs-identifier">Fingerprint</span></a><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.html#fingerprintString"><span class="hs-identifier hs-var">fingerprintString</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span class="hs-special">,</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Word.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span></a><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">{- Note [Grand plan for Typeable]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The overall plan is this:

1. Generate a binding for each module p:M
   (done in TcTypeable by mkModIdBindings)
       M.$trModule :: GHC.Types.Module
       M.$trModule = Module &quot;p&quot; &quot;M&quot;
   (&quot;tr&quot; is short for &quot;type representation&quot;; see GHC.Types)

   We might want to add the filename too.
   This can be used for the lightweight stack-tracing stuff too

   Record the Name M.$trModule in the tcg_tr_module field of TcGblEnv

2. Generate a binding for every data type declaration T in module M,
       M.$tcT :: GHC.Types.TyCon
       M.$tcT = TyCon ...fingerprint info...
                      $trModule
                      &quot;T&quot;
   We define (in TyCon)
      type TyConRepName = Name
   to use for these M.$tcT &quot;tycon rep names&quot;.

3. Record the TyConRepName in T's TyCon, including for promoted
   data and type constructors, and kinds like * and #.

   The TyConRepName is not an &quot;implicit Id&quot;.  It's more like a record
   selector: the TyCon knows its name but you have to go to the
   interface file to find its type, value, etc

4. Solve Typeable constraints.  This is done by a custom Typeable solver,
   currently in TcInteract, that use M.$tcT so solve (Typeable T).

There are many wrinkles:

* The timing of when we produce this bindings is rather important: they must be
  defined after the rest of the module has been typechecked since we need to be
  able to lookup Module and TyCon in the type environment and we may be
  currently compiling GHC.Types (where they are defined).

* GHC.Prim doesn't have any associated object code, so we need to put the
  representations for types defined in this module elsewhere. We chose this
  place to be GHC.Types. TcTypeable.mkPrimTypeableBinds is responsible for
  injecting the bindings for the GHC.Prim representions when compiling
  GHC.Types.

* TyCon.tyConRepModOcc is responsible for determining where to find
  the representation binding for a given type. This is where we handle
  the special case for GHC.Prim.

* To save space and reduce dependencies, we need use quite low-level
  representations for TyCon and Module.  See GHC.Types
  Note [Runtime representation of modules and tycons]

-}</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | Generate the Typeable bindings for a module. This is the only</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- entry-point of this module and is invoked by the typechecker driver in</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- 'tcRnSrcDecls'.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- See Note [Grand plan for Typeable] in TcTypeable.</span><span>
</span><a name="line-95"></a><span class="hs-identifier">mkTypeableBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span>
</span><a name="line-96"></a><a name="mkTypeableBinds"><a href="TcTypeable.html#mkTypeableBinds"><span class="hs-identifier">mkTypeableBinds</span></a></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Create a binding for $trModule.</span><span>
</span><a name="line-98"></a><span>         </span><span class="hs-comment">-- Do this before processing any data type declarations,</span><span>
</span><a name="line-99"></a><span>         </span><span class="hs-comment">-- which need tcg_tr_module to be initialised</span><span>
</span><a name="line-100"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153611"><a href="#local-1628153611"><span class="hs-identifier">tcg_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeable.html#mkModIdBindings"><span class="hs-identifier hs-var">mkModIdBindings</span></a><span>
</span><a name="line-101"></a><span>         </span><span class="hs-comment">-- Now we can generate the TyCon representations...</span><span>
</span><a name="line-102"></a><span>         </span><span class="hs-comment">-- First we handle the primitive TyCons if we are compiling GHC.Types</span><span>
</span><a name="line-103"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153612"><a href="#local-1628153612"><span class="hs-identifier">tcg_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#setGblEnv"><span class="hs-identifier hs-var">setGblEnv</span></a><span> </span><a href="#local-1628153611"><span class="hs-identifier hs-var">tcg_env</span></a><span> </span><a href="TcTypeable.html#mkPrimTypeableBinds"><span class="hs-identifier hs-var">mkPrimTypeableBinds</span></a><span>
</span><a name="line-104"></a><span>         </span><span class="hs-comment">-- Then we produce bindings for the user-defined types in this module.</span><span>
</span><a name="line-105"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#setGblEnv"><span class="hs-identifier hs-var">setGblEnv</span></a><span> </span><a href="#local-1628153612"><span class="hs-identifier hs-var">tcg_env</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-106"></a><span>             </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153613"><a href="#local-1628153613"><span class="hs-identifier">tycons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628153609"><span class="hs-identifier hs-var">needs_typeable_binds</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_tcs</span><span> </span><a href="#local-1628153612"><span class="hs-identifier hs-var">tcg_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>             </span><span class="hs-keyword">in</span><span> </span><a href="TcTypeable.html#mkTypeableTyConBinds"><span class="hs-identifier hs-var">mkTypeableTyConBinds</span></a><span> </span><a href="#local-1628153613"><span class="hs-identifier hs-var">tycons</span></a><span>
</span><a name="line-108"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-110"></a><span>    </span><a name="local-1628153609"><a href="#local-1628153609"><span class="hs-identifier">needs_typeable_binds</span></a></a><span> </span><a name="local-1628153610"><a href="#local-1628153610"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-111"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isFamInstTyCon"><span class="hs-identifier hs-var">isFamInstTyCon</span></a><span> </span><a href="#local-1628153610"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-1628153610"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>       </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a><span> </span><a href="#local-1628153610"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-113"></a><span>       </span><span class="hs-operator hs-var">||</span><span> </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span> </span><a href="#local-1628153610"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
            Building top-level binding for $trModule
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">mkModIdBindings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span>
</span><a name="line-123"></a><a name="mkModIdBindings"><a href="TcTypeable.html#mkModIdBindings"><span class="hs-identifier">mkModIdBindings</span></a></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628153614"><a href="#local-1628153614"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-125"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153615"><a href="#local-1628153615"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span>
</span><a name="line-126"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153616"><a href="#local-1628153616"><span class="hs-identifier">mod_nm</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span> </span><a href="#local-1628153614"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOcc"><span class="hs-identifier hs-var">mkVarOcc</span></a><span> </span><span class="hs-string">&quot;$trModule&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628153615"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-127"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153617"><a href="#local-1628153617"><span class="hs-identifier">trModuleTyCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a><span> </span><a href="PrelNames.html#trModuleTyConName"><span class="hs-identifier hs-var">trModuleTyConName</span></a><span>
</span><a name="line-128"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153618"><a href="#local-1628153618"><span class="hs-identifier">mod_id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkExportedVanillaId"><span class="hs-identifier hs-var">mkExportedVanillaId</span></a><span> </span><a href="#local-1628153616"><span class="hs-identifier hs-var">mod_nm</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1628153617"><span class="hs-identifier hs-var">trModuleTyCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153619"><a href="#local-1628153619"><span class="hs-identifier">mod_bind</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsUtils.html#mkVarBind"><span class="hs-identifier hs-var">mkVarBind</span></a><span> </span><a href="#local-1628153618"><span class="hs-identifier hs-var">mod_id</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcTypeable.html#mkModIdRHS"><span class="hs-identifier hs-var">mkModIdRHS</span></a><span> </span><a href="#local-1628153614"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153620"><a href="#local-1628153620"><span class="hs-identifier">tcg_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcExtendGlobalValEnv"><span class="hs-identifier hs-var">tcExtendGlobalValEnv</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628153618"><span class="hs-identifier hs-var">mod_id</span></a><span class="hs-special">]</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-132"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628153620"><span class="hs-identifier hs-var">tcg_env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcg_tr_module</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628153618"><span class="hs-identifier hs-var">mod_id</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>                 </span><span class="hs-special">`</span><a href="TcBinds.html#addTypecheckedBinds"><span class="hs-identifier hs-var">addTypecheckedBinds</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="#local-1628153619"><span class="hs-identifier hs-var">mod_bind</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-identifier">mkModIdRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><a name="mkModIdRHS"><a href="TcTypeable.html#mkModIdRHS"><span class="hs-identifier">mkModIdRHS</span></a></a><span> </span><a name="local-1628153621"><a href="#local-1628153621"><span class="hs-identifier">mod</span></a></a><span>
</span><a name="line-137"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628153622"><a href="#local-1628153622"><span class="hs-identifier">trModuleDataCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupDataCon"><span class="hs-identifier hs-var">tcLookupDataCon</span></a><span> </span><a href="PrelNames.html#trModuleDataConName"><span class="hs-identifier hs-var">trModuleDataConName</span></a><span>
</span><a name="line-138"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153623"><a href="#local-1628153623"><span class="hs-identifier">trNameLit</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeable.html#mkTrNameLit"><span class="hs-identifier hs-var">mkTrNameLit</span></a><span>
</span><a name="line-139"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><a href="#local-1628153622"><span class="hs-identifier hs-var">trModuleDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>                           </span><span class="hs-special">[</span><span> </span><a href="#local-1628153623"><span class="hs-identifier hs-var">trNameLit</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#unitIdFS"><span class="hs-identifier hs-var">unitIdFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-1628153621"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="#local-1628153623"><span class="hs-identifier hs-var">trNameLit</span></a><span> </span><span class="hs-special">(</span><a href="Module.html#moduleNameFS"><span class="hs-identifier hs-var">moduleNameFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1628153621"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-142"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Building type-representation bindings
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Generate TyCon bindings for a set of type constructors</span><span>
</span><a name="line-151"></a><span class="hs-identifier">mkTypeableTyConBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span>
</span><a name="line-152"></a><a name="mkTypeableTyConBinds"><a href="TcTypeable.html#mkTypeableTyConBinds"><span class="hs-identifier">mkTypeableTyConBinds</span></a></a><span> </span><a name="local-1628153624"><a href="#local-1628153624"><span class="hs-identifier">tycons</span></a></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628153625"><a href="#local-1628153625"><span class="hs-identifier">gbl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-154"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153626"><a href="#local-1628153626"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-155"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153627"><a href="#local-1628153627"><span class="hs-identifier">mod_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">tcg_tr_module</span><span> </span><a href="#local-1628153625"><span class="hs-identifier hs-var">gbl_env</span></a><span> </span><span class="hs-keyword">of</span><span>  </span><span class="hs-comment">-- Should be set by now</span><span>
</span><a name="line-156"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628153628"><a href="#local-1628153628"><span class="hs-identifier">mod_id</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628153628"><span class="hs-identifier hs-var">mod_id</span></a><span>
</span><a name="line-157"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tcMkTypeableBinds&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628153624"><span class="hs-identifier hs-var">tycons</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153629"><a href="#local-1628153629"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeable.html#collect_stuff"><span class="hs-identifier hs-var">collect_stuff</span></a><span> </span><a href="#local-1628153626"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1628153627"><span class="hs-identifier hs-var">mod_expr</span></a><span>
</span><a name="line-159"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153630"><a href="#local-1628153630"><span class="hs-identifier">all_tycons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628153634"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628153633"><a href="#local-1628153633"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628153624"><span class="hs-identifier hs-var">tycons</span></a><span class="hs-special">,</span><span> </span><a name="local-1628153634"><a href="#local-1628153634"><span class="hs-identifier">tc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628153633"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="TyCon.html#tyConATs"><span class="hs-identifier hs-var">tyConATs</span></a><span> </span><a href="#local-1628153633"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-160"></a><span>                             </span><span class="hs-comment">-- We need type representations for any associated types</span><span>
</span><a name="line-161"></a><span>             </span><a name="local-1628153631"><a href="#local-1628153631"><span class="hs-identifier">tc_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeable.html#mk_typeable_binds"><span class="hs-identifier hs-var">mk_typeable_binds</span></a><span> </span><a href="#local-1628153629"><span class="hs-identifier hs-var">stuff</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628153630"><span class="hs-identifier hs-var">all_tycons</span></a><span>
</span><a name="line-162"></a><span>             </span><a name="local-1628153632"><a href="#local-1628153632"><span class="hs-identifier">tycon_rep_ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1628153631"><span class="hs-identifier hs-var">tc_binds</span></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628153635"><a href="#local-1628153635"><span class="hs-identifier">gbl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcExtendGlobalValEnv"><span class="hs-identifier hs-var">tcExtendGlobalValEnv</span></a><span> </span><a href="#local-1628153632"><span class="hs-identifier hs-var">tycon_rep_ids</span></a><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-165"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628153635"><span class="hs-identifier hs-var">gbl_env</span></a><span> </span><span class="hs-special">`</span><a href="TcBinds.html#addTypecheckedBinds"><span class="hs-identifier hs-var">addTypecheckedBinds</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628153631"><span class="hs-identifier hs-var">tc_binds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | Generate bindings for the type representation of a wired-in TyCon defined</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- by the virtual &quot;GHC.Prim&quot; module. This is where we inject the representation</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- bindings for primitive types into &quot;GHC.Types&quot;</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- See Note [Grand plan for Typeable] in this module.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">mkPrimTypeableBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span>
</span><a name="line-173"></a><a name="mkPrimTypeableBinds"><a href="TcTypeable.html#mkPrimTypeableBinds"><span class="hs-identifier">mkPrimTypeableBinds</span></a></a><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628153636"><a href="#local-1628153636"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-175"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628153636"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#gHC_TYPES"><span class="hs-identifier hs-var">gHC_TYPES</span></a><span>
</span><a name="line-176"></a><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628153637"><a href="#local-1628153637"><span class="hs-identifier">trModuleTyCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a><span> </span><a href="PrelNames.html#trModuleTyConName"><span class="hs-identifier hs-var">trModuleTyConName</span></a><span>
</span><a name="line-177"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153638"><a href="#local-1628153638"><span class="hs-identifier">ghc_prim_module_id</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-178"></a><span>                             </span><a href="Id.html#mkExportedVanillaId"><span class="hs-identifier hs-var">mkExportedVanillaId</span></a><span> </span><a href="PrelNames.html#trGhcPrimModuleName"><span class="hs-identifier hs-var">trGhcPrimModuleName</span></a><span>
</span><a name="line-179"></a><span>                                                 </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span> </span><a href="#local-1628153637"><span class="hs-identifier hs-var">trModuleTyCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-1628153639"><a href="#local-1628153639"><span class="hs-identifier">ghc_prim_module_bind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsUtils.html#mkVarBind"><span class="hs-identifier hs-var">mkVarBind</span></a><span> </span><a href="#local-1628153638"><span class="hs-identifier hs-var">ghc_prim_module_id</span></a><span>
</span><a name="line-182"></a><span>                                             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcTypeable.html#mkModIdRHS"><span class="hs-identifier hs-var">mkModIdRHS</span></a><span> </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-1628153640"><a href="#local-1628153640"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeable.html#collect_stuff"><span class="hs-identifier hs-var">collect_stuff</span></a><span> </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628153638"><span class="hs-identifier hs-var">ghc_prim_module_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">prim_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-186"></a><span>                         </span><a name="local-1628153641"><a href="#local-1628153641"><span class="hs-identifier">prim_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><a href="#local-1628153639"><span class="hs-identifier hs-var">ghc_prim_module_bind</span></a><span>
</span><a name="line-187"></a><span>                                      </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><a href="TcTypeable.html#ghcPrimTypeableBinds"><span class="hs-identifier hs-var">ghcPrimTypeableBinds</span></a><span> </span><a href="#local-1628153640"><span class="hs-identifier hs-var">stuff</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span>                         </span><a name="local-1628153642"><a href="#local-1628153642"><span class="hs-identifier">prim_rep_ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span> </span><a href="#local-1628153641"><span class="hs-identifier hs-var">prim_binds</span></a><span>
</span><a name="line-190"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-1628153643"><a href="#local-1628153643"><span class="hs-identifier">gbl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcExtendGlobalValEnv"><span class="hs-identifier hs-var">tcExtendGlobalValEnv</span></a><span> </span><a href="#local-1628153642"><span class="hs-identifier hs-var">prim_rep_ids</span></a><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-191"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628153643"><span class="hs-identifier hs-var">gbl_env</span></a><span> </span><span class="hs-special">`</span><a href="TcBinds.html#addTypecheckedBinds"><span class="hs-identifier hs-var">addTypecheckedBinds</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="#local-1628153641"><span class="hs-identifier hs-var">prim_binds</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-193"></a><span>           </span><span class="hs-keyword">else</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-194"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- | Generate bindings for the type representation of the wired-in TyCons defined</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- by the virtual &quot;GHC.Prim&quot; module. This differs from the usual</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- @mkTypeableBinds@ path in that here we need to lie to 'mk_typeable_binds'</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- about the module we are compiling (since we are currently compiling</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- &quot;GHC.Types&quot; yet are producing representations for types in &quot;GHC.Prim&quot;).</span><span>
</span><a name="line-202"></a><span class="hs-comment">--</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- See Note [Grand plan for Typeable] in this module.</span><span>
</span><a name="line-204"></a><span class="hs-identifier">ghcPrimTypeableBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier hs-type">TypeableStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-205"></a><a name="ghcPrimTypeableBinds"><a href="TcTypeable.html#ghcPrimTypeableBinds"><span class="hs-identifier">ghcPrimTypeableBinds</span></a></a><span> </span><a name="local-1628153644"><a href="#local-1628153644"><span class="hs-identifier">stuff</span></a></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628153646"><span class="hs-identifier hs-var">mkBind</span></a><span> </span><a href="#local-1628153645"><span class="hs-identifier hs-var">all_prim_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-identifier">all_prim_tys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-209"></a><span>    </span><a name="local-1628153645"><a href="#local-1628153645"><span class="hs-identifier">all_prim_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628153648"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628153647"><a href="#local-1628153647"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="TysPrim.html#primTyCons"><span class="hs-identifier hs-var">primTyCons</span></a><span>
</span><a name="line-210"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="local-1628153648"><a href="#local-1628153648"><span class="hs-identifier">tc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628153647"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="TyCon.html#tyConATs"><span class="hs-identifier hs-var">tyConATs</span></a><span> </span><a href="#local-1628153647"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>    </span><span class="hs-identifier">mkBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-213"></a><span>    </span><a name="local-1628153646"><a href="#local-1628153646"><span class="hs-identifier">mkBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeable.html#mk_typeable_binds"><span class="hs-identifier hs-var">mk_typeable_binds</span></a><span> </span><a href="#local-1628153644"><span class="hs-identifier hs-var">stuff</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-keyword">data</span><span> </span><a name="TypeableStuff"><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier">TypeableStuff</span></a></a><span>
</span><a name="line-216"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Stuff"><a href="TcTypeable.html#Stuff"><span class="hs-identifier">Stuff</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="dflags"><a href="TcTypeable.html#dflags"><span class="hs-identifier">dflags</span></a></a><span>         </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-217"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="mod_rep"><a href="TcTypeable.html#mod_rep"><span class="hs-identifier">mod_rep</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>  </span><span class="hs-comment">-- ^ Of type GHC.Types.Module</span><span>
</span><a name="line-218"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pkg_str"><a href="TcTypeable.html#pkg_str"><span class="hs-identifier">pkg_str</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>      </span><span class="hs-comment">-- ^ Package name</span><span>
</span><a name="line-219"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="mod_str"><a href="TcTypeable.html#mod_str"><span class="hs-identifier">mod_str</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>      </span><span class="hs-comment">-- ^ Module name</span><span>
</span><a name="line-220"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="trTyConTyCon"><a href="TcTypeable.html#trTyConTyCon"><span class="hs-identifier">trTyConTyCon</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>       </span><span class="hs-comment">-- ^ of @TyCon@</span><span>
</span><a name="line-221"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="trTyConDataCon"><a href="TcTypeable.html#trTyConDataCon"><span class="hs-identifier">trTyConDataCon</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>     </span><span class="hs-comment">-- ^ of @TyCon@</span><span>
</span><a name="line-222"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="trNameLit"><a href="TcTypeable.html#trNameLit"><span class="hs-identifier">trNameLit</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-223"></a><span>                                            </span><span class="hs-comment">-- ^ To construct @TrName@s</span><span>
</span><a name="line-224"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | Collect various tidbits which we'll need to generate TyCon representations.</span><span>
</span><a name="line-227"></a><span class="hs-identifier">collect_stuff</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier hs-type">TypeableStuff</span></a><span>
</span><a name="line-228"></a><a name="collect_stuff"><a href="TcTypeable.html#collect_stuff"><span class="hs-identifier">collect_stuff</span></a></a><span> </span><a name="local-1628153649"><a href="#local-1628153649"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1628153650"><a href="#local-1628153650"><span class="hs-identifier">mod_rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-229"></a><span>    </span><a name="local-1628153651"><a href="#local-1628153651"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-230"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1628153652"><a href="#local-1628153652"><span class="hs-identifier">pkg_str</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#unitIdString"><span class="hs-identifier hs-var">unitIdString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-1628153649"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span>        </span><a name="local-1628153653"><a href="#local-1628153653"><span class="hs-identifier">mod_str</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1628153649"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span>    </span><a name="local-1628153654"><a href="#local-1628153654"><span class="hs-identifier">trTyConTyCon</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a><span> </span><a href="PrelNames.html#trTyConTyConName"><span class="hs-identifier hs-var">trTyConTyConName</span></a><span>
</span><a name="line-234"></a><span>    </span><a name="local-1628153655"><a href="#local-1628153655"><span class="hs-identifier">trTyConDataCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupDataCon"><span class="hs-identifier hs-var">tcLookupDataCon</span></a><span> </span><a href="PrelNames.html#trTyConDataConName"><span class="hs-identifier hs-var">trTyConDataConName</span></a><span>
</span><a name="line-235"></a><span>    </span><a name="local-1628153656"><a href="#local-1628153656"><span class="hs-identifier">trNameLit</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeable.html#mkTrNameLit"><span class="hs-identifier hs-var">mkTrNameLit</span></a><span>
</span><a name="line-236"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TcTypeable.html#Stuff"><span class="hs-identifier hs-var">Stuff</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | Lookup the necessary pieces to construct the @trNameLit@. We do this so we</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- can save the work of repeating lookups when constructing many TyCon</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- representations.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">mkTrNameLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><a name="mkTrNameLit"><a href="TcTypeable.html#mkTrNameLit"><span class="hs-identifier">mkTrNameLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-243"></a><span>    </span><a name="local-1628153657"><a href="#local-1628153657"><span class="hs-identifier">trNameSDataCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupDataCon"><span class="hs-identifier hs-var">tcLookupDataCon</span></a><span> </span><a href="PrelNames.html#trNameSDataConName"><span class="hs-identifier hs-var">trNameSDataConName</span></a><span>
</span><a name="line-244"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">trNameLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-245"></a><span>        </span><a name="local-1628153658"><a href="#local-1628153658"><span class="hs-identifier">trNameLit</span></a></a><span> </span><a name="local-1628153659"><a href="#local-1628153659"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><a href="#local-1628153657"><span class="hs-identifier hs-var">trNameSDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>                                </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsStringPrimLit"><span class="hs-identifier hs-var">mkHsStringPrimLit</span></a><span> </span><a href="#local-1628153659"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-247"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628153658"><span class="hs-identifier hs-var">trNameLit</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | Make bindings for the type representations of a 'TyCon' and its</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- promoted constructors.</span><span>
</span><a name="line-251"></a><span class="hs-identifier">mk_typeable_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier hs-type">TypeableStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-252"></a><a name="mk_typeable_binds"><a href="TcTypeable.html#mk_typeable_binds"><span class="hs-identifier">mk_typeable_binds</span></a></a><span> </span><a name="local-1628153660"><a href="#local-1628153660"><span class="hs-identifier">stuff</span></a></a><span> </span><a name="local-1628153661"><a href="#local-1628153661"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeable.html#mkTyConRepBinds"><span class="hs-identifier hs-var">mkTyConRepBinds</span></a><span> </span><a href="#local-1628153660"><span class="hs-identifier hs-var">stuff</span></a><span> </span><a href="#local-1628153661"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-254"></a><span>    </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span>
</span><a name="line-255"></a><span>    </span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeable.html#mkTyConRepBinds"><span class="hs-identifier hs-var">mkTyConRepBinds</span></a><span> </span><a href="#local-1628153660"><span class="hs-identifier hs-var">stuff</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="DataCon.html#promoteDataCon"><span class="hs-identifier hs-var">promoteDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>                       </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628153661"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | Make typeable bindings for the given 'TyCon'.</span><span>
</span><a name="line-259"></a><span class="hs-identifier">mkTyConRepBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier hs-type">TypeableStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-260"></a><a name="mkTyConRepBinds"><a href="TcTypeable.html#mkTyConRepBinds"><span class="hs-identifier">mkTyConRepBinds</span></a></a><span> </span><a name="local-1628153662"><a href="#local-1628153662"><span class="hs-identifier">stuff</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcTypeable.html#Stuff"><span class="hs-identifier hs-var">Stuff</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1628153670"><a href="#local-1628153670"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConRepName_maybe"><span class="hs-identifier hs-var">tyConRepName_maybe</span></a><span> </span><a href="#local-1628153670"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-262"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628153671"><a href="#local-1628153671"><span class="hs-identifier">rep_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkVarBind"><span class="hs-identifier hs-var">mkVarBind</span></a><span> </span><a href="#local-1628153672"><span class="hs-identifier hs-var">rep_id</span></a><span> </span><a href="#local-1628153673"><span class="hs-identifier hs-var">rep_rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>         </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>           </span><a name="local-1628153672"><a href="#local-1628153672"><span class="hs-identifier">rep_id</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkExportedVanillaId"><span class="hs-identifier hs-var">mkExportedVanillaId</span></a><span> </span><a href="#local-1628153671"><span class="hs-identifier hs-var">rep_name</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span> </span><a href="#local-1628153667"><span class="hs-identifier hs-var">trTyConTyCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>           </span><a name="local-1628153673"><a href="#local-1628153673"><span class="hs-identifier">rep_rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeable.html#mkTyConRepRHS"><span class="hs-identifier hs-var">mkTyConRepRHS</span></a><span> </span><a href="#local-1628153662"><span class="hs-identifier hs-var">stuff</span></a><span> </span><a href="#local-1628153670"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-266"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Produce the right-hand-side of a @TyCon@ representation.</span><span>
</span><a name="line-269"></a><span class="hs-identifier">mkTyConRepRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcTypeable.html#TypeableStuff"><span class="hs-identifier hs-type">TypeableStuff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-270"></a><a name="mkTyConRepRHS"><a href="TcTypeable.html#mkTyConRepRHS"><span class="hs-identifier">mkTyConRepRHS</span></a></a><span> </span><span class="hs-special">(</span><a href="TcTypeable.html#Stuff"><span class="hs-identifier hs-var">Stuff</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1628153681"><a href="#local-1628153681"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628153682"><span class="hs-identifier hs-var">rep_rhs</span></a><span>
</span><a name="line-271"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-272"></a><span>    </span><a name="local-1628153682"><a href="#local-1628153682"><span class="hs-identifier">rep_rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><a href="#local-1628153679"><span class="hs-identifier hs-var">trTyConDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>                       </span><span class="hs-special">[</span><span> </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628153688"><span class="hs-identifier hs-var">word64</span></a><span> </span><a href="#local-1628153686"><span class="hs-identifier hs-var">high</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628153688"><span class="hs-identifier hs-var">word64</span></a><span> </span><a href="#local-1628153687"><span class="hs-identifier hs-var">low</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="#local-1628153675"><span class="hs-identifier hs-var">mod_rep</span></a><span>
</span><a name="line-275"></a><span>                       </span><span class="hs-special">,</span><span> </span><a href="#local-1628153680"><span class="hs-identifier hs-var">trNameLit</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-1628153683"><span class="hs-identifier hs-var">tycon_str</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span>    </span><a name="local-1628153683"><a href="#local-1628153683"><span class="hs-identifier">tycon_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628153684"><span class="hs-identifier hs-var">add_tick</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1628153681"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>    </span><a name="local-1628153684"><a href="#local-1628153684"><span class="hs-identifier">add_tick</span></a></a><span> </span><a name="local-1628153689"><a href="#local-1628153689"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isPromotedDataCon"><span class="hs-identifier hs-var">isPromotedDataCon</span></a><span> </span><a href="#local-1628153681"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\''</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628153689"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-279"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628153689"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span>    </span><span class="hs-identifier">hashThis</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-282"></a><span>    </span><a name="local-1628153685"><a href="#local-1628153685"><span class="hs-identifier">hashThis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#unwords"><span class="hs-identifier hs-var">unwords</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628153676"><span class="hs-identifier hs-var">pkg_str</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628153677"><span class="hs-identifier hs-var">mod_str</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628153683"><span class="hs-identifier hs-var">tycon_str</span></a><span class="hs-special">]</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-var">Fingerprint</span></a><span> </span><a name="local-1628153686"><a href="#local-1628153686"><span class="hs-identifier">high</span></a></a><span> </span><a name="local-1628153687"><a href="#local-1628153687"><span class="hs-identifier">low</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Fingerprint.html#fingerprintString"><span class="hs-identifier hs-var">fingerprintString</span></a><span> </span><a href="#local-1628153685"><span class="hs-identifier hs-var">hashThis</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span>    </span><span class="hs-identifier">word64</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span>
</span><a name="line-287"></a><span>    </span><a name="local-1628153688"><a href="#local-1628153688"><span class="hs-identifier">word64</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-1628153674"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628153690"><a href="#local-1628153690"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsWord64Prim"><span class="hs-identifier hs-var">HsWord64Prim</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1628153690"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><a href="#local-1628153690"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628153691"><a href="#local-1628153691"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span>   </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1628153691"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a><span> </span><a href="#local-1628153691"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a></pre></body></html>