<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-2006

\section[RnEnv]{Environment manipulation for the renamer monad}
-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP, MultiWayIf #-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">RnEnv</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-10"></a><span>        </span><a href="RnEnv.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>        </span><a href="RnEnv.html#lookupLocatedTopBndrRn"><span class="hs-identifier hs-var">lookupLocatedTopBndrRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupTopBndrRn"><span class="hs-identifier hs-var">lookupTopBndrRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>        </span><a href="RnEnv.html#lookupLocatedOccRn"><span class="hs-identifier hs-var">lookupLocatedOccRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupOccRn_maybe"><span class="hs-identifier hs-var">lookupOccRn_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="RnEnv.html#lookupLocalOccRn_maybe"><span class="hs-identifier hs-var">lookupLocalOccRn_maybe</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupInfoOccRn"><span class="hs-identifier hs-var">lookupInfoOccRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="RnEnv.html#lookupLocalOccThLvl_maybe"><span class="hs-identifier hs-var">lookupLocalOccThLvl_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupKindOccRn"><span class="hs-identifier hs-var">lookupKindOccRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="RnEnv.html#lookupGlobalOccRn"><span class="hs-identifier hs-var">lookupGlobalOccRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupGlobalOccRnExport"><span class="hs-identifier hs-var">lookupGlobalOccRnExport</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_maybe"><span class="hs-identifier hs-var">lookupGlobalOccRn_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="RnEnv.html#lookupOccRn_overloaded"><span class="hs-identifier hs-var">lookupOccRn_overloaded</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_overloaded"><span class="hs-identifier hs-var">lookupGlobalOccRn_overloaded</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="RnEnv.html#reportUnboundName"><span class="hs-identifier hs-var">reportUnboundName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#unknownNameSuggestions"><span class="hs-identifier hs-var">unknownNameSuggestions</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="RnEnv.html#addNameClashErrRn"><span class="hs-identifier hs-var">addNameClashErrRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>        </span><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier hs-type">HsSigCtxt</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupLocalTcNames"><span class="hs-identifier hs-var">lookupLocalTcNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupSigOccRn"><span class="hs-identifier hs-var">lookupSigOccRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="RnEnv.html#lookupSigCtxtOccRn"><span class="hs-identifier hs-var">lookupSigCtxtOccRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>        </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupFixityRn_help"><span class="hs-identifier hs-var">lookupFixityRn_help</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="RnEnv.html#lookupFieldFixityRn"><span class="hs-identifier hs-var">lookupFieldFixityRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>        </span><a href="RnEnv.html#lookupInstDeclBndr"><span class="hs-identifier hs-var">lookupInstDeclBndr</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupRecFieldOcc"><span class="hs-identifier hs-var">lookupRecFieldOcc</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupFamInstName"><span class="hs-identifier hs-var">lookupFamInstName</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="RnEnv.html#lookupConstructorFields"><span class="hs-identifier hs-var">lookupConstructorFields</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="RnEnv.html#lookupSyntaxName"><span class="hs-identifier hs-var">lookupSyntaxName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupSyntaxNames"><span class="hs-identifier hs-var">lookupSyntaxNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#lookupIfThenElse"><span class="hs-identifier hs-var">lookupIfThenElse</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="RnEnv.html#lookupGreAvailRn"><span class="hs-identifier hs-var">lookupGreAvailRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>        </span><a href="RnEnv.html#getLookupOccRn"><span class="hs-identifier hs-var">getLookupOccRn</span></a><span class="hs-special">,</span><a href="PrelNames.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#addUsedGREs"><span class="hs-identifier hs-var">addUsedGREs</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#addUsedDataCons"><span class="hs-identifier hs-var">addUsedDataCons</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>        </span><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#newLocalBndrsRn"><span class="hs-identifier hs-var">newLocalBndrsRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="RnEnv.html#bindLocalNames"><span class="hs-identifier hs-var">bindLocalNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="RnEnv.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="RnEnv.html#addLocalFixities"><span class="hs-identifier hs-var">addLocalFixities</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="RnEnv.html#bindLocatedLocalsFV"><span class="hs-identifier hs-var">bindLocatedLocalsFV</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#bindLocatedLocalsRn"><span class="hs-identifier hs-var">bindLocatedLocalsRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="RnEnv.html#extendTyVarEnvFVRn"><span class="hs-identifier hs-var">extendTyVarEnvFVRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>        </span><a href="RnEnv.html#checkDupRdrNames"><span class="hs-identifier hs-var">checkDupRdrNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><a href="RnEnv.html#checkDupNames"><span class="hs-identifier hs-var">checkDupNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#checkDupAndShadowedNames"><span class="hs-identifier hs-var">checkDupAndShadowedNames</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#dupNamesErr"><span class="hs-identifier hs-var">dupNamesErr</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="RnEnv.html#checkTupSize"><span class="hs-identifier hs-var">checkTupSize</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="RnEnv.html#addFvRn"><span class="hs-identifier hs-var">addFvRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#mapMaybeFvRn"><span class="hs-identifier hs-var">mapMaybeFvRn</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#mapFvRnCPS"><span class="hs-identifier hs-var">mapFvRnCPS</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="RnEnv.html#warnUnusedMatches"><span class="hs-identifier hs-var">warnUnusedMatches</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#warnUnusedTypePatterns"><span class="hs-identifier hs-var">warnUnusedTypePatterns</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>        </span><a href="RnEnv.html#warnUnusedTopBinds"><span class="hs-identifier hs-var">warnUnusedTopBinds</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#warnUnusedLocalBinds"><span class="hs-identifier hs-var">warnUnusedLocalBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="RnEnv.html#mkFieldEnv"><span class="hs-identifier hs-var">mkFieldEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>        </span><a href="RnEnv.html#dataTcOccs"><span class="hs-identifier hs-var">dataTcOccs</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#kindSigErr"><span class="hs-identifier hs-var">kindSigErr</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#perhapsForallMsg"><span class="hs-identifier hs-var">perhapsForallMsg</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#unknownSubordinateErr"><span class="hs-identifier hs-var">unknownSubordinateErr</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="RnEnv.html#inHsDocContext"><span class="hs-identifier hs-var">inHsDocContext</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="LoadIface.html"><span class="hs-identifier">LoadIface</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="LoadIface.html#loadInterfaceForName"><span class="hs-identifier hs-var">loadInterfaceForName</span></a><span class="hs-special">,</span><span> </span><a href="LoadIface.html#loadSrcInterface_maybe"><span class="hs-identifier hs-var">loadSrcInterface_maybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="IfaceEnv.html"><span class="hs-identifier">IfaceEnv</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="TcEnv.html"><span class="hs-identifier">TcEnv</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="RdrHsSyn.html"><span class="hs-identifier">RdrHsSyn</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Avail.html"><span class="hs-identifier">Avail</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="PrelNames.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#rOOT_MAIN"><span class="hs-identifier hs-var">rOOT_MAIN</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#forall_tv_RDR"><span class="hs-identifier hs-var">forall_tv_RDR</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#FixityDirection"><span class="hs-identifier hs-type">FixityDirection</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#defaultFixity"><span class="hs-identifier hs-var">defaultFixity</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="ListSetOps.html#minusList"><span class="hs-identifier hs-var">minusList</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><a href="Constants.html"><span class="hs-identifier">Constants</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">{-
*********************************************************
*                                                      *
                Source-code binders
*                                                      *
*********************************************************

Note [Signature lazy interface loading]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

GHC's lazy interface loading can be a bit confusing, so this Note is an
empirical description of what happens in one interesting case. When
compiling a signature module against an its implementation, we do NOT
load interface files associated with its names until after the type
checking phase.  For example:

    module ASig where
        data T
        f :: T -&gt; T

Suppose we compile this with -sig-of &quot;A is ASig&quot;:

    module B where
        data T = T
        f T = T

    module A(module B) where
        import B

During type checking, we'll load A.hi because we need to know what the
RdrEnv for the module is, but we DO NOT load the interface for B.hi!
It's wholly unnecessary: our local definition 'data T' in ASig is all
the information we need to finish type checking.  This is contrast to
type checking of ordinary Haskell files, in which we would not have the
local definition &quot;data T&quot; and would need to consult B.hi immediately.
(Also, this situation never occurs for hs-boot files, since you're not
allowed to reexport from another module.)

After type checking, we then check that the types we provided are
consistent with the backing implementation (in checkHiBootOrHsigIface).
At this point, B.hi is loaded, because we need something to compare
against.

I discovered this behavior when trying to figure out why type class
instances for Data.Map weren't in the EPS when I was type checking a
test very much like ASig (sigof02dm): the associated interface hadn't
been loaded yet!  (The larger issue is a moot point, since an instance
declared in a signature can never be a duplicate.)

This behavior might change in the future.  Consider this
alternate module B:

    module B where
        {-# DEPRECATED T, f &quot;Don't use&quot; #-}
        data T = T
        f T = T

One might conceivably want to report deprecation warnings when compiling
ASig with -sig-of B, in which case we need to look at B.hi to find the
deprecation warnings during renaming.  At the moment, you don't get any
warning until you use the identifier further downstream.  This would
require adjusting addUsedGRE so that during signature compilation,
we do not report deprecation warnings for LocalDef.  See also
Note [Handling of deprecations]
-}</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-identifier">newTopSrcBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-156"></a><a name="newTopSrcBinder"><a href="RnEnv.html#newTopSrcBinder"><span class="hs-identifier">newTopSrcBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628001443"><a href="#local-1628001443"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628001444"><a href="#local-1628001444"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001445"><a href="#local-1628001445"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-158"></a><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- This is here to catch</span><span>
</span><a name="line-159"></a><span>        </span><span class="hs-comment">--   (a) Exact-name binders created by Template Haskell</span><span>
</span><a name="line-160"></a><span>        </span><span class="hs-comment">--   (b) The PrelBase defn of (say) [] and similar, for which</span><span>
</span><a name="line-161"></a><span>        </span><span class="hs-comment">--       the parser reads the special syntax and returns an Exact RdrName</span><span>
</span><a name="line-162"></a><span>        </span><span class="hs-comment">-- We are at a binding site for the name, so check first that it</span><span>
</span><a name="line-163"></a><span>        </span><span class="hs-comment">-- the current module is the correct one; otherwise GHC can get</span><span>
</span><a name="line-164"></a><span>        </span><span class="hs-comment">-- very confused indeed. This test rejects code like</span><span>
</span><a name="line-165"></a><span>        </span><span class="hs-comment">--      data T = (,) Int Int</span><span>
</span><a name="line-166"></a><span>        </span><span class="hs-comment">-- unless we are in GHC.Tup</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span> </span><a href="#local-1628001445"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-168"></a><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001446"><a href="#local-1628001446"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-169"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001446"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-1628001445"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>                  </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#badOrigBinding"><span class="hs-identifier hs-var">badOrigBinding</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001445"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-keyword">else</span><span>   </span><span class="hs-comment">-- See Note [Binders in Template Haskell] in Convert.hs</span><span>
</span><a name="line-173"></a><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001447"><a href="#local-1628001447"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-174"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#externaliseName"><span class="hs-identifier hs-var">externaliseName</span></a><span> </span><a href="#local-1628001447"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-1628001445"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001448"><a href="#local-1628001448"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001449"><a href="#local-1628001449"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-177"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001450"><a href="#local-1628001450"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-178"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001448"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001450"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1628001448"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#rOOT_MAIN"><span class="hs-identifier hs-var">rOOT_MAIN</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>                 </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#badOrigBinding"><span class="hs-identifier hs-var">badOrigBinding</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>        </span><span class="hs-comment">-- When reading External Core we get Orig names as binders,</span><span>
</span><a name="line-181"></a><span>        </span><span class="hs-comment">-- but they should agree with the module gotten from the monad</span><span>
</span><a name="line-182"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-183"></a><span>        </span><span class="hs-comment">-- We can get built-in syntax showing up here too, sadly.  If you type</span><span>
</span><a name="line-184"></a><span>        </span><span class="hs-comment">--      data T = (,,,)</span><span>
</span><a name="line-185"></a><span>        </span><span class="hs-comment">-- the constructor is parsed as a type, and then RdrHsSyn.tyConToDataCon</span><span>
</span><a name="line-186"></a><span>        </span><span class="hs-comment">-- uses setRdrNameSpace to make it into a data constructors.  At that point</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- the nice Exact name for the TyCon gets swizzled to an Orig name.</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-comment">-- Hence the badOrigBinding error message.</span><span>
</span><a name="line-189"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-190"></a><span>        </span><span class="hs-comment">-- Except for the &quot;:Main.main = ...&quot; definition inserted into</span><span>
</span><a name="line-191"></a><span>        </span><span class="hs-comment">-- the Main module; ugh!</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span>        </span><span class="hs-comment">-- Because of this latter case, we call newGlobalBinder with a module from</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-comment">-- the RdrName, not from the environment.  In principle, it'd be fine to</span><span>
</span><a name="line-195"></a><span>        </span><span class="hs-comment">-- have an arbitrary mixture of external core definitions in a single module,</span><span>
</span><a name="line-196"></a><span>        </span><span class="hs-comment">-- (apart from module-initialisation issues, perhaps).</span><span>
</span><a name="line-197"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span> </span><a href="#local-1628001448"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001449"><span class="hs-identifier hs-var">rdr_occ</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-200"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isQual"><span class="hs-identifier hs-var">isQual</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>                 </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#badQualBndrErr"><span class="hs-identifier hs-var">badQualBndrErr</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>                </span><span class="hs-comment">-- Binders should not be qualified; if they are, and with a different</span><span>
</span><a name="line-203"></a><span>                </span><span class="hs-comment">-- module name, we we get a confusing &quot;M.T is not in scope&quot; error later</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628001451"><a href="#local-1628001451"><span class="hs-identifier">stage</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getStage"><span class="hs-identifier hs-var">getStage</span></a><span>
</span><a name="line-206"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628001452"><a href="#local-1628001452"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-207"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="TcEnv.html#isBrackStage"><span class="hs-identifier hs-var">isBrackStage</span></a><span> </span><a href="#local-1628001451"><span class="hs-identifier hs-var">stage</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-208"></a><span>                </span><span class="hs-comment">-- We are inside a TH bracket, so make an *Internal* name</span><span>
</span><a name="line-209"></a><span>                </span><span class="hs-comment">-- See Note [Top-level Names in Template Haskell decl quotes] in RnNames</span><span>
</span><a name="line-210"></a><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001453"><a href="#local-1628001453"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-211"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1628001453"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-212"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">tcg_impl_rdr_env</span><span> </span><a href="#local-1628001452"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-213"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001454"><a href="#local-1628001454"><span class="hs-identifier">gr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-214"></a><span>                </span><span class="hs-comment">-- We're compiling --sig-of, so resolve with respect to this</span><span>
</span><a name="line-215"></a><span>                </span><span class="hs-comment">-- module.</span><span>
</span><a name="line-216"></a><span>                </span><span class="hs-comment">-- See Note [Signature parameters in TcGblEnv and DynFlags]</span><span>
</span><a name="line-217"></a><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><a href="#local-1628001454"><span class="hs-identifier hs-var">gr</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>                    </span><span class="hs-comment">-- Be sure to override the loc so that we get accurate</span><span>
</span><a name="line-219"></a><span>                    </span><span class="hs-comment">-- information later</span><span>
</span><a name="line-220"></a><span>                    </span><span class="hs-special">[</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001455"><a href="#local-1628001455"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-221"></a><span>                      </span><span class="hs-comment">-- NB: Just adding this line will not work:</span><span>
</span><a name="line-222"></a><span>                      </span><span class="hs-comment">--    addUsedGRE True gre</span><span>
</span><a name="line-223"></a><span>                      </span><span class="hs-comment">-- see Note [Signature lazy interface loading] for</span><span>
</span><a name="line-224"></a><span>                      </span><span class="hs-comment">-- more details.</span><span>
</span><a name="line-225"></a><span>                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#setNameLoc"><span class="hs-identifier hs-var">setNameLoc</span></a><span> </span><a href="#local-1628001455"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-227"></a><span>                      </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- NB: cannot use reportUnboundName rdr_name</span><span>
</span><a name="line-228"></a><span>                        </span><span class="hs-comment">-- because it looks up in the wrong RdrEnv</span><span>
</span><a name="line-229"></a><span>                        </span><span class="hs-comment">-- ToDo: more helpful error messages</span><span>
</span><a name="line-230"></a><span>                      </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#unknownNameErr"><span class="hs-identifier hs-var">unknownNameErr</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier hs-var">pprNonVarNameSpace</span></a><span>
</span><a name="line-231"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>                      </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>                      </span><span class="hs-special">}</span><span>
</span><a name="line-234"></a><span>                </span><span class="hs-special">}</span><span>
</span><a name="line-235"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-236"></a><span>                </span><span class="hs-comment">-- Normal case</span><span>
</span><a name="line-237"></a><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001456"><a href="#local-1628001456"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-238"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;newTopSrcBinder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001456"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span> </span><a href="#local-1628001456"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001444"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001443"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">{-
*********************************************************
*                                                      *
        Source code occurrences
*                                                      *
*********************************************************

Looking up a name in the RnEnv.

Note [Type and class operator definitions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We want to reject all of these unless we have -XTypeOperators (Trac #3265)
   data a :*: b  = ...
   class a :*: b where ...
   data (:*:) a b  = ....
   class (:*:) a b where ...
The latter two mean that we are not just looking for a
*syntactically-infix* declaration, but one that uses an operator
OccName.  We use OccName.isSymOcc to detect that case, which isn't
terribly efficient, but there seems to be no better way.
-}</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-identifier">lookupTopBndrRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-264"></a><a name="lookupTopBndrRn"><a href="RnEnv.html#lookupTopBndrRn"><span class="hs-identifier">lookupTopBndrRn</span></a></a><span> </span><a name="local-1628001457"><a href="#local-1628001457"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628001458"><a href="#local-1628001458"><span class="hs-identifier">nopt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTopBndrRn_maybe"><span class="hs-identifier hs-var">lookupTopBndrRn_maybe</span></a><span> </span><a href="#local-1628001457"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-265"></a><span>                       </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001458"><span class="hs-identifier hs-var">nopt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-266"></a><span>                         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001459"><a href="#local-1628001459"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001459"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-267"></a><span>                         </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupTopBndrRn fail&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001457"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>                                       </span><a href="RnEnv.html#unboundName"><span class="hs-identifier hs-var">unboundName</span></a><span> </span><a href="RnEnv.html#WL_LocalTop"><span class="hs-identifier hs-var">WL_LocalTop</span></a><span> </span><a href="#local-1628001457"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-identifier">lookupLocatedTopBndrRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><a name="lookupLocatedTopBndrRn"><a href="RnEnv.html#lookupLocatedTopBndrRn"><span class="hs-identifier">lookupLocatedTopBndrRn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="RnEnv.html#lookupTopBndrRn"><span class="hs-identifier hs-var">lookupTopBndrRn</span></a><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-identifier">lookupTopBndrRn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- Look up a top-level source-code binder.   We may be looking up an unqualified 'f',</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- and there may be several imported 'f's too, which must not confuse us.</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- For example, this is OK:</span><span>
</span><a name="line-277"></a><span class="hs-comment">--      import Foo( f )</span><span>
</span><a name="line-278"></a><span class="hs-comment">--      infix 9 f       -- The 'f' here does not need to be qualified</span><span>
</span><a name="line-279"></a><span class="hs-comment">--      f x = x         -- Nor here, of course</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- So we have to filter out the non-local ones.</span><span>
</span><a name="line-281"></a><span class="hs-comment">--</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- A separate function (importsFromLocalDecls) reports duplicate top level</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- decls, so here it's safe just to choose an arbitrary one.</span><span>
</span><a name="line-284"></a><span class="hs-comment">--</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- There should never be a qualified name in a binding position in Haskell,</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- but there can be if we have read in an external-Core file.</span><span>
</span><a name="line-287"></a><span class="hs-comment">-- The Haskell parser checks for the illegal qualified name in Haskell</span><span>
</span><a name="line-288"></a><span class="hs-comment">-- source files, so we don't need to do so here.</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><a name="lookupTopBndrRn_maybe"><a href="RnEnv.html#lookupTopBndrRn_maybe"><span class="hs-identifier">lookupTopBndrRn_maybe</span></a></a><span> </span><a name="local-1628001460"><a href="#local-1628001460"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-291"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001461"><a href="#local-1628001461"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001460"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-292"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001462"><a href="#local-1628001462"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupExactOcc"><span class="hs-identifier hs-var">lookupExactOcc</span></a><span> </span><a href="#local-1628001461"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001462"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001463"><a href="#local-1628001463"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001464"><a href="#local-1628001464"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001460"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-295"></a><span>        </span><span class="hs-comment">-- This deals with the case of derived bindings, where</span><span>
</span><a name="line-296"></a><span>        </span><span class="hs-comment">-- we don't bother to call newTopSrcBinder first</span><span>
</span><a name="line-297"></a><span>        </span><span class="hs-comment">-- We assume there is no &quot;parent&quot; name</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001465"><a href="#local-1628001465"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span>
</span><a name="line-299"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628001466"><a href="#local-1628001466"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span> </span><a href="#local-1628001463"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001464"><span class="hs-identifier hs-var">rdr_occ</span></a><span> </span><a href="#local-1628001465"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-300"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001466"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- Check for operators in type or class declarations</span><span>
</span><a name="line-304"></a><span>           </span><span class="hs-comment">-- See Note [Type and class operator definitions]</span><span>
</span><a name="line-305"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001467"><a href="#local-1628001467"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001460"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-306"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span> </span><a href="#local-1628001467"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1628001467"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>               </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001468"><a href="#local-1628001468"><span class="hs-identifier">op_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#TypeOperators"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeOperators</span></a><span>
</span><a name="line-308"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-1628001468"><span class="hs-identifier hs-var">op_ok</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#opDeclErr"><span class="hs-identifier hs-var">opDeclErr</span></a><span> </span><a href="#local-1628001460"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628001469"><a href="#local-1628001469"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-311"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001460"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001469"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-312"></a><span>            </span><span class="hs-special">[</span><a name="local-1628001470"><a href="#local-1628001470"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001470"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>            </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-comment">-- Ambiguous (can't happen) or unbound</span><span>
</span><a name="line-314"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- | Lookup an @Exact@ @RdrName@. See Note [Looking up Exact RdrNames].</span><span>
</span><a name="line-318"></a><span class="hs-comment">-- This adds an error if the name cannot be found.</span><span>
</span><a name="line-319"></a><span class="hs-identifier">lookupExactOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-320"></a><a name="lookupExactOcc"><a href="RnEnv.html#lookupExactOcc"><span class="hs-identifier">lookupExactOcc</span></a></a><span> </span><a name="local-1628001471"><a href="#local-1628001471"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001472"><a href="#local-1628001472"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupExactOcc_either"><span class="hs-identifier hs-var">lookupExactOcc_either</span></a><span> </span><a href="#local-1628001471"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-322"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001472"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-323"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628001473"><a href="#local-1628001473"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-1628001473"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-324"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001471"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-325"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628001474"><a href="#local-1628001474"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001474"><span class="hs-identifier hs-var">name'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | Lookup an @Exact@ @RdrName@. See Note [Looking up Exact RdrNames].</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- This never adds an error, but it may return one.</span><span>
</span><a name="line-329"></a><span class="hs-identifier">lookupExactOcc_either</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span class="hs-comment">-- See Note [Looking up Exact RdrNames]</span><span>
</span><a name="line-331"></a><a name="lookupExactOcc_either"><a href="RnEnv.html#lookupExactOcc_either"><span class="hs-identifier">lookupExactOcc_either</span></a></a><span> </span><a name="local-1628001475"><a href="#local-1628001475"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-332"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001477"><a href="#local-1628001477"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#wiredInNameTyThing_maybe"><span class="hs-identifier hs-var">wiredInNameTyThing_maybe</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-333"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001480"><a href="#local-1628001480"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001477"><span class="hs-identifier hs-var">thing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-334"></a><span>                    </span><a href="TyCoRep.html#ATyCon"><span class="hs-identifier hs-var">ATyCon</span></a><span> </span><a name="local-1628001478"><a href="#local-1628001478"><span class="hs-identifier">tc</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001478"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-335"></a><span>                    </span><a href="TyCoRep.html#AConLike"><span class="hs-identifier hs-var">AConLike</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-1628001479"><a href="#local-1628001479"><span class="hs-identifier">dc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-1628001479"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>                    </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-337"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-1628001480"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-338"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#checkTupSize"><span class="hs-identifier hs-var">checkTupSize</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1628001480"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-342"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-345"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001481"><a href="#local-1628001481"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-346"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [Splicing Exact names]</span><span>
</span><a name="line-347"></a><span>             </span><a name="local-1628001482"><a href="#local-1628001482"><span class="hs-identifier">main_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-348"></a><span>             </span><a name="local-1628001483"><a href="#local-1628001483"><span class="hs-identifier">demoted_occs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="OccName.html#demoteOccName"><span class="hs-identifier hs-var">demoteOccName</span></a><span> </span><a href="#local-1628001482"><span class="hs-identifier hs-var">main_occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-349"></a><span>                              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001485"><a href="#local-1628001485"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628001485"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">]</span><span>
</span><a name="line-350"></a><span>                              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-351"></a><span>             </span><a name="local-1628001484"><a href="#local-1628001484"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628001487"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001486"><a href="#local-1628001486"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001482"><span class="hs-identifier hs-var">main_occ</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628001483"><span class="hs-identifier hs-var">demoted_occs</span></a><span>
</span><a name="line-352"></a><span>                          </span><span class="hs-special">,</span><span> </span><a name="local-1628001487"><a href="#local-1628001487"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><a href="#local-1628001481"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628001486"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-353"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001487"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-354"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001484"><span class="hs-identifier hs-var">gres</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-355"></a><span>           </span><span class="hs-special">[</span><a name="local-1628001488"><a href="#local-1628001488"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001488"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- See Note [Splicing Exact names]</span><span>
</span><a name="line-358"></a><span>                    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001489"><a href="#local-1628001489"><span class="hs-identifier">lcl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-359"></a><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="RdrName.html#inLocalRdrEnvScope"><span class="hs-identifier hs-var">inLocalRdrEnvScope</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001489"><span class="hs-identifier hs-var">lcl_env</span></a><span>
</span><a name="line-360"></a><span>                         </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>                         </span><span class="hs-keyword">else</span><span>
</span><a name="line-362"></a><span class="hs-cpp">#ifdef GHCI</span><span>
</span><a name="line-363"></a><span>                         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001490"><a href="#local-1628001490"><span class="hs-identifier">th_topnames_var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-identifier">tcg_th_topnames</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-364"></a><span>                            </span><span class="hs-special">;</span><span> </span><a name="local-1628001491"><a href="#local-1628001491"><span class="hs-identifier">th_topnames</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#readTcRef"><span class="hs-identifier hs-var">readTcRef</span></a><span> </span><a href="#local-1628001490"><span class="hs-identifier hs-var">th_topnames_var</span></a><span>
</span><a name="line-365"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001491"><span class="hs-identifier hs-var">th_topnames</span></a><span>
</span><a name="line-366"></a><span>                              </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>                              </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001476"><span class="hs-identifier hs-var">exact_nm_err</span></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>                            </span><span class="hs-special">}</span><span>
</span><a name="line-369"></a><span class="hs-cpp">#else /* !GHCI */</span><span>
</span><a name="line-370"></a><span>                         </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-identifier">exact_nm_err</span><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span class="hs-cpp">#endif /* !GHCI */</span><span>
</span><a name="line-372"></a><span>                       </span><span class="hs-special">}</span><span>
</span><a name="line-373"></a><span>           </span><a name="local-1628001492"><a href="#local-1628001492"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#sameNameErr"><span class="hs-identifier hs-var">sameNameErr</span></a><span> </span><a href="#local-1628001492"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Ugh!  See Note [Template Haskell ambiguity]</span><span>
</span><a name="line-374"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-375"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-376"></a><span>    </span><a name="local-1628001476"><a href="#local-1628001476"><span class="hs-identifier">exact_nm_err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The exact Name&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001475"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;is not in scope&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>                      </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Probable cause: you used a unique Template Haskell name (NameU), &quot;</span><span>
</span><a name="line-378"></a><span>                              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;perhaps via newName, but did not bind it&quot;</span><span>
</span><a name="line-379"></a><span>                              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;If that's it, then -ddump-splices might be useful&quot;</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-identifier">sameNameErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span>
</span><a name="line-382"></a><a name="sameNameErr"><a href="RnEnv.html#sameNameErr"><span class="hs-identifier">sameNameErr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;addSameNameErr: empty list&quot;</span><span>
</span><a name="line-383"></a><span class="hs-identifier">sameNameErr</span><span> </span><a name="local-1628001493"><a href="#local-1628001493"><span class="hs-identifier">gres</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-384"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Same exact name in multiple name-spaces:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628001495"><span class="hs-identifier hs-var">pp_one</span></a><span> </span><a href="#local-1628001494"><span class="hs-identifier hs-var">sorted_names</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628001496"><span class="hs-identifier hs-var">th_hint</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-387"></a><span>    </span><a name="local-1628001494"><a href="#local-1628001494"><span class="hs-identifier">sorted_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Exts.html#sortWith"><span class="hs-identifier hs-var">sortWith</span></a><span> </span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001493"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>    </span><a name="local-1628001495"><a href="#local-1628001495"><span class="hs-identifier">pp_one</span></a></a><span> </span><a name="local-1628001497"><a href="#local-1628001497"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-389"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#pprNameSpace"><span class="hs-identifier hs-var">pprNameSpace</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1628001497"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001497"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;declared at:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span> </span><a href="#local-1628001497"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span>    </span><a name="local-1628001496"><a href="#local-1628001496"><span class="hs-identifier">th_hint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Probable cause: you bound a unique Template Haskell name (NameU),&quot;</span><span>
</span><a name="line-394"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;perhaps via newName, in different name-spaces.&quot;</span><span>
</span><a name="line-395"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;If that's it, then -ddump-splices might be useful&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-399"></a><span class="hs-identifier">lookupInstDeclBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-400"></a><span class="hs-comment">-- This is called on the method name on the left-hand side of an</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- instance declaration binding. eg.  instance Functor T where</span><span>
</span><a name="line-402"></a><span class="hs-comment">--                                       fmap = ...</span><span>
</span><a name="line-403"></a><span class="hs-comment">--                                       ^^^^ called on this</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- Regardless of how many unqualified fmaps are in scope, we want</span><span>
</span><a name="line-405"></a><span class="hs-comment">-- the one that comes from the Functor class.</span><span>
</span><a name="line-406"></a><span class="hs-comment">--</span><span>
</span><a name="line-407"></a><span class="hs-comment">-- Furthermore, note that we take no account of whether the</span><span>
</span><a name="line-408"></a><span class="hs-comment">-- name is only in scope qualified.  I.e. even if method op is</span><span>
</span><a name="line-409"></a><span class="hs-comment">-- in scope as M.op, we still allow plain 'op' on the LHS of</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- an instance decl</span><span>
</span><a name="line-411"></a><span class="hs-comment">--</span><span>
</span><a name="line-412"></a><span class="hs-comment">-- The &quot;what&quot; parameter says &quot;method&quot; or &quot;associated type&quot;,</span><span>
</span><a name="line-413"></a><span class="hs-comment">-- depending on what we are looking up</span><span>
</span><a name="line-414"></a><a name="lookupInstDeclBndr"><a href="RnEnv.html#lookupInstDeclBndr"><span class="hs-identifier">lookupInstDeclBndr</span></a></a><span> </span><a name="local-1628001498"><a href="#local-1628001498"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-1628001499"><a href="#local-1628001499"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628001500"><a href="#local-1628001500"><span class="hs-identifier">rdr</span></a></a><span>
</span><a name="line-415"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#isQual"><span class="hs-identifier hs-var">isQual</span></a><span> </span><a href="#local-1628001500"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#badQualBndrErr"><span class="hs-identifier hs-var">badQualBndrErr</span></a><span> </span><a href="#local-1628001500"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>                </span><span class="hs-comment">-- In an instance decl you aren't allowed</span><span>
</span><a name="line-418"></a><span>                </span><span class="hs-comment">-- to use a qualified name for the method</span><span>
</span><a name="line-419"></a><span>                </span><span class="hs-comment">-- (Although it'd make perfect sense.)</span><span>
</span><a name="line-420"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001502"><a href="#local-1628001502"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupSubBndrOcc"><span class="hs-identifier hs-var">lookupSubBndrOcc</span></a><span>
</span><a name="line-421"></a><span>                          </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-comment">-- False =&gt; we don't give deprecated</span><span>
</span><a name="line-422"></a><span>                                </span><span class="hs-comment">-- warnings when a deprecated class</span><span>
</span><a name="line-423"></a><span>                                </span><span class="hs-comment">-- method is defined. We only warn</span><span>
</span><a name="line-424"></a><span>                                </span><span class="hs-comment">-- when it's used</span><span>
</span><a name="line-425"></a><span>                          </span><a href="#local-1628001498"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-1628001501"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001500"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-426"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001502"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-427"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628001503"><a href="#local-1628001503"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-1628001503"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001500"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-428"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628001504"><a href="#local-1628001504"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001504"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-429"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-430"></a><span>    </span><a name="local-1628001501"><a href="#local-1628001501"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001499"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;of class&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001498"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-434"></a><span class="hs-identifier">lookupFamInstName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- Used for TyData and TySynonym family instances only,</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- See Note [Family instance binders]</span><span>
</span><a name="line-437"></a><a name="lookupFamInstName"><a href="RnEnv.html#lookupFamInstName"><span class="hs-identifier">lookupFamInstName</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001505"><a href="#local-1628001505"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628001506"><a href="#local-1628001506"><span class="hs-identifier">tc_rdr</span></a></a><span>  </span><span class="hs-comment">-- Associated type; c.f RnBinds.rnMethodBind</span><span>
</span><a name="line-438"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#lookupInstDeclBndr"><span class="hs-identifier hs-var">lookupInstDeclBndr</span></a><span> </span><a href="#local-1628001505"><span class="hs-identifier hs-var">cls</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;associated type&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628001506"><span class="hs-identifier hs-var">tc_rdr</span></a><span>
</span><a name="line-439"></a><span class="hs-identifier">lookupFamInstName</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a name="local-1628001507"><a href="#local-1628001507"><span class="hs-identifier">tc_rdr</span></a></a><span>     </span><span class="hs-comment">-- Family instance; tc_rdr is an *occurrence*</span><span>
</span><a name="line-440"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupLocatedOccRn"><span class="hs-identifier hs-var">lookupLocatedOccRn</span></a><span> </span><a href="#local-1628001507"><span class="hs-identifier hs-var">tc_rdr</span></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-443"></a><span class="hs-identifier">lookupConstructorFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-444"></a><span class="hs-comment">-- Look up the fields of a given constructor</span><span>
</span><a name="line-445"></a><span class="hs-comment">--   *  For constructors from this module, use the record field env,</span><span>
</span><a name="line-446"></a><span class="hs-comment">--      which is itself gathered from the (as yet un-typechecked)</span><span>
</span><a name="line-447"></a><span class="hs-comment">--      data type decls</span><span>
</span><a name="line-448"></a><span class="hs-comment">--</span><span>
</span><a name="line-449"></a><span class="hs-comment">--    * For constructors from imported modules, use the *type* environment</span><span>
</span><a name="line-450"></a><span class="hs-comment">--      since imported modles are already compiled, the info is conveniently</span><span>
</span><a name="line-451"></a><span class="hs-comment">--      right there</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><a name="lookupConstructorFields"><a href="RnEnv.html#lookupConstructorFields"><span class="hs-identifier">lookupConstructorFields</span></a></a><span> </span><a name="local-1628001508"><a href="#local-1628001508"><span class="hs-identifier">con_name</span></a></a><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001509"><a href="#local-1628001509"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-455"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a><span> </span><a href="#local-1628001509"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-1628001508"><span class="hs-identifier hs-var">con_name</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-456"></a><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001510"><a href="#local-1628001510"><span class="hs-identifier">field_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getRecFieldEnv"><span class="hs-identifier hs-var">getRecFieldEnv</span></a><span>
</span><a name="line-457"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;lookupCF&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001508"><span class="hs-identifier hs-var">con_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><a href="#local-1628001510"><span class="hs-identifier hs-var">field_env</span></a><span> </span><a href="#local-1628001508"><span class="hs-identifier hs-var">con_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001510"><span class="hs-identifier hs-var">field_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><a href="#local-1628001510"><span class="hs-identifier hs-var">field_env</span></a><span> </span><a href="#local-1628001508"><span class="hs-identifier hs-var">con_name</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-459"></a><span>          </span><span class="hs-keyword">else</span><span>
</span><a name="line-460"></a><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001511"><a href="#local-1628001511"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupDataCon"><span class="hs-identifier hs-var">tcLookupDataCon</span></a><span> </span><a href="#local-1628001508"><span class="hs-identifier hs-var">con_name</span></a><span>
</span><a name="line-461"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;lookupCF 2&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001511"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-462"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span> </span><a href="#local-1628001511"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-465"></a><span class="hs-comment">-- Used for record construction and pattern matching</span><span>
</span><a name="line-466"></a><span class="hs-comment">-- When the -XDisambiguateRecordFields flag is on, take account of the</span><span>
</span><a name="line-467"></a><span class="hs-comment">-- constructor name to disambiguate which field to use; it's just the</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- same as for instance decls</span><span>
</span><a name="line-469"></a><span class="hs-comment">--</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- NB: Consider this:</span><span>
</span><a name="line-471"></a><span class="hs-comment">--      module Foo where { data R = R { fld :: Int } }</span><span>
</span><a name="line-472"></a><span class="hs-comment">--      module Odd where { import Foo; fld x = x { fld = 3 } }</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- Arguably this should work, because the reference to 'fld' is</span><span>
</span><a name="line-474"></a><span class="hs-comment">-- unambiguous because there is only one field id 'fld' in scope.</span><span>
</span><a name="line-475"></a><span class="hs-comment">-- But currently it's rejected.</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-identifier">lookupRecFieldOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>  </span><span class="hs-comment">-- Nothing    =&gt; just look it up as usual</span><span>
</span><a name="line-478"></a><span>                                 </span><span class="hs-comment">-- Just tycon =&gt; use tycon to disambiguate</span><span>
</span><a name="line-479"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-480"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-481"></a><a name="lookupRecFieldOcc"><a href="RnEnv.html#lookupRecFieldOcc"><span class="hs-identifier">lookupRecFieldOcc</span></a></a><span> </span><a name="local-1628001512"><a href="#local-1628001512"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-1628001513"><a href="#local-1628001513"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1628001514"><a href="#local-1628001514"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-482"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001515"><a href="#local-1628001515"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001512"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-483"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001516"><a href="#local-1628001516"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupSubBndrOcc"><span class="hs-identifier hs-var">lookupSubBndrOcc</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001515"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><a href="#local-1628001513"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001514"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-484"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001516"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-485"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628001517"><a href="#local-1628001517"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-1628001517"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001514"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-486"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628001518"><a href="#local-1628001518"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001518"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-489"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn"><span class="hs-identifier hs-var">lookupGlobalOccRn</span></a><span> </span><a href="#local-1628001514"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-identifier">lookupSubBndrOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-492"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>     </span><span class="hs-comment">-- Parent</span><span>
</span><a name="line-493"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-494"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-495"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span class="hs-comment">-- Find all the things the rdr-name maps to</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- and pick the one with the right parent namep</span><span>
</span><a name="line-498"></a><a name="lookupSubBndrOcc"><a href="RnEnv.html#lookupSubBndrOcc"><span class="hs-identifier">lookupSubBndrOcc</span></a></a><span> </span><a name="local-1628001519"><a href="#local-1628001519"><span class="hs-identifier">warn_if_deprec</span></a></a><span> </span><a name="local-1628001520"><a href="#local-1628001520"><span class="hs-identifier">the_parent</span></a></a><span> </span><a name="local-1628001521"><a href="#local-1628001521"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1628001522"><a href="#local-1628001522"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-499"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001530"><a href="#local-1628001530"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span>   </span><span class="hs-comment">-- This happens in derived code</span><span>
</span><a name="line-500"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001531"><a href="#local-1628001531"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupExactOcc"><span class="hs-identifier hs-var">lookupExactOcc</span></a><span> </span><a href="#local-1628001530"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-501"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001531"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001532"><a href="#local-1628001532"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001533"><a href="#local-1628001533"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-504"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001534"><a href="#local-1628001534"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><a href="#local-1628001532"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001533"><span class="hs-identifier hs-var">rdr_occ</span></a><span>
</span><a name="line-505"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001534"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PrelNames.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a><span> </span><a href="#local-1628001520"><span class="hs-identifier hs-var">the_parent</span></a><span>
</span><a name="line-508"></a><span>        </span><span class="hs-comment">-- Avoid an error cascade from malformed decls:</span><span>
</span><a name="line-509"></a><span>        </span><span class="hs-comment">--   instance Int where { foo = e }</span><span>
</span><a name="line-510"></a><span>        </span><span class="hs-comment">-- We have already generated an error in rnLHsInstDecl</span><span>
</span><a name="line-511"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-514"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001535"><a href="#local-1628001535"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-515"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001536"><a href="#local-1628001536"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><a href="#local-1628001535"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>                </span><span class="hs-comment">-- NB: lookupGlobalRdrEnv, not lookupGRE_RdrName!</span><span>
</span><a name="line-517"></a><span>                </span><span class="hs-comment">--     The latter does pickGREs, but we want to allow 'x'</span><span>
</span><a name="line-518"></a><span>                </span><span class="hs-comment">--     even if only 'M.x' is in scope</span><span>
</span><a name="line-519"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupSubBndrOcc&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001520"><span class="hs-identifier hs-var">the_parent</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001536"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001523"><span class="hs-identifier hs-var">pick_gres</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001536"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001523"><span class="hs-identifier hs-var">pick_gres</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001536"><span class="hs-identifier hs-var">gres</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-521"></a><span>            </span><span class="hs-special">(</span><a name="local-1628001537"><a href="#local-1628001537"><span class="hs-identifier">gre</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span> </span><a href="#local-1628001519"><span class="hs-identifier hs-var">warn_if_deprec</span></a><span> </span><a href="#local-1628001537"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-522"></a><span>                            </span><span class="hs-comment">-- Add a usage; this is an *occurrence* site</span><span>
</span><a name="line-523"></a><span>                            </span><span class="hs-comment">-- Note [Usage for sub-bndrs]</span><span>
</span><a name="line-524"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001537"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-525"></a><span>                 </span><span class="hs-comment">-- If there is more than one local GRE for the</span><span>
</span><a name="line-526"></a><span>                 </span><span class="hs-comment">-- same OccName 'f', that will be reported separately</span><span>
</span><a name="line-527"></a><span>                 </span><span class="hs-comment">-- as a duplicate top-level binding for 'f'</span><span>
</span><a name="line-528"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001538"><a href="#local-1628001538"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupQualifiedNameGHCi"><span class="hs-identifier hs-var">lookupQualifiedNameGHCi</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-529"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001538"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-530"></a><span>                         </span><span class="hs-special">(</span><a name="local-1628001539"><a href="#local-1628001539"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001539"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Unlikely to be more than one...?</span><span>
</span><a name="line-531"></a><span>                         </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#unknownSubordinateErr"><span class="hs-identifier hs-var">unknownSubordinateErr</span></a><span> </span><a href="#local-1628001521"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001522"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-533"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-534"></a><span>    </span><span class="hs-comment">-- If Parent = NoParent, just do a normal lookup</span><span>
</span><a name="line-535"></a><span>    </span><span class="hs-comment">-- If Parent = Parent p then find all GREs that</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-comment">--   (a) have parent p</span><span>
</span><a name="line-537"></a><span>    </span><span class="hs-comment">--   (b) for Unqual, are in scope qualified or unqualified</span><span>
</span><a name="line-538"></a><span>    </span><span class="hs-comment">--       for Qual, are in scope with that qualification</span><span>
</span><a name="line-539"></a><span>    </span><a name="local-1628001523"><a href="#local-1628001523"><span class="hs-identifier">pick_gres</span></a></a><span> </span><a name="local-1628001525"><a href="#local-1628001525"><span class="hs-identifier">rdr_name</span></a></a><span> </span><a name="local-1628001526"><a href="#local-1628001526"><span class="hs-identifier">gres</span></a></a><span>
</span><a name="line-540"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isUnqual"><span class="hs-identifier hs-var">isUnqual</span></a><span> </span><a href="#local-1628001525"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628001524"><span class="hs-identifier hs-var">right_parent</span></a><span> </span><a href="#local-1628001526"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-541"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628001524"><span class="hs-identifier hs-var">right_parent</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#pickGREs"><span class="hs-identifier hs-var">pickGREs</span></a><span> </span><a href="#local-1628001525"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001526"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span>    </span><a name="local-1628001524"><a href="#local-1628001524"><span class="hs-identifier">right_parent</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_par</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001527"><a href="#local-1628001527"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#ParentIs"><span class="hs-identifier hs-var">ParentIs</span></a><span> </span><a name="local-1628001528"><a href="#local-1628001528"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001527"><span class="hs-identifier hs-var">p</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001528"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001520"><span class="hs-identifier hs-var">the_parent</span></a><span>
</span><a name="line-545"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#FldParent"><span class="hs-identifier hs-var">FldParent</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">par_is</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001529"><a href="#local-1628001529"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001527"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001529"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001520"><span class="hs-identifier hs-var">the_parent</span></a><span>
</span><a name="line-546"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">{-
Note [Family instance binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
  data family F a
  data instance F T = X1 | X2

The 'data instance' decl has an *occurrence* of F (and T), and *binds*
X1 and X2.  (This is unlike a normal data type declaration which would
bind F too.)  So we want an AvailTC F [X1,X2].

Now consider a similar pair:
  class C a where
    data G a
  instance C S where
    data G S = Y1 | Y2

The 'data G S' *binds* Y1 and Y2, and has an *occurrence* of G.

But there is a small complication: in an instance decl, we don't use
qualified names on the LHS; instead we use the class to disambiguate.
Thus:
  module M where
    import Blib( G )
    class C a where
      data G a
    instance C S where
      data G S = Y1 | Y2
Even though there are two G's in scope (M.G and Blib.G), the occurrence
of 'G' in the 'instance C S' decl is unambiguous, because C has only
one associated type called G. This is exactly what happens for methods,
and it is only consistent to do the same thing for types. That's the
role of the function lookupTcdName; the (Maybe Name) give the class of
the encloseing instance decl, if any.

Note [Looking up Exact RdrNames]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Exact RdrNames are generated by Template Haskell.  See Note [Binders
in Template Haskell] in Convert.

For data types and classes have Exact system Names in the binding
positions for constructors, TyCons etc.  For example
    [d| data T = MkT Int |]
when we splice in and Convert to HsSyn RdrName, we'll get
    data (Exact (system Name &quot;T&quot;)) = (Exact (system Name &quot;MkT&quot;)) ...
These System names are generated by Convert.thRdrName

But, constructors and the like need External Names, not System Names!
So we do the following

 * In RnEnv.newTopSrcBinder we spot Exact RdrNames that wrap a
   non-External Name, and make an External name for it. This is
   the name that goes in the GlobalRdrEnv

 * When looking up an occurrence of an Exact name, done in
   RnEnv.lookupExactOcc, we find the Name with the right unique in the
   GlobalRdrEnv, and use the one from the envt -- it will be an
   External Name in the case of the data type/constructor above.

 * Exact names are also use for purely local binders generated
   by TH, such as    \x_33. x_33
   Both binder and occurrence are Exact RdrNames.  The occurrence
   gets looked up in the LocalRdrEnv by RnEnv.lookupOccRn, and
   misses, because lookupLocalRdrEnv always returns Nothing for
   an Exact Name.  Now we fall through to lookupExactOcc, which
   will find the Name is not in the GlobalRdrEnv, so we just use
   the Exact supplied Name.

Note [Splicing Exact names]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider the splice $(do { x &lt;- newName &quot;x&quot;; return (VarE x) })
This will generate a (HsExpr RdrName) term that mentions the
Exact RdrName &quot;x_56&quot; (or whatever), but does not bind it.  So
when looking such Exact names we want to check that it's in scope,
otherwise the type checker will get confused.  To do this we need to
keep track of all the Names in scope, and the LocalRdrEnv does just that;
we consult it with RdrName.inLocalRdrEnvScope.

There is another wrinkle.  With TH and -XDataKinds, consider
   $( [d| data Nat = Zero
          data T = MkT (Proxy 'Zero)  |] )
After splicing, but before renaming we get this:
   data Nat_77{tc} = Zero_78{d}
   data T_79{tc} = MkT_80{d} (Proxy 'Zero_78{tc})  |] )
The occurrence of 'Zero in the data type for T has the right unique,
but it has a TcClsName name-space in its OccName.  (This is set by
the ctxt_ns argument of Convert.thRdrName.)  When we check that is
in scope in the GlobalRdrEnv, we need to look up the DataName namespace
too.  (An alternative would be to make the GlobalRdrEnv also have
a Name -&gt; GRE mapping.)

Note [Template Haskell ambiguity]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The GlobalRdrEnv invariant says that if
  occ -&gt; [gre1, ..., gren]
then the gres have distinct Names (INVARIANT 1 of GlobalRdrEnv).
This is guaranteed by extendGlobalRdrEnvRn (the dups check in add_gre).

So how can we get multiple gres in lookupExactOcc_maybe?  Because in
TH we might use the same TH NameU in two different name spaces.
eg (Trac #7241):
   $(newName &quot;Foo&quot; &gt;&gt;= \o -&gt; return [DataD [] o [] [RecC o []] [''Show]])
Here we generate a type constructor and data constructor with the same
unique, but differnt name spaces.

It'd be nicer to rule this out in extendGlobalRdrEnvRn, but that would
mean looking up the OccName in every name-space, just in case, and that
seems a bit brutal.  So it's just done here on lookup.  But we might
need to revisit that choice.

Note [Usage for sub-bndrs]
~~~~~~~~~~~~~~~~~~~~~~~~~~
If you have this
   import qualified M( C( f ) )
   instance M.C T where
     f x = x
then is the qualified import M.f used?  Obviously yes.
But the RdrName used in the instance decl is unqualified.  In effect,
we fill in the qualification by looking for f's whose class is M.C
But when adding to the UsedRdrNames we must make that qualification
explicit (saying &quot;used  M.f&quot;), otherwise we get &quot;Redundant import of M.f&quot;.

So we make up a suitable (fake) RdrName.  But be careful
   import qualifed M
   import M( C(f) )
   instance C T where
     f x = x
Here we want to record a use of 'f', not of 'M.f', otherwise
we'll miss the fact that the qualified import is redundant.

--------------------------------------------------
--              Occurrences
--------------------------------------------------
-}</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">getLookupOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><a name="getLookupOccRn"><a href="RnEnv.html#getLookupOccRn"><span class="hs-identifier">getLookupOccRn</span></a></a><span>
</span><a name="line-685"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628001540"><a href="#local-1628001540"><span class="hs-identifier">local_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-686"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupLocalRdrOcc"><span class="hs-identifier hs-var">lookupLocalRdrOcc</span></a><span> </span><a href="#local-1628001540"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span class="hs-identifier">mkUnboundNameRdr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-689"></a><a name="mkUnboundNameRdr"><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier">mkUnboundNameRdr</span></a></a><span> </span><a name="local-1628001541"><a href="#local-1628001541"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001541"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span class="hs-identifier">lookupLocatedOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><a name="lookupLocatedOccRn"><a href="RnEnv.html#lookupLocatedOccRn"><span class="hs-identifier">lookupLocatedOccRn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span>
</span><a name="line-693"></a><span>
</span><a name="line-694"></a><span class="hs-identifier">lookupLocalOccRn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- Just look in the local environment</span><span>
</span><a name="line-696"></a><a name="lookupLocalOccRn_maybe"><a href="RnEnv.html#lookupLocalOccRn_maybe"><span class="hs-identifier">lookupLocalOccRn_maybe</span></a></a><span> </span><a name="local-1628001542"><a href="#local-1628001542"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-697"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001543"><a href="#local-1628001543"><span class="hs-identifier">local_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-698"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-1628001543"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001542"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-699"></a><span>
</span><a name="line-700"></a><span class="hs-identifier">lookupLocalOccThLvl_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span class="hs-comment">-- Just look in the local environment</span><span>
</span><a name="line-702"></a><a name="lookupLocalOccThLvl_maybe"><a href="RnEnv.html#lookupLocalOccThLvl_maybe"><span class="hs-identifier">lookupLocalOccThLvl_maybe</span></a></a><span> </span><a name="local-1628001544"><a href="#local-1628001544"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-703"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001545"><a href="#local-1628001545"><span class="hs-identifier">lcl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-704"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_th_bndrs</span><span> </span><a href="#local-1628001545"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001544"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-comment">-- lookupOccRn looks up an occurrence of a RdrName</span><span>
</span><a name="line-707"></a><span class="hs-identifier">lookupOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-708"></a><a name="lookupOccRn"><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier">lookupOccRn</span></a></a><span> </span><a name="local-1628001546"><a href="#local-1628001546"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-709"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001547"><a href="#local-1628001547"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupOccRn_maybe"><span class="hs-identifier hs-var">lookupOccRn_maybe</span></a><span> </span><a href="#local-1628001546"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-710"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001547"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-711"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001548"><a href="#local-1628001548"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001548"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-712"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#reportUnboundName"><span class="hs-identifier hs-var">reportUnboundName</span></a><span> </span><a href="#local-1628001546"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-identifier">lookupKindOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-715"></a><span class="hs-comment">-- Looking up a name occurring in a kind</span><span>
</span><a name="line-716"></a><a name="lookupKindOccRn"><a href="RnEnv.html#lookupKindOccRn"><span class="hs-identifier">lookupKindOccRn</span></a></a><span> </span><a name="local-1628001549"><a href="#local-1628001549"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-717"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001550"><a href="#local-1628001550"><span class="hs-identifier">typeintype</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-718"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001550"><span class="hs-identifier hs-var">typeintype</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span> </span><a href="#local-1628001549"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-719"></a><span>      </span><span class="hs-comment">-- With -XNoTypeInType, treat any usage of * in kinds as in scope</span><span>
</span><a name="line-720"></a><span>      </span><span class="hs-comment">-- this is a dirty hack, but then again so was the old * kind.</span><span>
</span><a name="line-721"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="RnEnv.html#is_star"><span class="hs-identifier hs-var">is_star</span></a><span> </span><a href="#local-1628001549"><span class="hs-identifier hs-var">rdr_name</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span>
</span><a name="line-722"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="RnEnv.html#is_uni_star"><span class="hs-identifier hs-var">is_uni_star</span></a><span> </span><a href="#local-1628001549"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span>
</span><a name="line-723"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span> </span><a href="#local-1628001549"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-724"></a><span>
</span><a name="line-725"></a><span class="hs-comment">-- lookupPromotedOccRn looks up an optionally promoted RdrName.</span><span>
</span><a name="line-726"></a><span class="hs-identifier">lookupTypeOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-727"></a><span class="hs-comment">-- see Note [Demotion]</span><span>
</span><a name="line-728"></a><a name="lookupTypeOccRn"><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier">lookupTypeOccRn</span></a></a><span> </span><a name="local-1628001551"><a href="#local-1628001551"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-729"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001552"><a href="#local-1628001552"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupOccRn_maybe"><span class="hs-identifier hs-var">lookupOccRn_maybe</span></a><span> </span><a href="#local-1628001551"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-730"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001552"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-731"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001553"><a href="#local-1628001553"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001553"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-732"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001554"><a href="#local-1628001554"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-733"></a><span>                             </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#lookup_demoted"><span class="hs-identifier hs-var">lookup_demoted</span></a><span> </span><a href="#local-1628001551"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001554"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-identifier">lookup_demoted</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-736"></a><a name="lookup_demoted"><a href="RnEnv.html#lookup_demoted"><span class="hs-identifier">lookup_demoted</span></a></a><span> </span><a name="local-1628001555"><a href="#local-1628001555"><span class="hs-identifier">rdr_name</span></a></a><span> </span><a name="local-1628001556"><a href="#local-1628001556"><span class="hs-identifier">dflags</span></a></a><span>
</span><a name="line-737"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001561"><a href="#local-1628001561"><span class="hs-identifier">demoted_rdr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#demoteRdrName"><span class="hs-identifier hs-var">demoteRdrName</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-738"></a><span>    </span><span class="hs-comment">-- Maybe it's the name of a *data* constructor</span><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001562"><a href="#local-1628001562"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-740"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001563"><a href="#local-1628001563"><span class="hs-identifier">mb_demoted_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupOccRn_maybe"><span class="hs-identifier hs-var">lookupOccRn_maybe</span></a><span> </span><a href="#local-1628001561"><span class="hs-identifier hs-var">demoted_rdr</span></a><span>
</span><a name="line-741"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001563"><span class="hs-identifier hs-var">mb_demoted_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-742"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#unboundNameX"><span class="hs-identifier hs-var">unboundNameX</span></a><span> </span><a href="RnEnv.html#WL_Any"><span class="hs-identifier hs-var">WL_Any</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001559"><span class="hs-identifier hs-var">star_info</span></a><span>
</span><a name="line-743"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001564"><a href="#local-1628001564"><span class="hs-identifier">demoted_name</span></a></a><span>
</span><a name="line-744"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001562"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-745"></a><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnUntickedPromotedConstructors"><span class="hs-identifier hs-var">Opt_WarnUntickedPromotedConstructors</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-746"></a><span>                  </span><a href="TcRnMonad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnUntickedPromotedConstructors"><span class="hs-identifier hs-var">Opt_WarnUntickedPromotedConstructors</span></a><span class="hs-special">)</span><span>
</span><a name="line-747"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628001558"><span class="hs-identifier hs-var">untickedPromConstrWarn</span></a><span> </span><a href="#local-1628001564"><span class="hs-identifier hs-var">demoted_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001564"><span class="hs-identifier hs-var">demoted_name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-749"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnEnv.html#unboundNameX"><span class="hs-identifier hs-var">unboundNameX</span></a><span> </span><a href="RnEnv.html#WL_Any"><span class="hs-identifier hs-var">WL_Any</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001557"><span class="hs-identifier hs-var">suggest_dk</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-752"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#reportUnboundName"><span class="hs-identifier hs-var">reportUnboundName</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-755"></a><span>    </span><a name="local-1628001557"><a href="#local-1628001557"><span class="hs-identifier">suggest_dk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;A data constructor of that name is in scope; did you mean DataKinds?&quot;</span><span>
</span><a name="line-756"></a><span>    </span><a name="local-1628001558"><a href="#local-1628001558"><span class="hs-identifier">untickedPromConstrWarn</span></a></a><span> </span><a name="local-1628001560"><a href="#local-1628001560"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-757"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unticked promoted constructor&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001560"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-758"></a><span>      </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-759"></a><span>      </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use&quot;</span><span>
</span><a name="line-760"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\''</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001560"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-761"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;instead of&quot;</span><span>
</span><a name="line-762"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001560"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span>    </span><a name="local-1628001559"><a href="#local-1628001559"><span class="hs-identifier">star_info</span></a></a><span>
</span><a name="line-765"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RnEnv.html#is_star"><span class="hs-identifier hs-var">is_star</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RnEnv.html#is_uni_star"><span class="hs-identifier hs-var">is_uni_star</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-766"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span> </span><a href="#local-1628001556"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-767"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB: With TypeInType, you must import&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-768"></a><span>             </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001555"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from Data.Kind&quot;</span><span>
</span><a name="line-769"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-772"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-identifier">is_star</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_uni_star</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-775"></a><a name="is_star"><a href="RnEnv.html#is_star"><span class="hs-identifier">is_star</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">occNameFS</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span>
</span><a name="line-776"></a><a name="is_uni_star"><a href="RnEnv.html#is_uni_star"><span class="hs-identifier">is_uni_star</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;&#9733;&quot;</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">occNameFS</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span class="hs-comment">{-
Note [Demotion]
~~~~~~~~~~~~~~~
When the user writes:
  data Nat = Zero | Succ Nat
  foo :: f Zero -&gt; Int

'Zero' in the type signature of 'foo' is parsed as:
  HsTyVar (&quot;Zero&quot;, TcClsName)

When the renamer hits this occurrence of 'Zero' it's going to realise
that it's not in scope. But because it is renaming a type, it knows
that 'Zero' might be a promoted data constructor, so it will demote
its namespace to DataName and do a second lookup.

The final result (after the renamer) will be:
  HsTyVar (&quot;Zero&quot;, DataName)
-}</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span class="hs-comment">--              Use this version to get tracing</span><span>
</span><a name="line-798"></a><span class="hs-comment">--</span><span>
</span><a name="line-799"></a><span class="hs-comment">-- lookupOccRn_maybe, lookupOccRn_maybe' :: RdrName -&gt; RnM (Maybe Name)</span><span>
</span><a name="line-800"></a><span class="hs-comment">-- lookupOccRn_maybe rdr_name</span><span>
</span><a name="line-801"></a><span class="hs-comment">--  = do { mb_res &lt;- lookupOccRn_maybe' rdr_name</span><span>
</span><a name="line-802"></a><span class="hs-comment">--       ; gbl_rdr_env   &lt;- getGlobalRdrEnv</span><span>
</span><a name="line-803"></a><span class="hs-comment">--       ; local_rdr_env &lt;- getLocalRdrEnv</span><span>
</span><a name="line-804"></a><span class="hs-comment">--       ; traceRn $ text &quot;lookupOccRn_maybe&quot; &lt;+&gt;</span><span>
</span><a name="line-805"></a><span class="hs-comment">--           vcat [ ppr rdr_name &lt;+&gt; ppr (getUnique (rdrNameOcc rdr_name))</span><span>
</span><a name="line-806"></a><span class="hs-comment">--                , ppr mb_res</span><span>
</span><a name="line-807"></a><span class="hs-comment">--                , text &quot;Lcl env&quot; &lt;+&gt; ppr local_rdr_env</span><span>
</span><a name="line-808"></a><span class="hs-comment">--                , text &quot;Gbl env&quot; &lt;+&gt; ppr [ (getUnique (nameOccName (gre_name (head gres'))),gres') | gres &lt;- occEnvElts gbl_rdr_env</span><span>
</span><a name="line-809"></a><span class="hs-comment">--                                         , let gres' = filter isLocalGRE gres, not (null gres') ] ]</span><span>
</span><a name="line-810"></a><span class="hs-comment">--       ; return mb_res }</span><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><span class="hs-identifier">lookupOccRn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-813"></a><span class="hs-comment">-- lookupOccRn looks up an occurrence of a RdrName</span><span>
</span><a name="line-814"></a><a name="lookupOccRn_maybe"><a href="RnEnv.html#lookupOccRn_maybe"><span class="hs-identifier">lookupOccRn_maybe</span></a></a><span> </span><a name="local-1628001565"><a href="#local-1628001565"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-815"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001566"><a href="#local-1628001566"><span class="hs-identifier">local_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-816"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-1628001566"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001565"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-817"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001567"><a href="#local-1628001567"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001567"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-818"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-819"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_maybe"><span class="hs-identifier hs-var">lookupGlobalOccRn_maybe</span></a><span> </span><a href="#local-1628001565"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span class="hs-identifier">lookupGlobalOccRn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-822"></a><span class="hs-comment">-- Looks up a RdrName occurrence in the top-level</span><span>
</span><a name="line-823"></a><span class="hs-comment">--   environment, including using lookupQualifiedNameGHCi</span><span>
</span><a name="line-824"></a><span class="hs-comment">--   for the GHCi case</span><span>
</span><a name="line-825"></a><span class="hs-comment">-- No filter function; does not report an error on failure</span><span>
</span><a name="line-826"></a><span class="hs-comment">-- Uses addUsedRdrName to record use and deprecations</span><span>
</span><a name="line-827"></a><a name="lookupGlobalOccRn_maybe"><a href="RnEnv.html#lookupGlobalOccRn_maybe"><span class="hs-identifier">lookupGlobalOccRn_maybe</span></a></a><span> </span><a name="local-1628001568"><a href="#local-1628001568"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-828"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001569"><a href="#local-1628001569"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001568"><span class="hs-identifier hs-var">rdr_name</span></a><span>   </span><span class="hs-comment">-- This happens in derived code</span><span>
</span><a name="line-829"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001570"><a href="#local-1628001570"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupExactOcc"><span class="hs-identifier hs-var">lookupExactOcc</span></a><span> </span><a href="#local-1628001569"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001570"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001571"><a href="#local-1628001571"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001572"><a href="#local-1628001572"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001568"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001573"><a href="#local-1628001573"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><a href="#local-1628001571"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001572"><span class="hs-identifier hs-var">rdr_occ</span></a><span>
</span><a name="line-833"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001573"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-836"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001574"><a href="#local-1628001574"><span class="hs-identifier">mb_gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupGreRn_maybe"><span class="hs-identifier hs-var">lookupGreRn_maybe</span></a><span> </span><a href="#local-1628001568"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-837"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001574"><span class="hs-identifier hs-var">mb_gre</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-838"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001575"><a href="#local-1628001575"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001575"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-839"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-840"></a><span>     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001576"><a href="#local-1628001576"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupQualifiedNameGHCi"><span class="hs-identifier hs-var">lookupQualifiedNameGHCi</span></a><span> </span><a href="#local-1628001568"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-841"></a><span>                      </span><span class="hs-comment">-- This test is not expensive,</span><span>
</span><a name="line-842"></a><span>                      </span><span class="hs-comment">-- and only happens for failed lookups</span><span>
</span><a name="line-843"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001576"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-844"></a><span>           </span><span class="hs-special">(</span><a name="local-1628001577"><a href="#local-1628001577"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001577"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Unlikely to be more than one...?</span><span>
</span><a name="line-845"></a><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span class="hs-identifier">lookupGlobalOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-848"></a><span class="hs-comment">-- lookupGlobalOccRn is like lookupOccRn, except that it looks in the global</span><span>
</span><a name="line-849"></a><span class="hs-comment">-- environment.  Adds an error message if the RdrName is not in scope.</span><span>
</span><a name="line-850"></a><a name="lookupGlobalOccRn"><a href="RnEnv.html#lookupGlobalOccRn"><span class="hs-identifier">lookupGlobalOccRn</span></a></a><span> </span><a name="local-1628001578"><a href="#local-1628001578"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-851"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001579"><a href="#local-1628001579"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_maybe"><span class="hs-identifier hs-var">lookupGlobalOccRn_maybe</span></a><span> </span><a href="#local-1628001578"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-852"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001579"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-853"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001580"><a href="#local-1628001580"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001580"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-854"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupGlobalOccRn&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001578"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#unboundName"><span class="hs-identifier hs-var">unboundName</span></a><span> </span><a href="RnEnv.html#WL_Global"><span class="hs-identifier hs-var">WL_Global</span></a><span> </span><a href="#local-1628001578"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-856"></a><span>
</span><a name="line-857"></a><span class="hs-comment">-- like lookupGlobalOccRn but suggests adding 'type' keyword</span><span>
</span><a name="line-858"></a><span class="hs-comment">-- to export type constructors mistaken for data constructors</span><span>
</span><a name="line-859"></a><span class="hs-identifier">lookupGlobalOccRnExport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-860"></a><a name="lookupGlobalOccRnExport"><a href="RnEnv.html#lookupGlobalOccRnExport"><span class="hs-identifier">lookupGlobalOccRnExport</span></a></a><span> </span><a name="local-1628001581"><a href="#local-1628001581"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-861"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001582"><a href="#local-1628001582"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_maybe"><span class="hs-identifier hs-var">lookupGlobalOccRn_maybe</span></a><span> </span><a href="#local-1628001581"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-862"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001582"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-863"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001583"><a href="#local-1628001583"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001583"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-864"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001584"><a href="#local-1628001584"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-865"></a><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001585"><a href="#local-1628001585"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001581"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>                               </span><a name="local-1628001586"><a href="#local-1628001586"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="OccName.html#lookupOccEnv"><span class="hs-identifier hs-var">lookupOccEnv</span></a><span> </span><a href="#local-1628001584"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628001585"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-867"></a><span>                                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001588"><a href="#local-1628001588"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001587"><span class="hs-identifier hs-var">make_msg</span></a><span> </span><a href="#local-1628001588"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-868"></a><span>                                   </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-869"></a><span>                               </span><a name="local-1628001587"><a href="#local-1628001587"><span class="hs-identifier">make_msg</span></a></a><span> </span><a name="local-1628001589"><a href="#local-1628001589"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span>
</span><a name="line-870"></a><span>                                   </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Note: use&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-871"></a><span>                                       </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-872"></a><span>                                       </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;keyword to export type constructor&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-873"></a><span>                                       </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001589"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-874"></a><span>                                   </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="RdrName.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a><span> </span><a href="#local-1628001589"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">,</span><span>
</span><a name="line-875"></a><span>                                       </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(requires TypeOperators extension)&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-876"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#unboundNameX"><span class="hs-identifier hs-var">unboundNameX</span></a><span> </span><a href="RnEnv.html#WL_Global"><span class="hs-identifier hs-var">WL_Global</span></a><span> </span><a href="#local-1628001581"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001586"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span class="hs-identifier">lookupInfoOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-879"></a><span class="hs-comment">-- lookupInfoOccRn is intended for use in GHCi's &quot;:info&quot; command</span><span>
</span><a name="line-880"></a><span class="hs-comment">-- It finds all the GREs that RdrName could mean, not complaining</span><span>
</span><a name="line-881"></a><span class="hs-comment">-- about ambiguity, but rather returning them all</span><span>
</span><a name="line-882"></a><span class="hs-comment">-- C.f. Trac #9881</span><span>
</span><a name="line-883"></a><a name="lookupInfoOccRn"><a href="RnEnv.html#lookupInfoOccRn"><span class="hs-identifier">lookupInfoOccRn</span></a></a><span> </span><a name="local-1628001590"><a href="#local-1628001590"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-884"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001591"><a href="#local-1628001591"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001590"><span class="hs-identifier hs-var">rdr_name</span></a><span>   </span><span class="hs-comment">-- e.g. (-&gt;)</span><span>
</span><a name="line-885"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628001591"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-886"></a><span>
</span><a name="line-887"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001592"><a href="#local-1628001592"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001593"><a href="#local-1628001593"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001590"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-888"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001594"><a href="#local-1628001594"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><a href="#local-1628001592"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001593"><span class="hs-identifier hs-var">rdr_occ</span></a><span>
</span><a name="line-889"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628001594"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-892"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001595"><a href="#local-1628001595"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-893"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001596"><a href="#local-1628001596"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001590"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001595"><span class="hs-identifier hs-var">rdr_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-894"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001597"><a href="#local-1628001597"><span class="hs-identifier">qual_ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupQualifiedNameGHCi"><span class="hs-identifier hs-var">lookupQualifiedNameGHCi</span></a><span> </span><a href="#local-1628001590"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-895"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001596"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001597"><span class="hs-identifier hs-var">qual_ns</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#minusList"><span class="hs-identifier hs-var">minusList</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001596"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-896"></a><span>
</span><a name="line-897"></a><span class="hs-comment">-- | Like 'lookupOccRn_maybe', but with a more informative result if</span><span>
</span><a name="line-898"></a><span class="hs-comment">-- the 'RdrName' happens to be a record selector:</span><span>
</span><a name="line-899"></a><span class="hs-comment">--</span><span>
</span><a name="line-900"></a><span class="hs-comment">--   * Nothing         -&gt; name not in scope (no error reported)</span><span>
</span><a name="line-901"></a><span class="hs-comment">--   * Just (Left x)   -&gt; name uniquely refers to x,</span><span>
</span><a name="line-902"></a><span class="hs-comment">--                        or there is a name clash (reported)</span><span>
</span><a name="line-903"></a><span class="hs-comment">--   * Just (Right xs) -&gt; name refers to one or more record selectors;</span><span>
</span><a name="line-904"></a><span class="hs-comment">--                        if overload_ok was False, this list will be</span><span>
</span><a name="line-905"></a><span class="hs-comment">--                        a singleton.</span><span>
</span><a name="line-906"></a><span class="hs-identifier">lookupOccRn_overloaded</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">[</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-907"></a><a name="lookupOccRn_overloaded"><a href="RnEnv.html#lookupOccRn_overloaded"><span class="hs-identifier">lookupOccRn_overloaded</span></a></a><span> </span><a name="local-1628001598"><a href="#local-1628001598"><span class="hs-identifier">overload_ok</span></a></a><span> </span><a name="local-1628001599"><a href="#local-1628001599"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-908"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001600"><a href="#local-1628001600"><span class="hs-identifier">local_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-909"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-1628001600"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001599"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-910"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001601"><a href="#local-1628001601"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001601"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-911"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-912"></a><span>       </span><span class="hs-special">{</span><span> </span><a name="local-1628001602"><a href="#local-1628001602"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupGlobalOccRn_overloaded"><span class="hs-identifier hs-var">lookupGlobalOccRn_overloaded</span></a><span> </span><a href="#local-1628001598"><span class="hs-identifier hs-var">overload_ok</span></a><span> </span><a href="#local-1628001599"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-913"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001602"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-914"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001603"><a href="#local-1628001603"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001603"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-915"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-916"></a><span>       </span><span class="hs-special">{</span><span> </span><a name="local-1628001604"><a href="#local-1628001604"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupQualifiedNameGHCi"><span class="hs-identifier hs-var">lookupQualifiedNameGHCi</span></a><span> </span><a href="#local-1628001599"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-917"></a><span>                      </span><span class="hs-comment">-- This test is not expensive,</span><span>
</span><a name="line-918"></a><span>                      </span><span class="hs-comment">-- and only happens for failed lookups</span><span>
</span><a name="line-919"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001604"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-920"></a><span>           </span><span class="hs-special">(</span><a name="local-1628001605"><a href="#local-1628001605"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001605"><span class="hs-identifier hs-var">n</span></a><span>  </span><span class="hs-comment">-- Unlikely to be more than one...?</span><span>
</span><a name="line-921"></a><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-identifier">lookupGlobalOccRn_overloaded</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">[</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-924"></a><a name="lookupGlobalOccRn_overloaded"><a href="RnEnv.html#lookupGlobalOccRn_overloaded"><span class="hs-identifier">lookupGlobalOccRn_overloaded</span></a></a><span> </span><a name="local-1628001606"><a href="#local-1628001606"><span class="hs-identifier">overload_ok</span></a></a><span> </span><a name="local-1628001607"><a href="#local-1628001607"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-925"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001608"><a href="#local-1628001608"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span>   </span><span class="hs-comment">-- This happens in derived code</span><span>
</span><a name="line-926"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001609"><a href="#local-1628001609"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupExactOcc"><span class="hs-identifier hs-var">lookupExactOcc</span></a><span> </span><a href="#local-1628001608"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001609"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-927"></a><span>
</span><a name="line-928"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001610"><a href="#local-1628001610"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001611"><a href="#local-1628001611"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-929"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001612"><a href="#local-1628001612"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><a href="#local-1628001610"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001611"><span class="hs-identifier hs-var">rdr_occ</span></a><span>
</span><a name="line-930"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001612"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-933"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001613"><a href="#local-1628001613"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-934"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001613"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-935"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-936"></a><span>                </span><span class="hs-special">[</span><a name="local-1628001614"><a href="#local-1628001614"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a><span> </span><a href="#local-1628001614"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-937"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001614"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-938"></a><span>                               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><a name="line-939"></a><span>                                   </span><span class="hs-identifier">fld_occ</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-940"></a><span>                                   </span><a name="local-1628001615"><a href="#local-1628001615"><span class="hs-identifier">fld_occ</span></a></a><span>
</span><a name="line-941"></a><span>                                     </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001614"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628001615"><span class="hs-identifier hs-var">fld_occ</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-943"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-944"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001614"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-945"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001614"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-946"></a><span>                </span><a name="local-1628001616"><a href="#local-1628001616"><span class="hs-identifier">gres</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="RdrName.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a><span> </span><a href="#local-1628001616"><span class="hs-identifier hs-var">gres</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-1628001606"><span class="hs-identifier hs-var">overload_ok</span></a><span>
</span><a name="line-947"></a><span>                            </span><span class="hs-comment">-- Don't record usage for ambiguous selectors</span><span>
</span><a name="line-948"></a><span>                            </span><span class="hs-comment">-- until we know which is meant</span><span>
</span><a name="line-949"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span>
</span><a name="line-950"></a><span>                             </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span>
</span><a name="line-951"></a><span>                                     </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">gre_name</span><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>                                           </span><a href="#local-1628001616"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>                </span><a name="local-1628001617"><a href="#local-1628001617"><span class="hs-identifier">gres</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addNameClashErrRn"><span class="hs-identifier hs-var">addNameClashErrRn</span></a><span> </span><a href="#local-1628001607"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001617"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-954"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628001617"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-955"></a><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-958"></a><span class="hs-comment">--      Lookup in the Global RdrEnv of the module</span><span>
</span><a name="line-959"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-960"></a><span>
</span><a name="line-961"></a><span class="hs-identifier">lookupGreRn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span class="hs-comment">-- Look up the RdrName in the GlobalRdrEnv</span><span>
</span><a name="line-963"></a><span class="hs-comment">--   Exactly one binding: records it as &quot;used&quot;, return (Just gre)</span><span>
</span><a name="line-964"></a><span class="hs-comment">--   No bindings:         return Nothing</span><span>
</span><a name="line-965"></a><span class="hs-comment">--   Many bindings:       report &quot;ambiguous&quot;, return an arbitrary (Just gre)</span><span>
</span><a name="line-966"></a><span class="hs-comment">-- (This API is a bit strange; lookupGRERn2_maybe is simpler.</span><span>
</span><a name="line-967"></a><span class="hs-comment">--  But it works and I don't want to fiddle too much.)</span><span>
</span><a name="line-968"></a><span class="hs-comment">-- Uses addUsedRdrName to record use and deprecations</span><span>
</span><a name="line-969"></a><a name="lookupGreRn_maybe"><a href="RnEnv.html#lookupGreRn_maybe"><span class="hs-identifier">lookupGreRn_maybe</span></a></a><span> </span><a name="local-1628001618"><a href="#local-1628001618"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-970"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001619"><a href="#local-1628001619"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-971"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001618"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001619"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-972"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-973"></a><span>            </span><span class="hs-special">[</span><a name="local-1628001620"><a href="#local-1628001620"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001620"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-974"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001620"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-975"></a><span>            </span><a name="local-1628001621"><a href="#local-1628001621"><span class="hs-identifier">gres</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addNameClashErrRn"><span class="hs-identifier hs-var">addNameClashErrRn</span></a><span> </span><a href="#local-1628001618"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001621"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-976"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;name clash&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001618"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001621"><span class="hs-identifier hs-var">gres</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001619"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-977"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628001621"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-identifier">lookupGreRn2_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span class="hs-comment">-- Look up the RdrName in the GlobalRdrEnv</span><span>
</span><a name="line-981"></a><span class="hs-comment">--   Exactly one binding: record it as &quot;used&quot;,   return (Just gre)</span><span>
</span><a name="line-982"></a><span class="hs-comment">--   No bindings:         report &quot;not in scope&quot;, return Nothing</span><span>
</span><a name="line-983"></a><span class="hs-comment">--   Many bindings:       report &quot;ambiguous&quot;,    return Nothing</span><span>
</span><a name="line-984"></a><span class="hs-comment">-- Uses addUsedRdrName to record use and deprecations</span><span>
</span><a name="line-985"></a><a name="lookupGreRn2_maybe"><a href="RnEnv.html#lookupGreRn2_maybe"><span class="hs-identifier">lookupGreRn2_maybe</span></a></a><span> </span><a name="local-1628001622"><a href="#local-1628001622"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-986"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001623"><a href="#local-1628001623"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-987"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001622"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001623"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-988"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#unboundName"><span class="hs-identifier hs-var">unboundName</span></a><span> </span><a href="RnEnv.html#WL_Global"><span class="hs-identifier hs-var">WL_Global</span></a><span> </span><a href="#local-1628001622"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-989"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-990"></a><span>            </span><span class="hs-special">[</span><a name="local-1628001624"><a href="#local-1628001624"><span class="hs-identifier">gre</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001624"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-991"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001624"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-992"></a><span>            </span><a name="local-1628001625"><a href="#local-1628001625"><span class="hs-identifier">gres</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#addNameClashErrRn"><span class="hs-identifier hs-var">addNameClashErrRn</span></a><span> </span><a href="#local-1628001622"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001625"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-993"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;name clash&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001622"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001625"><span class="hs-identifier hs-var">gres</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001623"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-994"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span class="hs-identifier">lookupGreAvailRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a><span class="hs-special">)</span><span>
</span><a name="line-997"></a><span class="hs-comment">-- Used in export lists</span><span>
</span><a name="line-998"></a><span class="hs-comment">-- If not found or ambiguous, add error message, and fake with UnboundName</span><span>
</span><a name="line-999"></a><span class="hs-comment">-- Uses addUsedRdrName to record use and deprecations</span><span>
</span><a name="line-1000"></a><a name="lookupGreAvailRn"><a href="RnEnv.html#lookupGreAvailRn"><span class="hs-identifier">lookupGreAvailRn</span></a></a><span> </span><a name="local-1628001626"><a href="#local-1628001626"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1001"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001627"><a href="#local-1628001627"><span class="hs-identifier">mb_gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupGreRn2_maybe"><span class="hs-identifier hs-var">lookupGreRn2_maybe</span></a><span> </span><a href="#local-1628001626"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1002"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001627"><span class="hs-identifier hs-var">mb_gre</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1003"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001628"><a href="#local-1628001628"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001628"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#availFromGRE"><span class="hs-identifier hs-var">availFromGRE</span></a><span> </span><a href="#local-1628001628"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1004"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1005"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupGreRn&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001626"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1006"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001629"><a href="#local-1628001629"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001626"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1007"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001629"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="Avail.html#avail"><span class="hs-identifier hs-var">avail</span></a><span> </span><a href="#local-1628001629"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-comment">{-
*********************************************************
*                                                      *
                Deprecations
*                                                      *
*********************************************************

Note [Handling of deprecations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* We report deprecations at each *occurrence* of the deprecated thing
  (see Trac #5867)

* We do not report deprecations for locally-defined names. For a
  start, we may be exporting a deprecated thing. Also we may use a
  deprecated thing in the defn of another deprecated things.  We may
  even use a deprecated thing in the defn of a non-deprecated thing,
  when changing a module's interface.

* addUsedGREs: we do not report deprecations for sub-binders:
     - the &quot;..&quot; completion for records
     - the &quot;..&quot; in an export item 'T(..)'
     - the things exported by a module export 'module M'
-}</span><span>
</span><a name="line-1032"></a><span>
</span><a name="line-1033"></a><span class="hs-identifier">addUsedDataCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span class="hs-comment">-- Remember use of in-scope data constructors (Trac #7969)</span><span>
</span><a name="line-1035"></a><a name="addUsedDataCons"><a href="RnEnv.html#addUsedDataCons"><span class="hs-identifier">addUsedDataCons</span></a></a><span> </span><a name="local-1628001630"><a href="#local-1628001630"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-1628001631"><a href="#local-1628001631"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1036"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#addUsedGREs"><span class="hs-identifier hs-var">addUsedGREs</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628001633"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1037"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001632"><a href="#local-1628001632"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-1628001631"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1038"></a><span>                </span><span class="hs-special">,</span><span> </span><a name="local-1628001633"><a href="#local-1628001633"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a><span> </span><a href="#local-1628001630"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a><span> </span><a href="#local-1628001632"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1039"></a><span>
</span><a name="line-1040"></a><span class="hs-identifier">addUsedGRE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1041"></a><span class="hs-comment">-- Called for both local and imported things</span><span>
</span><a name="line-1042"></a><span class="hs-comment">-- Add usage *and* warn if deprecated</span><span>
</span><a name="line-1043"></a><a name="addUsedGRE"><a href="RnEnv.html#addUsedGRE"><span class="hs-identifier">addUsedGRE</span></a></a><span> </span><a name="local-1628001634"><a href="#local-1628001634"><span class="hs-identifier">warn_if_deprec</span></a></a><span> </span><a name="local-1628001635"><a href="#local-1628001635"><span class="hs-identifier">gre</span></a></a><span>
</span><a name="line-1044"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="#local-1628001634"><span class="hs-identifier hs-var">warn_if_deprec</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#warnIfDeprecated"><span class="hs-identifier hs-var">warnIfDeprecated</span></a><span> </span><a href="#local-1628001635"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span>
</span><a name="line-1045"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span> </span><a href="#local-1628001635"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1046"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001636"><a href="#local-1628001636"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-1047"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;addUsedGRE&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001635"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span>
</span><a name="line-1048"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="IOEnv.html#updMutVar"><span class="hs-identifier hs-var">updMutVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_used_gres</span><span> </span><a href="#local-1628001636"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628001635"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1049"></a><span>
</span><a name="line-1050"></a><span class="hs-identifier">addUsedGREs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1051"></a><span class="hs-comment">-- Record uses of any *imported* GREs</span><span>
</span><a name="line-1052"></a><span class="hs-comment">-- Used for recording used sub-bndrs</span><span>
</span><a name="line-1053"></a><span class="hs-comment">-- NB: no call to warnIfDeprecated; see Note [Handling of deprecations]</span><span>
</span><a name="line-1054"></a><a name="addUsedGREs"><a href="RnEnv.html#addUsedGREs"><span class="hs-identifier">addUsedGREs</span></a></a><span> </span><a name="local-1628001637"><a href="#local-1628001637"><span class="hs-identifier">gres</span></a></a><span>
</span><a name="line-1055"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001638"><span class="hs-identifier hs-var">imp_gres</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001639"><a href="#local-1628001639"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-1057"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;addUsedGREs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001638"><span class="hs-identifier hs-var">imp_gres</span></a><span class="hs-special">)</span><span>
</span><a name="line-1058"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="IOEnv.html#updMutVar"><span class="hs-identifier hs-var">updMutVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_used_gres</span><span> </span><a href="#local-1628001639"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1628001638"><span class="hs-identifier hs-var">imp_gres</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1059"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1060"></a><span>    </span><a name="local-1628001638"><a href="#local-1628001638"><span class="hs-identifier">imp_gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span> </span><a href="#local-1628001637"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span class="hs-identifier">warnIfDeprecated</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1063"></a><a name="warnIfDeprecated"><a href="RnEnv.html#warnIfDeprecated"><span class="hs-identifier">warnIfDeprecated</span></a></a><span> </span><a name="local-1628001640"><a href="#local-1628001640"><span class="hs-identifier">gre</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001641"><a href="#local-1628001641"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_imp</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001642"><a href="#local-1628001642"><span class="hs-identifier">iss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001652"><a href="#local-1628001652"><span class="hs-identifier">imp_spec</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001642"><span class="hs-identifier hs-var">iss</span></a><span>
</span><a name="line-1065"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001653"><a href="#local-1628001653"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1066"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001654"><a href="#local-1628001654"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-1067"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a><span> </span><a href="DynFlags.html#Opt_WarnWarningsDeprecations"><span class="hs-identifier hs-var">Opt_WarnWarningsDeprecations</span></a><span> </span><a href="#local-1628001653"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1068"></a><span>               </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a><span> </span><a href="#local-1628001654"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-1628001641"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1069"></a><span>                   </span><span class="hs-comment">-- See Note [Handling of deprecations]</span><span>
</span><a name="line-1070"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001655"><a href="#local-1628001655"><span class="hs-identifier">iface</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LoadIface.html#loadInterfaceForName"><span class="hs-identifier hs-var">loadInterfaceForName</span></a><span> </span><a href="#local-1628001645"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001641"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1071"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RnEnv.html#lookupImpDeprec"><span class="hs-identifier hs-var">lookupImpDeprec</span></a><span> </span><a href="#local-1628001655"><span class="hs-identifier hs-var">iface</span></a><span> </span><a href="#local-1628001640"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1072"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001656"><a href="#local-1628001656"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnWarningsDeprecations"><span class="hs-identifier hs-var">Opt_WarnWarningsDeprecations</span></a><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>                                   </span><span class="hs-special">(</span><a href="#local-1628001646"><span class="hs-identifier hs-var">mk_msg</span></a><span> </span><a href="#local-1628001652"><span class="hs-identifier hs-var">imp_spec</span></a><span> </span><a href="#local-1628001656"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1074"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1075"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1076"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1077"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1078"></a><span>    </span><a name="local-1628001643"><a href="#local-1628001643"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a><span> </span><a href="#local-1628001640"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1079"></a><span>    </span><a name="local-1628001644"><a href="#local-1628001644"><span class="hs-identifier">name_mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isExternalName</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">nameModule</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1080"></a><span>    </span><a name="local-1628001645"><a href="#local-1628001645"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The name&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001643"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;is mentioned explicitly&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span>    </span><a name="local-1628001646"><a href="#local-1628001646"><span class="hs-identifier">mk_msg</span></a></a><span> </span><a name="local-1628001647"><a href="#local-1628001647"><span class="hs-identifier">imp_spec</span></a></a><span> </span><a name="local-1628001648"><a href="#local-1628001648"><span class="hs-identifier">txt</span></a></a><span>
</span><a name="line-1083"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the use of&quot;</span><span>
</span><a name="line-1084"></a><span>                    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier hs-var">pprNonVarNameSpace</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-1628001643"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1085"></a><span>                    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001643"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="#local-1628001650"><span class="hs-identifier hs-var">imp_msg</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1087"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001648"><span class="hs-identifier hs-var">txt</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1088"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1089"></a><span>        </span><a name="local-1628001649"><a href="#local-1628001649"><span class="hs-identifier">imp_mod</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#importSpecModule"><span class="hs-identifier hs-var">importSpecModule</span></a><span> </span><a href="#local-1628001647"><span class="hs-identifier hs-var">imp_spec</span></a><span>
</span><a name="line-1090"></a><span>        </span><a name="local-1628001650"><a href="#local-1628001650"><span class="hs-identifier">imp_msg</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;imported from&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001649"><span class="hs-identifier hs-var">imp_mod</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-1628001651"><span class="hs-identifier hs-var">extra</span></a><span>
</span><a name="line-1091"></a><span>        </span><a name="local-1628001651"><a href="#local-1628001651"><span class="hs-identifier">extra</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001649"><span class="hs-identifier hs-var">imp_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1628001644"><span class="hs-identifier hs-var">name_mod</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1092"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;, but defined in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001644"><span class="hs-identifier hs-var">name_mod</span></a><span>
</span><a name="line-1093"></a><span>
</span><a name="line-1094"></a><span class="hs-identifier">lookupImpDeprec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="BasicTypes.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a><span>
</span><a name="line-1095"></a><a name="lookupImpDeprec"><a href="RnEnv.html#lookupImpDeprec"><span class="hs-identifier">lookupImpDeprec</span></a></a><span> </span><a name="local-1628001657"><a href="#local-1628001657"><span class="hs-identifier">iface</span></a></a><span> </span><a name="local-1628001658"><a href="#local-1628001658"><span class="hs-identifier">gre</span></a></a><span>
</span><a name="line-1096"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mi_warn_fn</span><span> </span><a href="#local-1628001657"><span class="hs-identifier hs-var">iface</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a><span> </span><a href="#local-1628001658"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mplus"><span class="hs-identifier hs-var">mplus</span></a><span class="hs-special">`</span><span>  </span><span class="hs-comment">-- Bleat if the thing,</span><span>
</span><a name="line-1097"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">gre_par</span><span> </span><a href="#local-1628001658"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-keyword">of</span><span>                      </span><span class="hs-comment">-- or its parent, is warn'd</span><span>
</span><a name="line-1098"></a><span>       </span><a href="RdrName.html#ParentIs"><span class="hs-identifier hs-var">ParentIs</span></a><span>  </span><a name="local-1628001659"><a href="#local-1628001659"><span class="hs-identifier">p</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mi_warn_fn</span><span> </span><a href="#local-1628001657"><span class="hs-identifier hs-var">iface</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001659"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1099"></a><span>       </span><a href="RdrName.html#FldParent"><span class="hs-identifier hs-var">FldParent</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">par_is</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001660"><a href="#local-1628001660"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mi_warn_fn</span><span> </span><a href="#local-1628001657"><span class="hs-identifier hs-var">iface</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001660"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>       </span><a href="RdrName.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1101"></a><span>       </span><a href="RdrName.html#PatternSynonym"><span class="hs-identifier hs-var">PatternSynonym</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1102"></a><span>
</span><a name="line-1103"></a><span class="hs-comment">{-
Note [Used names with interface not loaded]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's (just) possible to find a used
Name whose interface hasn't been loaded:

a) It might be a WiredInName; in that case we may not load
   its interface (although we could).

b) It might be GHC.Real.fromRational, or GHC.Num.fromInteger
   These are seen as &quot;used&quot; by the renamer (if -XRebindableSyntax)
   is on), but the typechecker may discard their uses
   if in fact the in-scope fromRational is GHC.Read.fromRational,
   (see tcPat.tcOverloadedLit), and the typechecker sees that the type
   is fixed, say, to GHC.Base.Float (see Inst.lookupSimpleInst).
   In that obscure case it won't force the interface in.

In both cases we simply don't permit deprecations;
this is, after all, wired-in stuff.


*********************************************************
*                                                      *
                GHCi support
*                                                      *
*********************************************************

A qualified name on the command line can refer to any module at
all: we try to load the interface if we don't already have it, just
as if there was an &quot;import qualified M&quot; declaration for every
module.

If we fail we just return Nothing, rather than bleating
about &quot;attempting to use module &#8216;D&#8217; (./D.hs) which is not loaded&quot;
which is what loadSrcInterface does.

Note [Safe Haskell and GHCi]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We DONT do this Safe Haskell as we need to check imports. We can
and should instead check the qualified import but at the moment
this requires some refactoring so leave as a TODO
-}</span><span>
</span><a name="line-1145"></a><span>
</span><a name="line-1146"></a><span class="hs-identifier">lookupQualifiedNameGHCi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1147"></a><a name="lookupQualifiedNameGHCi"><a href="RnEnv.html#lookupQualifiedNameGHCi"><span class="hs-identifier">lookupQualifiedNameGHCi</span></a></a><span> </span><a name="local-1628001661"><a href="#local-1628001661"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1148"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- We want to behave as we would for a source file import here,</span><span>
</span><a name="line-1149"></a><span>    </span><span class="hs-comment">-- and respect hiddenness of modules/packages, hence loadSrcInterface.</span><span>
</span><a name="line-1150"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001672"><a href="#local-1628001672"><span class="hs-identifier">dflags</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1151"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001673"><a href="#local-1628001673"><span class="hs-identifier">is_ghci</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getIsGHCi"><span class="hs-identifier hs-var">getIsGHCi</span></a><span>
</span><a name="line-1152"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-1628001662"><span class="hs-identifier hs-var">go_for_it</span></a><span> </span><a href="#local-1628001672"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001673"><span class="hs-identifier hs-var">is_ghci</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1153"></a><span>
</span><a name="line-1154"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1155"></a><span>    </span><a name="local-1628001662"><a href="#local-1628001662"><span class="hs-identifier">go_for_it</span></a></a><span> </span><a name="local-1628001664"><a href="#local-1628001664"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628001665"><a href="#local-1628001665"><span class="hs-identifier">is_ghci</span></a></a><span>
</span><a name="line-1156"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001666"><a href="#local-1628001666"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><a name="local-1628001667"><a href="#local-1628001667"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isQual_maybe"><span class="hs-identifier hs-var">isQual_maybe</span></a><span> </span><a href="#local-1628001661"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1157"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1628001665"><span class="hs-identifier hs-var">is_ghci</span></a><span>
</span><a name="line-1158"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_ImplicitImportQualified"><span class="hs-identifier hs-var">Opt_ImplicitImportQualified</span></a><span> </span><a href="#local-1628001664"><span class="hs-identifier hs-var">dflags</span></a><span>   </span><span class="hs-comment">-- Enables this GHCi behaviour</span><span>
</span><a name="line-1159"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#safeDirectImpsReq"><span class="hs-identifier hs-var">safeDirectImpsReq</span></a><span> </span><a href="#local-1628001664"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- See Note [Safe Haskell and GHCi]</span><span>
</span><a name="line-1160"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001668"><a href="#local-1628001668"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LoadIface.html#loadSrcInterface_maybe"><span class="hs-identifier hs-var">loadSrcInterface_maybe</span></a><span> </span><a href="#local-1628001663"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001666"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1161"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001668"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1162"></a><span>                </span><a href="Maybes.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a><span> </span><a name="local-1628001669"><a href="#local-1628001669"><span class="hs-identifier">iface</span></a></a><span>
</span><a name="line-1163"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628001671"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1164"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001670"><a href="#local-1628001670"><span class="hs-identifier">avail</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mi_exports</span><span> </span><a href="#local-1628001669"><span class="hs-identifier hs-var">iface</span></a><span>
</span><a name="line-1165"></a><span>                            </span><span class="hs-special">,</span><span> </span><a name="local-1628001671"><a href="#local-1628001671"><span class="hs-identifier">name</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Avail.html#availNames"><span class="hs-identifier hs-var">availNames</span></a><span> </span><a href="#local-1628001670"><span class="hs-identifier hs-var">avail</span></a><span>
</span><a name="line-1166"></a><span>                            </span><span class="hs-special">,</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001671"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001667"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Either we couldn't load the interface, or</span><span>
</span><a name="line-1169"></a><span>                     </span><span class="hs-comment">-- we could but we didn't find the name in it</span><span>
</span><a name="line-1170"></a><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupQualifiedNameGHCi&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001661"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1171"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1172"></a><span>
</span><a name="line-1173"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1174"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupQualifedNameGHCi: off&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001661"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1175"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1176"></a><span>
</span><a name="line-1177"></a><span>    </span><a name="local-1628001663"><a href="#local-1628001663"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Need to find&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001661"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span class="hs-comment">{-
Note [Looking up signature names]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lookupSigOccRn is used for type signatures and pragmas
Is this valid?
  module A
        import M( f )
        f :: Int -&gt; Int
        f x = x
It's clear that the 'f' in the signature must refer to A.f
The Haskell98 report does not stipulate this, but it will!
So we must treat the 'f' in the signature in the same way
as the binding occurrence of 'f', using lookupBndrRn

However, consider this case:
        import M( f )
        f :: Int -&gt; Int
        g x = x
We don't want to say 'f' is out of scope; instead, we want to
return the imported 'f', so that later on the reanamer will
correctly report &quot;misplaced type sig&quot;.

Note [Signatures for top level things]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data HsSigCtxt = ... | TopSigCtxt NameSet | ....

* The NameSet says what is bound in this group of bindings.
  We can't use isLocalGRE from the GlobalRdrEnv, because of this:
       f x = x
       $( ...some TH splice... )
       f :: Int -&gt; Int
  When we encounter the signature for 'f', the binding for 'f'
  will be in the GlobalRdrEnv, and will be a LocalDef. Yet the
  signature is mis-placed

* For type signatures the NameSet should be the names bound by the
  value bindings; for fixity declarations, the NameSet should also
  include class sigs and record selectors

      infix 3 `f`          -- Yes, ok
      f :: C a =&gt; a -&gt; a   -- No, not ok
      class C a where
        f :: a -&gt; a
-}</span><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span class="hs-keyword">data</span><span> </span><a name="HsSigCtxt"><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier">HsSigCtxt</span></a></a><span>
</span><a name="line-1225"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TopSigCtxt"><a href="RnEnv.html#TopSigCtxt"><span class="hs-identifier">TopSigCtxt</span></a></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>       </span><span class="hs-comment">-- At top level, binding these names</span><span>
</span><a name="line-1226"></a><span>                             </span><span class="hs-comment">-- See Note [Signatures for top level things]</span><span>
</span><a name="line-1227"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LocalBindCtxt"><a href="RnEnv.html#LocalBindCtxt"><span class="hs-identifier">LocalBindCtxt</span></a></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>    </span><span class="hs-comment">-- In a local binding, binding these names</span><span>
</span><a name="line-1228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClsDeclCtxt"><a href="RnEnv.html#ClsDeclCtxt"><span class="hs-identifier">ClsDeclCtxt</span></a></a><span>   </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>       </span><span class="hs-comment">-- Class decl for this class</span><span>
</span><a name="line-1229"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InstDeclCtxt"><a href="RnEnv.html#InstDeclCtxt"><span class="hs-identifier">InstDeclCtxt</span></a></a><span>  </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>    </span><span class="hs-comment">-- Instance decl whose user-written method</span><span>
</span><a name="line-1230"></a><span>                             </span><span class="hs-comment">-- bindings are for these methods</span><span>
</span><a name="line-1231"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HsBootCtxt"><a href="RnEnv.html#HsBootCtxt"><span class="hs-identifier">HsBootCtxt</span></a></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>       </span><span class="hs-comment">-- Top level of a hs-boot file, binding these names</span><span>
</span><a name="line-1232"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RoleAnnotCtxt"><a href="RnEnv.html#RoleAnnotCtxt"><span class="hs-identifier">RoleAnnotCtxt</span></a></a><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>    </span><span class="hs-comment">-- A role annotation, with the names of all types</span><span>
</span><a name="line-1233"></a><span>                             </span><span class="hs-comment">-- in the group</span><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-identifier">lookupSigOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier hs-type">HsSigCtxt</span></a><span>
</span><a name="line-1236"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#Sig"><span class="hs-identifier hs-type">Sig</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1237"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1238"></a><a name="lookupSigOccRn"><a href="RnEnv.html#lookupSigOccRn"><span class="hs-identifier">lookupSigOccRn</span></a></a><span> </span><a name="local-1628001674"><a href="#local-1628001674"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628001675"><a href="#local-1628001675"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupSigCtxtOccRn"><span class="hs-identifier hs-var">lookupSigCtxtOccRn</span></a><span> </span><a href="#local-1628001674"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#hsSigDoc"><span class="hs-identifier hs-var">hsSigDoc</span></a><span> </span><a href="#local-1628001675"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-1239"></a><span>
</span><a name="line-1240"></a><span class="hs-comment">-- | Lookup a name in relation to the names in a 'HsSigCtxt'</span><span>
</span><a name="line-1241"></a><span class="hs-identifier">lookupSigCtxtOccRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier hs-type">HsSigCtxt</span></a><span>
</span><a name="line-1242"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>         </span><span class="hs-comment">-- ^ description of thing we're looking up,</span><span>
</span><a name="line-1243"></a><span>                                   </span><span class="hs-comment">-- like &quot;type family&quot;</span><span>
</span><a name="line-1244"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1245"></a><a name="lookupSigCtxtOccRn"><a href="RnEnv.html#lookupSigCtxtOccRn"><span class="hs-identifier">lookupSigCtxtOccRn</span></a></a><span> </span><a name="local-1628001676"><a href="#local-1628001676"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628001677"><a href="#local-1628001677"><span class="hs-identifier">what</span></a></a><span>
</span><a name="line-1246"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628001678"><a href="#local-1628001678"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1247"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001679"><a href="#local-1628001679"><span class="hs-identifier">mb_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupBindGroupOcc"><span class="hs-identifier hs-var">lookupBindGroupOcc</span></a><span> </span><a href="#local-1628001676"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628001677"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="#local-1628001678"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1248"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001679"><span class="hs-identifier hs-var">mb_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1249"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628001680"><a href="#local-1628001680"><span class="hs-identifier">err</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-1628001680"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001678"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1250"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628001681"><a href="#local-1628001681"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001681"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1251"></a><span>
</span><a name="line-1252"></a><span class="hs-identifier">lookupBindGroupOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier hs-type">HsSigCtxt</span></a><span>
</span><a name="line-1253"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1254"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="ErrUtils.html#MsgDoc"><span class="hs-identifier hs-type">MsgDoc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1255"></a><span class="hs-comment">-- Looks up the RdrName, expecting it to resolve to one of the</span><span>
</span><a name="line-1256"></a><span class="hs-comment">-- bound names passed in.  If not, return an appropriate error message</span><span>
</span><a name="line-1257"></a><span class="hs-comment">--</span><span>
</span><a name="line-1258"></a><span class="hs-comment">-- See Note [Looking up signature names]</span><span>
</span><a name="line-1259"></a><a name="lookupBindGroupOcc"><a href="RnEnv.html#lookupBindGroupOcc"><span class="hs-identifier">lookupBindGroupOcc</span></a></a><span> </span><a name="local-1628001682"><a href="#local-1628001682"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628001683"><a href="#local-1628001683"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628001684"><a href="#local-1628001684"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1260"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001700"><a href="#local-1628001700"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupExactOcc_either"><span class="hs-identifier hs-var">lookupExactOcc_either</span></a><span> </span><a href="#local-1628001700"><span class="hs-identifier hs-var">n</span></a><span>   </span><span class="hs-comment">-- allow for the possibility of missing Exacts;</span><span>
</span><a name="line-1262"></a><span>                              </span><span class="hs-comment">-- see Note [dataTcOccs and Exact Names]</span><span>
</span><a name="line-1263"></a><span>      </span><span class="hs-comment">-- Maybe we should check the side conditions</span><span>
</span><a name="line-1264"></a><span>      </span><span class="hs-comment">-- but it's a pain, and Exact things only show</span><span>
</span><a name="line-1265"></a><span>      </span><span class="hs-comment">-- up when you know what you are doing</span><span>
</span><a name="line-1266"></a><span>
</span><a name="line-1267"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001701"><a href="#local-1628001701"><span class="hs-identifier">rdr_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001702"><a href="#local-1628001702"><span class="hs-identifier">rdr_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isOrig_maybe"><span class="hs-identifier hs-var">isOrig_maybe</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1268"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001703"><a href="#local-1628001703"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><a href="#local-1628001701"><span class="hs-identifier hs-var">rdr_mod</span></a><span> </span><a href="#local-1628001702"><span class="hs-identifier hs-var">rdr_occ</span></a><span>
</span><a name="line-1269"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001703"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1270"></a><span>
</span><a name="line-1271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1272"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001682"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1273"></a><span>      </span><a href="RnEnv.html#HsBootCtxt"><span class="hs-identifier hs-var">HsBootCtxt</span></a><span> </span><a name="local-1628001704"><a href="#local-1628001704"><span class="hs-identifier">ns</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001686"><span class="hs-identifier hs-var">lookup_top</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001704"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1274"></a><span>      </span><a href="RnEnv.html#TopSigCtxt"><span class="hs-identifier hs-var">TopSigCtxt</span></a><span> </span><a name="local-1628001705"><a href="#local-1628001705"><span class="hs-identifier">ns</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001686"><span class="hs-identifier hs-var">lookup_top</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001705"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1275"></a><span>      </span><a href="RnEnv.html#RoleAnnotCtxt"><span class="hs-identifier hs-var">RoleAnnotCtxt</span></a><span> </span><a name="local-1628001706"><a href="#local-1628001706"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001686"><span class="hs-identifier hs-var">lookup_top</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001706"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1276"></a><span>      </span><a href="RnEnv.html#LocalBindCtxt"><span class="hs-identifier hs-var">LocalBindCtxt</span></a><span> </span><a name="local-1628001707"><a href="#local-1628001707"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001687"><span class="hs-identifier hs-var">lookup_group</span></a><span> </span><a href="#local-1628001707"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-1277"></a><span>      </span><a href="RnEnv.html#ClsDeclCtxt"><span class="hs-identifier hs-var">ClsDeclCtxt</span></a><span>  </span><a name="local-1628001708"><a href="#local-1628001708"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001685"><span class="hs-identifier hs-var">lookup_cls_op</span></a><span> </span><a href="#local-1628001708"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-1278"></a><span>      </span><a href="RnEnv.html#InstDeclCtxt"><span class="hs-identifier hs-var">InstDeclCtxt</span></a><span> </span><a name="local-1628001709"><a href="#local-1628001709"><span class="hs-identifier">ns</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001686"><span class="hs-identifier hs-var">lookup_top</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001709"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1279"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1280"></a><span>    </span><a name="local-1628001685"><a href="#local-1628001685"><span class="hs-identifier">lookup_cls_op</span></a></a><span> </span><a name="local-1628001690"><a href="#local-1628001690"><span class="hs-identifier">cls</span></a></a><span>
</span><a name="line-1281"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupSubBndrOcc"><span class="hs-identifier hs-var">lookupSubBndrOcc</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-1628001690"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-1628001691"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1282"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1283"></a><span>        </span><a name="local-1628001691"><a href="#local-1628001691"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;method of class&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001690"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>
</span><a name="line-1285"></a><span>    </span><a name="local-1628001686"><a href="#local-1628001686"><span class="hs-identifier">lookup_top</span></a></a><span> </span><a name="local-1628001692"><a href="#local-1628001692"><span class="hs-identifier">keep_me</span></a></a><span>
</span><a name="line-1286"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001693"><a href="#local-1628001693"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-1287"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001694"><a href="#local-1628001694"><span class="hs-identifier">all_gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><a href="#local-1628001693"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1288"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001692"><span class="hs-identifier hs-var">keep_me</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">gre_name</span><span class="hs-special">)</span><span> </span><a href="#local-1628001694"><span class="hs-identifier hs-var">all_gres</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1289"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001694"><span class="hs-identifier hs-var">all_gres</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001688"><span class="hs-identifier hs-var">bale_out_with</span></a><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1290"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001688"><span class="hs-identifier hs-var">bale_out_with</span></a><span> </span><a href="#local-1628001689"><span class="hs-identifier hs-var">local_msg</span></a><span>
</span><a name="line-1291"></a><span>               </span><span class="hs-special">(</span><a name="local-1628001695"><a href="#local-1628001695"><span class="hs-identifier">gre</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001695"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span>    </span><a name="local-1628001687"><a href="#local-1628001687"><span class="hs-identifier">lookup_group</span></a></a><span> </span><a name="local-1628001696"><a href="#local-1628001696"><span class="hs-identifier">bound_names</span></a></a><span>  </span><span class="hs-comment">-- Look in the local envt (not top level)</span><span>
</span><a name="line-1294"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001697"><a href="#local-1628001697"><span class="hs-identifier">local_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-1295"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-1628001697"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1296"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001698"><a href="#local-1628001698"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1297"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001698"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001696"><span class="hs-identifier hs-var">bound_names</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001698"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001688"><span class="hs-identifier hs-var">bale_out_with</span></a><span> </span><a href="#local-1628001689"><span class="hs-identifier hs-var">local_msg</span></a><span>
</span><a name="line-1299"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001688"><span class="hs-identifier hs-var">bale_out_with</span></a><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1300"></a><span>
</span><a name="line-1301"></a><span>    </span><a name="local-1628001688"><a href="#local-1628001688"><span class="hs-identifier">bale_out_with</span></a></a><span> </span><a name="local-1628001699"><a href="#local-1628001699"><span class="hs-identifier">msg</span></a></a><span>
</span><a name="line-1302"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628001683"><span class="hs-identifier hs-var">what</span></a><span>
</span><a name="line-1303"></a><span>                                </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1304"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lacks an accompanying binding&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1305"></a><span>                       </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-1628001699"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>
</span><a name="line-1307"></a><span>    </span><a name="local-1628001689"><a href="#local-1628001689"><span class="hs-identifier">local_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628001683"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;must be given where&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1308"></a><span>                           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001684"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is declared&quot;</span><span>
</span><a name="line-1309"></a><span>
</span><a name="line-1310"></a><span>
</span><a name="line-1311"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1312"></a><span class="hs-identifier">lookupLocalTcNames</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsSigCtxt"><span class="hs-identifier hs-type">HsSigCtxt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1313"></a><span class="hs-comment">-- GHC extension: look up both the tycon and data con or variable.</span><span>
</span><a name="line-1314"></a><span class="hs-comment">-- Used for top-level fixity signatures and deprecations.</span><span>
</span><a name="line-1315"></a><span class="hs-comment">-- Complain if neither is in scope.</span><span>
</span><a name="line-1316"></a><span class="hs-comment">-- See Note [Fixity signature lookup]</span><span>
</span><a name="line-1317"></a><a name="lookupLocalTcNames"><a href="RnEnv.html#lookupLocalTcNames"><span class="hs-identifier">lookupLocalTcNames</span></a></a><span> </span><a name="local-1628001710"><a href="#local-1628001710"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628001711"><a href="#local-1628001711"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628001712"><a href="#local-1628001712"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1318"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001716"><a href="#local-1628001716"><span class="hs-identifier">mb_gres</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628001713"><span class="hs-identifier hs-var">lookup</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#dataTcOccs"><span class="hs-identifier hs-var">dataTcOccs</span></a><span> </span><a href="#local-1628001712"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628001717"><a href="#local-1628001717"><span class="hs-identifier">errs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001718"><a href="#local-1628001718"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#splitEithers"><span class="hs-identifier hs-var">splitEithers</span></a><span> </span><a href="#local-1628001716"><span class="hs-identifier hs-var">mb_gres</span></a><span>
</span><a name="line-1320"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001718"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628001717"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Bleat about one only</span><span>
</span><a name="line-1321"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001718"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1322"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1323"></a><span>    </span><a name="local-1628001713"><a href="#local-1628001713"><span class="hs-identifier">lookup</span></a></a><span> </span><a name="local-1628001714"><a href="#local-1628001714"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001715"><a href="#local-1628001715"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupBindGroupOcc"><span class="hs-identifier hs-var">lookupBindGroupOcc</span></a><span> </span><a href="#local-1628001710"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-1628001711"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="#local-1628001714"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1324"></a><span>                    </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-1628001714"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001715"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span class="hs-identifier">dataTcOccs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1327"></a><span class="hs-comment">-- Return both the given name and the same name promoted to the TcClsName</span><span>
</span><a name="line-1328"></a><span class="hs-comment">-- namespace.  This is useful when we aren't sure which we are looking at.</span><span>
</span><a name="line-1329"></a><span class="hs-comment">-- See also Note [dataTcOccs and Exact Names]</span><span>
</span><a name="line-1330"></a><a name="dataTcOccs"><a href="RnEnv.html#dataTcOccs"><span class="hs-identifier">dataTcOccs</span></a></a><span> </span><a name="local-1628001719"><a href="#local-1628001719"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1331"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><a href="#local-1628001720"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="OccName.html#isVarOcc"><span class="hs-identifier hs-var">isVarOcc</span></a><span> </span><a href="#local-1628001720"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628001719"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001721"><span class="hs-identifier hs-var">rdr_name_tc</span></a><span class="hs-special">]</span><span>
</span><a name="line-1333"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1334"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628001719"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1335"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1336"></a><span>    </span><a name="local-1628001720"><a href="#local-1628001720"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001719"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1337"></a><span>    </span><a name="local-1628001721"><a href="#local-1628001721"><span class="hs-identifier">rdr_name_tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a><span> </span><a href="#local-1628001719"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="OccName.html#tcName"><span class="hs-identifier hs-var">tcName</span></a><span>
</span><a name="line-1338"></a><span>
</span><a name="line-1339"></a><span class="hs-comment">{-
Note [dataTcOccs and Exact Names]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Exact RdrNames can occur in code generated by Template Haskell, and generally
those references are, well, exact. However, the TH `Name` type isn't expressive
enough to always track the correct namespace information, so we sometimes get
the right Unique but wrong namespace. Thus, we still have to do the double-lookup
for Exact RdrNames.

There is also an awkward situation for built-in syntax. Example in GHCi
   :info []
This parses as the Exact RdrName for nilDataCon, but we also want
the list type constructor.

Note that setRdrNameSpace on an Exact name requires the Name to be External,
which it always is for built in syntax.

*********************************************************
*                                                      *
                Fixities
*                                                      *
*********************************************************

Note [Fixity signature lookup]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A fixity declaration like

    infixr 2 ?

can refer to a value-level operator, e.g.:

    (?) :: String -&gt; String -&gt; String

or a type-level operator, like:

    data (?) a b = A a | B b

so we extend the lookup of the reader name '?' to the TcClsName namespace, as
well as the original namespace.

The extended lookup is also used in other places, like resolution of
deprecation declarations, and lookup of names in GHCi.
-}</span><span>
</span><a name="line-1382"></a><span>
</span><a name="line-1383"></a><span class="hs-comment">--------------------------------</span><span>
</span><a name="line-1384"></a><span class="hs-keyword">type</span><span> </span><a name="MiniFixityEnv"><a href="RnEnv.html#MiniFixityEnv"><span class="hs-identifier">MiniFixityEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#FastStringEnv"><span class="hs-identifier hs-type">FastStringEnv</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1385"></a><span>        </span><span class="hs-comment">-- Mini fixity env for the names we're about</span><span>
</span><a name="line-1386"></a><span>        </span><span class="hs-comment">-- to bind, in a single binding group</span><span>
</span><a name="line-1387"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1388"></a><span>        </span><span class="hs-comment">-- It is keyed by the *FastString*, not the *OccName*, because</span><span>
</span><a name="line-1389"></a><span>        </span><span class="hs-comment">-- the single fixity decl       infix 3 T</span><span>
</span><a name="line-1390"></a><span>        </span><span class="hs-comment">-- affects both the data constructor T and the type constrctor T</span><span>
</span><a name="line-1391"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1392"></a><span>        </span><span class="hs-comment">-- We keep the location so that if we find</span><span>
</span><a name="line-1393"></a><span>        </span><span class="hs-comment">-- a duplicate, we can report it sensibly</span><span>
</span><a name="line-1394"></a><span>
</span><a name="line-1395"></a><span class="hs-comment">--------------------------------</span><span>
</span><a name="line-1396"></a><span class="hs-comment">-- Used for nested fixity decls to bind names along with their fixities.</span><span>
</span><a name="line-1397"></a><span class="hs-comment">-- the fixities are given as a UFM from an OccName's FastString to a fixity decl</span><span>
</span><a name="line-1398"></a><span>
</span><a name="line-1399"></a><span class="hs-identifier">addLocalFixities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001442"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001442"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1400"></a><a name="addLocalFixities"><a href="RnEnv.html#addLocalFixities"><span class="hs-identifier">addLocalFixities</span></a></a><span> </span><a name="local-1628001722"><a href="#local-1628001722"><span class="hs-identifier">mini_fix_env</span></a></a><span> </span><a name="local-1628001723"><a href="#local-1628001723"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-1628001724"><a href="#local-1628001724"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1401"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#extendFixityEnv"><span class="hs-identifier hs-var">extendFixityEnv</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><a href="#local-1628001725"><span class="hs-identifier hs-var">find_fixity</span></a><span> </span><a href="#local-1628001723"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001724"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-1402"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1403"></a><span>    </span><a name="local-1628001725"><a href="#local-1628001725"><span class="hs-identifier">find_fixity</span></a></a><span> </span><a name="local-1628001726"><a href="#local-1628001726"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-1404"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="FastStringEnv.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a><span> </span><a href="#local-1628001722"><span class="hs-identifier hs-var">mini_fix_env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-1628001727"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1405"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628001728"><a href="#local-1628001728"><span class="hs-identifier">fix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001726"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="HscTypes.html#FixItem"><span class="hs-identifier hs-var">FixItem</span></a><span> </span><a href="#local-1628001727"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1628001728"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1406"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1407"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1408"></a><span>        </span><a name="local-1628001727"><a href="#local-1628001727"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001726"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1409"></a><span>
</span><a name="line-1410"></a><span class="hs-comment">{-
--------------------------------
lookupFixity is a bit strange.

* Nested local fixity decls are put in the local fixity env, which we
  find with getFixtyEnv

* Imported fixities are found in the HIT or PIT

* Top-level fixity decls in this module may be for Names that are
    either  Global         (constructors, class operations)
    or      Local/Exported (everything else)
  (See notes with RnNames.getLocalDeclBinders for why we have this split.)
  We put them all in the local fixity environment
-}</span><span>
</span><a name="line-1425"></a><span>
</span><a name="line-1426"></a><span class="hs-identifier">lookupFixityRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1427"></a><a name="lookupFixityRn"><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier">lookupFixityRn</span></a></a><span> </span><a name="local-1628001729"><a href="#local-1628001729"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn%27"><span class="hs-identifier hs-var">lookupFixityRn'</span></a><span> </span><a href="#local-1628001729"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001729"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1428"></a><span>
</span><a name="line-1429"></a><span class="hs-identifier">lookupFixityRn'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1430"></a><a name="lookupFixityRn%27"><a href="RnEnv.html#lookupFixityRn%27"><span class="hs-identifier">lookupFixityRn'</span></a></a><span> </span><a name="local-1628001730"><a href="#local-1628001730"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RnEnv.html#lookupFixityRn_help%27"><span class="hs-identifier hs-var">lookupFixityRn_help'</span></a><span> </span><a href="#local-1628001730"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1431"></a><span>
</span><a name="line-1432"></a><span class="hs-comment">-- | 'lookupFixityRn_help' returns @(True, fixity)@ if it finds a 'Fixity'</span><span>
</span><a name="line-1433"></a><span class="hs-comment">-- in a local environment or from an interface file. Otherwise, it returns</span><span>
</span><a name="line-1434"></a><span class="hs-comment">-- @(False, fixity)@ (e.g., for unbound 'Name's or 'Name's without</span><span>
</span><a name="line-1435"></a><span class="hs-comment">-- user-supplied fixity declarations).</span><span>
</span><a name="line-1436"></a><span class="hs-identifier">lookupFixityRn_help</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1437"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1438"></a><a name="lookupFixityRn_help"><a href="RnEnv.html#lookupFixityRn_help"><span class="hs-identifier">lookupFixityRn_help</span></a></a><span> </span><a name="local-1628001731"><a href="#local-1628001731"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1439"></a><span>    </span><a href="RnEnv.html#lookupFixityRn_help%27"><span class="hs-identifier hs-var">lookupFixityRn_help'</span></a><span> </span><a href="#local-1628001731"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001731"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span>
</span><a name="line-1441"></a><span class="hs-identifier">lookupFixityRn_help'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1442"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-1443"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><a name="lookupFixityRn_help%27"><a href="RnEnv.html#lookupFixityRn_help%27"><span class="hs-identifier">lookupFixityRn_help'</span></a></a><span> </span><a name="local-1628001732"><a href="#local-1628001732"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628001733"><a href="#local-1628001733"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-1445"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PrelNames.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1446"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="BasicTypes.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>    </span><span class="hs-comment">-- Minimise errors from ubound names; eg</span><span>
</span><a name="line-1448"></a><span>    </span><span class="hs-comment">--    a&gt;0 `foo` b&gt;0</span><span>
</span><a name="line-1449"></a><span>    </span><span class="hs-comment">-- where 'foo' is not in scope, should not give an error (Trac #7937)</span><span>
</span><a name="line-1450"></a><span>
</span><a name="line-1451"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1452"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001741"><a href="#local-1628001741"><span class="hs-identifier">local_fix_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getFixityEnv"><span class="hs-identifier hs-var">getFixityEnv</span></a><span>
</span><a name="line-1453"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><a href="#local-1628001741"><span class="hs-identifier hs-var">local_fix_env</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1454"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HscTypes.html#FixItem"><span class="hs-identifier hs-var">FixItem</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628001742"><a href="#local-1628001742"><span class="hs-identifier">fix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="#local-1628001742"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1455"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1456"></a><span>
</span><a name="line-1457"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001743"><a href="#local-1628001743"><span class="hs-identifier">this_mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a><span>
</span><a name="line-1458"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a><span> </span><a href="#local-1628001743"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1459"></a><span>               </span><span class="hs-comment">-- Local (and interactive) names are all in the</span><span>
</span><a name="line-1460"></a><span>               </span><span class="hs-comment">-- fixity env, and don't have entries in the HPT</span><span>
</span><a name="line-1461"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#defaultFixity"><span class="hs-identifier hs-var">defaultFixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1462"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="#local-1628001734"><span class="hs-identifier hs-var">lookup_imported</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1463"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1464"></a><span>    </span><a name="local-1628001734"><a href="#local-1628001734"><span class="hs-identifier">lookup_imported</span></a></a><span>
</span><a name="line-1465"></a><span>      </span><span class="hs-comment">-- For imported names, we have to get their fixities by doing a</span><span>
</span><a name="line-1466"></a><span>      </span><span class="hs-comment">-- loadInterfaceForName, and consulting the Ifaces that comes back</span><span>
</span><a name="line-1467"></a><span>      </span><span class="hs-comment">-- from that, because the interface file for the Name might not</span><span>
</span><a name="line-1468"></a><span>      </span><span class="hs-comment">-- have been loaded yet.  Why not?  Suppose you import module A,</span><span>
</span><a name="line-1469"></a><span>      </span><span class="hs-comment">-- which exports a function 'f', thus;</span><span>
</span><a name="line-1470"></a><span>      </span><span class="hs-comment">--        module CurrentModule where</span><span>
</span><a name="line-1471"></a><span>      </span><span class="hs-comment">--          import A( f )</span><span>
</span><a name="line-1472"></a><span>      </span><span class="hs-comment">--        module A( f ) where</span><span>
</span><a name="line-1473"></a><span>      </span><span class="hs-comment">--          import B( f )</span><span>
</span><a name="line-1474"></a><span>      </span><span class="hs-comment">-- Then B isn't loaded right away (after all, it's possible that</span><span>
</span><a name="line-1475"></a><span>      </span><span class="hs-comment">-- nothing from B will be used).  When we come across a use of</span><span>
</span><a name="line-1476"></a><span>      </span><span class="hs-comment">-- 'f', we need to know its fixity, and it's then, and only</span><span>
</span><a name="line-1477"></a><span>      </span><span class="hs-comment">-- then, that we load B.hi.  That is what's happening here.</span><span>
</span><a name="line-1478"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-1479"></a><span>      </span><span class="hs-comment">-- loadInterfaceForName will find B.hi even if B is a hidden module,</span><span>
</span><a name="line-1480"></a><span>      </span><span class="hs-comment">-- and that's what we want.</span><span>
</span><a name="line-1481"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001736"><a href="#local-1628001736"><span class="hs-identifier">iface</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LoadIface.html#loadInterfaceForName"><span class="hs-identifier hs-var">loadInterfaceForName</span></a><span> </span><a href="#local-1628001735"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1482"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001737"><a href="#local-1628001737"><span class="hs-identifier">mb_fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mi_fix_fn</span><span> </span><a href="#local-1628001736"><span class="hs-identifier hs-var">iface</span></a><span> </span><a href="#local-1628001733"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1483"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001738"><a href="#local-1628001738"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001737"><span class="hs-identifier hs-var">mb_fix</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1484"></a><span>                            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1485"></a><span>                                  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;looking up name&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1486"></a><span>                              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in iface, but found no fixity for it.&quot;</span><span>
</span><a name="line-1487"></a><span>                              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Using default fixity instead.&quot;</span><span>
</span><a name="line-1488"></a><span>                            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001739"><a href="#local-1628001739"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1489"></a><span>                                  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;looking up name in iface and found:&quot;</span><span>
</span><a name="line-1490"></a><span>                              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001739"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-1491"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lookupFixityRn_either:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628001738"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1492"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#defaultFixity"><span class="hs-identifier hs-var">defaultFixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628001740"><a href="#local-1628001740"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="#local-1628001740"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628001737"><span class="hs-identifier hs-var">mb_fix</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-1493"></a><span>
</span><a name="line-1494"></a><span>    </span><a name="local-1628001735"><a href="#local-1628001735"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Checking fixity for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1495"></a><span>
</span><a name="line-1496"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1497"></a><span class="hs-identifier">lookupTyFixityRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1498"></a><a name="lookupTyFixityRn"><a href="RnEnv.html#lookupTyFixityRn"><span class="hs-identifier">lookupTyFixityRn</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628001744"><a href="#local-1628001744"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="#local-1628001744"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1499"></a><span>
</span><a name="line-1500"></a><span class="hs-comment">-- | Look up the fixity of a (possibly ambiguous) occurrence of a record field</span><span>
</span><a name="line-1501"></a><span class="hs-comment">-- selector.  We use 'lookupFixityRn'' so that we can specifiy the 'OccName' as</span><span>
</span><a name="line-1502"></a><span class="hs-comment">-- the field label, which might be different to the 'OccName' of the selector</span><span>
</span><a name="line-1503"></a><span class="hs-comment">-- 'Name' if @DuplicateRecordFields@ is in use (Trac #1173). If there are</span><span>
</span><a name="line-1504"></a><span class="hs-comment">-- multiple possible selectors with different fixities, generate an error.</span><span>
</span><a name="line-1505"></a><span class="hs-identifier">lookupFieldFixityRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#AmbiguousFieldOcc"><span class="hs-identifier hs-type">AmbiguousFieldOcc</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1506"></a><a name="lookupFieldFixityRn"><a href="RnEnv.html#lookupFieldFixityRn"><span class="hs-identifier">lookupFieldFixityRn</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#Unambiguous"><span class="hs-identifier hs-var">Unambiguous</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628001745"><a href="#local-1628001745"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628001746"><a href="#local-1628001746"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1507"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn%27"><span class="hs-identifier hs-var">lookupFixityRn'</span></a><span> </span><a href="#local-1628001746"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001745"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1508"></a><span class="hs-identifier">lookupFieldFixityRn</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#Ambiguous"><span class="hs-identifier hs-var">Ambiguous</span></a><span>   </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628001747"><a href="#local-1628001747"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001748"><span class="hs-identifier hs-var">get_ambiguous_fixity</span></a><span> </span><a href="#local-1628001747"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1509"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1510"></a><span>    </span><span class="hs-identifier">get_ambiguous_fixity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1511"></a><span>    </span><a name="local-1628001748"><a href="#local-1628001748"><span class="hs-identifier">get_ambiguous_fixity</span></a></a><span> </span><a name="local-1628001752"><a href="#local-1628001752"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1512"></a><span>      </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;get_ambiguous_fixity&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001752"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1513"></a><span>      </span><a name="local-1628001753"><a href="#local-1628001753"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-1514"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001754"><a href="#local-1628001754"><span class="hs-identifier">elts</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><a href="#local-1628001752"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001753"><span class="hs-identifier hs-var">rdr_env</span></a><span>
</span><a name="line-1515"></a><span>
</span><a name="line-1516"></a><span>      </span><a name="local-1628001755"><a href="#local-1628001755"><span class="hs-identifier">fixities</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-1628001754"><span class="hs-identifier hs-var">elts</span></a><span>
</span><a name="line-1517"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628001749"><span class="hs-identifier hs-var">lookup_gre_fixity</span></a><span> </span><a href="#local-1628001754"><span class="hs-identifier hs-var">elts</span></a><span>
</span><a name="line-1518"></a><span>
</span><a name="line-1519"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001755"><span class="hs-identifier hs-var">fixities</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1520"></a><span>        </span><span class="hs-comment">-- There should always be at least one fixity.</span><span>
</span><a name="line-1521"></a><span>        </span><span class="hs-comment">-- Something's very wrong if there are no fixity candidates, so panic</span><span>
</span><a name="line-1522"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;get_ambiguous_fixity: no candidates for a given RdrName&quot;</span><span>
</span><a name="line-1523"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628001756"><a href="#local-1628001756"><span class="hs-identifier">fix</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001756"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-1524"></a><span>        </span><a name="local-1628001757"><a href="#local-1628001757"><span class="hs-identifier">ambigs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001750"><span class="hs-identifier hs-var">ambiguous_fixity_err</span></a><span> </span><a href="#local-1628001752"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="#local-1628001757"><span class="hs-identifier hs-var">ambigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1525"></a><span>                  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="BasicTypes.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#minPrecedence"><span class="hs-identifier hs-var">minPrecedence</span></a><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span class="hs-special">)</span><span>
</span><a name="line-1526"></a><span>
</span><a name="line-1527"></a><span>    </span><a name="local-1628001749"><a href="#local-1628001749"><span class="hs-identifier">lookup_gre_fixity</span></a></a><span> </span><a name="local-1628001758"><a href="#local-1628001758"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#lookupFixityRn%27"><span class="hs-identifier hs-var">lookupFixityRn'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001758"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a><span> </span><a href="#local-1628001758"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span>
</span><a name="line-1528"></a><span>
</span><a name="line-1529"></a><span>    </span><a name="local-1628001750"><a href="#local-1628001750"><span class="hs-identifier">ambiguous_fixity_err</span></a></a><span> </span><a name="local-1628001759"><a href="#local-1628001759"><span class="hs-identifier">rn</span></a></a><span> </span><a name="local-1628001760"><a href="#local-1628001760"><span class="hs-identifier">ambigs</span></a></a><span>
</span><a name="line-1530"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Ambiguous fixity for record field&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001759"><span class="hs-identifier hs-var">rn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1531"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Conflicts: &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1532"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628001751"><span class="hs-identifier hs-var">format_ambig</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="#local-1628001760"><span class="hs-identifier hs-var">ambigs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1533"></a><span>
</span><a name="line-1534"></a><span>    </span><a name="local-1628001751"><a href="#local-1628001751"><span class="hs-identifier">format_ambig</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628001761"><a href="#local-1628001761"><span class="hs-identifier">elt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001762"><a href="#local-1628001762"><span class="hs-identifier">fix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001762"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1535"></a><span>                                 </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a><span> </span><a href="#local-1628001761"><span class="hs-identifier hs-var">elt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1536"></a><span>
</span><a name="line-1537"></a><span>
</span><a name="line-1538"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                        Rebindable names
        Dealing with rebindable syntax is driven by the
        Opt_RebindableSyntax dynamic flag.

        In &quot;deriving&quot; code we don't want to use rebindable syntax
        so we switch off the flag locally

*                                                                      *
************************************************************************

Haskell 98 says that when you say &quot;3&quot; you get the &quot;fromInteger&quot; from the
Standard Prelude, regardless of what is in scope.   However, to experiment
with having a language that is less coupled to the standard prelude, we're
trying a non-standard extension that instead gives you whatever &quot;Prelude.fromInteger&quot;
happens to be in scope.  Then you can
        import Prelude ()
        import MyPrelude as Prelude
to get the desired effect.

At the moment this just happens for
  * fromInteger, fromRational on literals (in expressions and patterns)
  * negate (in expressions)
  * minus  (arising from n+k patterns)
  * &quot;do&quot; notation

We store the relevant Name in the HsSyn tree, in
  * HsIntegral/HsFractional/HsIsString
  * NegApp
  * NPlusKPat
  * HsDo
respectively.  Initially, we just store the &quot;standard&quot; name (PrelNames.fromIntegralName,
fromRationalName etc), but the renamer changes this to the appropriate user
name if Opt_NoImplicitPrelude is on.  That is what lookupSyntaxName does.

We treat the orignal (standard) names as free-vars too, because the type checker
checks the type of the user thing against the type of the standard thing.
-}</span><span>
</span><a name="line-1578"></a><span>
</span><a name="line-1579"></a><span class="hs-identifier">lookupIfThenElse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1580"></a><span class="hs-comment">-- Different to lookupSyntaxName because in the non-rebindable</span><span>
</span><a name="line-1581"></a><span class="hs-comment">-- case we desugar directly rather than calling an existing function</span><span>
</span><a name="line-1582"></a><span class="hs-comment">-- Hence the (Maybe (SyntaxExpr Name)) return type</span><span>
</span><a name="line-1583"></a><a name="lookupIfThenElse"><a href="RnEnv.html#lookupIfThenElse"><span class="hs-identifier">lookupIfThenElse</span></a></a><span>
</span><a name="line-1584"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001763"><a href="#local-1628001763"><span class="hs-identifier">rebindable_on</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">RebindableSyntax</span></a><span>
</span><a name="line-1585"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628001763"><span class="hs-identifier hs-var">rebindable_on</span></a><span>
</span><a name="line-1586"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1587"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001764"><a href="#local-1628001764"><span class="hs-identifier">ite</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;ifThenElse&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1588"></a><span>                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#mkRnSyntaxExpr"><span class="hs-identifier hs-var">mkRnSyntaxExpr</span></a><span> </span><a href="#local-1628001764"><span class="hs-identifier hs-var">ite</span></a><span class="hs-special">)</span><span>
</span><a name="line-1589"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-1628001764"><span class="hs-identifier hs-var">ite</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1590"></a><span>
</span><a name="line-1591"></a><span class="hs-identifier">lookupSyntaxName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>                                </span><span class="hs-comment">-- The standard name</span><span>
</span><a name="line-1592"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Possibly a non-standard name</span><span>
</span><a name="line-1593"></a><a name="lookupSyntaxName"><a href="RnEnv.html#lookupSyntaxName"><span class="hs-identifier">lookupSyntaxName</span></a></a><span> </span><a name="local-1628001765"><a href="#local-1628001765"><span class="hs-identifier">std_name</span></a></a><span>
</span><a name="line-1594"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001766"><a href="#local-1628001766"><span class="hs-identifier">rebindable_on</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">RebindableSyntax</span></a><span>
</span><a name="line-1595"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628001766"><span class="hs-identifier hs-var">rebindable_on</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-1596"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#mkRnSyntaxExpr"><span class="hs-identifier hs-var">mkRnSyntaxExpr</span></a><span> </span><a href="#local-1628001765"><span class="hs-identifier hs-var">std_name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1597"></a><span>         </span><span class="hs-keyword">else</span><span>
</span><a name="line-1598"></a><span>            </span><span class="hs-comment">-- Get the similarly named thing from the local environment</span><span>
</span><a name="line-1599"></a><span>           </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001767"><a href="#local-1628001767"><span class="hs-identifier">usr_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001765"><span class="hs-identifier hs-var">std_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1600"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#mkRnSyntaxExpr"><span class="hs-identifier hs-var">mkRnSyntaxExpr</span></a><span> </span><a href="#local-1628001767"><span class="hs-identifier hs-var">usr_name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-1628001767"><span class="hs-identifier hs-var">usr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1601"></a><span>
</span><a name="line-1602"></a><span class="hs-identifier">lookupSyntaxNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>                          </span><span class="hs-comment">-- Standard names</span><span>
</span><a name="line-1603"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- See comments with HsExpr.ReboundNames</span><span>
</span><a name="line-1604"></a><span>   </span><span class="hs-comment">-- this works with CmdTop, which wants HsExprs, not SyntaxExprs</span><span>
</span><a name="line-1605"></a><a name="lookupSyntaxNames"><a href="RnEnv.html#lookupSyntaxNames"><span class="hs-identifier">lookupSyntaxNames</span></a></a><span> </span><a name="local-1628001768"><a href="#local-1628001768"><span class="hs-identifier">std_names</span></a></a><span>
</span><a name="line-1606"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001769"><a href="#local-1628001769"><span class="hs-identifier">rebindable_on</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#RebindableSyntax"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">RebindableSyntax</span></a><span>
</span><a name="line-1607"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628001769"><span class="hs-identifier hs-var">rebindable_on</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-1608"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001768"><span class="hs-identifier hs-var">std_names</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1609"></a><span>        </span><span class="hs-keyword">else</span><span>
</span><a name="line-1610"></a><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001770"><a href="#local-1628001770"><span class="hs-identifier">usr_names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001768"><span class="hs-identifier hs-var">std_names</span></a><span>
</span><a name="line-1611"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001770"><span class="hs-identifier hs-var">usr_names</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#mkFVs"><span class="hs-identifier hs-var">mkFVs</span></a><span> </span><a href="#local-1628001770"><span class="hs-identifier hs-var">usr_names</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1612"></a><span>
</span><a name="line-1613"></a><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Binding}
*                                                      *
*********************************************************
-}</span><span>
</span><a name="line-1620"></a><span>
</span><a name="line-1621"></a><span class="hs-identifier">newLocalBndrRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1622"></a><span class="hs-comment">-- Used for non-top-level binders.  These should</span><span>
</span><a name="line-1623"></a><span class="hs-comment">-- never be qualified.</span><span>
</span><a name="line-1624"></a><a name="newLocalBndrRn"><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier">newLocalBndrRn</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628001771"><a href="#local-1628001771"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628001772"><a href="#local-1628001772"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1625"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001773"><a href="#local-1628001773"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#isExact_maybe"><span class="hs-identifier hs-var">isExact_maybe</span></a><span> </span><a href="#local-1628001772"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1626"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628001773"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-comment">-- This happens in code generated by Template Haskell</span><span>
</span><a name="line-1627"></a><span>                </span><span class="hs-comment">-- See Note [Binders in Template Haskell] in Convert.hs</span><span>
</span><a name="line-1628"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1629"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#isUnqual"><span class="hs-identifier hs-var">isUnqual</span></a><span> </span><a href="#local-1628001772"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1630"></a><span>                </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-1628001771"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#badQualBndrErr"><span class="hs-identifier hs-var">badQualBndrErr</span></a><span> </span><a href="#local-1628001772"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001774"><a href="#local-1628001774"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-1632"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1628001774"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001772"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001771"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1633"></a><span>
</span><a name="line-1634"></a><span class="hs-identifier">newLocalBndrsRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1635"></a><a name="newLocalBndrsRn"><a href="RnEnv.html#newLocalBndrsRn"><span class="hs-identifier">newLocalBndrsRn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="RnEnv.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span>
</span><a name="line-1636"></a><span>
</span><a name="line-1637"></a><span class="hs-comment">---------------------</span><span>
</span><a name="line-1638"></a><span class="hs-identifier">bindLocatedLocalsRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1639"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001441"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001441"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1641"></a><a name="bindLocatedLocalsRn"><a href="RnEnv.html#bindLocatedLocalsRn"><span class="hs-identifier">bindLocatedLocalsRn</span></a></a><span> </span><a name="local-1628001775"><a href="#local-1628001775"><span class="hs-identifier">rdr_names_w_loc</span></a></a><span> </span><a name="local-1628001776"><a href="#local-1628001776"><span class="hs-identifier">enclosed_scope</span></a></a><span>
</span><a name="line-1642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#checkDupRdrNames"><span class="hs-identifier hs-var">checkDupRdrNames</span></a><span> </span><a href="#local-1628001775"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a><span>
</span><a name="line-1643"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a><span> </span><a href="#local-1628001775"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a><span>
</span><a name="line-1644"></a><span>
</span><a name="line-1645"></a><span>        </span><span class="hs-comment">-- Make fresh Names and extend the environment</span><span>
</span><a name="line-1646"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628001777"><a href="#local-1628001777"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#newLocalBndrsRn"><span class="hs-identifier hs-var">newLocalBndrsRn</span></a><span> </span><a href="#local-1628001775"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a><span>
</span><a name="line-1647"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#bindLocalNames"><span class="hs-identifier hs-var">bindLocalNames</span></a><span> </span><a href="#local-1628001777"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001776"><span class="hs-identifier hs-var">enclosed_scope</span></a><span> </span><a href="#local-1628001777"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span class="hs-identifier">bindLocalNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001440"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001440"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1650"></a><a name="bindLocalNames"><a href="RnEnv.html#bindLocalNames"><span class="hs-identifier">bindLocalNames</span></a></a><span> </span><a name="local-1628001778"><a href="#local-1628001778"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-1628001779"><a href="#local-1628001779"><span class="hs-identifier">enclosed_scope</span></a></a><span>
</span><a name="line-1651"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001780"><a href="#local-1628001780"><span class="hs-identifier">lcl_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-1652"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001781"><a href="#local-1628001781"><span class="hs-identifier">th_level</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_th_ctxt</span><span> </span><a href="#local-1628001780"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-1653"></a><span>             </span><a name="local-1628001782"><a href="#local-1628001782"><span class="hs-identifier">th_bndrs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#extendNameEnvList"><span class="hs-identifier hs-var">extendNameEnvList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_th_bndrs</span><span> </span><a href="#local-1628001780"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-1654"></a><span>                           </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-1628001784"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001781"><span class="hs-identifier hs-var">th_level</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001784"><a href="#local-1628001784"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001778"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1655"></a><span>             </span><a name="local-1628001783"><a href="#local-1628001783"><span class="hs-identifier">rdr_env'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#extendLocalRdrEnvList"><span class="hs-identifier hs-var">extendLocalRdrEnvList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcl_rdr</span><span> </span><a href="#local-1628001780"><span class="hs-identifier hs-var">lcl_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001778"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1656"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001780"><span class="hs-identifier hs-var">lcl_env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcl_th_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001782"><span class="hs-identifier hs-var">th_bndrs'</span></a><span>
</span><a name="line-1657"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcl_rdr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001783"><span class="hs-identifier hs-var">rdr_env'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1658"></a><span>                    </span><a href="#local-1628001779"><span class="hs-identifier hs-var">enclosed_scope</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1659"></a><span>
</span><a name="line-1660"></a><span class="hs-identifier">bindLocalNamesFV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001439"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001439"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1661"></a><a name="bindLocalNamesFV"><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier">bindLocalNamesFV</span></a></a><span> </span><a name="local-1628001785"><a href="#local-1628001785"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-1628001786"><a href="#local-1628001786"><span class="hs-identifier">enclosed_scope</span></a></a><span>
</span><a name="line-1662"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628001787"><a href="#local-1628001787"><span class="hs-identifier">result</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001788"><a href="#local-1628001788"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#bindLocalNames"><span class="hs-identifier hs-var">bindLocalNames</span></a><span> </span><a href="#local-1628001785"><span class="hs-identifier hs-var">names</span></a><span> </span><a href="#local-1628001786"><span class="hs-identifier hs-var">enclosed_scope</span></a><span>
</span><a name="line-1663"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001787"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#delFVs"><span class="hs-identifier hs-var">delFVs</span></a><span> </span><a href="#local-1628001785"><span class="hs-identifier hs-var">names</span></a><span> </span><a href="#local-1628001788"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1664"></a><span>
</span><a name="line-1665"></a><span>
</span><a name="line-1666"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1667"></a><span>        </span><span class="hs-comment">-- binLocalsFVRn is the same as bindLocalsRn</span><span>
</span><a name="line-1668"></a><span>        </span><span class="hs-comment">-- except that it deals with free vars</span><span>
</span><a name="line-1669"></a><span class="hs-identifier">bindLocatedLocalsFV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1670"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1671"></a><a name="bindLocatedLocalsFV"><a href="RnEnv.html#bindLocatedLocalsFV"><span class="hs-identifier">bindLocatedLocalsFV</span></a></a><span> </span><a name="local-1628001789"><a href="#local-1628001789"><span class="hs-identifier">rdr_names</span></a></a><span> </span><a name="local-1628001790"><a href="#local-1628001790"><span class="hs-identifier">enclosed_scope</span></a></a><span>
</span><a name="line-1672"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#bindLocatedLocalsRn"><span class="hs-identifier hs-var">bindLocatedLocalsRn</span></a><span> </span><a href="#local-1628001789"><span class="hs-identifier hs-var">rdr_names</span></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628001791"><a href="#local-1628001791"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1673"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628001792"><a href="#local-1628001792"><span class="hs-identifier">thing</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001793"><a href="#local-1628001793"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001790"><span class="hs-identifier hs-var">enclosed_scope</span></a><span> </span><a href="#local-1628001791"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1674"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001792"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#delFVs"><span class="hs-identifier hs-var">delFVs</span></a><span> </span><a href="#local-1628001791"><span class="hs-identifier hs-var">names</span></a><span> </span><a href="#local-1628001793"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1675"></a><span>
</span><a name="line-1676"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1677"></a><span>
</span><a name="line-1678"></a><span class="hs-identifier">extendTyVarEnvFVRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001437"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001437"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1679"></a><span>        </span><span class="hs-comment">-- This function is used only in rnSourceDecl on InstDecl</span><span>
</span><a name="line-1680"></a><a name="extendTyVarEnvFVRn"><a href="RnEnv.html#extendTyVarEnvFVRn"><span class="hs-identifier">extendTyVarEnvFVRn</span></a></a><span> </span><a name="local-1628001794"><a href="#local-1628001794"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-1628001795"><a href="#local-1628001795"><span class="hs-identifier">thing_inside</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-1628001794"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="#local-1628001795"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-1681"></a><span>
</span><a name="line-1682"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1683"></a><span class="hs-identifier">checkDupRdrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1684"></a><span class="hs-comment">-- Check for duplicated names in a binding group</span><span>
</span><a name="line-1685"></a><a name="checkDupRdrNames"><a href="RnEnv.html#checkDupRdrNames"><span class="hs-identifier">checkDupRdrNames</span></a></a><span> </span><a name="local-1628001796"><a href="#local-1628001796"><span class="hs-identifier">rdr_names_w_loc</span></a></a><span>
</span><a name="line-1686"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#dupNamesErr"><span class="hs-identifier hs-var">dupNamesErr</span></a><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001797"><span class="hs-identifier hs-var">dups</span></a><span>
</span><a name="line-1687"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1688"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628001797"><a href="#local-1628001797"><span class="hs-identifier">dups</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628001798"><a href="#local-1628001798"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-1628001799"><a href="#local-1628001799"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628001798"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628001799"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001796"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a><span>
</span><a name="line-1689"></a><span>
</span><a name="line-1690"></a><span class="hs-identifier">checkDupNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1691"></a><span class="hs-comment">-- Check for duplicated names in a binding group</span><span>
</span><a name="line-1692"></a><a name="checkDupNames"><a href="RnEnv.html#checkDupNames"><span class="hs-identifier">checkDupNames</span></a></a><span> </span><a name="local-1628001800"><a href="#local-1628001800"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#check_dup_names"><span class="hs-identifier hs-var">check_dup_names</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="Name.html#isSystemName"><span class="hs-identifier hs-var">isSystemName</span></a><span> </span><a href="#local-1628001800"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1693"></a><span>                </span><span class="hs-comment">-- See Note [Binders in Template Haskell] in Convert</span><span>
</span><a name="line-1694"></a><span>
</span><a name="line-1695"></a><span class="hs-identifier">check_dup_names</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1696"></a><a name="check_dup_names"><a href="RnEnv.html#check_dup_names"><span class="hs-identifier">check_dup_names</span></a></a><span> </span><a name="local-1628001801"><a href="#local-1628001801"><span class="hs-identifier">names</span></a></a><span>
</span><a name="line-1697"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#dupNamesErr"><span class="hs-identifier hs-var">dupNamesErr</span></a><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001802"><span class="hs-identifier hs-var">dups</span></a><span>
</span><a name="line-1698"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1699"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628001802"><a href="#local-1628001802"><span class="hs-identifier">dups</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628001803"><a href="#local-1628001803"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-1628001804"><a href="#local-1628001804"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001803"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001804"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001801"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1700"></a><span>
</span><a name="line-1701"></a><span class="hs-comment">---------------------</span><span>
</span><a name="line-1702"></a><span class="hs-identifier">checkShadowedRdrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1703"></a><a name="checkShadowedRdrNames"><a href="RnEnv.html#checkShadowedRdrNames"><span class="hs-identifier">checkShadowedRdrNames</span></a></a><span> </span><a name="local-1628001805"><a href="#local-1628001805"><span class="hs-identifier">loc_rdr_names</span></a></a><span>
</span><a name="line-1704"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001810"><a href="#local-1628001810"><span class="hs-identifier">envs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getRdrEnvs"><span class="hs-identifier hs-var">getRdrEnvs</span></a><span>
</span><a name="line-1705"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#checkShadowedOccs"><span class="hs-identifier hs-var">checkShadowedOccs</span></a><span> </span><a href="#local-1628001810"><span class="hs-identifier hs-var">envs</span></a><span> </span><a href="#local-1628001807"><span class="hs-identifier hs-var">get_loc_occ</span></a><span> </span><a href="#local-1628001806"><span class="hs-identifier hs-var">filtered_rdrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1706"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1707"></a><span>    </span><a name="local-1628001806"><a href="#local-1628001806"><span class="hs-identifier">filtered_rdrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#isExact"><span class="hs-identifier hs-var">isExact</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001805"><span class="hs-identifier hs-var">loc_rdr_names</span></a><span>
</span><a name="line-1708"></a><span>                </span><span class="hs-comment">-- See Note [Binders in Template Haskell] in Convert</span><span>
</span><a name="line-1709"></a><span>    </span><a name="local-1628001807"><a href="#local-1628001807"><span class="hs-identifier">get_loc_occ</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628001808"><a href="#local-1628001808"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628001809"><a href="#local-1628001809"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628001808"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001809"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1710"></a><span>
</span><a name="line-1711"></a><span class="hs-identifier">checkDupAndShadowedNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1712"></a><a name="checkDupAndShadowedNames"><a href="RnEnv.html#checkDupAndShadowedNames"><span class="hs-identifier">checkDupAndShadowedNames</span></a></a><span> </span><a name="local-1628001811"><a href="#local-1628001811"><span class="hs-identifier">envs</span></a></a><span> </span><a name="local-1628001812"><a href="#local-1628001812"><span class="hs-identifier">names</span></a></a><span>
</span><a name="line-1713"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#check_dup_names"><span class="hs-identifier hs-var">check_dup_names</span></a><span> </span><a href="#local-1628001813"><span class="hs-identifier hs-var">filtered_names</span></a><span>
</span><a name="line-1714"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnEnv.html#checkShadowedOccs"><span class="hs-identifier hs-var">checkShadowedOccs</span></a><span> </span><a href="#local-1628001811"><span class="hs-identifier hs-var">envs</span></a><span> </span><a href="#local-1628001814"><span class="hs-identifier hs-var">get_loc_occ</span></a><span> </span><a href="#local-1628001813"><span class="hs-identifier hs-var">filtered_names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1715"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1716"></a><span>    </span><a name="local-1628001813"><a href="#local-1628001813"><span class="hs-identifier">filtered_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="Name.html#isSystemName"><span class="hs-identifier hs-var">isSystemName</span></a><span> </span><a href="#local-1628001812"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1717"></a><span>                </span><span class="hs-comment">-- See Note [Binders in Template Haskell] in Convert</span><span>
</span><a name="line-1718"></a><span>    </span><a name="local-1628001814"><a href="#local-1628001814"><span class="hs-identifier">get_loc_occ</span></a></a><span> </span><a name="local-1628001815"><a href="#local-1628001815"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628001815"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001815"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1719"></a><span>
</span><a name="line-1720"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1721"></a><span class="hs-identifier">checkShadowedOccs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1722"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628001436"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1723"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628001436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1724"></a><a name="checkShadowedOccs"><a href="RnEnv.html#checkShadowedOccs"><span class="hs-identifier">checkShadowedOccs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628001816"><a href="#local-1628001816"><span class="hs-identifier">global_env</span></a></a><span class="hs-special">,</span><a name="local-1628001817"><a href="#local-1628001817"><span class="hs-identifier">local_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628001818"><a href="#local-1628001818"><span class="hs-identifier">get_loc_occ</span></a></a><span> </span><a name="local-1628001819"><a href="#local-1628001819"><span class="hs-identifier">ns</span></a></a><span>
</span><a name="line-1725"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnNameShadowing"><span class="hs-identifier hs-var">Opt_WarnNameShadowing</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1726"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;shadow&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628001818"><span class="hs-identifier hs-var">get_loc_occ</span></a><span> </span><a href="#local-1628001819"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1727"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628001820"><span class="hs-identifier hs-var">check_shadow</span></a><span> </span><a href="#local-1628001819"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1728"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1729"></a><span>    </span><a name="local-1628001820"><a href="#local-1628001820"><span class="hs-identifier">check_shadow</span></a></a><span> </span><a name="local-1628001822"><a href="#local-1628001822"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1730"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span> </span><a href="#local-1628001824"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Do not report shadowing for &quot;_x&quot;</span><span>
</span><a name="line-1731"></a><span>                                                </span><span class="hs-comment">-- See Trac #3262</span><span>
</span><a name="line-1732"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001829"><a href="#local-1628001829"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001825"><span class="hs-identifier hs-var">mb_local</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001827"><span class="hs-identifier hs-var">complain</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bound at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span> </span><a href="#local-1628001829"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1733"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001830"><a href="#local-1628001830"><span class="hs-identifier">gres'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#filterM"><span class="hs-identifier hs-var">filterM</span></a><span> </span><a href="#local-1628001821"><span class="hs-identifier hs-var">is_shadowed_gre</span></a><span> </span><a href="#local-1628001826"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-1734"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="#local-1628001827"><span class="hs-identifier hs-var">complain</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="RdrName.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a><span> </span><a href="#local-1628001830"><span class="hs-identifier hs-var">gres'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1735"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1736"></a><span>          </span><span class="hs-special">(</span><a name="local-1628001823"><a href="#local-1628001823"><span class="hs-identifier">loc</span></a></a><span class="hs-special">,</span><a name="local-1628001824"><a href="#local-1628001824"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001818"><span class="hs-identifier hs-var">get_loc_occ</span></a><span> </span><a href="#local-1628001822"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1737"></a><span>          </span><a name="local-1628001825"><a href="#local-1628001825"><span class="hs-identifier">mb_local</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#lookupLocalRdrOcc"><span class="hs-identifier hs-var">lookupLocalRdrOcc</span></a><span> </span><a href="#local-1628001817"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001824"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1738"></a><span>          </span><a name="local-1628001826"><a href="#local-1628001826"><span class="hs-identifier">gres</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><a href="#local-1628001824"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001816"><span class="hs-identifier hs-var">global_env</span></a><span>
</span><a name="line-1739"></a><span>                </span><span class="hs-comment">-- Make an Unqualified RdrName and look that up, so that</span><span>
</span><a name="line-1740"></a><span>                </span><span class="hs-comment">-- we don't find any GREs that are in scope qualified-only</span><span>
</span><a name="line-1741"></a><span>
</span><a name="line-1742"></a><span>          </span><a name="local-1628001827"><a href="#local-1628001827"><span class="hs-identifier">complain</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1743"></a><span>          </span><span class="hs-identifier">complain</span><span> </span><a name="local-1628001828"><a href="#local-1628001828"><span class="hs-identifier">pp_locs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnNameShadowing"><span class="hs-identifier hs-var">Opt_WarnNameShadowing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1744"></a><span>                                       </span><a href="#local-1628001823"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1745"></a><span>                                       </span><span class="hs-special">(</span><a href="RnEnv.html#shadowedNameWarn"><span class="hs-identifier hs-var">shadowedNameWarn</span></a><span> </span><a href="#local-1628001824"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1628001828"><span class="hs-identifier hs-var">pp_locs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1746"></a><span>
</span><a name="line-1747"></a><span>    </span><span class="hs-identifier">is_shadowed_gre</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1748"></a><span>        </span><span class="hs-comment">-- Returns False for record selectors that are shadowed, when</span><span>
</span><a name="line-1749"></a><span>        </span><span class="hs-comment">-- punning or wild-cards are on (cf Trac #2723)</span><span>
</span><a name="line-1750"></a><span>    </span><a name="local-1628001821"><a href="#local-1628001821"><span class="hs-identifier">is_shadowed_gre</span></a></a><span> </span><a name="local-1628001831"><a href="#local-1628001831"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a><span> </span><a href="#local-1628001831"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1751"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001832"><a href="#local-1628001832"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1752"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#RecordPuns"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">RecordPuns</span></a><span> </span><a href="#local-1628001832"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1753"></a><span>                             </span><span class="hs-operator hs-var">||</span><span> </span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#RecordWildCards"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">RecordWildCards</span></a><span> </span><a href="#local-1628001832"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1754"></a><span>    </span><span class="hs-identifier">is_shadowed_gre</span><span> </span><a name="local-1628001833"><a href="#local-1628001833"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
               What to do when a lookup fails
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1763"></a><span>
</span><a name="line-1764"></a><span class="hs-keyword">data</span><span> </span><a name="WhereLooking"><a href="RnEnv.html#WhereLooking"><span class="hs-identifier">WhereLooking</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WL_Any"><a href="RnEnv.html#WL_Any"><span class="hs-identifier">WL_Any</span></a></a><span>        </span><span class="hs-comment">-- Any binding</span><span>
</span><a name="line-1765"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="WL_Global"><a href="RnEnv.html#WL_Global"><span class="hs-identifier">WL_Global</span></a></a><span>     </span><span class="hs-comment">-- Any top-level binding (local or imported)</span><span>
</span><a name="line-1766"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="WL_LocalTop"><a href="RnEnv.html#WL_LocalTop"><span class="hs-identifier">WL_LocalTop</span></a></a><span>   </span><span class="hs-comment">-- Any top-level binding in this module</span><span>
</span><a name="line-1767"></a><span>
</span><a name="line-1768"></a><span class="hs-identifier">reportUnboundName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1769"></a><a name="reportUnboundName"><a href="RnEnv.html#reportUnboundName"><span class="hs-identifier">reportUnboundName</span></a></a><span> </span><a name="local-1628001834"><a href="#local-1628001834"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unboundName"><span class="hs-identifier hs-var">unboundName</span></a><span> </span><a href="RnEnv.html#WL_Any"><span class="hs-identifier hs-var">WL_Any</span></a><span> </span><a href="#local-1628001834"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1770"></a><span>
</span><a name="line-1771"></a><span class="hs-identifier">unboundName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#WhereLooking"><span class="hs-identifier hs-type">WhereLooking</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1772"></a><a name="unboundName"><a href="RnEnv.html#unboundName"><span class="hs-identifier">unboundName</span></a></a><span> </span><a name="local-1628001835"><a href="#local-1628001835"><span class="hs-identifier">wl</span></a></a><span> </span><a name="local-1628001836"><a href="#local-1628001836"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unboundNameX"><span class="hs-identifier hs-var">unboundNameX</span></a><span> </span><a href="#local-1628001835"><span class="hs-identifier hs-var">wl</span></a><span> </span><a href="#local-1628001836"><span class="hs-identifier hs-var">rdr</span></a><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1773"></a><span>
</span><a name="line-1774"></a><span class="hs-identifier">unboundNameX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#WhereLooking"><span class="hs-identifier hs-type">WhereLooking</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1775"></a><a name="unboundNameX"><a href="RnEnv.html#unboundNameX"><span class="hs-identifier">unboundNameX</span></a></a><span> </span><a name="local-1628001837"><a href="#local-1628001837"><span class="hs-identifier">where_look</span></a></a><span> </span><a name="local-1628001838"><a href="#local-1628001838"><span class="hs-identifier">rdr_name</span></a></a><span> </span><a name="local-1628001839"><a href="#local-1628001839"><span class="hs-identifier">extra</span></a></a><span>
</span><a name="line-1776"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628001840"><a href="#local-1628001840"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-1777"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001841"><a href="#local-1628001841"><span class="hs-identifier">show_helpful_errors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_HelpfulErrors"><span class="hs-identifier hs-var">Opt_HelpfulErrors</span></a><span> </span><a href="#local-1628001840"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1778"></a><span>              </span><a name="local-1628001842"><a href="#local-1628001842"><span class="hs-identifier">what</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier hs-var">pprNonVarNameSpace</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001838"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1779"></a><span>              </span><a name="local-1628001843"><a href="#local-1628001843"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unknownNameErr"><span class="hs-identifier hs-var">unknownNameErr</span></a><span> </span><a href="#local-1628001842"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="#local-1628001838"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628001839"><span class="hs-identifier hs-var">extra</span></a><span>
</span><a name="line-1780"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628001841"><span class="hs-identifier hs-var">show_helpful_errors</span></a><span>
</span><a name="line-1781"></a><span>          </span><span class="hs-keyword">then</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-1628001843"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-1782"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628001844"><a href="#local-1628001844"><span class="hs-identifier">local_env</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-1783"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-1628001845"><a href="#local-1628001845"><span class="hs-identifier">global_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-1784"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-1628001846"><a href="#local-1628001846"><span class="hs-identifier">impInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getImports"><span class="hs-identifier hs-var">getImports</span></a><span>
</span><a name="line-1785"></a><span>                  </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001847"><a href="#local-1628001847"><span class="hs-identifier">suggestions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unknownNameSuggestions_"><span class="hs-identifier hs-var">unknownNameSuggestions_</span></a><span> </span><a href="#local-1628001837"><span class="hs-identifier hs-var">where_look</span></a><span>
</span><a name="line-1786"></a><span>                                        </span><a href="#local-1628001840"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001845"><span class="hs-identifier hs-var">global_env</span></a><span> </span><a href="#local-1628001844"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001846"><span class="hs-identifier hs-var">impInfo</span></a><span> </span><a href="#local-1628001838"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1787"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001843"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-1628001847"><span class="hs-identifier hs-var">suggestions</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1788"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#mkUnboundNameRdr"><span class="hs-identifier hs-var">mkUnboundNameRdr</span></a><span> </span><a href="#local-1628001838"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1789"></a><span>
</span><a name="line-1790"></a><span class="hs-identifier">unknownNameErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1791"></a><a name="unknownNameErr"><a href="RnEnv.html#unknownNameErr"><span class="hs-identifier">unknownNameErr</span></a></a><span> </span><a name="local-1628001848"><a href="#local-1628001848"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-1628001849"><a href="#local-1628001849"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1792"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Not in scope:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1793"></a><span>              </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="#local-1628001848"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001849"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1794"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-1628001850"><span class="hs-identifier hs-var">extra</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1795"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1796"></a><span>    </span><a name="local-1628001850"><a href="#local-1628001850"><span class="hs-identifier">extra</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001849"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#forall_tv_RDR"><span class="hs-identifier hs-var">forall_tv_RDR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#perhapsForallMsg"><span class="hs-identifier hs-var">perhapsForallMsg</span></a><span>
</span><a name="line-1797"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1798"></a><span>
</span><a name="line-1799"></a><span class="hs-keyword">type</span><span> </span><a name="HowInScope"><a href="RnEnv.html#HowInScope"><span class="hs-identifier">HowInScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><a href="RdrName.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a><span>
</span><a name="line-1800"></a><span>     </span><span class="hs-comment">-- Left loc    =&gt;  locally bound at loc</span><span>
</span><a name="line-1801"></a><span>     </span><span class="hs-comment">-- Right ispec =&gt;  imported as specified by ispec</span><span>
</span><a name="line-1802"></a><span>
</span><a name="line-1803"></a><span>
</span><a name="line-1804"></a><span class="hs-comment">-- | Called from the typechecker (TcErrors) when we find an unbound variable</span><span>
</span><a name="line-1805"></a><span class="hs-identifier">unknownNameSuggestions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-1806"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span>
</span><a name="line-1807"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1808"></a><a name="unknownNameSuggestions"><a href="RnEnv.html#unknownNameSuggestions"><span class="hs-identifier">unknownNameSuggestions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#unknownNameSuggestions_"><span class="hs-identifier hs-var">unknownNameSuggestions_</span></a><span> </span><a href="RnEnv.html#WL_Any"><span class="hs-identifier hs-var">WL_Any</span></a><span>
</span><a name="line-1809"></a><span>
</span><a name="line-1810"></a><span class="hs-identifier">unknownNameSuggestions_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#WhereLooking"><span class="hs-identifier hs-type">WhereLooking</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-1811"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span>
</span><a name="line-1812"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1813"></a><a name="unknownNameSuggestions_"><a href="RnEnv.html#unknownNameSuggestions_"><span class="hs-identifier">unknownNameSuggestions_</span></a></a><span> </span><a name="local-1628001851"><a href="#local-1628001851"><span class="hs-identifier">where_look</span></a></a><span> </span><a name="local-1628001852"><a href="#local-1628001852"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628001853"><a href="#local-1628001853"><span class="hs-identifier">global_env</span></a></a><span> </span><a name="local-1628001854"><a href="#local-1628001854"><span class="hs-identifier">local_env</span></a></a><span> </span><a name="local-1628001855"><a href="#local-1628001855"><span class="hs-identifier">imports</span></a></a><span> </span><a name="local-1628001856"><a href="#local-1628001856"><span class="hs-identifier">tried_rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1814"></a><span>    </span><a href="RnEnv.html#similarNameSuggestions"><span class="hs-identifier hs-var">similarNameSuggestions</span></a><span> </span><a href="#local-1628001851"><span class="hs-identifier hs-var">where_look</span></a><span> </span><a href="#local-1628001852"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001853"><span class="hs-identifier hs-var">global_env</span></a><span> </span><a href="#local-1628001854"><span class="hs-identifier hs-var">local_env</span></a><span> </span><a href="#local-1628001856"><span class="hs-identifier hs-var">tried_rdr_name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1815"></a><span>    </span><a href="RnEnv.html#importSuggestions"><span class="hs-identifier hs-var">importSuggestions</span></a><span> </span><a href="#local-1628001852"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001855"><span class="hs-identifier hs-var">imports</span></a><span> </span><a href="#local-1628001856"><span class="hs-identifier hs-var">tried_rdr_name</span></a><span>
</span><a name="line-1816"></a><span>
</span><a name="line-1817"></a><span>
</span><a name="line-1818"></a><span class="hs-identifier">similarNameSuggestions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#WhereLooking"><span class="hs-identifier hs-type">WhereLooking</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span>
</span><a name="line-1819"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span>
</span><a name="line-1820"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1821"></a><a name="similarNameSuggestions"><a href="RnEnv.html#similarNameSuggestions"><span class="hs-identifier">similarNameSuggestions</span></a></a><span> </span><a name="local-1628001857"><a href="#local-1628001857"><span class="hs-identifier">where_look</span></a></a><span> </span><a name="local-1628001858"><a href="#local-1628001858"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-1628001859"><a href="#local-1628001859"><span class="hs-identifier">global_env</span></a></a><span>
</span><a name="line-1822"></a><span>                        </span><a name="local-1628001860"><a href="#local-1628001860"><span class="hs-identifier">local_env</span></a></a><span> </span><a name="local-1628001861"><a href="#local-1628001861"><span class="hs-identifier">tried_rdr_name</span></a></a><span>
</span><a name="line-1823"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001863"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1824"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1825"></a><span>      </span><span class="hs-special">[</span><a name="local-1628001925"><a href="#local-1628001925"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628001864"><span class="hs-identifier hs-var">perhaps</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628001865"><span class="hs-identifier hs-var">pp_item</span></a><span> </span><a href="#local-1628001925"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1826"></a><span>      </span><a name="local-1628001926"><a href="#local-1628001926"><span class="hs-identifier">ps</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628001864"><span class="hs-identifier hs-var">perhaps</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;one of these:&quot;</span><span>
</span><a name="line-1827"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="#local-1628001865"><span class="hs-identifier hs-var">pp_item</span></a><span> </span><a href="#local-1628001926"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1828"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1829"></a><span>    </span><span class="hs-identifier">all_possibilities</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1830"></a><span>    </span><a name="local-1628001862"><a href="#local-1628001862"><span class="hs-identifier">all_possibilities</span></a></a><span>
</span><a name="line-1831"></a><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#showPpr"><span class="hs-identifier hs-var">showPpr</span></a><span> </span><a href="#local-1628001858"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001879"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628001879"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628001880"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1832"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001879"><a href="#local-1628001879"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-1628001880"><a href="#local-1628001880"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001873"><span class="hs-identifier hs-var">local_possibilities</span></a><span> </span><a href="#local-1628001860"><span class="hs-identifier hs-var">local_env</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1833"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#showPpr"><span class="hs-identifier hs-var">showPpr</span></a><span> </span><a href="#local-1628001858"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001881"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001882"><span class="hs-identifier hs-var">rp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001881"><a href="#local-1628001881"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001882"><a href="#local-1628001882"><span class="hs-identifier">rp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001875"><span class="hs-identifier hs-var">global_possibilities</span></a><span> </span><a href="#local-1628001859"><span class="hs-identifier hs-var">global_env</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1834"></a><span>
</span><a name="line-1835"></a><span>    </span><a name="local-1628001863"><a href="#local-1628001863"><span class="hs-identifier">suggest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#fuzzyLookup"><span class="hs-identifier hs-var">fuzzyLookup</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#showPpr"><span class="hs-identifier hs-var">showPpr</span></a><span> </span><a href="#local-1628001858"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628001861"><span class="hs-identifier hs-var">tried_rdr_name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001862"><span class="hs-identifier hs-var">all_possibilities</span></a><span>
</span><a name="line-1836"></a><span>    </span><a name="local-1628001864"><a href="#local-1628001864"><span class="hs-identifier">perhaps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you meant&quot;</span><span>
</span><a name="line-1837"></a><span>
</span><a name="line-1838"></a><span>    </span><span class="hs-identifier">pp_item</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1839"></a><span>    </span><a name="local-1628001865"><a href="#local-1628001865"><span class="hs-identifier">pp_item</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628001883"><a href="#local-1628001883"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628001884"><a href="#local-1628001884"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001866"><span class="hs-identifier hs-var">pp_ns</span></a><span> </span><a href="#local-1628001883"><span class="hs-identifier hs-var">rdr</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001883"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628001885"><span class="hs-identifier hs-var">loc'</span></a><span> </span><span class="hs-comment">-- Locally defined</span><span>
</span><a name="line-1840"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-1628001885"><a href="#local-1628001885"><span class="hs-identifier">loc'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001884"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1841"></a><span>                     </span><a href="SrcLoc.html#UnhelpfulSpan"><span class="hs-identifier hs-var">UnhelpfulSpan</span></a><span> </span><a name="local-1628001886"><a href="#local-1628001886"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001886"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1842"></a><span>                     </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-var">RealSrcSpan</span></a><span> </span><a name="local-1628001887"><a href="#local-1628001887"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;line&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a><span> </span><a href="#local-1628001887"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1843"></a><span>    </span><span class="hs-identifier">pp_item</span><span> </span><span class="hs-special">(</span><a name="local-1628001888"><a href="#local-1628001888"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628001889"><a href="#local-1628001889"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001866"><span class="hs-identifier hs-var">pp_ns</span></a><span> </span><a href="#local-1628001888"><span class="hs-identifier hs-var">rdr</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001888"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>   </span><span class="hs-comment">-- Imported</span><span>
</span><a name="line-1844"></a><span>                              </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;imported from&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">is_mod</span><span> </span><a href="#local-1628001889"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1845"></a><span>
</span><a name="line-1846"></a><span>    </span><span class="hs-identifier">pp_ns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1847"></a><span>    </span><a name="local-1628001866"><a href="#local-1628001866"><span class="hs-identifier">pp_ns</span></a></a><span> </span><a name="local-1628001890"><a href="#local-1628001890"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001891"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-1628001869"><span class="hs-identifier hs-var">tried_ns</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#pprNameSpace"><span class="hs-identifier hs-var">pprNameSpace</span></a><span> </span><a href="#local-1628001891"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-1848"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1849"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-1628001891"><a href="#local-1628001891"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameSpace"><span class="hs-identifier hs-var">rdrNameSpace</span></a><span> </span><a href="#local-1628001890"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1850"></a><span>
</span><a name="line-1851"></a><span>    </span><a name="local-1628001867"><a href="#local-1628001867"><span class="hs-identifier">tried_occ</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628001861"><span class="hs-identifier hs-var">tried_rdr_name</span></a><span>
</span><a name="line-1852"></a><span>    </span><a name="local-1628001868"><a href="#local-1628001868"><span class="hs-identifier">tried_is_sym</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1628001867"><span class="hs-identifier hs-var">tried_occ</span></a><span>
</span><a name="line-1853"></a><span>    </span><a name="local-1628001869"><a href="#local-1628001869"><span class="hs-identifier">tried_ns</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-1628001867"><span class="hs-identifier hs-var">tried_occ</span></a><span>
</span><a name="line-1854"></a><span>    </span><a name="local-1628001870"><a href="#local-1628001870"><span class="hs-identifier">tried_is_qual</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#isQual"><span class="hs-identifier hs-var">isQual</span></a><span> </span><a href="#local-1628001861"><span class="hs-identifier hs-var">tried_rdr_name</span></a><span>
</span><a name="line-1855"></a><span>
</span><a name="line-1856"></a><span>    </span><a name="local-1628001871"><a href="#local-1628001871"><span class="hs-identifier">correct_name_space</span></a></a><span> </span><a name="local-1628001892"><a href="#local-1628001892"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="OccName.html#nameSpacesRelated"><span class="hs-identifier hs-var">nameSpacesRelated</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-1628001892"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001869"><span class="hs-identifier hs-var">tried_ns</span></a><span>
</span><a name="line-1857"></a><span>                           </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><a href="#local-1628001892"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001868"><span class="hs-identifier hs-var">tried_is_sym</span></a><span>
</span><a name="line-1858"></a><span>        </span><span class="hs-comment">-- Treat operator and non-operators as non-matching</span><span>
</span><a name="line-1859"></a><span>        </span><span class="hs-comment">-- This heuristic avoids things like</span><span>
</span><a name="line-1860"></a><span>        </span><span class="hs-comment">--      Not in scope 'f'; perhaps you meant '+' (from Prelude)</span><span>
</span><a name="line-1861"></a><span>
</span><a name="line-1862"></a><span>    </span><a name="local-1628001872"><a href="#local-1628001872"><span class="hs-identifier">local_ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001857"><span class="hs-identifier hs-var">where_look</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnEnv.html#WL_Any"><span class="hs-identifier hs-var">WL_Any</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1863"></a><span>    </span><span class="hs-identifier">local_possibilities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1864"></a><span>    </span><a name="local-1628001873"><a href="#local-1628001873"><span class="hs-identifier">local_possibilities</span></a></a><span> </span><a name="local-1628001893"><a href="#local-1628001893"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-1865"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001870"><span class="hs-identifier hs-var">tried_is_qual</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1866"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628001872"><span class="hs-identifier hs-var">local_ok</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1867"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><a href="#local-1628001895"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628001894"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1868"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001894"><a href="#local-1628001894"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#localRdrEnvElts"><span class="hs-identifier hs-var">localRdrEnvElts</span></a><span> </span><a href="#local-1628001893"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-1869"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001895"><a href="#local-1628001895"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001894"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1870"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="#local-1628001871"><span class="hs-identifier hs-var">correct_name_space</span></a><span> </span><a href="#local-1628001895"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">]</span><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span>    </span><span class="hs-identifier">gre_ok</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1873"></a><span>    </span><a name="local-1628001874"><a href="#local-1628001874"><span class="hs-identifier">gre_ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001857"><span class="hs-identifier hs-var">where_look</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1874"></a><span>                   </span><a href="RnEnv.html#WL_LocalTop"><span class="hs-identifier hs-var">WL_LocalTop</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span>
</span><a name="line-1875"></a><span>                   </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1876"></a><span>
</span><a name="line-1877"></a><span>    </span><span class="hs-identifier">global_possibilities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1878"></a><span>    </span><a name="local-1628001875"><a href="#local-1628001875"><span class="hs-identifier">global_possibilities</span></a></a><span> </span><a name="local-1628001896"><a href="#local-1628001896"><span class="hs-identifier">global_env</span></a></a><span>
</span><a name="line-1879"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001870"><span class="hs-identifier hs-var">tried_is_qual</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-1628001902"><span class="hs-identifier hs-var">rdr_qual</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628001902"><span class="hs-identifier hs-var">rdr_qual</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001901"><span class="hs-identifier hs-var">how</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1880"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001897"><a href="#local-1628001897"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a><span> </span><a href="#local-1628001896"><span class="hs-identifier hs-var">global_env</span></a><span>
</span><a name="line-1881"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="#local-1628001874"><span class="hs-identifier hs-var">gre_ok</span></a><span> </span><a href="#local-1628001897"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1882"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001898"><a href="#local-1628001898"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001897"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1883"></a><span>                              </span><a name="local-1628001899"><a href="#local-1628001899"><span class="hs-identifier">occ</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001898"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1884"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="#local-1628001871"><span class="hs-identifier hs-var">correct_name_space</span></a><span> </span><a href="#local-1628001899"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1885"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628001900"><a href="#local-1628001900"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001901"><a href="#local-1628001901"><span class="hs-identifier">how</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001877"><span class="hs-identifier hs-var">quals_in_scope</span></a><span> </span><a href="#local-1628001897"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1886"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001902"><a href="#local-1628001902"><span class="hs-identifier">rdr_qual</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrQual"><span class="hs-identifier hs-var">mkRdrQual</span></a><span> </span><a href="#local-1628001900"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1628001899"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1887"></a><span>
</span><a name="line-1888"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-1628001906"><span class="hs-identifier hs-var">rdr_unqual</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001909"><span class="hs-identifier hs-var">pair</span></a><span class="hs-special">)</span><span>
</span><a name="line-1889"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001903"><a href="#local-1628001903"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrName.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a><span> </span><a href="#local-1628001896"><span class="hs-identifier hs-var">global_env</span></a><span>
</span><a name="line-1890"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-1628001874"><span class="hs-identifier hs-var">gre_ok</span></a><span> </span><a href="#local-1628001903"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1891"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001904"><a href="#local-1628001904"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628001903"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-1892"></a><span>                          </span><a name="local-1628001905"><a href="#local-1628001905"><span class="hs-identifier">occ</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001904"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1893"></a><span>                          </span><a name="local-1628001906"><a href="#local-1628001906"><span class="hs-identifier">rdr_unqual</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><a href="#local-1628001905"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1894"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-1628001871"><span class="hs-identifier hs-var">correct_name_space</span></a><span> </span><a href="#local-1628001905"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1895"></a><span>                    </span><span class="hs-special">,</span><span> </span><a name="local-1628001909"><a href="#local-1628001909"><span class="hs-identifier">pair</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-1628001876"><span class="hs-identifier hs-var">unquals_in_scope</span></a><span> </span><a href="#local-1628001903"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001878"><span class="hs-identifier hs-var">quals_only</span></a><span> </span><a href="#local-1628001903"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1896"></a><span>                                </span><span class="hs-special">(</span><a name="local-1628001907"><a href="#local-1628001907"><span class="hs-identifier">how</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-1628001906"><span class="hs-identifier hs-var">rdr_unqual</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001907"><span class="hs-identifier hs-var">how</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1897"></a><span>                                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>    </span><a name="local-1628001908"><a href="#local-1628001908"><span class="hs-identifier">pr</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628001908"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- See Note [Only-quals]</span><span>
</span><a name="line-1898"></a><span>                                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1899"></a><span>
</span><a name="line-1900"></a><span>              </span><span class="hs-comment">-- Note [Only-quals]</span><span>
</span><a name="line-1901"></a><span>              </span><span class="hs-comment">-- The second alternative returns those names with the same</span><span>
</span><a name="line-1902"></a><span>              </span><span class="hs-comment">-- OccName as the one we tried, but live in *qualified* imports</span><span>
</span><a name="line-1903"></a><span>              </span><span class="hs-comment">-- e.g. if you have:</span><span>
</span><a name="line-1904"></a><span>              </span><span class="hs-comment">--</span><span>
</span><a name="line-1905"></a><span>              </span><span class="hs-comment">-- &gt; import qualified Data.Map as Map</span><span>
</span><a name="line-1906"></a><span>              </span><span class="hs-comment">-- &gt; foo :: Map</span><span>
</span><a name="line-1907"></a><span>              </span><span class="hs-comment">--</span><span>
</span><a name="line-1908"></a><span>              </span><span class="hs-comment">-- then we suggest @Map.Map@.</span><span>
</span><a name="line-1909"></a><span>
</span><a name="line-1910"></a><span>    </span><span class="hs-comment">--------------------</span><span>
</span><a name="line-1911"></a><span>    </span><span class="hs-identifier">unquals_in_scope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">]</span><span>
</span><a name="line-1912"></a><span>    </span><a name="local-1628001876"><a href="#local-1628001876"><span class="hs-identifier">unquals_in_scope</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001910"><a href="#local-1628001910"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_lcl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001911"><a href="#local-1628001911"><span class="hs-identifier">lcl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_imp</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001912"><a href="#local-1628001912"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1913"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001911"><span class="hs-identifier hs-var">lcl</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628001910"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1914"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001914"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-1915"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001913"><a href="#local-1628001913"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001912"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001914"><a href="#local-1628001914"><span class="hs-identifier">ispec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_decl</span><span> </span><a href="#local-1628001913"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1916"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">is_qual</span><span> </span><a href="#local-1628001914"><span class="hs-identifier hs-var">ispec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1917"></a><span>
</span><a name="line-1918"></a><span>    </span><span class="hs-comment">--------------------</span><span>
</span><a name="line-1919"></a><span>    </span><span class="hs-identifier">quals_in_scope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Module.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1920"></a><span>    </span><span class="hs-comment">-- Ones for which the qualified version is in scope</span><span>
</span><a name="line-1921"></a><span>    </span><a name="local-1628001877"><a href="#local-1628001877"><span class="hs-identifier">quals_in_scope</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001915"><a href="#local-1628001915"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_lcl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001916"><a href="#local-1628001916"><span class="hs-identifier">lcl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_imp</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001917"><a href="#local-1628001917"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1922"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001916"><span class="hs-identifier hs-var">lcl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-1628001915"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1923"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1924"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001918"><a href="#local-1628001918"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-1628001918"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628001915"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1925"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">is_as</span><span> </span><a href="#local-1628001920"><span class="hs-identifier hs-var">ispec</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001920"><span class="hs-identifier hs-var">ispec</span></a><span class="hs-special">)</span><span>
</span><a name="line-1926"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001919"><a href="#local-1628001919"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001917"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001920"><a href="#local-1628001920"><span class="hs-identifier">ispec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_decl</span><span> </span><a href="#local-1628001919"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1927"></a><span>
</span><a name="line-1928"></a><span>    </span><span class="hs-comment">--------------------</span><span>
</span><a name="line-1929"></a><span>    </span><span class="hs-identifier">quals_only</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="RnEnv.html#HowInScope"><span class="hs-identifier hs-type">HowInScope</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1930"></a><span>    </span><span class="hs-comment">-- Ones for which *only* the qualified version is in scope</span><span>
</span><a name="line-1931"></a><span>    </span><a name="local-1628001878"><a href="#local-1628001878"><span class="hs-identifier">quals_only</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001921"><a href="#local-1628001921"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_imp</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628001922"><a href="#local-1628001922"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1932"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#mkRdrQual"><span class="hs-identifier hs-var">mkRdrQual</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">is_as</span><span> </span><a href="#local-1628001924"><span class="hs-identifier hs-var">ispec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001921"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628001924"><span class="hs-identifier hs-var">ispec</span></a><span class="hs-special">)</span><span>
</span><a name="line-1933"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="local-1628001923"><a href="#local-1628001923"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001922"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001924"><a href="#local-1628001924"><span class="hs-identifier">ispec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_decl</span><span> </span><a href="#local-1628001923"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_qual</span><span> </span><a href="#local-1628001924"><span class="hs-identifier hs-var">ispec</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1934"></a><span>
</span><a name="line-1935"></a><span class="hs-comment">-- | Generate helpful suggestions if a qualified name Mod.foo is not in scope.</span><span>
</span><a name="line-1936"></a><span class="hs-identifier">importSuggestions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1937"></a><a name="importSuggestions"><a href="RnEnv.html#importSuggestions"><span class="hs-identifier">importSuggestions</span></a></a><span> </span><a name="local-1628001927"><a href="#local-1628001927"><span class="hs-identifier">_dflags</span></a></a><span> </span><a name="local-1628001928"><a href="#local-1628001928"><span class="hs-identifier">imports</span></a></a><span> </span><a name="local-1628001929"><a href="#local-1628001929"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-1938"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isQual"><span class="hs-identifier hs-var">isQual</span></a><span> </span><a href="#local-1628001929"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RdrName.html#isUnqual"><span class="hs-identifier hs-var">isUnqual</span></a><span> </span><a href="#local-1628001929"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1939"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001933"><span class="hs-identifier hs-var">interesting_imports</span></a><span>
</span><a name="line-1940"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001951"><a href="#local-1628001951"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001931"><span class="hs-identifier hs-var">mod_name</span></a><span>
</span><a name="line-1941"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span>
</span><a name="line-1942"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;No module named&quot;</span><span>
</span><a name="line-1943"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001951"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1944"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is imported.&quot;</span><span>
</span><a name="line-1945"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1946"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001930"><span class="hs-identifier hs-var">is_qualified</span></a><span>
</span><a name="line-1947"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001935"><span class="hs-identifier hs-var">helpful_imports</span></a><span>
</span><a name="line-1948"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-1628001952"><a href="#local-1628001952"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001933"><span class="hs-identifier hs-var">interesting_imports</span></a><span>
</span><a name="line-1949"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span>
</span><a name="line-1950"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Module&quot;</span><span>
</span><a name="line-1951"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001952"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1952"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;does not export&quot;</span><span>
</span><a name="line-1953"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-1954"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1955"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628001930"><span class="hs-identifier hs-var">is_qualified</span></a><span>
</span><a name="line-1956"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001935"><span class="hs-identifier hs-var">helpful_imports</span></a><span>
</span><a name="line-1957"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="local-1628001953"><a href="#local-1628001953"><span class="hs-identifier">mods</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="#local-1628001933"><span class="hs-identifier hs-var">interesting_imports</span></a><span>
</span><a name="line-1958"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span>
</span><a name="line-1959"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Neither&quot;</span><span>
</span><a name="line-1960"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotedListWithNor"><span class="hs-identifier hs-var">quotedListWithNor</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001953"><span class="hs-identifier hs-var">mods</span></a><span class="hs-special">)</span><span>
</span><a name="line-1961"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;exports&quot;</span><span>
</span><a name="line-1962"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-1963"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1964"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-1628001954"><a href="#local-1628001954"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><a name="local-1628001955"><a href="#local-1628001955"><span class="hs-identifier">imv</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001937"><span class="hs-identifier hs-var">helpful_imports_non_hiding</span></a><span>
</span><a name="line-1965"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span>
</span><a name="line-1966"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you want to add&quot;</span><span>
</span><a name="line-1967"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1968"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to the import list&quot;</span><span>
</span><a name="line-1969"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the import of&quot;</span><span>
</span><a name="line-1970"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001954"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1971"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_span</span><span> </span><a href="#local-1628001955"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-1972"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1973"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001937"><span class="hs-identifier hs-var">helpful_imports_non_hiding</span></a><span class="hs-special">)</span><span>
</span><a name="line-1974"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span>
</span><a name="line-1975"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you want to add&quot;</span><span>
</span><a name="line-1976"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1977"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to one of these import lists:&quot;</span><span>
</span><a name="line-1978"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1979"></a><span>    </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1980"></a><span>    </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-1981"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001956"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_span</span><span> </span><a href="#local-1628001957"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1982"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001956"><a href="#local-1628001956"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><a name="local-1628001957"><a href="#local-1628001957"><span class="hs-identifier">imv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001937"><span class="hs-identifier hs-var">helpful_imports_non_hiding</span></a><span>
</span><a name="line-1983"></a><span>        </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1984"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-1628001958"><a href="#local-1628001958"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><a name="local-1628001959"><a href="#local-1628001959"><span class="hs-identifier">imv</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001936"><span class="hs-identifier hs-var">helpful_imports_hiding</span></a><span>
</span><a name="line-1985"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span>
</span><a name="line-1986"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you want to remove&quot;</span><span>
</span><a name="line-1987"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1988"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from the explicit hiding list&quot;</span><span>
</span><a name="line-1989"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the import of&quot;</span><span>
</span><a name="line-1990"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001958"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1991"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_span</span><span> </span><a href="#local-1628001959"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-1992"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1993"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628001936"><span class="hs-identifier hs-var">helpful_imports_hiding</span></a><span class="hs-special">)</span><span>
</span><a name="line-1994"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span>
</span><a name="line-1995"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you want to remove&quot;</span><span>
</span><a name="line-1996"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1997"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from the hiding clauses&quot;</span><span>
</span><a name="line-1998"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in one of these imports:&quot;</span><span>
</span><a name="line-1999"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-2000"></a><span>    </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2001"></a><span>    </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-2002"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628001960"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_span</span><span> </span><a href="#local-1628001961"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2003"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001960"><a href="#local-1628001960"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><a name="local-1628001961"><a href="#local-1628001961"><span class="hs-identifier">imv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001936"><span class="hs-identifier hs-var">helpful_imports_hiding</span></a><span>
</span><a name="line-2004"></a><span>        </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2005"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2006"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">Outputable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2007"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2008"></a><span>  </span><a name="local-1628001930"><a href="#local-1628001930"><span class="hs-identifier">is_qualified</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#isQual"><span class="hs-identifier hs-var">isQual</span></a><span> </span><a href="#local-1628001929"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-2009"></a><span>  </span><span class="hs-special">(</span><a name="local-1628001931"><a href="#local-1628001931"><span class="hs-identifier">mod_name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001932"><a href="#local-1628001932"><span class="hs-identifier">occ_name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001929"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2010"></a><span>    </span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a name="local-1628001938"><a href="#local-1628001938"><span class="hs-identifier">occ_name</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001938"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2011"></a><span>    </span><a href="RdrName.html#Qual"><span class="hs-identifier hs-var">Qual</span></a><span> </span><a name="local-1628001939"><a href="#local-1628001939"><span class="hs-identifier">mod_name</span></a></a><span> </span><a name="local-1628001940"><a href="#local-1628001940"><span class="hs-identifier">occ_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001939"><span class="hs-identifier hs-var">mod_name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001940"><span class="hs-identifier hs-var">occ_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2012"></a><span>    </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;importSuggestions: dead code&quot;</span><span>
</span><a name="line-2013"></a><span>
</span><a name="line-2014"></a><span>
</span><a name="line-2015"></a><span>  </span><span class="hs-comment">-- What import statements provide &quot;Mod&quot; at all</span><span>
</span><a name="line-2016"></a><span>  </span><span class="hs-comment">-- or, if this is an unqualified name, are not qualified imports</span><span>
</span><a name="line-2017"></a><span>  </span><a name="local-1628001933"><a href="#local-1628001933"><span class="hs-identifier">interesting_imports</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-1628001941"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001943"><span class="hs-identifier hs-var">imp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2018"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1628001941"><a href="#local-1628001941"><span class="hs-identifier">mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001942"><a href="#local-1628001942"><span class="hs-identifier">mod_imports</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Module.html#moduleEnvToList"><span class="hs-identifier hs-var">moduleEnvToList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imp_mods</span><span> </span><a href="#local-1628001928"><span class="hs-identifier hs-var">imports</span></a><span class="hs-special">)</span><span>
</span><a name="line-2019"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001943"><a href="#local-1628001943"><span class="hs-identifier">imp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628001934"><span class="hs-identifier hs-var">pick</span></a><span> </span><a href="#local-1628001942"><span class="hs-identifier hs-var">mod_imports</span></a><span>
</span><a name="line-2020"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-2021"></a><span>
</span><a name="line-2022"></a><span>  </span><span class="hs-comment">-- We want to keep only one for each original module; preferably one with an</span><span>
</span><a name="line-2023"></a><span>  </span><span class="hs-comment">-- explicit import list (for no particularly good reason)</span><span>
</span><a name="line-2024"></a><span>  </span><span class="hs-identifier">pick</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HscTypes.html#ImportedModsVal"><span class="hs-identifier hs-type">ImportedModsVal</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="HscTypes.html#ImportedModsVal"><span class="hs-identifier hs-type">ImportedModsVal</span></a><span>
</span><a name="line-2025"></a><span>  </span><a name="local-1628001934"><a href="#local-1628001934"><span class="hs-identifier">pick</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Function.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001945"><span class="hs-identifier hs-var">prefer</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628001944"><span class="hs-identifier hs-var">select</span></a><span>
</span><a name="line-2026"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1628001944"><a href="#local-1628001944"><span class="hs-identifier">select</span></a></a><span> </span><a name="local-1628001946"><a href="#local-1628001946"><span class="hs-identifier">imv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628001931"><span class="hs-identifier hs-var">mod_name</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001947"><a href="#local-1628001947"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">imv_name</span><span> </span><a href="#local-1628001946"><span class="hs-identifier hs-var">imv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628001947"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2027"></a><span>                                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_qualified</span><span> </span><a href="#local-1628001946"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2028"></a><span>          </span><a name="local-1628001945"><a href="#local-1628001945"><span class="hs-identifier">prefer</span></a></a><span> </span><a name="local-1628001948"><a href="#local-1628001948"><span class="hs-identifier">imv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_is_hiding</span><span> </span><a href="#local-1628001948"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_span</span><span> </span><a href="#local-1628001948"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2029"></a><span>
</span><a name="line-2030"></a><span>  </span><span class="hs-comment">-- Which of these would export a 'foo'</span><span>
</span><a name="line-2031"></a><span>  </span><span class="hs-comment">-- (all of these are restricted imports, because if they were not, we</span><span>
</span><a name="line-2032"></a><span>  </span><span class="hs-comment">-- wouldn't have an out-of-scope error in the first place)</span><span>
</span><a name="line-2033"></a><span>  </span><a name="local-1628001935"><a href="#local-1628001935"><span class="hs-identifier">helpful_imports</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628001949"><span class="hs-identifier hs-var">helpful</span></a><span> </span><a href="#local-1628001933"><span class="hs-identifier hs-var">interesting_imports</span></a><span>
</span><a name="line-2034"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1628001949"><a href="#local-1628001949"><span class="hs-identifier">helpful</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1628001950"><a href="#local-1628001950"><span class="hs-identifier">imv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2035"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RdrName.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_all_exports</span><span> </span><a href="#local-1628001950"><span class="hs-identifier hs-var">imv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001932"><span class="hs-identifier hs-var">occ_name</span></a><span>
</span><a name="line-2036"></a><span>
</span><a name="line-2037"></a><span>  </span><span class="hs-comment">-- Which of these do that because of an explicit hiding list resp. an</span><span>
</span><a name="line-2038"></a><span>  </span><span class="hs-comment">-- explicit import list</span><span>
</span><a name="line-2039"></a><span>  </span><span class="hs-special">(</span><a name="local-1628001936"><a href="#local-1628001936"><span class="hs-identifier">helpful_imports_hiding</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001937"><a href="#local-1628001937"><span class="hs-identifier">helpful_imports_non_hiding</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2040"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">imv_is_hiding</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001935"><span class="hs-identifier hs-var">helpful_imports</span></a><span>
</span><a name="line-2041"></a><span>
</span><a name="line-2042"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Free variable manipulation}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2049"></a><span>
</span><a name="line-2050"></a><span class="hs-comment">-- A useful utility</span><span>
</span><a name="line-2051"></a><span class="hs-identifier">addFvRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001435"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001435"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2052"></a><a name="addFvRn"><a href="RnEnv.html#addFvRn"><span class="hs-identifier">addFvRn</span></a></a><span> </span><a name="local-1628001962"><a href="#local-1628001962"><span class="hs-identifier">fvs1</span></a></a><span> </span><a name="local-1628001963"><a href="#local-1628001963"><span class="hs-identifier">thing_inside</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628001964"><a href="#local-1628001964"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001965"><a href="#local-1628001965"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001963"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-2053"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001964"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001962"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001965"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2054"></a><span>
</span><a name="line-2055"></a><span class="hs-identifier">mapFvRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1628001433"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001434"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628001433"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1628001434"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2056"></a><a name="mapFvRn"><a href="RnEnv.html#mapFvRn"><span class="hs-identifier">mapFvRn</span></a></a><span> </span><a name="local-1628001966"><a href="#local-1628001966"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1628001967"><a href="#local-1628001967"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628001968"><a href="#local-1628001968"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628001966"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628001967"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2057"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-1628001968"><span class="hs-identifier hs-var">stuff</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2058"></a><span>                      </span><span class="hs-special">(</span><a name="local-1628001969"><a href="#local-1628001969"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001970"><a href="#local-1628001970"><span class="hs-identifier">fvs_s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001969"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a><span> </span><a href="#local-1628001970"><span class="hs-identifier hs-var">fvs_s</span></a><span class="hs-special">)</span><span>
</span><a name="line-2059"></a><span>
</span><a name="line-2060"></a><span class="hs-identifier">mapMaybeFvRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1628001431"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001432"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1628001431"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1628001432"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2061"></a><a name="mapMaybeFvRn"><a href="RnEnv.html#mapMaybeFvRn"><span class="hs-identifier">mapMaybeFvRn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2062"></a><span class="hs-identifier">mapMaybeFvRn</span><span> </span><a name="local-1628001971"><a href="#local-1628001971"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628001972"><a href="#local-1628001972"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628001973"><a href="#local-1628001973"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628001974"><a href="#local-1628001974"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628001971"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628001972"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628001973"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628001974"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2063"></a><span>
</span><a name="line-2064"></a><span class="hs-comment">-- because some of the rename functions are CPSed:</span><span>
</span><a name="line-2065"></a><span class="hs-comment">-- maps the function across the list from left to right;</span><span>
</span><a name="line-2066"></a><span class="hs-comment">-- collects all the free vars into one set</span><span>
</span><a name="line-2067"></a><span class="hs-identifier">mapFvRnCPS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1628001428"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628001429"><span class="hs-identifier hs-type">b</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001430"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001430"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2068"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628001428"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1628001429"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001430"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="#local-1628001430"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-2069"></a><span>
</span><a name="line-2070"></a><a name="mapFvRnCPS"><a href="RnEnv.html#mapFvRnCPS"><span class="hs-identifier">mapFvRnCPS</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-1628001975"><a href="#local-1628001975"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001975"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2071"></a><span class="hs-identifier">mapFvRnCPS</span><span> </span><a name="local-1628001976"><a href="#local-1628001976"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628001977"><a href="#local-1628001977"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1628001978"><a href="#local-1628001978"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628001979"><a href="#local-1628001979"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628001976"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628001977"><span class="hs-identifier hs-var">x</span></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628001980"><a href="#local-1628001980"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2072"></a><span>                           </span><a href="RnEnv.html#mapFvRnCPS"><span class="hs-identifier hs-var">mapFvRnCPS</span></a><span> </span><a href="#local-1628001976"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628001978"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628001981"><a href="#local-1628001981"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2073"></a><span>                           </span><a href="#local-1628001979"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628001980"><span class="hs-identifier hs-var">x'</span></a><span class="hs-glyph">:</span><a href="#local-1628001981"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Envt utility functions}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2082"></a><span>
</span><a name="line-2083"></a><span class="hs-identifier">warnUnusedTopBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2084"></a><a name="warnUnusedTopBinds"><a href="RnEnv.html#warnUnusedTopBinds"><span class="hs-identifier">warnUnusedTopBinds</span></a></a><span> </span><a name="local-1628001982"><a href="#local-1628001982"><span class="hs-identifier">gres</span></a></a><span>
</span><a name="line-2085"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedTopBinds"><span class="hs-identifier hs-var">Opt_WarnUnusedTopBinds</span></a><span>
</span><a name="line-2086"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628001983"><a href="#local-1628001983"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a><span>
</span><a name="line-2087"></a><span>         </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001984"><a href="#local-1628001984"><span class="hs-identifier">isBoot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcg_src</span><span> </span><a href="#local-1628001983"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="DriverPhases.html#HsBootFile"><span class="hs-identifier hs-var">HsBootFile</span></a><span>
</span><a name="line-2088"></a><span>         </span><span class="hs-keyword">let</span><span> </span><a name="local-1628001985"><a href="#local-1628001985"><span class="hs-identifier">noParent</span></a></a><span> </span><a name="local-1628001987"><a href="#local-1628001987"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">gre_par</span><span> </span><a href="#local-1628001987"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2089"></a><span>                            </span><a href="RdrName.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2090"></a><span>                            </span><a href="RdrName.html#PatternSynonym"><span class="hs-identifier hs-var">PatternSynonym</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2091"></a><span>                            </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2092"></a><span>             </span><span class="hs-comment">-- Don't warn about unused bindings with parents in</span><span>
</span><a name="line-2093"></a><span>             </span><span class="hs-comment">-- .hs-boot files, as you are sometimes required to give</span><span>
</span><a name="line-2094"></a><span>             </span><span class="hs-comment">-- unused bindings (trac #3449).</span><span>
</span><a name="line-2095"></a><span>             </span><span class="hs-comment">-- HOWEVER, in a signature file, you are never obligated to put a</span><span>
</span><a name="line-2096"></a><span>             </span><span class="hs-comment">-- definition in the main text.  Thus, if you define something</span><span>
</span><a name="line-2097"></a><span>             </span><span class="hs-comment">-- and forget to export it, we really DO want to warn.</span><span>
</span><a name="line-2098"></a><span>             </span><a name="local-1628001986"><a href="#local-1628001986"><span class="hs-identifier">gres'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628001984"><span class="hs-identifier hs-var">isBoot</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-1628001985"><span class="hs-identifier hs-var">noParent</span></a><span> </span><a href="#local-1628001982"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-2099"></a><span>                               </span><span class="hs-keyword">else</span><span>                 </span><a href="#local-1628001982"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-2100"></a><span>         </span><a href="RnEnv.html#warnUnusedGREs"><span class="hs-identifier hs-var">warnUnusedGREs</span></a><span> </span><a href="#local-1628001986"><span class="hs-identifier hs-var">gres'</span></a><span>
</span><a name="line-2101"></a><span>
</span><a name="line-2102"></a><span class="hs-identifier">warnUnusedLocalBinds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">warnUnusedMatches</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">warnUnusedTypePatterns</span><span>
</span><a name="line-2103"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2104"></a><a name="warnUnusedLocalBinds"><a href="RnEnv.html#warnUnusedLocalBinds"><span class="hs-identifier">warnUnusedLocalBinds</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#check_unused"><span class="hs-identifier hs-var">check_unused</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedLocalBinds"><span class="hs-identifier hs-var">Opt_WarnUnusedLocalBinds</span></a><span>
</span><a name="line-2105"></a><a name="warnUnusedMatches"><a href="RnEnv.html#warnUnusedMatches"><span class="hs-identifier">warnUnusedMatches</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#check_unused"><span class="hs-identifier hs-var">check_unused</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedMatches"><span class="hs-identifier hs-var">Opt_WarnUnusedMatches</span></a><span>
</span><a name="line-2106"></a><a name="warnUnusedTypePatterns"><a href="RnEnv.html#warnUnusedTypePatterns"><span class="hs-identifier">warnUnusedTypePatterns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#check_unused"><span class="hs-identifier hs-var">check_unused</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedTypePatterns"><span class="hs-identifier hs-var">Opt_WarnUnusedTypePatterns</span></a><span>
</span><a name="line-2107"></a><span>
</span><a name="line-2108"></a><span class="hs-identifier">check_unused</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2109"></a><a name="check_unused"><a href="RnEnv.html#check_unused"><span class="hs-identifier">check_unused</span></a></a><span> </span><a name="local-1628001988"><a href="#local-1628001988"><span class="hs-identifier">flag</span></a></a><span> </span><a name="local-1628001989"><a href="#local-1628001989"><span class="hs-identifier">bound_names</span></a></a><span> </span><a name="local-1628001990"><a href="#local-1628001990"><span class="hs-identifier">used_names</span></a></a><span>
</span><a name="line-2110"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="#local-1628001988"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#warnUnused"><span class="hs-identifier hs-var">warnUnused</span></a><span> </span><a href="#local-1628001988"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628001990"><span class="hs-identifier hs-var">used_names</span></a><span class="hs-special">)</span><span>
</span><a name="line-2111"></a><span>                                               </span><a href="#local-1628001989"><span class="hs-identifier hs-var">bound_names</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2112"></a><span>
</span><a name="line-2113"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-2114"></a><span class="hs-comment">--      Helpers</span><span>
</span><a name="line-2115"></a><span class="hs-identifier">warnUnusedGREs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2116"></a><a name="warnUnusedGREs"><a href="RnEnv.html#warnUnusedGREs"><span class="hs-identifier">warnUnusedGREs</span></a></a><span> </span><a name="local-1628001991"><a href="#local-1628001991"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="RnEnv.html#warnUnusedGRE"><span class="hs-identifier hs-var">warnUnusedGRE</span></a><span> </span><a href="#local-1628001991"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-2117"></a><span>
</span><a name="line-2118"></a><span class="hs-identifier">warnUnused</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2119"></a><a name="warnUnused"><a href="RnEnv.html#warnUnused"><span class="hs-identifier">warnUnused</span></a></a><span> </span><a name="local-1628001992"><a href="#local-1628001992"><span class="hs-identifier">flag</span></a></a><span> </span><a name="local-1628001993"><a href="#local-1628001993"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2120"></a><span>    </span><a name="local-1628001994"><a href="#local-1628001994"><span class="hs-identifier">fld_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mkFieldEnv"><span class="hs-identifier hs-var">mkFieldEnv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-2121"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#warnUnused1"><span class="hs-identifier hs-var">warnUnused1</span></a><span> </span><a href="#local-1628001992"><span class="hs-identifier hs-var">flag</span></a><span> </span><a href="#local-1628001994"><span class="hs-identifier hs-var">fld_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628001993"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-2122"></a><span>
</span><a name="line-2123"></a><span class="hs-identifier">warnUnused1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><span class="hs-special">(</span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2124"></a><a name="warnUnused1"><a href="RnEnv.html#warnUnused1"><span class="hs-identifier">warnUnused1</span></a></a><span> </span><a name="local-1628001995"><a href="#local-1628001995"><span class="hs-identifier">flag</span></a></a><span> </span><a name="local-1628001996"><a href="#local-1628001996"><span class="hs-identifier">fld_env</span></a></a><span> </span><a name="local-1628001997"><a href="#local-1628001997"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-2125"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#reportable"><span class="hs-identifier hs-var">reportable</span></a><span> </span><a href="#local-1628001997"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2126"></a><span>    </span><a href="RnEnv.html#addUnusedWarning"><span class="hs-identifier hs-var">addUnusedWarning</span></a><span> </span><a href="#local-1628001995"><span class="hs-identifier hs-var">flag</span></a><span>
</span><a name="line-2127"></a><span>                     </span><a href="#local-1628001998"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1628001997"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2128"></a><span>                     </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Defined but not used&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2129"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2130"></a><span>    </span><a name="local-1628001998"><a href="#local-1628001998"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><a href="#local-1628001996"><span class="hs-identifier hs-var">fld_env</span></a><span> </span><a href="#local-1628001997"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2131"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628001999"><a href="#local-1628001999"><span class="hs-identifier">fl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><a href="#local-1628001999"><span class="hs-identifier hs-var">fl</span></a><span>
</span><a name="line-2132"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628001997"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2133"></a><span>
</span><a name="line-2134"></a><span class="hs-identifier">warnUnusedGRE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2135"></a><a name="warnUnusedGRE"><a href="RnEnv.html#warnUnusedGRE"><span class="hs-identifier">warnUnusedGRE</span></a></a><span> </span><a name="local-1628002000"><a href="#local-1628002000"><span class="hs-identifier">gre</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RdrName.html#GRE"><span class="hs-identifier hs-var">GRE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gre_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628002001"><a href="#local-1628002001"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_lcl</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628002002"><a href="#local-1628002002"><span class="hs-identifier">lcl</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">gre_imp</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628002003"><a href="#local-1628002003"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2136"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628002002"><span class="hs-identifier hs-var">lcl</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628002010"><a href="#local-1628002010"><span class="hs-identifier">fld_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#mkFieldEnv"><span class="hs-identifier hs-var">mkFieldEnv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcRnMonad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a><span>
</span><a name="line-2137"></a><span>                   </span><a href="RnEnv.html#warnUnused1"><span class="hs-identifier hs-var">warnUnused1</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedTopBinds"><span class="hs-identifier hs-var">Opt_WarnUnusedTopBinds</span></a><span> </span><a href="#local-1628002010"><span class="hs-identifier hs-var">fld_env</span></a><span> </span><a href="#local-1628002001"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2138"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#reportable"><span class="hs-identifier hs-var">reportable</span></a><span> </span><a href="#local-1628002001"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628002005"><span class="hs-identifier hs-var">warn</span></a><span> </span><a href="#local-1628002003"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-2139"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2140"></a><span>    </span><a name="local-1628002004"><a href="#local-1628002004"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a><span> </span><a href="#local-1628002000"><span class="hs-identifier hs-var">gre</span></a><span>
</span><a name="line-2141"></a><span>    </span><a name="local-1628002005"><a href="#local-1628002005"><span class="hs-identifier">warn</span></a></a><span> </span><a name="local-1628002006"><a href="#local-1628002006"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnEnv.html#addUnusedWarning"><span class="hs-identifier hs-var">addUnusedWarning</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedTopBinds"><span class="hs-identifier hs-var">Opt_WarnUnusedTopBinds</span></a><span> </span><a href="#local-1628002004"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1628002007"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-1628002009"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2142"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2143"></a><span>           </span><a name="local-1628002007"><a href="#local-1628002007"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#importSpecLoc"><span class="hs-identifier hs-var">importSpecLoc</span></a><span> </span><a href="#local-1628002006"><span class="hs-identifier hs-var">spec</span></a><span>
</span><a name="line-2144"></a><span>           </span><a name="local-1628002008"><a href="#local-1628002008"><span class="hs-identifier">pp_mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#importSpecModule"><span class="hs-identifier hs-var">importSpecModule</span></a><span> </span><a href="#local-1628002006"><span class="hs-identifier hs-var">spec</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2145"></a><span>           </span><a name="local-1628002009"><a href="#local-1628002009"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Imported from&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628002008"><span class="hs-identifier hs-var">pp_mod</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;but not used&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2146"></a><span>
</span><a name="line-2147"></a><span class="hs-comment">-- | Make a map from selector names to field labels and parent tycon</span><span>
</span><a name="line-2148"></a><span class="hs-comment">-- names, to be used when reporting unused record fields.</span><span>
</span><a name="line-2149"></a><span class="hs-identifier">mkFieldEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><span class="hs-special">(</span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2150"></a><a name="mkFieldEnv"><a href="RnEnv.html#mkFieldEnv"><span class="hs-identifier">mkFieldEnv</span></a></a><span> </span><a name="local-1628002011"><a href="#local-1628002011"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628002013"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628002014"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">par_is</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_par</span><span> </span><a href="#local-1628002013"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2151"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><a name="local-1628002012"><a href="#local-1628002012"><span class="hs-identifier">gres</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="OccName.html#occEnvElts"><span class="hs-identifier hs-var">occEnvElts</span></a><span> </span><a href="#local-1628002011"><span class="hs-identifier hs-var">rdr_env</span></a><span>
</span><a name="line-2152"></a><span>                               </span><span class="hs-special">,</span><span> </span><a name="local-1628002013"><a href="#local-1628002013"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628002012"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-2153"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628002014"><a href="#local-1628002014"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#greLabel"><span class="hs-identifier hs-var">greLabel</span></a><span> </span><a href="#local-1628002013"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">]</span><span>
</span><a name="line-2154"></a><span>                               </span><span class="hs-special">]</span><span>
</span><a name="line-2155"></a><span>
</span><a name="line-2156"></a><span class="hs-identifier">reportable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2157"></a><a name="reportable"><a href="RnEnv.html#reportable"><span class="hs-identifier">reportable</span></a></a><span> </span><a name="local-1628002015"><a href="#local-1628002015"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-2158"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a><span> </span><a href="#local-1628002015"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>    </span><span class="hs-comment">-- Don't report unused wired-in names</span><span>
</span><a name="line-2159"></a><span>                                  </span><span class="hs-comment">-- Otherwise we get a zillion warnings</span><span>
</span><a name="line-2160"></a><span>                                  </span><span class="hs-comment">-- from Data.Tuple</span><span>
</span><a name="line-2161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628002015"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2162"></a><span>
</span><a name="line-2163"></a><span class="hs-identifier">addUnusedWarning</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2164"></a><a name="addUnusedWarning"><a href="RnEnv.html#addUnusedWarning"><span class="hs-identifier">addUnusedWarning</span></a></a><span> </span><a name="local-1628002016"><a href="#local-1628002016"><span class="hs-identifier">flag</span></a></a><span> </span><a name="local-1628002017"><a href="#local-1628002017"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1628002018"><a href="#local-1628002018"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-1628002019"><a href="#local-1628002019"><span class="hs-identifier">msg</span></a></a><span>
</span><a name="line-2165"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="#local-1628002016"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628002018"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2166"></a><span>    </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628002019"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span class="hs-special">,</span><span>
</span><a name="line-2167"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="OccName.html#pprNonVarNameSpace"><span class="hs-identifier hs-var">pprNonVarNameSpace</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-1628002017"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-2168"></a><span>                        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002017"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2169"></a><span>
</span><a name="line-2170"></a><span class="hs-identifier">addNameClashErrRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2171"></a><a name="addNameClashErrRn"><a href="RnEnv.html#addNameClashErrRn"><span class="hs-identifier">addNameClashErrRn</span></a></a><span> </span><a name="local-1628002020"><a href="#local-1628002020"><span class="hs-identifier">rdr_name</span></a></a><span> </span><a name="local-1628002021"><a href="#local-1628002021"><span class="hs-identifier">gres</span></a></a><span>
</span><a name="line-2172"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="RdrName.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a><span> </span><a href="#local-1628002021"><span class="hs-identifier hs-var">gres</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="RdrName.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a><span> </span><a href="#local-1628002021"><span class="hs-identifier hs-var">gres</span></a><span class="hs-special">)</span><span>
</span><a name="line-2173"></a><span>               </span><span class="hs-comment">-- If there are two or more *local* defns, we'll have reported</span><span>
</span><a name="line-2174"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- that already, and we don't want an error cascade</span><span>
</span><a name="line-2175"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2176"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Ambiguous occurrence&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002020"><span class="hs-identifier hs-var">rdr_name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2177"></a><span>                  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;It could refer to&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628002024"><span class="hs-identifier hs-var">msg1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628002025"><span class="hs-identifier hs-var">msgs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2178"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2179"></a><span>    </span><span class="hs-special">(</span><a name="local-1628002022"><a href="#local-1628002022"><span class="hs-identifier">np1</span></a></a><span class="hs-glyph">:</span><a name="local-1628002023"><a href="#local-1628002023"><span class="hs-identifier">nps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628002021"><span class="hs-identifier hs-var">gres</span></a><span>
</span><a name="line-2180"></a><span>    </span><a name="local-1628002024"><a href="#local-1628002024"><span class="hs-identifier">msg1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span>  </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;either&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628002026"><span class="hs-identifier hs-var">mk_ref</span></a><span> </span><a href="#local-1628002022"><span class="hs-identifier hs-var">np1</span></a><span>
</span><a name="line-2181"></a><span>    </span><a name="local-1628002025"><a href="#local-1628002025"><span class="hs-identifier">msgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;    or&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628002026"><span class="hs-identifier hs-var">mk_ref</span></a><span> </span><a href="#local-1628002027"><span class="hs-identifier hs-var">np</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628002027"><a href="#local-1628002027"><span class="hs-identifier">np</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628002023"><span class="hs-identifier hs-var">nps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2182"></a><span>    </span><a name="local-1628002026"><a href="#local-1628002026"><span class="hs-identifier">mk_ref</span></a></a><span> </span><a name="local-1628002028"><a href="#local-1628002028"><span class="hs-identifier">gre</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628002029"><span class="hs-identifier hs-var">nom</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a><span> </span><a href="#local-1628002028"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">]</span><span>
</span><a name="line-2183"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-1628002029"><a href="#local-1628002029"><span class="hs-identifier">nom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">gre_par</span><span> </span><a href="#local-1628002028"><span class="hs-identifier hs-var">gre</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2184"></a><span>                    </span><a href="RdrName.html#FldParent"><span class="hs-identifier hs-var">FldParent</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">par_lbl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628002030"><a href="#local-1628002030"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the field&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002030"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">)</span><span>
</span><a name="line-2185"></a><span>                    </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">gre_name</span><span> </span><a href="#local-1628002028"><span class="hs-identifier hs-var">gre</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2186"></a><span>
</span><a name="line-2187"></a><span class="hs-identifier">shadowedNameWarn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2188"></a><a name="shadowedNameWarn"><a href="RnEnv.html#shadowedNameWarn"><span class="hs-identifier">shadowedNameWarn</span></a></a><span> </span><a name="local-1628002031"><a href="#local-1628002031"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1628002032"><a href="#local-1628002032"><span class="hs-identifier">shadowed_locs</span></a></a><span>
</span><a name="line-2189"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;This binding for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002031"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-2190"></a><span>            </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;shadows the existing binding&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628002032"><span class="hs-identifier hs-var">shadowed_locs</span></a><span class="hs-special">,</span><span>
</span><a name="line-2191"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-1628002032"><span class="hs-identifier hs-var">shadowed_locs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span class="hs-identifier">perhapsForallMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2194"></a><a name="perhapsForallMsg"><a href="RnEnv.html#perhapsForallMsg"><span class="hs-identifier">perhapsForallMsg</span></a></a><span>
</span><a name="line-2195"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use ExplicitForAll or similar flag&quot;</span><span>
</span><a name="line-2196"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to enable explicit-forall syntax: forall &lt;tvs&gt;. &lt;type&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2197"></a><span>
</span><a name="line-2198"></a><span class="hs-identifier">unknownSubordinateErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2199"></a><a name="unknownSubordinateErr"><a href="RnEnv.html#unknownSubordinateErr"><span class="hs-identifier">unknownSubordinateErr</span></a></a><span> </span><a name="local-1628002033"><a href="#local-1628002033"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-1628002034"><a href="#local-1628002034"><span class="hs-identifier">op</span></a></a><span>    </span><span class="hs-comment">-- Doc is &quot;method of class&quot; or</span><span>
</span><a name="line-2200"></a><span>                                </span><span class="hs-comment">-- &quot;field of constructor&quot;</span><span>
</span><a name="line-2201"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002034"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not a (visible)&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628002033"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2202"></a><span>
</span><a name="line-2203"></a><span class="hs-identifier">badOrigBinding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2204"></a><a name="badOrigBinding"><a href="RnEnv.html#badOrigBinding"><span class="hs-identifier">badOrigBinding</span></a></a><span> </span><a name="local-1628002035"><a href="#local-1628002035"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-2205"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal binding of built-in syntax:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-1628002035"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2206"></a><span>        </span><span class="hs-comment">-- The rdrNameOcc is because we don't want to print Prelude.(,)</span><span>
</span><a name="line-2207"></a><span>
</span><a name="line-2208"></a><span class="hs-identifier">dupNamesErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1628001427"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628001427"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628001427"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2209"></a><a name="dupNamesErr"><a href="RnEnv.html#dupNamesErr"><span class="hs-identifier">dupNamesErr</span></a></a><span> </span><a name="local-1628002036"><a href="#local-1628002036"><span class="hs-identifier">get_loc</span></a></a><span> </span><a name="local-1628002037"><a href="#local-1628002037"><span class="hs-identifier">names</span></a></a><span>
</span><a name="line-2210"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><a href="#local-1628002039"><span class="hs-identifier hs-var">big_loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2211"></a><span>    </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Conflicting definitions for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span> </span><a href="#local-1628002037"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2212"></a><span>          </span><a href="#local-1628002040"><span class="hs-identifier hs-var">locations</span></a><span class="hs-special">]</span><span>
</span><a name="line-2213"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2214"></a><span>    </span><a name="local-1628002038"><a href="#local-1628002038"><span class="hs-identifier">locs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628002036"><span class="hs-identifier hs-var">get_loc</span></a><span> </span><a href="#local-1628002037"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-2215"></a><span>    </span><a name="local-1628002039"><a href="#local-1628002039"><span class="hs-identifier">big_loc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-1628002038"><span class="hs-identifier hs-var">locs</span></a><span>
</span><a name="line-2216"></a><span>    </span><a name="local-1628002040"><a href="#local-1628002040"><span class="hs-identifier">locations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Bound at:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a><span> </span><a href="#local-1628002038"><span class="hs-identifier hs-var">locs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2217"></a><span>
</span><a name="line-2218"></a><span class="hs-identifier">kindSigErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1628001426"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1628001426"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2219"></a><a name="kindSigErr"><a href="RnEnv.html#kindSigErr"><span class="hs-identifier">kindSigErr</span></a></a><span> </span><a name="local-1628002041"><a href="#local-1628002041"><span class="hs-identifier">thing</span></a></a><span>
</span><a name="line-2220"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind signature for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002041"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2221"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use KindSignatures&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2222"></a><span>
</span><a name="line-2223"></a><span class="hs-identifier">badQualBndrErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2224"></a><a name="badQualBndrErr"><a href="RnEnv.html#badQualBndrErr"><span class="hs-identifier">badQualBndrErr</span></a></a><span> </span><a name="local-1628002042"><a href="#local-1628002042"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-2225"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Qualified name in binding position:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002042"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-2226"></a><span>
</span><a name="line-2227"></a><span class="hs-identifier">opDeclErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2228"></a><a name="opDeclErr"><a href="RnEnv.html#opDeclErr"><span class="hs-identifier">opDeclErr</span></a></a><span> </span><a name="local-1628002043"><a href="#local-1628002043"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-2229"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal declaration of a type or class operator&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002043"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2230"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use TypeOperators to declare operators in type and declarations&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2231"></a><span>
</span><a name="line-2232"></a><span class="hs-identifier">checkTupSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2233"></a><a name="checkTupSize"><a href="RnEnv.html#checkTupSize"><span class="hs-identifier">checkTupSize</span></a></a><span> </span><a name="local-1628002044"><a href="#local-1628002044"><span class="hs-identifier">tup_size</span></a></a><span>
</span><a name="line-2234"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628002044"><span class="hs-identifier hs-var">tup_size</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span>
</span><a name="line-2235"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2236"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2237"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;A&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="#local-1628002044"><span class="hs-identifier hs-var">tup_size</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;-tuple is too large for GHC&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2238"></a><span>                 </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;max size is&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#int"><span class="hs-identifier hs-var">int</span></a><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2239"></a><span>                 </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Workaround: use nested tuples or define a data type&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2240"></a><span>
</span><a name="line-2241"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Contexts for renaming errors}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2248"></a><span>
</span><a name="line-2249"></a><span class="hs-comment">-- AZ:TODO: Change these all to be Name instead of RdrName.</span><span>
</span><a name="line-2250"></a><span class="hs-comment">--          Merge TcType.UserTypeContext in to it.</span><span>
</span><a name="line-2251"></a><span class="hs-keyword">data</span><span> </span><a name="HsDocContext"><a href="RnEnv.html#HsDocContext"><span class="hs-identifier">HsDocContext</span></a></a><span>
</span><a name="line-2252"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TypeSigCtx"><a href="RnEnv.html#TypeSigCtx"><span class="hs-identifier">TypeSigCtx</span></a></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2253"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PatCtx"><a href="RnEnv.html#PatCtx"><span class="hs-identifier">PatCtx</span></a></a><span>
</span><a name="line-2254"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SpecInstSigCtx"><a href="RnEnv.html#SpecInstSigCtx"><span class="hs-identifier">SpecInstSigCtx</span></a></a><span>
</span><a name="line-2255"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DefaultDeclCtx"><a href="RnEnv.html#DefaultDeclCtx"><span class="hs-identifier">DefaultDeclCtx</span></a></a><span>
</span><a name="line-2256"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ForeignDeclCtx"><a href="RnEnv.html#ForeignDeclCtx"><span class="hs-identifier">ForeignDeclCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2257"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DerivDeclCtx"><a href="RnEnv.html#DerivDeclCtx"><span class="hs-identifier">DerivDeclCtx</span></a></a><span>
</span><a name="line-2258"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RuleCtx"><a href="RnEnv.html#RuleCtx"><span class="hs-identifier">RuleCtx</span></a></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-2259"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TyDataCtx"><a href="RnEnv.html#TyDataCtx"><span class="hs-identifier">TyDataCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2260"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TySynCtx"><a href="RnEnv.html#TySynCtx"><span class="hs-identifier">TySynCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2261"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TyFamilyCtx"><a href="RnEnv.html#TyFamilyCtx"><span class="hs-identifier">TyFamilyCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2262"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FamPatCtx"><a href="RnEnv.html#FamPatCtx"><span class="hs-identifier">FamPatCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- The patterns of a type/data family instance</span><span>
</span><a name="line-2263"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ConDeclCtx"><a href="RnEnv.html#ConDeclCtx"><span class="hs-identifier">ConDeclCtx</span></a></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-2264"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClassDeclCtx"><a href="RnEnv.html#ClassDeclCtx"><span class="hs-identifier">ClassDeclCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2265"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ExprWithTySigCtx"><a href="RnEnv.html#ExprWithTySigCtx"><span class="hs-identifier">ExprWithTySigCtx</span></a></a><span>
</span><a name="line-2266"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypBrCtx"><a href="RnEnv.html#TypBrCtx"><span class="hs-identifier">TypBrCtx</span></a></a><span>
</span><a name="line-2267"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HsTypeCtx"><a href="RnEnv.html#HsTypeCtx"><span class="hs-identifier">HsTypeCtx</span></a></a><span>
</span><a name="line-2268"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GHCiCtx"><a href="RnEnv.html#GHCiCtx"><span class="hs-identifier">GHCiCtx</span></a></a><span>
</span><a name="line-2269"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SpliceTypeCtx"><a href="RnEnv.html#SpliceTypeCtx"><span class="hs-identifier">SpliceTypeCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2270"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClassInstanceCtx"><a href="RnEnv.html#ClassInstanceCtx"><span class="hs-identifier">ClassInstanceCtx</span></a></a><span>
</span><a name="line-2271"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VectDeclCtx"><a href="RnEnv.html#VectDeclCtx"><span class="hs-identifier">VectDeclCtx</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2272"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GenericCtx"><a href="RnEnv.html#GenericCtx"><span class="hs-identifier">GenericCtx</span></a></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>   </span><span class="hs-comment">-- Maybe we want to use this more!</span><span>
</span><a name="line-2273"></a><span>
</span><a name="line-2274"></a><span class="hs-identifier">withHsDocContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2275"></a><a name="withHsDocContext"><a href="RnEnv.html#withHsDocContext"><span class="hs-identifier">withHsDocContext</span></a></a><span> </span><a name="local-1628002045"><a href="#local-1628002045"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-1628002046"><a href="#local-1628002046"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628002046"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="RnEnv.html#inHsDocContext"><span class="hs-identifier hs-var">inHsDocContext</span></a><span> </span><a href="#local-1628002045"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-2276"></a><span>
</span><a name="line-2277"></a><span class="hs-identifier">inHsDocContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2278"></a><a name="inHsDocContext"><a href="RnEnv.html#inHsDocContext"><span class="hs-identifier">inHsDocContext</span></a></a><span> </span><a name="local-1628002047"><a href="#local-1628002047"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-1628002047"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-2279"></a><span>
</span><a name="line-2280"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnEnv.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2281"></a><a name="pprHsDocContext"><a href="RnEnv.html#pprHsDocContext"><span class="hs-identifier">pprHsDocContext</span></a></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#GenericCtx"><span class="hs-identifier hs-var">GenericCtx</span></a><span> </span><a name="local-1628002048"><a href="#local-1628002048"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628002048"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2282"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#TypeSigCtx"><span class="hs-identifier hs-var">TypeSigCtx</span></a><span> </span><a name="local-1628002049"><a href="#local-1628002049"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the type signature for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-1628002049"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2283"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#PatCtx"><span class="hs-identifier hs-var">PatCtx</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a pattern type-signature&quot;</span><span>
</span><a name="line-2284"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#SpecInstSigCtx"><span class="hs-identifier hs-var">SpecInstSigCtx</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a SPECIALISE instance pragma&quot;</span><span>
</span><a name="line-2285"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#DefaultDeclCtx"><span class="hs-identifier hs-var">DefaultDeclCtx</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a `default' declaration&quot;</span><span>
</span><a name="line-2286"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#DerivDeclCtx"><span class="hs-identifier hs-var">DerivDeclCtx</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a deriving declaration&quot;</span><span>
</span><a name="line-2287"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#RuleCtx"><span class="hs-identifier hs-var">RuleCtx</span></a><span> </span><a name="local-1628002050"><a href="#local-1628002050"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the transformation rule&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-1628002050"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2288"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#TyDataCtx"><span class="hs-identifier hs-var">TyDataCtx</span></a><span> </span><a name="local-1628002051"><a href="#local-1628002051"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the data type declaration for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002051"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2289"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#FamPatCtx"><span class="hs-identifier hs-var">FamPatCtx</span></a><span> </span><a name="local-1628002052"><a href="#local-1628002052"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a type pattern of family instance for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002052"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2290"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#TySynCtx"><span class="hs-identifier hs-var">TySynCtx</span></a><span> </span><a name="local-1628002053"><a href="#local-1628002053"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the declaration for type synonym&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002053"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2291"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#TyFamilyCtx"><span class="hs-identifier hs-var">TyFamilyCtx</span></a><span> </span><a name="local-1628002054"><a href="#local-1628002054"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the declaration for type family&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002054"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2292"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#ClassDeclCtx"><span class="hs-identifier hs-var">ClassDeclCtx</span></a><span> </span><a name="local-1628002055"><a href="#local-1628002055"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the declaration for class&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002055"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2293"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;an expression type signature&quot;</span><span>
</span><a name="line-2294"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#TypBrCtx"><span class="hs-identifier hs-var">TypBrCtx</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a Template-Haskell quoted type&quot;</span><span>
</span><a name="line-2295"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#HsTypeCtx"><span class="hs-identifier hs-var">HsTypeCtx</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;a type argument&quot;</span><span>
</span><a name="line-2296"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#GHCiCtx"><span class="hs-identifier hs-var">GHCiCtx</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;GHCi input&quot;</span><span>
</span><a name="line-2297"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#SpliceTypeCtx"><span class="hs-identifier hs-var">SpliceTypeCtx</span></a><span> </span><a name="local-1628002056"><a href="#local-1628002056"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the spliced type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002056"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2298"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><a href="RnEnv.html#ClassInstanceCtx"><span class="hs-identifier hs-var">ClassInstanceCtx</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TcSplice.reifyInstances&quot;</span><span>
</span><a name="line-2299"></a><span>
</span><a name="line-2300"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#ForeignDeclCtx"><span class="hs-identifier hs-var">ForeignDeclCtx</span></a><span> </span><a name="local-1628002057"><a href="#local-1628002057"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2301"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the foreign declaration for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002057"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2302"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a><span> </span><span class="hs-special">[</span><a name="local-1628002058"><a href="#local-1628002058"><span class="hs-identifier">name</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2303"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the definition of data constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002058"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2304"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a><span> </span><a name="local-1628002059"><a href="#local-1628002059"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2305"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the definition of data constructors&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#interpp%27SP"><span class="hs-identifier hs-var">interpp'SP</span></a><span> </span><a href="#local-1628002059"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-2306"></a><span class="hs-identifier">pprHsDocContext</span><span> </span><span class="hs-special">(</span><a href="RnEnv.html#VectDeclCtx"><span class="hs-identifier hs-var">VectDeclCtx</span></a><span> </span><a name="local-1628002060"><a href="#local-1628002060"><span class="hs-identifier">tycon</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2307"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;the VECTORISE pragma for type constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628002060"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2308"></a></pre></body></html>