<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2002-2006</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE CPP, RankNTypes #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IfaceEnv</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-6"></a><span>        </span><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#newInteractiveBinder"><span class="hs-identifier hs-var">newInteractiveBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-7"></a><span>        </span><a href="IfaceEnv.html#externaliseName"><span class="hs-identifier hs-var">externaliseName</span></a><span class="hs-special">,</span><span>
</span><a name="line-8"></a><span>        </span><a href="IfaceEnv.html#lookupIfaceTop"><span class="hs-identifier hs-var">lookupIfaceTop</span></a><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>        </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#lookupOrigNameCache"><span class="hs-identifier hs-var">lookupOrigNameCache</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>        </span><a href="IfaceEnv.html#newIfaceName"><span class="hs-identifier hs-var">newIfaceName</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#newIfaceNames"><span class="hs-identifier hs-var">newIfaceNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>        </span><a href="IfaceEnv.html#extendIfaceIdEnv"><span class="hs-identifier hs-var">extendIfaceIdEnv</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#extendIfaceTyVarEnv"><span class="hs-identifier hs-var">extendIfaceTyVarEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>        </span><a href="IfaceEnv.html#tcIfaceLclId"><span class="hs-identifier hs-var">tcIfaceLclId</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#tcIfaceTyVar"><span class="hs-identifier hs-var">tcIfaceTyVar</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#lookupIfaceVar"><span class="hs-identifier hs-var">lookupIfaceVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="IfaceEnv.html#lookupIfaceTyVar"><span class="hs-identifier hs-var">lookupIfaceTyVar</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#extendIfaceEnvs"><span class="hs-identifier hs-var">extendIfaceEnvs</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span>        </span><a href="IfaceEnv.html#ifaceExportNames"><span class="hs-identifier hs-var">ifaceExportNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>        </span><span class="hs-comment">-- Name-cache stuff</span><span>
</span><a name="line-18"></a><span>        </span><a href="IfaceEnv.html#allocateGlobalBinder"><span class="hs-identifier hs-var">allocateGlobalBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="IfaceEnv.html#initNameCache"><span class="hs-identifier hs-var">initNameCache</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="IfaceEnv.html#mkNameCacheUpdater"><span class="hs-identifier hs-var">mkNameCacheUpdater</span></a><span class="hs-special">,</span><span> </span><a href="IfaceEnv.html#NameCacheUpdater"><span class="hs-identifier hs-type">NameCacheUpdater</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Avail.html"><span class="hs-identifier">Avail</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="UniqFM.html"><span class="hs-identifier">UniqFM</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="IfaceType.html"><span class="hs-identifier">IfaceType</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>     </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">{-
*********************************************************
*                                                      *
        Allocating new Names in the Name Cache
*                                                      *
*********************************************************

Note [The Name Cache]
~~~~~~~~~~~~~~~~~~~~~
The Name Cache makes sure that, during any invocation of GHC, each
External Name &quot;M.x&quot; has one, and only one globally-agreed Unique.

* The first time we come across M.x we make up a Unique and record that
  association in the Name Cache.

* When we come across &quot;M.x&quot; again, we look it up in the Name Cache,
  and get a hit.

The functions newGlobalBinder, allocateGlobalBinder do the main work.
When you make an External name, you should probably be calling one
of them.
-}</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-identifier">newGlobalBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988394"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627988395"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- Used for source code and interface files, to make the</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- Name for a thing, given its Module and OccName</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- See Note [The Name Cache]</span><span>
</span><a name="line-70"></a><span class="hs-comment">--</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- The cache may already already have a binding for this thing,</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- because we may have seen an occurrence before, but now is the</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- moment when we know its Module and SrcLoc in their full glory</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><a name="newGlobalBinder"><a href="IfaceEnv.html#newGlobalBinder"><span class="hs-identifier">newGlobalBinder</span></a></a><span> </span><a name="local-1627988396"><a href="#local-1627988396"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988397"><a href="#local-1627988397"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627988398"><a href="#local-1627988398"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="#local-1627988396"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-1627988397"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- See notes with lookupOrig</span><span>
</span><a name="line-77"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1627988400"><a href="#local-1627988400"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IfaceEnv.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627988399"><a href="#local-1627988399"><span class="hs-identifier">name_cache</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-78"></a><span>                 </span><a href="IfaceEnv.html#allocateGlobalBinder"><span class="hs-identifier hs-var">allocateGlobalBinder</span></a><span> </span><a href="#local-1627988399"><span class="hs-identifier hs-var">name_cache</span></a><span> </span><a href="#local-1627988396"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988397"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988398"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-79"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceIf"><span class="hs-identifier hs-var">traceIf</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;newGlobalBinder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-80"></a><span>                  </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988396"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988397"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988398"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988400"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627988400"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">newInteractiveBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- Works in the IO monad, and gets the Module</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- from the interactive context</span><span>
</span><a name="line-86"></a><a name="newInteractiveBinder"><a href="IfaceEnv.html#newInteractiveBinder"><span class="hs-identifier">newInteractiveBinder</span></a></a><span> </span><a name="local-1627988401"><a href="#local-1627988401"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-1627988402"><a href="#local-1627988402"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627988403"><a href="#local-1627988403"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-87"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627988404"><a href="#local-1627988404"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HscTypes.html#icInteractiveModule"><span class="hs-identifier hs-var">icInteractiveModule</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsc_IC</span><span> </span><a href="#local-1627988401"><span class="hs-identifier hs-var">hsc_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="HscTypes.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a><span> </span><a href="#local-1627988401"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627988405"><a href="#local-1627988405"><span class="hs-identifier">name_cache</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-89"></a><span>         </span><a href="IfaceEnv.html#allocateGlobalBinder"><span class="hs-identifier hs-var">allocateGlobalBinder</span></a><span> </span><a href="#local-1627988405"><span class="hs-identifier hs-var">name_cache</span></a><span> </span><a href="#local-1627988404"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988402"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988403"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-identifier">allocateGlobalBinder</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-94"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- See Note [The Name Cache]</span><span>
</span><a name="line-96"></a><a name="allocateGlobalBinder"><a href="IfaceEnv.html#allocateGlobalBinder"><span class="hs-identifier">allocateGlobalBinder</span></a></a><span> </span><a name="local-1627988406"><a href="#local-1627988406"><span class="hs-identifier">name_supply</span></a></a><span> </span><a name="local-1627988407"><a href="#local-1627988407"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988408"><a href="#local-1627988408"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627988409"><a href="#local-1627988409"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="IfaceEnv.html#lookupOrigNameCache"><span class="hs-identifier hs-var">lookupOrigNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988407"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988408"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-98"></a><span>        </span><span class="hs-comment">-- A hit in the cache!  We are at the binding site of the name.</span><span>
</span><a name="line-99"></a><span>        </span><span class="hs-comment">-- This is the moment when we know the SrcLoc</span><span>
</span><a name="line-100"></a><span>        </span><span class="hs-comment">-- of the Name, so we set this field in the Name we return.</span><span>
</span><a name="line-101"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-102"></a><span>        </span><span class="hs-comment">-- Then (bogus) multiple bindings of the same Name</span><span>
</span><a name="line-103"></a><span>        </span><span class="hs-comment">-- get different SrcLocs can can be reported as such.</span><span>
</span><a name="line-104"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-105"></a><span>        </span><span class="hs-comment">-- Possible other reason: it might be in the cache because we</span><span>
</span><a name="line-106"></a><span>        </span><span class="hs-comment">--      encountered an occurrence before the binding site for an</span><span>
</span><a name="line-107"></a><span>        </span><span class="hs-comment">--      implicitly-imported Name.  Perhaps the current SrcLoc is</span><span>
</span><a name="line-108"></a><span>        </span><span class="hs-comment">--      better... but not really: it'll still just say 'imported'</span><span>
</span><a name="line-109"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-110"></a><span>        </span><span class="hs-comment">-- IMPORTANT: Don't mess with wired-in names.</span><span>
</span><a name="line-111"></a><span>        </span><span class="hs-comment">--            Their wired-in-ness is in their NameSort</span><span>
</span><a name="line-112"></a><span>        </span><span class="hs-comment">--            and their Module is correct.</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988410"><a href="#local-1627988410"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a><span> </span><a href="#local-1627988410"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-115"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988410"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-117"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627988414"><span class="hs-identifier hs-var">new_name_supply</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988412"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>                  </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>                    </span><a name="local-1627988411"><a href="#local-1627988411"><span class="hs-identifier">uniq</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-1627988410"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-120"></a><span>                    </span><a name="local-1627988412"><a href="#local-1627988412"><span class="hs-identifier">name'</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span> </span><a href="#local-1627988411"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988407"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988408"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988409"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-121"></a><span>                                      </span><span class="hs-comment">-- name' is like name, but with the right SrcSpan</span><span>
</span><a name="line-122"></a><span>                    </span><a name="local-1627988413"><a href="#local-1627988413"><span class="hs-identifier">new_cache</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988407"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988408"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988412"><span class="hs-identifier hs-var">name'</span></a><span>
</span><a name="line-123"></a><span>                    </span><a name="local-1627988414"><a href="#local-1627988414"><span class="hs-identifier">new_name_supply</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">nsNames</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988413"><span class="hs-identifier hs-var">new_cache</span></a><span class="hs-special">}</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>        </span><span class="hs-comment">-- Miss in the cache!</span><span>
</span><a name="line-126"></a><span>        </span><span class="hs-comment">-- Build a completely new Name, and put it in the cache</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627988419"><span class="hs-identifier hs-var">new_name_supply</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988417"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>                  </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>                    </span><span class="hs-special">(</span><a name="local-1627988415"><a href="#local-1627988415"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627988416"><a href="#local-1627988416"><span class="hs-identifier">us'</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="UniqSupply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsUniqs</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>                    </span><a name="local-1627988417"><a href="#local-1627988417"><span class="hs-identifier">name</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span> </span><a href="#local-1627988415"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988407"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988408"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988409"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-131"></a><span>                    </span><a name="local-1627988418"><a href="#local-1627988418"><span class="hs-identifier">new_cache</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988407"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988408"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988417"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-132"></a><span>                    </span><a name="local-1627988419"><a href="#local-1627988419"><span class="hs-identifier">new_name_supply</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988406"><span class="hs-identifier hs-var">name_supply</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">nsUniqs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988416"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">nsNames</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988418"><span class="hs-identifier hs-var">new_cache</span></a><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-identifier">ifaceExportNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HscTypes.html#IfaceExport"><span class="hs-identifier hs-type">IfaceExport</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988392"><span class="hs-identifier hs-type">gbl</span></a><span> </span><a href="#local-1627988393"><span class="hs-identifier hs-type">lcl</span></a><span> </span><span class="hs-special">[</span><a href="Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a><span class="hs-special">]</span><span>
</span><a name="line-135"></a><a name="ifaceExportNames"><a href="IfaceEnv.html#ifaceExportNames"><span class="hs-identifier">ifaceExportNames</span></a></a><span> </span><a name="local-1627988420"><a href="#local-1627988420"><span class="hs-identifier">exports</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627988420"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Look up the 'Name' for a given 'Module' and 'OccName'.</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- Consider alternately using 'lookupIfaceTop' if you're in the 'IfL' monad</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- and 'Module' is simply that of the 'ModIface' you are typechecking.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">lookupOrig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988390"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627988391"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-141"></a><a name="lookupOrig"><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier">lookupOrig</span></a></a><span> </span><a name="local-1627988421"><a href="#local-1627988421"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988422"><a href="#local-1627988422"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-142"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span>       </span><span class="hs-comment">-- First ensure that mod and occ are evaluated</span><span>
</span><a name="line-143"></a><span>                </span><span class="hs-comment">-- If not, chaos can ensue:</span><span>
</span><a name="line-144"></a><span>                </span><span class="hs-comment">--      we read the name-cache</span><span>
</span><a name="line-145"></a><span>                </span><span class="hs-comment">--      then pull on mod (say)</span><span>
</span><a name="line-146"></a><span>                </span><span class="hs-comment">--      which does some stuff that modifies the name cache</span><span>
</span><a name="line-147"></a><span>                </span><span class="hs-comment">-- This did happen, with tycon_mod in TcIface.tcIfaceAlt (DataAlt..)</span><span>
</span><a name="line-148"></a><span>          </span><a href="#local-1627988421"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-1627988422"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span class="hs-comment">--      ; traceIf (text &quot;lookup_orig&quot; &lt;+&gt; ppr mod &lt;+&gt; ppr occ)</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627988423"><a href="#local-1627988423"><span class="hs-identifier">name_cache</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-152"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="IfaceEnv.html#lookupOrigNameCache"><span class="hs-identifier hs-var">lookupOrigNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988423"><span class="hs-identifier hs-var">name_cache</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988421"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988422"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-153"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988424"><a href="#local-1627988424"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627988423"><span class="hs-identifier hs-var">name_cache</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988424"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-154"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-155"></a><span>              </span><span class="hs-keyword">case</span><span> </span><a href="UniqSupply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsUniqs</span><span> </span><a href="#local-1627988423"><span class="hs-identifier hs-var">name_cache</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-156"></a><span>              </span><span class="hs-special">(</span><a name="local-1627988425"><a href="#local-1627988425"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627988426"><a href="#local-1627988426"><span class="hs-identifier">us</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-157"></a><span>                  </span><span class="hs-keyword">let</span><span>
</span><a name="line-158"></a><span>                    </span><a name="local-1627988427"><a href="#local-1627988427"><span class="hs-identifier">name</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span> </span><a href="#local-1627988425"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988421"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988422"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-159"></a><span>                    </span><a name="local-1627988428"><a href="#local-1627988428"><span class="hs-identifier">new_cache</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988423"><span class="hs-identifier hs-var">name_cache</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988421"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988422"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988427"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-160"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627988423"><span class="hs-identifier hs-var">name_cache</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">nsUniqs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988426"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">nsNames</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988428"><span class="hs-identifier hs-var">new_cache</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="#local-1627988427"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-identifier">externaliseName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988388"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-1627988389"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- Take an Internal Name and make it an External one,</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- with the same unique</span><span>
</span><a name="line-166"></a><a name="externaliseName"><a href="IfaceEnv.html#externaliseName"><span class="hs-identifier">externaliseName</span></a></a><span> </span><a name="local-1627988429"><a href="#local-1627988429"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988430"><a href="#local-1627988430"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627988431"><a href="#local-1627988431"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1627988430"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-168"></a><span>             </span><a name="local-1627988432"><a href="#local-1627988432"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-1627988430"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-169"></a><span>             </span><a name="local-1627988433"><a href="#local-1627988433"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-1627988430"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-170"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-1627988431"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- c.f. seq in newGlobalBinder</span><span>
</span><a name="line-171"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1627988434"><a href="#local-1627988434"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-172"></a><span>         </span><span class="hs-keyword">let</span><span> </span><a name="local-1627988435"><a href="#local-1627988435"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span> </span><a href="#local-1627988433"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988429"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988431"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988432"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-173"></a><span>             </span><a name="local-1627988436"><a href="#local-1627988436"><span class="hs-identifier">ns'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988434"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nsNames</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">nsNames</span><span> </span><a href="#local-1627988434"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988429"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-1627988431"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988435"><span class="hs-identifier hs-var">name'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-174"></a><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627988436"><span class="hs-identifier hs-var">ns'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988435"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Name cache access
*                                                                      *
************************************************************************

See Note [The Name Cache] above.

Note [Built-in syntax and the OrigNameCache]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You might think that usin isBuiltInOcc_maybe in lookupOrigNameCache is
unnecessary because tuple TyCon/DataCons are parsed as Exact RdrNames
and *don't* appear as original names in interface files (because
serialization gives them special treatment), so we will never look
them up in the original name cache.

However, there are two reasons why we might look up an Orig RdrName:

  * If you use setRdrNameSpace on an Exact RdrName it may be
    turned into an Orig RdrName.

  * Template Haskell turns a BuiltInSyntax Name into a TH.NameG
    (DsMeta.globalVar), and parses a NameG into an Orig RdrName
    (Convert.thRdrName).  So, eg $(do { reify '(,); ... }) will
    go this route (Trac #8954).
-}</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-identifier">lookupOrigNameCache</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-205"></a><a name="lookupOrigNameCache"><a href="IfaceEnv.html#lookupOrigNameCache"><span class="hs-identifier">lookupOrigNameCache</span></a></a><span> </span><a name="local-1627988437"><a href="#local-1627988437"><span class="hs-identifier">nc</span></a></a><span> </span><a name="local-1627988438"><a href="#local-1627988438"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988439"><a href="#local-1627988439"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988440"><a href="#local-1627988440"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TysWiredIn.html#isBuiltInOcc_maybe"><span class="hs-identifier hs-var">isBuiltInOcc_maybe</span></a><span> </span><a href="#local-1627988439"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- See Note [Known-key names], 3(c) in PrelNames</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-comment">-- Special case for tuples; there are too many</span><span>
</span><a name="line-209"></a><span>        </span><span class="hs-comment">-- of them to pre-populate the original-name cache</span><span>
</span><a name="line-210"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627988440"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-213"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Module.html#lookupModuleEnv"><span class="hs-identifier hs-var">lookupModuleEnv</span></a><span> </span><a href="#local-1627988437"><span class="hs-identifier hs-var">nc</span></a><span> </span><a href="#local-1627988438"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-214"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-215"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988441"><a href="#local-1627988441"><span class="hs-identifier">occ_env</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#lookupOccEnv"><span class="hs-identifier hs-var">lookupOccEnv</span></a><span> </span><a href="#local-1627988441"><span class="hs-identifier hs-var">occ_env</span></a><span> </span><a href="#local-1627988439"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">extendOrigNameCache</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span>
</span><a name="line-218"></a><a name="extendOrigNameCache"><a href="IfaceEnv.html#extendOrigNameCache"><span class="hs-identifier">extendOrigNameCache</span></a></a><span> </span><a name="local-1627988442"><a href="#local-1627988442"><span class="hs-identifier">nc</span></a></a><span> </span><a name="local-1627988443"><a href="#local-1627988443"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-219"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isExternalName</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>    </span><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a><span> </span><a href="#local-1627988442"><span class="hs-identifier hs-var">nc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-1627988443"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1627988443"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988443"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-identifier">extendNameCache</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span>
</span><a name="line-223"></a><a name="extendNameCache"><a href="IfaceEnv.html#extendNameCache"><span class="hs-identifier">extendNameCache</span></a></a><span> </span><a name="local-1627988444"><a href="#local-1627988444"><span class="hs-identifier">nc</span></a></a><span> </span><a name="local-1627988445"><a href="#local-1627988445"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-1627988446"><a href="#local-1627988446"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-1627988447"><a href="#local-1627988447"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-224"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#extendModuleEnvWith"><span class="hs-identifier hs-var">extendModuleEnvWith</span></a><span> </span><a href="#local-1627988448"><span class="hs-identifier hs-var">combine</span></a><span> </span><a href="#local-1627988444"><span class="hs-identifier hs-var">nc</span></a><span> </span><a href="#local-1627988445"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#unitOccEnv"><span class="hs-identifier hs-var">unitOccEnv</span></a><span> </span><a href="#local-1627988446"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988447"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-226"></a><span>    </span><a name="local-1627988448"><a href="#local-1627988448"><span class="hs-identifier">combine</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627988449"><a href="#local-1627988449"><span class="hs-identifier">occ_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#extendOccEnv"><span class="hs-identifier hs-var">extendOccEnv</span></a><span> </span><a href="#local-1627988449"><span class="hs-identifier hs-var">occ_env</span></a><span> </span><a href="#local-1627988446"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="#local-1627988447"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">updNameCache</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988385"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988386"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627988387"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627988385"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-229"></a><a name="updNameCache"><a href="IfaceEnv.html#updNameCache"><span class="hs-identifier">updNameCache</span></a></a><span> </span><a name="local-1627988450"><a href="#local-1627988450"><span class="hs-identifier">upd_fn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627988451"><a href="#local-1627988451"><span class="hs-identifier">hsc_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a><span>
</span><a name="line-230"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HscTypes.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a><span> </span><a href="#local-1627988451"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="#local-1627988450"><span class="hs-identifier hs-var">upd_fn</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- | A function that atomically updates the name cache given a modifier</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- function.  The second result of the modifier function will be the result</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- of the IO action.</span><span>
</span><a name="line-235"></a><span class="hs-keyword">newtype</span><span> </span><a name="NameCacheUpdater"><a href="IfaceEnv.html#NameCacheUpdater"><span class="hs-identifier">NameCacheUpdater</span></a></a><span>
</span><a name="line-236"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a name="NCU"><a href="IfaceEnv.html#NCU"><span class="hs-identifier">NCU</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="updateNameCache"><a href="IfaceEnv.html#updateNameCache"><span class="hs-identifier">updateNameCache</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627988379"><a href="#local-1627988379"><span class="hs-identifier">c</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627988379"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-1627988379"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | Return a function to atomically update the name cache.</span><span>
</span><a name="line-239"></a><span class="hs-identifier">mkNameCacheUpdater</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a><span> </span><a href="#local-1627988383"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627988384"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="IfaceEnv.html#NameCacheUpdater"><span class="hs-identifier hs-type">NameCacheUpdater</span></a><span>
</span><a name="line-240"></a><a name="mkNameCacheUpdater"><a href="IfaceEnv.html#mkNameCacheUpdater"><span class="hs-identifier">mkNameCacheUpdater</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627988452"><a href="#local-1627988452"><span class="hs-identifier">hsc_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a><span>
</span><a name="line-241"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="IfaceEnv.html#NCU"><span class="hs-identifier hs-var">NCU</span></a><span> </span><span class="hs-special">(</span><a href="HscTypes.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a><span> </span><a href="#local-1627988452"><span class="hs-identifier hs-var">hsc_env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-identifier">initNameCache</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UniqSupply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a><span>
</span><a name="line-244"></a><a name="initNameCache"><a href="IfaceEnv.html#initNameCache"><span class="hs-identifier">initNameCache</span></a></a><span> </span><a name="local-1627988453"><a href="#local-1627988453"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-1627988454"><a href="#local-1627988454"><span class="hs-identifier">names</span></a></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HscTypes.html#NameCache"><span class="hs-identifier hs-var">NameCache</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nsUniqs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988453"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span>
</span><a name="line-246"></a><span>                </span><span class="hs-identifier">nsNames</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#initOrigNames"><span class="hs-identifier hs-var">initOrigNames</span></a><span> </span><a href="#local-1627988454"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-identifier">initOrigNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HscTypes.html#OrigNameCache"><span class="hs-identifier hs-type">OrigNameCache</span></a><span>
</span><a name="line-249"></a><a name="initOrigNames"><a href="IfaceEnv.html#initOrigNames"><span class="hs-identifier">initOrigNames</span></a></a><span> </span><a name="local-1627988455"><a href="#local-1627988455"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="IfaceEnv.html#extendOrigNameCache"><span class="hs-identifier hs-var">extendOrigNameCache</span></a><span> </span><a href="Module.html#emptyModuleEnv"><span class="hs-identifier hs-var">emptyModuleEnv</span></a><span> </span><a href="#local-1627988455"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type variables and local Ids
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">tcIfaceLclId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-260"></a><a name="tcIfaceLclId"><a href="IfaceEnv.html#tcIfaceLclId"><span class="hs-identifier">tcIfaceLclId</span></a></a><span> </span><a name="local-1627988456"><a href="#local-1627988456"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988457"><a href="#local-1627988457"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-262"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_id_env</span><span> </span><a href="#local-1627988457"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988456"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-263"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988458"><a href="#local-1627988458"><span class="hs-identifier">ty_var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627988458"><span class="hs-identifier hs-var">ty_var</span></a><span>
</span><a name="line-264"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#failIfM"><span class="hs-identifier hs-var">failIfM</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Iface id out of scope: &quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988456"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-identifier">extendIfaceIdEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988382"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988382"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-268"></a><a name="extendIfaceIdEnv"><a href="IfaceEnv.html#extendIfaceIdEnv"><span class="hs-identifier">extendIfaceIdEnv</span></a></a><span> </span><a name="local-1627988459"><a href="#local-1627988459"><span class="hs-identifier">ids</span></a></a><span> </span><a name="local-1627988460"><a href="#local-1627988460"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988461"><a href="#local-1627988461"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-270"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627988462"><a href="#local-1627988462"><span class="hs-identifier">id_env'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#addListToUFM"><span class="hs-identifier hs-var">addListToUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_id_env</span><span> </span><a href="#local-1627988461"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988463"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-271"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-1627988463"><a href="#local-1627988463"><span class="hs-identifier">pairs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1627988464"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627988464"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1627988464"><a href="#local-1627988464"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627988459"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627988461"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">if_id_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988462"><span class="hs-identifier hs-var">id_env'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1627988460"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">tcIfaceTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-276"></a><a name="tcIfaceTyVar"><a href="IfaceEnv.html#tcIfaceTyVar"><span class="hs-identifier">tcIfaceTyVar</span></a></a><span> </span><a name="local-1627988465"><a href="#local-1627988465"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988466"><a href="#local-1627988466"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-278"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_tv_env</span><span> </span><a href="#local-1627988466"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988465"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-279"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627988467"><a href="#local-1627988467"><span class="hs-identifier">ty_var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627988467"><span class="hs-identifier hs-var">ty_var</span></a><span>
</span><a name="line-280"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnMonad.html#failIfM"><span class="hs-identifier hs-var">failIfM</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Iface type variable out of scope: &quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627988465"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">lookupIfaceTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IfaceType.html#IfaceTvBndr"><span class="hs-identifier hs-type">IfaceTvBndr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><a name="lookupIfaceTyVar"><a href="IfaceEnv.html#lookupIfaceTyVar"><span class="hs-identifier">lookupIfaceTyVar</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627988468"><a href="#local-1627988468"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988469"><a href="#local-1627988469"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-286"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_tv_env</span><span> </span><a href="#local-1627988469"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988468"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-identifier">lookupIfaceVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IfaceType.html#IfaceBndr"><span class="hs-identifier hs-type">IfaceBndr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><a name="lookupIfaceVar"><a href="IfaceEnv.html#lookupIfaceVar"><span class="hs-identifier">lookupIfaceVar</span></a></a><span> </span><span class="hs-special">(</span><a href="IfaceType.html#IfaceIdBndr"><span class="hs-identifier hs-var">IfaceIdBndr</span></a><span> </span><span class="hs-special">(</span><a name="local-1627988470"><a href="#local-1627988470"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988471"><a href="#local-1627988471"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-291"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_id_env</span><span> </span><a href="#local-1627988471"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988470"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-292"></a><span class="hs-identifier">lookupIfaceVar</span><span> </span><span class="hs-special">(</span><a href="IfaceType.html#IfaceTvBndr"><span class="hs-identifier hs-var">IfaceTvBndr</span></a><span> </span><span class="hs-special">(</span><a name="local-1627988472"><a href="#local-1627988472"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988473"><a href="#local-1627988473"><span class="hs-identifier">lcl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-294"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_tv_env</span><span> </span><a href="#local-1627988473"><span class="hs-identifier hs-var">lcl</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988472"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-identifier">extendIfaceTyVarEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988381"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-297"></a><a name="extendIfaceTyVarEnv"><a href="IfaceEnv.html#extendIfaceTyVarEnv"><span class="hs-identifier">extendIfaceTyVarEnv</span></a></a><span> </span><a name="local-1627988474"><a href="#local-1627988474"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-1627988475"><a href="#local-1627988475"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-298"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988476"><a href="#local-1627988476"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span>
</span><a name="line-299"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627988477"><a href="#local-1627988477"><span class="hs-identifier">tv_env'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#addListToUFM"><span class="hs-identifier hs-var">addListToUFM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_tv_env</span><span> </span><a href="#local-1627988476"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988478"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-300"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-1627988478"><a href="#local-1627988478"><span class="hs-identifier">pairs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-1627988479"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1627988479"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1627988479"><a href="#local-1627988479"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627988474"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-301"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627988476"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">if_tv_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627988477"><span class="hs-identifier hs-var">tv_env'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-1627988475"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">extendIfaceEnvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988380"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="#local-1627988380"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-304"></a><a name="extendIfaceEnvs"><a href="IfaceEnv.html#extendIfaceEnvs"><span class="hs-identifier">extendIfaceEnvs</span></a></a><span> </span><a name="local-1627988480"><a href="#local-1627988480"><span class="hs-identifier">tcvs</span></a></a><span> </span><a name="local-1627988481"><a href="#local-1627988481"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-305"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="IfaceEnv.html#extendIfaceTyVarEnv"><span class="hs-identifier hs-var">extendIfaceTyVarEnv</span></a><span> </span><a href="#local-1627988482"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-306"></a><span>    </span><a href="IfaceEnv.html#extendIfaceIdEnv"><span class="hs-identifier hs-var">extendIfaceIdEnv</span></a><span>    </span><a href="#local-1627988483"><span class="hs-identifier hs-var">cvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-307"></a><span>    </span><a href="#local-1627988481"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-308"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-309"></a><span>    </span><span class="hs-special">(</span><a name="local-1627988482"><a href="#local-1627988482"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627988483"><a href="#local-1627988483"><span class="hs-identifier">cvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1627988480"><span class="hs-identifier hs-var">tcvs</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Getting from RdrNames to Names
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-identifier">lookupIfaceTop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-320"></a><span class="hs-comment">-- Look up a top-level name from the current Iface module</span><span>
</span><a name="line-321"></a><a name="lookupIfaceTop"><a href="IfaceEnv.html#lookupIfaceTop"><span class="hs-identifier">lookupIfaceTop</span></a></a><span> </span><a name="local-1627988484"><a href="#local-1627988484"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-322"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988485"><a href="#local-1627988485"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a><span class="hs-special">;</span><span> </span><a href="IfaceEnv.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">if_mod</span><span> </span><a href="#local-1627988485"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627988484"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">newIfaceName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-325"></a><a name="newIfaceName"><a href="IfaceEnv.html#newIfaceName"><span class="hs-identifier">newIfaceName</span></a></a><span> </span><a name="local-1627988486"><a href="#local-1627988486"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988487"><a href="#local-1627988487"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-327"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1627988487"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988486"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">newIfaceNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#IfL"><span class="hs-identifier hs-type">IfL</span></a><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-330"></a><a name="newIfaceNames"><a href="IfaceEnv.html#newIfaceNames"><span class="hs-identifier">newIfaceNames</span></a></a><span> </span><a name="local-1627988488"><a href="#local-1627988488"><span class="hs-identifier">occs</span></a></a><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1627988489"><a href="#local-1627988489"><span class="hs-identifier">uniqs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUniqueSupply"><span class="hs-identifier hs-var">newUniqueSupply</span></a><span>
</span><a name="line-332"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1627988491"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627988490"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-333"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1627988490"><a href="#local-1627988490"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><a name="local-1627988491"><a href="#local-1627988491"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627988488"><span class="hs-identifier hs-var">occs</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">`</span><span> </span><a href="UniqSupply.html#uniqsFromSupply"><span class="hs-identifier hs-var">uniqsFromSupply</span></a><span> </span><a href="#local-1627988489"><span class="hs-identifier hs-var">uniqs</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-334"></a></pre></body></html>