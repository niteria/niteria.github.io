<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The AQUA Project, Glasgow University, 1996-1998


TcHsSyn: Specialisations of the @HsSyn@ syntax for the typechecker

This module is an extension of @HsSyn@ syntax, for use in the type
checker.
-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE CPP, TupleSections #-}</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcHsSyn</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>        </span><a href="HsUtils.html#mkHsConApp"><span class="hs-identifier hs-var">mkHsConApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier hs-var">mkHsDictLet</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsApp"><span class="hs-identifier hs-var">mkHsApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="HsTypes.html#mkHsAppTy"><span class="hs-identifier hs-var">mkHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier hs-var">shortCutLit</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsOverLitName"><span class="hs-identifier hs-var">hsOverLitName</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>        </span><span class="hs-comment">-- * re-exported from TcMonad</span><span>
</span><a name="line-23"></a><span>        </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcIdSet"><span class="hs-identifier hs-type">TcIdSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">-- * Zonking</span><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- | For a description of &quot;zonking&quot;, see Note [What is zonking?]</span><span>
</span><a name="line-27"></a><span>        </span><span class="hs-comment">-- in TcMType</span><span>
</span><a name="line-28"></a><span>        </span><a href="TcHsSyn.html#zonkTopDecls"><span class="hs-identifier hs-var">zonkTopDecls</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTopExpr"><span class="hs-identifier hs-var">zonkTopExpr</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTopLExpr"><span class="hs-identifier hs-var">zonkTopLExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="TcHsSyn.html#zonkTopBndrs"><span class="hs-identifier hs-var">zonkTopBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyBinders"><span class="hs-identifier hs-var">zonkTyBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>        </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier hs-var">zonkTyVarOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#zonkTcKindToKind"><span class="hs-identifier hs-var">zonkTcKindToKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>        </span><span class="hs-comment">-- * Validity checking</span><span>
</span><a name="line-36"></a><span>        </span><a href="TcHsSyn.html#checkForRepresentationPolymorphism"><span class="hs-identifier hs-var">checkForRepresentationPolymorphism</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="TcMType.html"><span class="hs-identifier">TcMType</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Literal.html"><span class="hs-identifier">Literal</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[mkFailurePair]{Code for pattern-matching and other failures}
*                                                                      *
************************************************************************

Note: If @hsLPatType@ doesn't bear a strong resemblance to @exprType@,
then something is wrong.
-}</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-identifier">hsLPatType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-86"></a><a name="hsLPatType"><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier">hsLPatType</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027368"><a href="#local-1628027368"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span> </span><a href="#local-1628027368"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-89"></a><a name="hsPatType"><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier">hsPatType</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-1628027369"><a href="#local-1628027369"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-1628027369"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-90"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a name="local-1628027370"><a href="#local-1628027370"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027370"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-91"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027371"><a href="#local-1628027371"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628027371"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-92"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-1628027372"><a href="#local-1628027372"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-1628027372"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-93"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-1628027373"><a href="#local-1628027373"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLPatType"><span class="hs-identifier hs-var">hsLPatType</span></a><span> </span><a href="#local-1628027373"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-1628027374"><a href="#local-1628027374"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span> </span><a href="#local-1628027374"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-95"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><a name="local-1628027375"><a href="#local-1628027375"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628027375"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027376"><a href="#local-1628027376"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027376"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-97"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027377"><a href="#local-1628027377"><span class="hs-identifier">ty</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkListTy"><span class="hs-identifier hs-var">mkListTy</span></a><span> </span><a href="#local-1628027377"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-98"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628027378"><a href="#local-1628027378"><span class="hs-identifier">ty</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027378"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-99"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027379"><a href="#local-1628027379"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkPArrTy"><span class="hs-identifier hs-var">mkPArrTy</span></a><span> </span><a href="#local-1628027379"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-100"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027380"><a href="#local-1628027380"><span class="hs-identifier">bx</span></a></a><span> </span><a name="local-1628027381"><a href="#local-1628027381"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkTupleTy"><span class="hs-identifier hs-var">mkTupleTy</span></a><span> </span><a href="#local-1628027380"><span class="hs-identifier hs-var">bx</span></a><span> </span><a href="#local-1628027381"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-101"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027382"><a href="#local-1628027382"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027383"><a href="#local-1628027383"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>                                      </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span> </span><a href="#local-1628027382"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628027383"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-103"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027384"><a href="#local-1628027384"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027384"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-104"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027385"><a href="#local-1628027385"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027385"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-105"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027386"><a href="#local-1628027386"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027386"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-106"></a><span class="hs-identifier">hsPatType</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027387"><a href="#local-1628027387"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027387"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-107"></a><span class="hs-identifier">hsPatType</span><span> </span><a name="local-1628027388"><a href="#local-1628027388"><span class="hs-identifier">p</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;hsPatType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628027388"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-111"></a><a name="hsLitType"><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier">hsLitType</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsChar"><span class="hs-identifier hs-var">HsChar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#charTy"><span class="hs-identifier hs-var">charTy</span></a><span>
</span><a name="line-112"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsCharPrim"><span class="hs-identifier hs-var">HsCharPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#stringTy"><span class="hs-identifier hs-var">stringTy</span></a><span>
</span><a name="line-114"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsStringPrim"><span class="hs-identifier hs-var">HsStringPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>
</span><a name="line-115"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#intTy"><span class="hs-identifier hs-var">intTy</span></a><span>
</span><a name="line-116"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>
</span><a name="line-117"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>
</span><a name="line-118"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt64Prim"><span class="hs-identifier hs-var">HsInt64Prim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a><span>
</span><a name="line-119"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWord64Prim"><span class="hs-identifier hs-var">HsWord64Prim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a><span>
</span><a name="line-120"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInteger"><span class="hs-identifier hs-var">HsInteger</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027389"><a href="#local-1628027389"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027389"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027390"><a href="#local-1628027390"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027390"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFloatPrim"><span class="hs-identifier hs-var">HsFloatPrim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span>
</span><a name="line-123"></a><span class="hs-identifier">hsLitType</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsDoublePrim"><span class="hs-identifier hs-var">HsDoublePrim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- Overloaded literals. Here mainly because it uses isIntTy etc</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#OverLitVal"><span class="hs-identifier hs-type">OverLitVal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><a name="shortCutLit"><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier">shortCutLit</span></a></a><span> </span><a name="local-1628027391"><a href="#local-1628027391"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><a name="local-1628027392"><a href="#local-1628027392"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-1628027393"><a href="#local-1628027393"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027394"><a href="#local-1628027394"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isIntTy"><span class="hs-identifier hs-var">isIntTy</span></a><span> </span><a href="#local-1628027394"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span>  </span><a href="#local-1628027391"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="#local-1628027392"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isWordTy"><span class="hs-identifier hs-var">isWordTy</span></a><span> </span><a href="#local-1628027394"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Literal.html#inWordRange"><span class="hs-identifier hs-var">inWordRange</span></a><span> </span><a href="#local-1628027391"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-131"></a><span>                                   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><a href="#local-1628027392"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isIntegerTy"><span class="hs-identifier hs-var">isIntegerTy</span></a><span> </span><a href="#local-1628027394"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInteger"><span class="hs-identifier hs-var">HsInteger</span></a><span> </span><a href="#local-1628027392"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-1628027394"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#shortCutLit"><span class="hs-identifier hs-var">shortCutLit</span></a><span> </span><a href="#local-1628027391"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#integralFractionalLit"><span class="hs-identifier hs-var">integralFractionalLit</span></a><span> </span><a href="#local-1628027393"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628027394"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-134"></a><span>        </span><span class="hs-comment">-- The 'otherwise' case is important</span><span>
</span><a name="line-135"></a><span>        </span><span class="hs-comment">-- Consider (3 :: Float).  Syntactically it looks like an IntLit,</span><span>
</span><a name="line-136"></a><span>        </span><span class="hs-comment">-- so we'll call shortCutIntLit, but of course it's a float</span><span>
</span><a name="line-137"></a><span>        </span><span class="hs-comment">-- This can make a big difference for programs with a lot of</span><span>
</span><a name="line-138"></a><span>        </span><span class="hs-comment">-- literals, compiled without -O</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><a name="local-1628027395"><a href="#local-1628027395"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027396"><a href="#local-1628027396"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isFloatTy"><span class="hs-identifier hs-var">isFloatTy</span></a><span> </span><a href="#local-1628027396"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a><span>  </span><span class="hs-special">(</span><a href="HsLit.html#HsFloatPrim"><span class="hs-identifier hs-var">HsFloatPrim</span></a><span> </span><a href="#local-1628027395"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isDoubleTy"><span class="hs-identifier hs-var">isDoubleTy</span></a><span> </span><a href="#local-1628027396"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#mkLit"><span class="hs-identifier hs-var">mkLit</span></a><span> </span><a href="TysWiredIn.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsDoublePrim"><span class="hs-identifier hs-var">HsDoublePrim</span></a><span> </span><a href="#local-1628027395"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">shortCutLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span> </span><a name="local-1628027397"><a href="#local-1628027397"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-1628027398"><a href="#local-1628027398"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027399"><a href="#local-1628027399"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a><span> </span><a href="#local-1628027399"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a href="#local-1628027397"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027398"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">mkLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-150"></a><a name="mkLit"><a href="TcHsSyn.html#mkLit"><span class="hs-identifier">mkLit</span></a></a><span> </span><a name="local-1628027400"><a href="#local-1628027400"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628027401"><a href="#local-1628027401"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><a href="#local-1628027400"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span> </span><a href="#local-1628027401"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-153"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#OverLitVal"><span class="hs-identifier hs-type">OverLitVal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-154"></a><span class="hs-comment">-- Get the canonical 'fromX' name for a particular OverLitVal</span><span>
</span><a name="line-155"></a><a name="hsOverLitName"><a href="TcHsSyn.html#hsOverLitName"><span class="hs-identifier">hsOverLitName</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromIntegerName"><span class="hs-identifier hs-var">fromIntegerName</span></a><span>
</span><a name="line-156"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromRationalName"><span class="hs-identifier hs-var">fromRationalName</span></a><span>
</span><a name="line-157"></a><span class="hs-identifier">hsOverLitName</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#fromStringName"><span class="hs-identifier hs-var">fromStringName</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-HsBinds]{Running a substitution over @HsBinds@}
*                                                                      *
************************************************************************

The rest of the zonking is done *after* typechecking.
The main zonking pass runs over the bindings

 a) to convert TcTyVars to TyVars etc, dereferencing any bindings etc
 b) convert unbound TcTyVar to Void
 c) convert each TcId to an Id by zonking its type

The type variables are converted by binding mutable tyvars to immutable ones
and then zonking as normal.

The Ids are converted by binding them in the normal Tc envt; that
way we maintain sharing; eg an Id is zonked at its binding site and they
all occurrences of that Id point to the common zonked copy

It's all pretty boring stuff, because HsSyn is such a large type, and
the environment manipulation is tiresome.
-}</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-185"></a><span class="hs-keyword">type</span><span> </span><a name="UnboundTyVarZonker"><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier">UnboundTyVarZonker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-186"></a><span>        </span><span class="hs-comment">-- How to zonk an unbound type variable</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- Note [Zonking the LHS of a RULE]</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | A ZonkEnv carries around several bits.</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- The UnboundTyVarZonker just zaps unbouned meta-tyvars to Any (as</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- defined in zonkTypeZapping), except on the LHS of rules. See</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- Note [Zonking the LHS of a RULE]. The (TyCoVarEnv TyVar) and is just</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- an optimisation: when binding a tyvar or covar, we zonk the kind right away</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- and add a mapping to the env. This prevents re-zonking the kind at</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- every occurrence. But this is *just* an optimisation.</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- The final (IdEnv Var) optimises zonking for</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- Ids. It is knot-tied. We must be careful never to put coercion variables</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- (which are Ids, after all) in the knot-tied env, because coercions can</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- appear in types, and we sometimes inspect a zonked type in this module.</span><span>
</span><a name="line-200"></a><span class="hs-comment">--</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-202"></a><span class="hs-keyword">data</span><span> </span><a name="ZonkEnv"><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier">ZonkEnv</span></a></a><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ZonkEnv"><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier">ZonkEnv</span></a></a><span>
</span><a name="line-204"></a><span>      </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-205"></a><span>      </span><span class="hs-special">(</span><a href="VarEnv.html#TyCoVarEnv"><span class="hs-identifier hs-type">TyCoVarEnv</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>      </span><span class="hs-special">(</span><a href="VarEnv.html#IdEnv"><span class="hs-identifier hs-type">IdEnv</span></a><span>      </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- What variables are in scope</span><span>
</span><a name="line-207"></a><span>        </span><span class="hs-comment">-- Maps an Id or EvVar to its zonked version; both have the same Name</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-comment">-- Note that all evidence (coercion variables as well as dictionaries)</span><span>
</span><a name="line-209"></a><span>        </span><span class="hs-comment">--      are kept in the ZonkEnv</span><span>
</span><a name="line-210"></a><span>        </span><span class="hs-comment">-- Only *type* abstraction is done by side effect</span><span>
</span><a name="line-211"></a><span>        </span><span class="hs-comment">-- Is only consulted lazily; hence knot-tying</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-214"></a><span>  </span><a name="local-1912652361"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028584"><a href="#local-1628028584"><span class="hs-identifier">_ty_env</span></a></a><span> </span><a name="local-1628028585"><a href="#local-1628028585"><span class="hs-identifier">var_env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#varEnvElts"><span class="hs-identifier hs-var">varEnvElts</span></a><span> </span><a href="#local-1628028585"><span class="hs-identifier hs-var">var_env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- The EvBinds have to already be zonked, but that's usually the case.</span><span>
</span><a name="line-218"></a><span class="hs-identifier">emptyZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-219"></a><a name="emptyZonkEnv"><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier">emptyZonkEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a><span> </span><a href="TcHsSyn.html#zonkTypeZapping"><span class="hs-identifier hs-var">zonkTypeZapping</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-identifier">mkEmptyZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-222"></a><a name="mkEmptyZonkEnv"><a href="TcHsSyn.html#mkEmptyZonkEnv"><span class="hs-identifier">mkEmptyZonkEnv</span></a></a><span> </span><a name="local-1628027402"><a href="#local-1628027402"><span class="hs-identifier">zonker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027402"><span class="hs-identifier hs-var">zonker</span></a><span> </span><a href="VarEnv.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a><span> </span><a href="VarEnv.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-comment">-- | Extend the knot-tied environment.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">extendIdZonkEnvRec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-226"></a><a name="extendIdZonkEnvRec"><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier">extendIdZonkEnvRec</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628027403"><a href="#local-1628027403"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-1628027404"><a href="#local-1628027404"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-1628027405"><a href="#local-1628027405"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027406"><a href="#local-1628027406"><span class="hs-identifier">ids</span></a></a><span>
</span><a name="line-227"></a><span>    </span><span class="hs-comment">-- NB: Don't look at the var to decide which env't to put it in. That</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-comment">-- would end up knot-tying all the env'ts.</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027403"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-1628027404"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-1628027405"><span class="hs-identifier hs-var">id_env</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628027407"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><a href="#local-1628027407"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628027407"><a href="#local-1628027407"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027406"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-comment">-- Given coercion variables will actually end up here. That's OK though:</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-comment">-- coercion variables are never looked up in the knot-tied env't, so zonking</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-comment">-- them simply doesn't get optimised. No one gets hurt. An improvement (?)</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-comment">-- would be to do SCC analysis in zonkEvBinds and then only knot-tie the</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-comment">-- recursive groups. But perhaps the time it takes to do the analysis is</span><span>
</span><a name="line-235"></a><span>  </span><span class="hs-comment">-- more than the savings.</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-identifier">extendZonkEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-238"></a><a name="extendZonkEnv"><a href="TcHsSyn.html#extendZonkEnv"><span class="hs-identifier">extendZonkEnv</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628027408"><a href="#local-1628027408"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-1628027409"><a href="#local-1628027409"><span class="hs-identifier">tyco_env</span></a></a><span> </span><a name="local-1628027410"><a href="#local-1628027410"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027411"><a href="#local-1628027411"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-239"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027408"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-1628027409"><span class="hs-identifier hs-var">tyco_env</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628027414"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><a href="#local-1628027414"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628027414"><a href="#local-1628027414"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027412"><span class="hs-identifier hs-var">tycovars</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>                    </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnvList"><span class="hs-identifier hs-var">extendVarEnvList</span></a><span> </span><a href="#local-1628027410"><span class="hs-identifier hs-var">id_env</span></a><span>   </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1628027415"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">,</span><a href="#local-1628027415"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628027415"><a href="#local-1628027415"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027413"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-1628027412"><a href="#local-1628027412"><span class="hs-identifier">tycovars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027413"><a href="#local-1628027413"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a><span> </span><a href="#local-1628027411"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-identifier">extendIdZonkEnv1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-244"></a><a name="extendIdZonkEnv1"><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier">extendIdZonkEnv1</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628027416"><a href="#local-1628027416"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-1628027417"><a href="#local-1628027417"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-1628027418"><a href="#local-1628027418"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027419"><a href="#local-1628027419"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027416"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-1628027417"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-1628027418"><span class="hs-identifier hs-var">id_env</span></a><span> </span><a href="#local-1628027419"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-1628027419"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-identifier">extendTyZonkEnv1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-248"></a><a name="extendTyZonkEnv1"><a href="TcHsSyn.html#extendTyZonkEnv1"><span class="hs-identifier">extendTyZonkEnv1</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628027420"><a href="#local-1628027420"><span class="hs-identifier">zonk_ty</span></a></a><span> </span><a name="local-1628027421"><a href="#local-1628027421"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-1628027422"><a href="#local-1628027422"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027423"><a href="#local-1628027423"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027420"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-1628027421"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><a href="#local-1628027423"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628027423"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027422"><span class="hs-identifier hs-var">id_env</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">setZonkType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-252"></a><a name="setZonkType"><a href="TcHsSyn.html#setZonkType"><span class="hs-identifier">setZonkType</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027424"><a href="#local-1628027424"><span class="hs-identifier">ty_env</span></a></a><span> </span><a name="local-1628027425"><a href="#local-1628027425"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027426"><a href="#local-1628027426"><span class="hs-identifier">zonk_ty</span></a></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a href="#local-1628027426"><span class="hs-identifier hs-var">zonk_ty</span></a><span> </span><a href="#local-1628027424"><span class="hs-identifier hs-var">ty_env</span></a><span> </span><a href="#local-1628027425"><span class="hs-identifier hs-var">id_env</span></a><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-identifier">zonkEnvIds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-256"></a><a name="zonkEnvIds"><a href="TcHsSyn.html#zonkEnvIds"><span class="hs-identifier">zonkEnvIds</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027427"><a href="#local-1628027427"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#varEnvElts"><span class="hs-identifier hs-var">varEnvElts</span></a><span> </span><a href="#local-1628027427"><span class="hs-identifier hs-var">id_env</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-identifier">zonkIdOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-259"></a><span class="hs-comment">-- Ids defined in this module should be in the envt;</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- ignore others.  (Actually, data constructors are also</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- not LocalVars, even when locally defined, but that is fine.)</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- (Also foreign-imported things aren't currently in the ZonkEnv;</span><span>
</span><a name="line-263"></a><span class="hs-comment">--  that's ok because they don't need zonking.)</span><span>
</span><a name="line-264"></a><span class="hs-comment">--</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- Actually, Template Haskell works in 'chunks' of declarations, and</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- an earlier chunk won't be in the 'env' that the zonking phase</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- carries around.  Instead it'll be in the tcg_gbl_env, already fully</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- zonked.  There's no point in looking it up there (except for error</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- checking), and it's not conveniently to hand; hence the simple</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- 'orElse' case in the LocalVar branch.</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- Even without template splices, in module Main, the checking of</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- 'main' is done as a separate chunk.</span><span>
</span><a name="line-274"></a><a name="zonkIdOcc"><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier">zonkIdOcc</span></a></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628027428"><a href="#local-1628027428"><span class="hs-identifier">_zonk_ty</span></a></a><span> </span><a name="local-1628027429"><a href="#local-1628027429"><span class="hs-identifier">_ty_env</span></a></a><span> </span><a name="local-1628027430"><a href="#local-1628027430"><span class="hs-identifier">id_env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027431"><a href="#local-1628027431"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-275"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isLocalVar"><span class="hs-identifier hs-var">isLocalVar</span></a><span> </span><a href="#local-1628027431"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-1628027430"><span class="hs-identifier hs-var">id_env</span></a><span> </span><a href="#local-1628027431"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span>
</span><a name="line-276"></a><span>                    </span><a href="#local-1628027431"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027431"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-identifier">zonkIdOccs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-280"></a><a name="zonkIdOccs"><a href="TcHsSyn.html#zonkIdOccs"><span class="hs-identifier">zonkIdOccs</span></a></a><span> </span><a name="local-1628027432"><a href="#local-1628027432"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027433"><a href="#local-1628027433"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628027432"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027433"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- zonkIdBndr is used *after* typechecking to get the Id's type</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- to its final form.  The TyVarEnv give</span><span>
</span><a name="line-284"></a><span class="hs-identifier">zonkIdBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-285"></a><a name="zonkIdBndr"><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier">zonkIdBndr</span></a></a><span> </span><a name="local-1628027434"><a href="#local-1628027434"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027435"><a href="#local-1628027435"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027436"><a href="#local-1628027436"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027434"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628027435"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>       </span><a href="TcHsSyn.html#ensureNotRepresentationPolymorphic"><span class="hs-identifier hs-var">ensureNotRepresentationPolymorphic</span></a><span> </span><a href="#local-1628027436"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-288"></a><span>         </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type of binder&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628027435"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#setIdType"><span class="hs-identifier hs-var">setIdType</span></a><span> </span><a href="#local-1628027435"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-1628027436"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-identifier">zonkIdBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-292"></a><a name="zonkIdBndrs"><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier">zonkIdBndrs</span></a></a><span> </span><a name="local-1628027437"><a href="#local-1628027437"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027438"><a href="#local-1628027438"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027437"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027438"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-identifier">zonkTopBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-295"></a><a name="zonkTopBndrs"><a href="TcHsSyn.html#zonkTopBndrs"><span class="hs-identifier">zonkTopBndrs</span></a></a><span> </span><a name="local-1628027439"><a href="#local-1628027439"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-1628027439"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-identifier">zonkFieldOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><a name="zonkFieldOcc"><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier">zonkFieldOcc</span></a></a><span> </span><a name="local-1628027440"><a href="#local-1628027440"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><a name="local-1628027441"><a href="#local-1628027441"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-1628027442"><a href="#local-1628027442"><span class="hs-identifier">sel</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><a href="#local-1628027441"><span class="hs-identifier hs-var">lbl</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027440"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027442"><span class="hs-identifier hs-var">sel</span></a><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">zonkEvBndrsX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-301"></a><a name="zonkEvBndrsX"><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier">zonkEvBndrsX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier hs-var">zonkEvBndrX</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">zonkEvBndrX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- Works for dictionaries and coercions</span><span>
</span><a name="line-305"></a><a name="zonkEvBndrX"><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier">zonkEvBndrX</span></a></a><span> </span><a name="local-1628027443"><a href="#local-1628027443"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027444"><a href="#local-1628027444"><span class="hs-identifier">var</span></a></a><span>
</span><a name="line-306"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027445"><a href="#local-1628027445"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier hs-var">zonkEvBndr</span></a><span> </span><a href="#local-1628027443"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027444"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-307"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendZonkEnv"><span class="hs-identifier hs-var">extendZonkEnv</span></a><span> </span><a href="#local-1628027443"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628027445"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1628027445"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-identifier">zonkEvBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- Works for dictionaries and coercions</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- Does not extend the ZonkEnv</span><span>
</span><a name="line-312"></a><a name="zonkEvBndr"><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier">zonkEvBndr</span></a></a><span> </span><a name="local-1628027446"><a href="#local-1628027446"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027447"><a href="#local-1628027447"><span class="hs-identifier">var</span></a></a><span>
</span><a name="line-313"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628027448"><a href="#local-1628027448"><span class="hs-identifier">var_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628027447"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-314"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027449"><a href="#local-1628027449"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-315"></a><span>           </span><span class="hs-pragma">{-# SCC &quot;zonkEvBndr_zonkTcTypeToType&quot; #-}</span><span>
</span><a name="line-316"></a><span>           </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027446"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027448"><span class="hs-identifier hs-var">var_ty</span></a><span>
</span><a name="line-317"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a><span> </span><a href="#local-1628027447"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1628027449"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-identifier">zonkEvVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-320"></a><a name="zonkEvVarOcc"><a href="TcHsSyn.html#zonkEvVarOcc"><span class="hs-identifier">zonkEvVarOcc</span></a></a><span> </span><a name="local-1628027450"><a href="#local-1628027450"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027451"><a href="#local-1628027451"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-1628027451"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-322"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier hs-var">zonkCoVarOcc</span></a><span> </span><a href="#local-1628027450"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027451"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-323"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628027450"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027451"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">zonkTyBndrsX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-327"></a><a name="zonkTyBndrsX"><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier">zonkTyBndrsX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">zonkTyBndrX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span class="hs-comment">-- This guarantees to return a TyVar (not a TcTyVar)</span><span>
</span><a name="line-331"></a><span class="hs-comment">-- then we add it to the envt, so all occurrences are replaced</span><span>
</span><a name="line-332"></a><a name="zonkTyBndrX"><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier">zonkTyBndrX</span></a></a><span> </span><a name="local-1628027452"><a href="#local-1628027452"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027453"><a href="#local-1628027453"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-333"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027454"><a href="#local-1628027454"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027452"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628027453"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>               </span><span class="hs-comment">-- Internal names tidy up better, for iface files.</span><span>
</span><a name="line-336"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628027455"><a href="#local-1628027455"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span> </span><a href="#local-1628027453"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027454"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-337"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendTyZonkEnv1"><span class="hs-identifier hs-var">extendTyZonkEnv1</span></a><span> </span><a href="#local-1628027452"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027455"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027455"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-identifier">zonkTyBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyBinder"><span class="hs-identifier hs-type">TcTyBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><a name="zonkTyBinders"><a href="TcHsSyn.html#zonkTyBinders"><span class="hs-identifier">zonkTyBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkTyBinder"><span class="hs-identifier hs-var">zonkTyBinder</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-identifier">zonkTyBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyBinder"><span class="hs-identifier hs-type">TcTyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><a name="zonkTyBinder"><a href="TcHsSyn.html#zonkTyBinder"><span class="hs-identifier">zonkTyBinder</span></a></a><span> </span><a name="local-1628027456"><a href="#local-1628027456"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1628027457"><a href="#local-1628027457"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628027456"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027456"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027457"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-344"></a><span class="hs-identifier">zonkTyBinder</span><span> </span><a name="local-1628027458"><a href="#local-1628027458"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1628027459"><a href="#local-1628027459"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1628027460"><a href="#local-1628027460"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027461"><a href="#local-1628027461"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027462"><a href="#local-1628027462"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-1628027458"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027459"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-346"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027461"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1628027462"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1628027460"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-identifier">zonkTopExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-349"></a><a name="zonkTopExpr"><a href="TcHsSyn.html#zonkTopExpr"><span class="hs-identifier">zonkTopExpr</span></a></a><span> </span><a name="local-1628027463"><a href="#local-1628027463"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-1628027463"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">zonkTopLExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><a name="zonkTopLExpr"><a href="TcHsSyn.html#zonkTopLExpr"><span class="hs-identifier">zonkTopLExpr</span></a></a><span> </span><a name="local-1628027464"><a href="#local-1628027464"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-1628027464"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-identifier">zonkTopDecls</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-355"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-356"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span>
</span><a name="line-357"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-358"></a><span>                     </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-359"></a><span>                     </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span>
</span><a name="line-360"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-361"></a><span>                     </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-362"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span>    </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-363"></a><span>                     </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span>    </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-364"></a><a name="zonkTopDecls"><a href="TcHsSyn.html#zonkTopDecls"><span class="hs-identifier">zonkTopDecls</span></a></a><span> </span><a name="local-1628027465"><a href="#local-1628027465"><span class="hs-identifier">ev_binds</span></a></a><span> </span><a name="local-1628027466"><a href="#local-1628027466"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628027467"><a href="#local-1628027467"><span class="hs-identifier">rules</span></a></a><span> </span><a name="local-1628027468"><a href="#local-1628027468"><span class="hs-identifier">vects</span></a></a><span> </span><a name="local-1628027469"><a href="#local-1628027469"><span class="hs-identifier">imp_specs</span></a></a><span> </span><a name="local-1628027470"><a href="#local-1628027470"><span class="hs-identifier">fords</span></a></a><span>
</span><a name="line-365"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027471"><a href="#local-1628027471"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027472"><a href="#local-1628027472"><span class="hs-identifier">ev_binds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-1628027465"><span class="hs-identifier hs-var">ev_binds</span></a><span>
</span><a name="line-366"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027473"><a href="#local-1628027473"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027474"><a href="#local-1628027474"><span class="hs-identifier">binds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier hs-var">zonkRecMonoBinds</span></a><span> </span><a href="#local-1628027471"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027466"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-367"></a><span>                        </span><span class="hs-comment">-- Top level is implicitly recursive</span><span>
</span><a name="line-368"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027475"><a href="#local-1628027475"><span class="hs-identifier">rules'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRules"><span class="hs-identifier hs-var">zonkRules</span></a><span> </span><a href="#local-1628027473"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027467"><span class="hs-identifier hs-var">rules</span></a><span>
</span><a name="line-369"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027476"><a href="#local-1628027476"><span class="hs-identifier">vects'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkVects"><span class="hs-identifier hs-var">zonkVects</span></a><span> </span><a href="#local-1628027473"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027468"><span class="hs-identifier hs-var">vects</span></a><span>
</span><a name="line-370"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027477"><a href="#local-1628027477"><span class="hs-identifier">specs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier hs-var">zonkLTcSpecPrags</span></a><span> </span><a href="#local-1628027473"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027469"><span class="hs-identifier hs-var">imp_specs</span></a><span>
</span><a name="line-371"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027478"><a href="#local-1628027478"><span class="hs-identifier">fords'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkForeignExports"><span class="hs-identifier hs-var">zonkForeignExports</span></a><span> </span><a href="#local-1628027473"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027470"><span class="hs-identifier hs-var">fords</span></a><span>
</span><a name="line-372"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEnvIds"><span class="hs-identifier hs-var">zonkEnvIds</span></a><span> </span><a href="#local-1628027473"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027472"><span class="hs-identifier hs-var">ev_binds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027474"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027478"><span class="hs-identifier hs-var">fords'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027477"><span class="hs-identifier hs-var">specs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027475"><span class="hs-identifier hs-var">rules'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027476"><span class="hs-identifier hs-var">vects'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-375"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><a name="zonkLocalBinds"><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier">zonkLocalBinds</span></a></a><span> </span><a name="local-1628027479"><a href="#local-1628027479"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span>
</span><a name="line-377"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027479"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsIn"><span class="hs-identifier hs-var">ValBindsIn</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;zonkLocalBinds&quot;</span><span> </span><span class="hs-comment">-- Not in typechecker output</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><a name="local-1628027480"><a href="#local-1628027480"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a name="local-1628027481"><a href="#local-1628027481"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628027482"><a href="#local-1628027482"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027493"><a href="#local-1628027493"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027494"><a href="#local-1628027494"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027483"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628027480"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027481"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-384"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027493"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><a href="#local-1628027494"><span class="hs-identifier hs-var">new_binds</span></a><span> </span><a href="#local-1628027482"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-385"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-386"></a><span>    </span><a name="local-1628027483"><a href="#local-1628027483"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1628027484"><a href="#local-1628027484"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-387"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027484"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1628027485"><a href="#local-1628027485"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1628027486"><a href="#local-1628027486"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-1628027487"><a href="#local-1628027487"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-1628027488"><a href="#local-1628027488"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027489"><a href="#local-1628027489"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027490"><a href="#local-1628027490"><span class="hs-identifier">b'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier hs-var">zonkRecMonoBinds</span></a><span> </span><a href="#local-1628027485"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027487"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-390"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027491"><a href="#local-1628027491"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027492"><a href="#local-1628027492"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027483"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628027489"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027488"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-391"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027491"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628027486"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-1628027490"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-1628027492"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-identifier">zonkLocalBinds</span><span> </span><a name="local-1628027495"><a href="#local-1628027495"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBinds"><span class="hs-identifier hs-var">IPBinds</span></a><span> </span><a name="local-1628027496"><a href="#local-1628027496"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-1628027497"><a href="#local-1628027497"><span class="hs-identifier">dict_binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-394"></a><span>    </span><a name="local-1628027503"><a href="#local-1628027503"><span class="hs-identifier">new_binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-1628027498"><span class="hs-identifier hs-var">zonk_ip_bind</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027496"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-395"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-396"></a><span>        </span><a name="local-1628027504"><a href="#local-1628027504"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628027495"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-1628027505"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628027505"><a href="#local-1628027505"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027503"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">]</span><span>
</span><a name="line-397"></a><span>    </span><span class="hs-special">(</span><a name="local-1628027506"><a href="#local-1628027506"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027507"><a href="#local-1628027507"><span class="hs-identifier">new_dict_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-1628027504"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027497"><span class="hs-identifier hs-var">dict_binds</span></a><span>
</span><a name="line-398"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027506"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBinds"><span class="hs-identifier hs-var">IPBinds</span></a><span> </span><a href="#local-1628027503"><span class="hs-identifier hs-var">new_binds</span></a><span> </span><a href="#local-1628027507"><span class="hs-identifier hs-var">new_dict_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-400"></a><span>    </span><a name="local-1628027498"><a href="#local-1628027498"><span class="hs-identifier">zonk_ip_bind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><a name="local-1628027499"><a href="#local-1628027499"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628027500"><a href="#local-1628027500"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027501"><a href="#local-1628027501"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#mapIPNameTc"><span class="hs-identifier hs-var">mapIPNameTc</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027495"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027499"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-402"></a><span>             </span><a name="local-1628027502"><a href="#local-1628027502"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027495"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027500"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-403"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#IPBind"><span class="hs-identifier hs-var">IPBind</span></a><span> </span><a href="#local-1628027501"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-1628027502"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-406"></a><span class="hs-identifier">zonkRecMonoBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><a name="zonkRecMonoBinds"><a href="TcHsSyn.html#zonkRecMonoBinds"><span class="hs-identifier">zonkRecMonoBinds</span></a></a><span> </span><a name="local-1628027508"><a href="#local-1628027508"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027509"><a href="#local-1628027509"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-408"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027510"><a href="#local-1628027510"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-409"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628027511"><a href="#local-1628027511"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628027508"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span> </span><a href="#local-1628027510"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027512"><a href="#local-1628027512"><span class="hs-identifier">binds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier hs-var">zonkMonoBinds</span></a><span> </span><a href="#local-1628027511"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027509"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-411"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027511"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027512"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">---------------------------------------------</span><span>
</span><a name="line-414"></a><span class="hs-identifier">zonkMonoBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><a name="zonkMonoBinds"><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier">zonkMonoBinds</span></a></a><span> </span><a name="local-1628027513"><a href="#local-1628027513"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027514"><a href="#local-1628027514"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#mapBagM"><span class="hs-identifier hs-var">mapBagM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_lbind"><span class="hs-identifier hs-var">zonk_lbind</span></a><span> </span><a href="#local-1628027513"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027514"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-identifier">zonk_lbind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><a name="zonk_lbind"><a href="TcHsSyn.html#zonk_lbind"><span class="hs-identifier">zonk_lbind</span></a></a><span> </span><a name="local-1628027515"><a href="#local-1628027515"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_bind"><span class="hs-identifier hs-var">zonk_bind</span></a><span> </span><a href="#local-1628027515"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-identifier">zonk_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><a name="zonk_bind"><a href="TcHsSyn.html#zonk_bind"><span class="hs-identifier">zonk_bind</span></a></a><span> </span><a name="local-1628027516"><a href="#local-1628027516"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027517"><a href="#local-1628027517"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027518"><a href="#local-1628027518"><span class="hs-identifier">pat</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027519"><a href="#local-1628027519"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027520"><a href="#local-1628027520"><span class="hs-identifier">ty</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027521"><a href="#local-1628027521"><span class="hs-identifier">_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027522"><a href="#local-1628027522"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628027516"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027518"><span class="hs-identifier hs-var">pat</span></a><span>            </span><span class="hs-comment">-- Env already extended</span><span>
</span><a name="line-423"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027523"><a href="#local-1628027523"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier hs-var">zonkGRHSs</span></a><span> </span><a href="#local-1628027516"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027519"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-424"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027524"><a href="#local-1628027524"><span class="hs-identifier">new_ty</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027516"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027520"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-425"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027517"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027522"><span class="hs-identifier hs-var">new_pat</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027523"><span class="hs-identifier hs-var">new_grhss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027524"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-1628027525"><a href="#local-1628027525"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027526"><a href="#local-1628027526"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027527"><a href="#local-1628027527"><span class="hs-identifier">expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027528"><a href="#local-1628027528"><span class="hs-identifier">inl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027529"><a href="#local-1628027529"><span class="hs-identifier">new_var</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027525"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027526"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-429"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027530"><a href="#local-1628027530"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027525"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027527"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-430"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027529"><span class="hs-identifier hs-var">new_var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027530"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027528"><span class="hs-identifier hs-var">inl</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-1628027531"><a href="#local-1628027531"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027532"><a href="#local-1628027532"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027533"><a href="#local-1628027533"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628027534"><a href="#local-1628027534"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027535"><a href="#local-1628027535"><span class="hs-identifier">ms</span></a></a><span>
</span><a name="line-433"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027536"><a href="#local-1628027536"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027537"><a href="#local-1628027537"><span class="hs-identifier">new_var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027534"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-435"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027538"><a href="#local-1628027538"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027539"><a href="#local-1628027539"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027531"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027536"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-436"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027540"><a href="#local-1628027540"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027538"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027535"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-437"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027532"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027533"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628027537"><span class="hs-identifier hs-var">new_var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027540"><span class="hs-identifier hs-var">new_ms</span></a><span>
</span><a name="line-438"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027539"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-1628027541"><a href="#local-1628027541"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027542"><a href="#local-1628027542"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027543"><a href="#local-1628027543"><span class="hs-identifier">evs</span></a></a><span>
</span><a name="line-441"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027544"><a href="#local-1628027544"><span class="hs-identifier">ev_binds</span></a></a><span>
</span><a name="line-442"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027545"><a href="#local-1628027545"><span class="hs-identifier">exports</span></a></a><span>
</span><a name="line-443"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027546"><a href="#local-1628027546"><span class="hs-identifier">val_binds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-444"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027556"><a href="#local-1628027556"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027557"><a href="#local-1628027557"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-1628027541"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027542"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-446"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027558"><a href="#local-1628027558"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027559"><a href="#local-1628027559"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-1628027556"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628027543"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-447"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027560"><a href="#local-1628027560"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027561"><a href="#local-1628027561"><span class="hs-identifier">new_ev_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds_s"><span class="hs-identifier hs-var">zonkTcEvBinds_s</span></a><span> </span><a href="#local-1628027558"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027544"><span class="hs-identifier hs-var">ev_binds</span></a><span>
</span><a name="line-448"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027566"><a href="#local-1628027566"><span class="hs-identifier">new_val_bind</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027567"><a href="#local-1628027567"><span class="hs-identifier">new_exports</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-1628027562"><a href="#local-1628027562"><span class="hs-identifier">new_val_binds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-449"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628027563"><a href="#local-1628027563"><span class="hs-identifier">env3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628027560"><span class="hs-identifier hs-var">env2</span></a><span>
</span><a name="line-450"></a><span>                           </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span> </span><a href="#local-1628027562"><span class="hs-identifier hs-var">new_val_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-1628027564"><a href="#local-1628027564"><span class="hs-identifier">new_val_binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMonoBinds"><span class="hs-identifier hs-var">zonkMonoBinds</span></a><span> </span><a href="#local-1628027563"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628027546"><span class="hs-identifier hs-var">val_binds</span></a><span>
</span><a name="line-452"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-1628027565"><a href="#local-1628027565"><span class="hs-identifier">new_exports</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027547"><span class="hs-identifier hs-var">zonkExport</span></a><span> </span><a href="#local-1628027563"><span class="hs-identifier hs-var">env3</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027545"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-453"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027564"><span class="hs-identifier hs-var">new_val_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628027565"><span class="hs-identifier hs-var">new_exports</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-454"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027557"><span class="hs-identifier hs-var">new_tyvars</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027559"><span class="hs-identifier hs-var">new_evs</span></a><span>
</span><a name="line-455"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027561"><span class="hs-identifier hs-var">new_ev_binds</span></a><span>
</span><a name="line-456"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027567"><span class="hs-identifier hs-var">new_exports</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027566"><span class="hs-identifier hs-var">new_val_bind</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-457"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-458"></a><span>    </span><a name="local-1628027547"><a href="#local-1628027547"><span class="hs-identifier">zonkExport</span></a></a><span> </span><a name="local-1628027548"><a href="#local-1628027548"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ABE"><span class="hs-identifier hs-var">ABE</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">abe_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027549"><a href="#local-1628027549"><span class="hs-identifier">wrap</span></a></a><span>
</span><a name="line-459"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_poly</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027550"><a href="#local-1628027550"><span class="hs-identifier">poly_id</span></a></a><span>
</span><a name="line-460"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_mono</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027551"><a href="#local-1628027551"><span class="hs-identifier">mono_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_prags</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027552"><a href="#local-1628027552"><span class="hs-identifier">prags</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027553"><a href="#local-1628027553"><span class="hs-identifier">new_poly_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027548"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027550"><span class="hs-identifier hs-var">poly_id</span></a><span>
</span><a name="line-462"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027554"><a href="#local-1628027554"><span class="hs-identifier">new_wrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027548"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027549"><span class="hs-identifier hs-var">wrap</span></a><span>
</span><a name="line-463"></a><span>             </span><a name="local-1628027555"><a href="#local-1628027555"><span class="hs-identifier">new_prags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier hs-var">zonkSpecPrags</span></a><span> </span><a href="#local-1628027548"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027552"><span class="hs-identifier hs-var">prags</span></a><span>
</span><a name="line-464"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ABE"><span class="hs-identifier hs-var">ABE</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">abe_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027554"><span class="hs-identifier hs-var">new_wrap</span></a><span>
</span><a name="line-465"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_poly</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027553"><span class="hs-identifier hs-var">new_poly_id</span></a><span>
</span><a name="line-466"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_mono</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628027548"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027551"><span class="hs-identifier hs-var">mono_id</span></a><span>
</span><a name="line-467"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abe_prags</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027555"><span class="hs-identifier hs-var">new_prags</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-1628027568"><a href="#local-1628027568"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027569"><a href="#local-1628027569"><span class="hs-identifier">outer_bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027570"><a href="#local-1628027570"><span class="hs-identifier">tyvars</span></a></a><span>
</span><a name="line-470"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027571"><a href="#local-1628027571"><span class="hs-identifier">evs</span></a></a><span>
</span><a name="line-471"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_export</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027572"><a href="#local-1628027572"><span class="hs-identifier">poly</span></a></a><span>
</span><a name="line-472"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_prags</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027573"><a href="#local-1628027573"><span class="hs-identifier">prags</span></a></a><span>
</span><a name="line-473"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_ev_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027574"><a href="#local-1628027574"><span class="hs-identifier">ev_bind</span></a></a><span>
</span><a name="line-474"></a><span>                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_bind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027575"><a href="#local-1628027575"><span class="hs-identifier">lbind</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027576"><a href="#local-1628027576"><span class="hs-identifier">bind_loc</span></a></a><span> </span><a name="local-1628027577"><a href="#local-1628027577"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027578"><a href="#local-1628027578"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628027579"><a href="#local-1628027579"><span class="hs-identifier">local</span></a></a><span>
</span><a name="line-476"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027580"><a href="#local-1628027580"><span class="hs-identifier">ms</span></a></a><span>
</span><a name="line-477"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027581"><a href="#local-1628027581"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027575"><span class="hs-identifier hs-var">lbind</span></a><span>
</span><a name="line-478"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027582"><a href="#local-1628027582"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027583"><a href="#local-1628027583"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-1628027568"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-1628027570"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-480"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027584"><a href="#local-1628027584"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027585"><a href="#local-1628027585"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-1628027582"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628027571"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-481"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027586"><a href="#local-1628027586"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027587"><a href="#local-1628027587"><span class="hs-identifier">new_ev_bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-1628027584"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027574"><span class="hs-identifier hs-var">ev_bind</span></a><span>
</span><a name="line-482"></a><span>           </span><span class="hs-comment">-- Inline zonk_bind (FunBind ...) because we wish to skip</span><span>
</span><a name="line-483"></a><span>           </span><span class="hs-comment">-- the check for representation-polymorphic binders. The</span><span>
</span><a name="line-484"></a><span>           </span><span class="hs-comment">-- local binder in the FunBind in an AbsBindsSig is never actually</span><span>
</span><a name="line-485"></a><span>           </span><span class="hs-comment">-- bound in Core -- indeed, that's the whole point of AbsBindsSig.</span><span>
</span><a name="line-486"></a><span>           </span><span class="hs-comment">-- just calling zonk_bind causes #11405.</span><span>
</span><a name="line-487"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027588"><a href="#local-1628027588"><span class="hs-identifier">new_local</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027586"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027579"><span class="hs-identifier hs-var">local</span></a><span>
</span><a name="line-488"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027589"><a href="#local-1628027589"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027590"><a href="#local-1628027590"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027586"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027581"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-489"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027591"><a href="#local-1628027591"><span class="hs-identifier">new_ms</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027589"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027580"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-490"></a><span>           </span><span class="hs-comment">-- If there is a representation polymorphism problem, it will</span><span>
</span><a name="line-491"></a><span>           </span><span class="hs-comment">-- be caught here:</span><span>
</span><a name="line-492"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027592"><a href="#local-1628027592"><span class="hs-identifier">new_poly_id</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027586"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027572"><span class="hs-identifier hs-var">poly</span></a><span>
</span><a name="line-493"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027593"><a href="#local-1628027593"><span class="hs-identifier">new_prags</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier hs-var">zonkSpecPrags</span></a><span> </span><a href="#local-1628027586"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027573"><span class="hs-identifier hs-var">prags</span></a><span>
</span><a name="line-494"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628027594"><a href="#local-1628027594"><span class="hs-identifier">new_val_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027576"><span class="hs-identifier hs-var">bind_loc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027577"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027578"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628027588"><span class="hs-identifier hs-var">new_local</span></a><span>
</span><a name="line-495"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027591"><span class="hs-identifier hs-var">new_ms</span></a><span>
</span><a name="line-496"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027590"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBindsSig"><span class="hs-identifier hs-var">AbsBindsSig</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_tvs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027583"><span class="hs-identifier hs-var">new_tyvars</span></a><span>
</span><a name="line-498"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_ev_vars</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027585"><span class="hs-identifier hs-var">new_evs</span></a><span>
</span><a name="line-499"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_export</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027592"><span class="hs-identifier hs-var">new_poly_id</span></a><span>
</span><a name="line-500"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_prags</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027593"><span class="hs-identifier hs-var">new_prags</span></a><span>
</span><a name="line-501"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_ev_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027587"><span class="hs-identifier hs-var">new_ev_bind</span></a><span>
</span><a name="line-502"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig_bind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027594"><span class="hs-identifier hs-var">new_val_bind</span></a><span>  </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-505"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonk_bind&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628027569"><span class="hs-identifier hs-var">outer_bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-identifier">zonk_bind</span><span> </span><a name="local-1628027595"><a href="#local-1628027595"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a name="local-1628027596"><a href="#local-1628027596"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027597"><a href="#local-1628027597"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628027598"><a href="#local-1628027598"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-508"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027599"><a href="#local-1628027599"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-509"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027600"><a href="#local-1628027600"><span class="hs-identifier">lpat</span></a></a><span>
</span><a name="line-510"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027601"><a href="#local-1628027601"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027602"><a href="#local-1628027602"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027595"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027598"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-512"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027603"><a href="#local-1628027603"><span class="hs-identifier">details'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPatSynDetails"><span class="hs-identifier hs-var">zonkPatSynDetails</span></a><span> </span><a href="#local-1628027595"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027599"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-513"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027604"><a href="#local-1628027604"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027605"><a href="#local-1628027605"><span class="hs-identifier">lpat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628027595"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027600"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-514"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027606"><a href="#local-1628027606"><span class="hs-identifier">_env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027607"><a href="#local-1628027607"><span class="hs-identifier">dir'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPatSynDir"><span class="hs-identifier hs-var">zonkPatSynDir</span></a><span> </span><a href="#local-1628027604"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027601"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-515"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-516"></a><span>                  </span><a href="#local-1628027596"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027597"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628027602"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-517"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027603"><span class="hs-identifier hs-var">details'</span></a><span>
</span><a name="line-518"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027605"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-519"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027607"><span class="hs-identifier hs-var">dir'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">zonkPatSynDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-522"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-524"></a><a name="zonkPatSynDetails"><a href="TcHsSyn.html#zonkPatSynDetails"><span class="hs-identifier">zonkPatSynDetails</span></a></a><span> </span><a name="local-1628027608"><a href="#local-1628027608"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628027608"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-527"></a><a name="zonkPatSynDir"><a href="TcHsSyn.html#zonkPatSynDir"><span class="hs-identifier">zonkPatSynDir</span></a></a><span> </span><a name="local-1628027609"><a href="#local-1628027609"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027609"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><a name="local-1628027610"><a href="#local-1628027610"><span class="hs-identifier">env</span></a></a><span> </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027610"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span class="hs-identifier">zonkPatSynDir</span><span> </span><a name="local-1628027611"><a href="#local-1628027611"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span> </span><a name="local-1628027612"><a href="#local-1628027612"><span class="hs-identifier">mg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-530"></a><span>    </span><a name="local-1628027613"><a href="#local-1628027613"><span class="hs-identifier">mg'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027611"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027612"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-531"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027611"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span> </span><a href="#local-1628027613"><span class="hs-identifier hs-var">mg'</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">zonkSpecPrags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#TcSpecPrags"><span class="hs-identifier hs-type">TcSpecPrags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="HsBinds.html#TcSpecPrags"><span class="hs-identifier hs-type">TcSpecPrags</span></a><span>
</span><a name="line-534"></a><a name="zonkSpecPrags"><a href="TcHsSyn.html#zonkSpecPrags"><span class="hs-identifier">zonkSpecPrags</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><a href="HsBinds.html#IsDefaultMethod"><span class="hs-identifier hs-var">IsDefaultMethod</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="HsBinds.html#IsDefaultMethod"><span class="hs-identifier hs-var">IsDefaultMethod</span></a><span>
</span><a name="line-535"></a><span class="hs-identifier">zonkSpecPrags</span><span> </span><a name="local-1628027614"><a href="#local-1628027614"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrags"><span class="hs-identifier hs-var">SpecPrags</span></a><span> </span><a name="local-1628027615"><a href="#local-1628027615"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027616"><a href="#local-1628027616"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier hs-var">zonkLTcSpecPrags</span></a><span> </span><a href="#local-1628027614"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027615"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-536"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrags"><span class="hs-identifier hs-var">SpecPrags</span></a><span> </span><a href="#local-1628027616"><span class="hs-identifier hs-var">ps'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-identifier">zonkLTcSpecPrags</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a><span class="hs-special">]</span><span>
</span><a name="line-539"></a><a name="zonkLTcSpecPrags"><a href="TcHsSyn.html#zonkLTcSpecPrags"><span class="hs-identifier">zonkLTcSpecPrags</span></a></a><span> </span><a name="local-1628027617"><a href="#local-1628027617"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027618"><a href="#local-1628027618"><span class="hs-identifier">ps</span></a></a><span>
</span><a name="line-540"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628027619"><span class="hs-identifier hs-var">zonk_prag</span></a><span> </span><a href="#local-1628027618"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-541"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-542"></a><span>    </span><a name="local-1628027619"><a href="#local-1628027619"><span class="hs-identifier">zonk_prag</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027620"><a href="#local-1628027620"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrag"><span class="hs-identifier hs-var">SpecPrag</span></a><span> </span><a name="local-1628027621"><a href="#local-1628027621"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-1628027622"><a href="#local-1628027622"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-1628027623"><a href="#local-1628027623"><span class="hs-identifier">inl</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027624"><a href="#local-1628027624"><span class="hs-identifier">co_fn'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027617"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027622"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-544"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027620"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#SpecPrag"><span class="hs-identifier hs-var">SpecPrag</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628027617"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027621"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027624"><span class="hs-identifier hs-var">co_fn'</span></a><span> </span><a href="#local-1628027623"><span class="hs-identifier hs-var">inl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Match-GRHSs]{Match and GRHSs}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-identifier">zonkMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-555"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027367"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027367"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-556"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027367"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027367"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-557"></a><a name="zonkMatchGroup"><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier">zonkMatchGroup</span></a></a><span> </span><a name="local-1628027625"><a href="#local-1628027625"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027626"><a href="#local-1628027626"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027627"><a href="#local-1628027627"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027628"><a href="#local-1628027628"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027629"><a href="#local-1628027629"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-558"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027630"><a href="#local-1628027630"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027631"><a href="#local-1628027631"><span class="hs-identifier">origin</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-559"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628027632"><a href="#local-1628027632"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkMatch"><span class="hs-identifier hs-var">zonkMatch</span></a><span> </span><a href="#local-1628027625"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027626"><span class="hs-identifier hs-var">zBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027628"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-560"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027633"><a href="#local-1628027633"><span class="hs-identifier">arg_tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span> </span><a href="#local-1628027625"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027629"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-561"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027634"><a href="#local-1628027634"><span class="hs-identifier">res_ty'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027625"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027630"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-562"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027627"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027632"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027633"><span class="hs-identifier hs-var">arg_tys'</span></a><span>
</span><a name="line-563"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027634"><span class="hs-identifier hs-var">res_ty'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027631"><span class="hs-identifier hs-var">origin</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">zonkMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-566"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027366"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027366"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-567"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027366"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027366"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-568"></a><a name="zonkMatch"><a href="TcHsSyn.html#zonkMatch"><span class="hs-identifier">zonkMatch</span></a></a><span> </span><a name="local-1628027635"><a href="#local-1628027635"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027636"><a href="#local-1628027636"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027637"><a href="#local-1628027637"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a name="local-1628027638"><a href="#local-1628027638"><span class="hs-identifier">mf</span></a></a><span> </span><a name="local-1628027639"><a href="#local-1628027639"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027640"><a href="#local-1628027640"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-569"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027641"><a href="#local-1628027641"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027642"><a href="#local-1628027642"><span class="hs-identifier">new_pats</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628027635"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027639"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-570"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027643"><a href="#local-1628027643"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier hs-var">zonkGRHSs</span></a><span> </span><a href="#local-1628027641"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027636"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628027640"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-571"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027637"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="#local-1628027638"><span class="hs-identifier hs-var">mf</span></a><span> </span><a href="#local-1628027642"><span class="hs-identifier hs-var">new_pats</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-1628027643"><span class="hs-identifier hs-var">new_grhss</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-574"></a><span class="hs-identifier">zonkGRHSs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-575"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027365"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027365"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027365"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027365"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><a name="zonkGRHSs"><a href="TcHsSyn.html#zonkGRHSs"><span class="hs-identifier">zonkGRHSs</span></a></a><span> </span><a name="local-1628027644"><a href="#local-1628027644"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027645"><a href="#local-1628027645"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a name="local-1628027646"><a href="#local-1628027646"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027647"><a href="#local-1628027647"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027648"><a href="#local-1628027648"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-special">(</span><a name="local-1628027649"><a href="#local-1628027649"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027650"><a href="#local-1628027650"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-1628027644"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027648"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-580"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-581"></a><span>        </span><a name="local-1628027651"><a href="#local-1628027651"><span class="hs-identifier">zonk_grhs</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-1628027652"><a href="#local-1628027652"><span class="hs-identifier">guarded</span></a></a><span> </span><a name="local-1628027653"><a href="#local-1628027653"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-582"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027654"><a href="#local-1628027654"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027655"><a href="#local-1628027655"><span class="hs-identifier">new_guarded</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628027649"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027652"><span class="hs-identifier hs-var">guarded</span></a><span>
</span><a name="line-583"></a><span>               </span><a name="local-1628027656"><a href="#local-1628027656"><span class="hs-identifier">new_rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027645"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628027654"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027653"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-584"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="#local-1628027655"><span class="hs-identifier hs-var">new_guarded</span></a><span> </span><a href="#local-1628027656"><span class="hs-identifier hs-var">new_rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>    </span><a name="local-1628027657"><a href="#local-1628027657"><span class="hs-identifier">new_grhss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-1628027651"><span class="hs-identifier hs-var">zonk_grhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027646"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-586"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a href="#local-1628027657"><span class="hs-identifier hs-var">new_grhss</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027647"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027650"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>
</span><a name="line-588"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-HsExpr]{Running a zonkitution over a TypeCheckedExpr}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-identifier">zonkLExprs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-597"></a><span class="hs-identifier">zonkLExpr</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span class="hs-identifier">zonkExpr</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><a name="zonkLExprs"><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier">zonkLExprs</span></a></a><span> </span><a name="local-1628027658"><a href="#local-1628027658"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027659"><a href="#local-1628027659"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027658"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027659"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-601"></a><a name="zonkLExpr"><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier">zonkLExpr</span></a></a><span>  </span><a name="local-1628027660"><a href="#local-1628027660"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027661"><a href="#local-1628027661"><span class="hs-identifier">expr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027660"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027661"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><a name="zonkExpr"><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier">zonkExpr</span></a></a><span> </span><a name="local-1628027662"><a href="#local-1628027662"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027663"><a href="#local-1628027663"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027664"><a href="#local-1628027664"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027663"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628027662"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027664"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a><span> </span><a name="local-1628027665"><a href="#local-1628027665"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-607"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIPVar"><span class="hs-identifier hs-var">HsIPVar</span></a><span> </span><a href="#local-1628027665"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a><span> </span><a name="local-1628027666"><a href="#local-1628027666"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLabel"><span class="hs-identifier hs-var">HsOverLabel</span></a><span> </span><a href="#local-1628027666"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027667"><a href="#local-1628027667"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><a name="local-1628027668"><a href="#local-1628027668"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1628027669"><a href="#local-1628027669"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027670"><a href="#local-1628027670"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027667"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027669"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-614"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsRat"><span class="hs-identifier hs-var">HsRat</span></a><span> </span><a href="#local-1628027668"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628027670"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a name="local-1628027671"><a href="#local-1628027671"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="#local-1628027671"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027672"><a href="#local-1628027672"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a name="local-1628027673"><a href="#local-1628027673"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628027674"><a href="#local-1628027674"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-1628027672"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027673"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-621"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a href="#local-1628027674"><span class="hs-identifier hs-var">lit'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027675"><a href="#local-1628027675"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a name="local-1628027676"><a href="#local-1628027676"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027677"><a href="#local-1628027677"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027675"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027676"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-625"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="#local-1628027677"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027678"><a href="#local-1628027678"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><a name="local-1628027679"><a href="#local-1628027679"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-628"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027680"><a href="#local-1628027680"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027678"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027679"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-629"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><a href="#local-1628027680"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027681"><a href="#local-1628027681"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a name="local-1628027682"><a href="#local-1628027682"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628027683"><a href="#local-1628027683"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027684"><a href="#local-1628027684"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027681"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027682"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-633"></a><span>       </span><a name="local-1628027685"><a href="#local-1628027685"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027681"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027683"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-634"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-1628027684"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628027685"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027686"><a href="#local-1628027686"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppTypeOut"><span class="hs-identifier hs-var">HsAppTypeOut</span></a><span> </span><a name="local-1628027687"><a href="#local-1628027687"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628027688"><a href="#local-1628027688"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027689"><a href="#local-1628027689"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027686"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027687"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-638"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppTypeOut"><span class="hs-identifier hs-var">HsAppTypeOut</span></a><span> </span><a href="#local-1628027689"><span class="hs-identifier hs-var">new_e</span></a><span> </span><a href="#local-1628027688"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>       </span><span class="hs-comment">-- NB: the type is an HsType; can't zonk that!</span><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027690"><a href="#local-1628027690"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsRnBracketOut"><span class="hs-identifier hs-var">HsRnBracketOut</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonkExpr: HsRnBracketOut&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628027690"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027691"><a href="#local-1628027691"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTcBracketOut"><span class="hs-identifier hs-var">HsTcBracketOut</span></a><span> </span><a name="local-1628027692"><a href="#local-1628027692"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1628027693"><a href="#local-1628027693"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027698"><a href="#local-1628027698"><span class="hs-identifier">bs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628027694"><span class="hs-identifier hs-var">zonk_b</span></a><span> </span><a href="#local-1628027693"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-646"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTcBracketOut"><span class="hs-identifier hs-var">HsTcBracketOut</span></a><span> </span><a href="#local-1628027692"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1628027698"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-648"></a><span>    </span><a name="local-1628027694"><a href="#local-1628027694"><span class="hs-identifier">zonk_b</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a><span> </span><a name="local-1628027695"><a href="#local-1628027695"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628027696"><a href="#local-1628027696"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027697"><a href="#local-1628027697"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027696"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-649"></a><span>                                      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a><span> </span><a href="#local-1628027695"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1628027697"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a name="local-1628027699"><a href="#local-1628027699"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier hs-var">s</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Should not happen</span><span>
</span><a name="line-652"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a href="#local-1628027699"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027700"><a href="#local-1628027700"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a name="local-1628027701"><a href="#local-1628027701"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628027702"><a href="#local-1628027702"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628027703"><a href="#local-1628027703"><span class="hs-identifier">fixity</span></a></a><span> </span><a name="local-1628027704"><a href="#local-1628027704"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027705"><a href="#local-1628027705"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027701"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-656"></a><span>       </span><a name="local-1628027706"><a href="#local-1628027706"><span class="hs-identifier">new_op</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027702"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-657"></a><span>       </span><a name="local-1628027707"><a href="#local-1628027707"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027704"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-658"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-1628027705"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628027706"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-1628027703"><span class="hs-identifier hs-var">fixity</span></a><span> </span><a href="#local-1628027707"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027708"><a href="#local-1628027708"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a name="local-1628027709"><a href="#local-1628027709"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027710"><a href="#local-1628027710"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-661"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027711"><a href="#local-1628027711"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027712"><a href="#local-1628027712"><span class="hs-identifier">new_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628027708"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027710"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-662"></a><span>       </span><a name="local-1628027713"><a href="#local-1628027713"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027711"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1628027709"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-663"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a href="#local-1628027713"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027712"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027714"><a href="#local-1628027714"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a name="local-1628027715"><a href="#local-1628027715"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027716"><a href="#local-1628027716"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027714"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027715"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-667"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="#local-1628027716"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027717"><a href="#local-1628027717"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a><span> </span><a name="local-1628027718"><a href="#local-1628027718"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027719"><a href="#local-1628027719"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027720"><a href="#local-1628027720"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027717"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027718"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-671"></a><span>       </span><a name="local-1628027721"><a href="#local-1628027721"><span class="hs-identifier">new_op</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027717"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027719"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-672"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionL"><span class="hs-identifier hs-var">SectionL</span></a><span> </span><a href="#local-1628027720"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027721"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">)</span><span>
</span><a name="line-673"></a><span>
</span><a name="line-674"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027722"><a href="#local-1628027722"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><a name="local-1628027723"><a href="#local-1628027723"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628027724"><a href="#local-1628027724"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027725"><a href="#local-1628027725"><span class="hs-identifier">new_op</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027722"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027723"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-676"></a><span>       </span><a name="local-1628027726"><a href="#local-1628027726"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027722"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027724"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-677"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><a href="#local-1628027725"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-1628027726"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027727"><a href="#local-1628027727"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a name="local-1628027728"><a href="#local-1628027728"><span class="hs-identifier">tup_args</span></a></a><span> </span><a name="local-1628027729"><a href="#local-1628027729"><span class="hs-identifier">boxed</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027737"><a href="#local-1628027737"><span class="hs-identifier">new_tup_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628027730"><span class="hs-identifier hs-var">zonk_tup_arg</span></a><span> </span><a href="#local-1628027728"><span class="hs-identifier hs-var">tup_args</span></a><span>
</span><a name="line-681"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a href="#local-1628027737"><span class="hs-identifier hs-var">new_tup_args</span></a><span> </span><a href="#local-1628027729"><span class="hs-identifier hs-var">boxed</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-682"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-683"></a><span>    </span><a name="local-1628027730"><a href="#local-1628027730"><span class="hs-identifier">zonk_tup_arg</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027731"><a href="#local-1628027731"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><a name="local-1628027732"><a href="#local-1628027732"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027733"><a href="#local-1628027733"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027727"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027732"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-684"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027731"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><a href="#local-1628027733"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-685"></a><span>    </span><span class="hs-identifier">zonk_tup_arg</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027734"><a href="#local-1628027734"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a name="local-1628027735"><a href="#local-1628027735"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027736"><a href="#local-1628027736"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027727"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027735"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-686"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027734"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a href="#local-1628027736"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027738"><a href="#local-1628027738"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a name="local-1628027739"><a href="#local-1628027739"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027740"><a href="#local-1628027740"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027741"><a href="#local-1628027741"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027738"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027739"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-690"></a><span>       </span><a name="local-1628027742"><a href="#local-1628027742"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027738"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027740"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-691"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a href="#local-1628027741"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027742"><span class="hs-identifier hs-var">new_ms</span></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>
</span><a name="line-693"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027743"><a href="#local-1628027743"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a name="local-1628027744"><a href="#local-1628027744"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628027745"><a href="#local-1628027745"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-1628027746"><a href="#local-1628027746"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-694"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027747"><a href="#local-1628027747"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027743"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027744"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-695"></a><span>       </span><a name="local-1628027748"><a href="#local-1628027748"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027743"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027745"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-696"></a><span>       </span><a name="local-1628027749"><a href="#local-1628027749"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027743"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027746"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-697"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-1628027747"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628027748"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-1628027749"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>
</span><a name="line-699"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027750"><a href="#local-1628027750"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628027751"><a href="#local-1628027751"><span class="hs-identifier">fun</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027752"><a href="#local-1628027752"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628027753"><a href="#local-1628027753"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-1628027754"><a href="#local-1628027754"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027755"><a href="#local-1628027755"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027756"><a href="#local-1628027756"><span class="hs-identifier">new_fun</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628027750"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027751"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-701"></a><span>       </span><a name="local-1628027757"><a href="#local-1628027757"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027755"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027752"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-702"></a><span>       </span><a name="local-1628027758"><a href="#local-1628027758"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027755"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027753"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-703"></a><span>       </span><a name="local-1628027759"><a href="#local-1628027759"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027755"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027754"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-704"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628027756"><span class="hs-identifier hs-var">new_fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027757"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628027758"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-1628027759"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027760"><a href="#local-1628027760"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a><span> </span><a name="local-1628027761"><a href="#local-1628027761"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628027762"><a href="#local-1628027762"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027769"><a href="#local-1628027769"><span class="hs-identifier">alts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><a href="#local-1628027763"><span class="hs-identifier hs-var">zonk_alt</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027762"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-708"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027770"><a href="#local-1628027770"><span class="hs-identifier">ty'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027760"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027761"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-709"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#HsMultiIf"><span class="hs-identifier hs-var">HsMultiIf</span></a><span> </span><a href="#local-1628027770"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1628027769"><span class="hs-identifier hs-var">alts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-710"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1628027763"><a href="#local-1628027763"><span class="hs-identifier">zonk_alt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-1628027764"><a href="#local-1628027764"><span class="hs-identifier">guard</span></a></a><span> </span><a name="local-1628027765"><a href="#local-1628027765"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027766"><a href="#local-1628027766"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027767"><a href="#local-1628027767"><span class="hs-identifier">guard'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628027760"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027764"><span class="hs-identifier hs-var">guard</span></a><span>
</span><a name="line-712"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-1628027768"><a href="#local-1628027768"><span class="hs-identifier">expr'</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027766"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1628027765"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-713"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="#local-1628027767"><span class="hs-identifier hs-var">guard'</span></a><span> </span><a href="#local-1628027768"><span class="hs-identifier hs-var">expr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-714"></a><span>
</span><a name="line-715"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027771"><a href="#local-1628027771"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027772"><a href="#local-1628027772"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027773"><a href="#local-1628027773"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027774"><a href="#local-1628027774"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027775"><a href="#local-1628027775"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027776"><a href="#local-1628027776"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-1628027771"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027773"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-717"></a><span>       </span><a name="local-1628027777"><a href="#local-1628027777"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027775"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="#local-1628027774"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-718"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027772"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027776"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027777"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>
</span><a name="line-720"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027778"><a href="#local-1628027778"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a name="local-1628027779"><a href="#local-1628027779"><span class="hs-identifier">do_or_lc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027780"><a href="#local-1628027780"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027781"><a href="#local-1628027781"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027782"><a href="#local-1628027782"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-721"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027783"><a href="#local-1628027783"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628027778"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027781"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-722"></a><span>       </span><a name="local-1628027784"><a href="#local-1628027784"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027778"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027782"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-723"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a href="#local-1628027779"><span class="hs-identifier hs-var">do_or_lc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027780"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027783"><span class="hs-identifier hs-var">new_stmts</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027784"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span>
</span><a name="line-725"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027785"><a href="#local-1628027785"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a name="local-1628027786"><a href="#local-1628027786"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628027787"><a href="#local-1628027787"><span class="hs-identifier">wit</span></a></a><span> </span><a name="local-1628027788"><a href="#local-1628027788"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027793"><a href="#local-1628027793"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027794"><a href="#local-1628027794"><span class="hs-identifier">new_wit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027789"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-1628027785"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027787"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-727"></a><span>       </span><a name="local-1628027795"><a href="#local-1628027795"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027793"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027786"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-728"></a><span>       </span><a name="local-1628027796"><a href="#local-1628027796"><span class="hs-identifier">new_exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier hs-var">zonkLExprs</span></a><span> </span><a href="#local-1628027793"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027788"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-729"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a href="#local-1628027795"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-1628027794"><span class="hs-identifier hs-var">new_wit</span></a><span> </span><a href="#local-1628027796"><span class="hs-identifier hs-var">new_exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-1628027789"><a href="#local-1628027789"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-1628027790"><a href="#local-1628027790"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027790"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>         </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-1628027791"><a href="#local-1628027791"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628027792"><a href="#local-1628027792"><span class="hs-identifier">fln</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628027791"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027792"><span class="hs-identifier hs-var">fln</span></a><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027797"><a href="#local-1628027797"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><a name="local-1628027798"><a href="#local-1628027798"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628027799"><a href="#local-1628027799"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-734"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027800"><a href="#local-1628027800"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027797"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027798"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-735"></a><span>       </span><a name="local-1628027801"><a href="#local-1628027801"><span class="hs-identifier">new_exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExprs"><span class="hs-identifier hs-var">zonkLExprs</span></a><span> </span><a href="#local-1628027797"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027799"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-736"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><a href="#local-1628027800"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-1628027801"><span class="hs-identifier hs-var">new_exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-737"></a><span>
</span><a name="line-738"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027802"><a href="#local-1628027802"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027803"><a href="#local-1628027803"><span class="hs-identifier">expr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027804"><a href="#local-1628027804"><span class="hs-identifier">con_expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027805"><a href="#local-1628027805"><span class="hs-identifier">rbinds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628027806"><a href="#local-1628027806"><span class="hs-identifier">new_con_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027802"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027804"><span class="hs-identifier hs-var">con_expr</span></a><span>
</span><a name="line-740"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027807"><a href="#local-1628027807"><span class="hs-identifier">new_rbinds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecFields"><span class="hs-identifier hs-var">zonkRecFields</span></a><span> </span><a href="#local-1628027802"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027805"><span class="hs-identifier hs-var">rbinds</span></a><span>
</span><a name="line-741"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027803"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027806"><span class="hs-identifier hs-var">new_con_expr</span></a><span>
</span><a name="line-742"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027807"><span class="hs-identifier hs-var">new_rbinds</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027808"><a href="#local-1628027808"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027809"><a href="#local-1628027809"><span class="hs-identifier">expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027810"><a href="#local-1628027810"><span class="hs-identifier">rbinds</span></a></a><span>
</span><a name="line-745"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027811"><a href="#local-1628027811"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_in_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027812"><a href="#local-1628027812"><span class="hs-identifier">in_tys</span></a></a><span>
</span><a name="line-746"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_out_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027813"><a href="#local-1628027813"><span class="hs-identifier">out_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027814"><a href="#local-1628027814"><span class="hs-identifier">req_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628027815"><a href="#local-1628027815"><span class="hs-identifier">new_expr</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027808"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027809"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-748"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027816"><a href="#local-1628027816"><span class="hs-identifier">new_in_tys</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027808"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027812"><span class="hs-identifier hs-var">in_tys</span></a><span>
</span><a name="line-749"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027817"><a href="#local-1628027817"><span class="hs-identifier">new_out_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027808"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027813"><span class="hs-identifier hs-var">out_tys</span></a><span>
</span><a name="line-750"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027818"><a href="#local-1628027818"><span class="hs-identifier">new_rbinds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkRecUpdFields"><span class="hs-identifier hs-var">zonkRecUpdFields</span></a><span> </span><a href="#local-1628027808"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027810"><span class="hs-identifier hs-var">rbinds</span></a><span>
</span><a name="line-751"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027819"><a href="#local-1628027819"><span class="hs-identifier">new_recwrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027808"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027814"><span class="hs-identifier hs-var">req_wrap</span></a><span>
</span><a name="line-752"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027815"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-1628027818"><span class="hs-identifier hs-var">new_rbinds</span></a><span>
</span><a name="line-753"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027811"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_in_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027816"><span class="hs-identifier hs-var">new_in_tys</span></a><span>
</span><a name="line-754"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_out_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027817"><span class="hs-identifier hs-var">new_out_tys</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027819"><span class="hs-identifier hs-var">new_recwrap</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027820"><a href="#local-1628027820"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySigOut"><span class="hs-identifier hs-var">ExprWithTySigOut</span></a><span> </span><a name="local-1628027821"><a href="#local-1628027821"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1628027822"><a href="#local-1628027822"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027823"><a href="#local-1628027823"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027820"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027821"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-758"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySigOut"><span class="hs-identifier hs-var">ExprWithTySigOut</span></a><span> </span><a href="#local-1628027823"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-1628027822"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027824"><a href="#local-1628027824"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a><span> </span><a name="local-1628027825"><a href="#local-1628027825"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027826"><a href="#local-1628027826"><span class="hs-identifier">wit</span></a></a><span> </span><a name="local-1628027827"><a href="#local-1628027827"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-761"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027832"><a href="#local-1628027832"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027833"><a href="#local-1628027833"><span class="hs-identifier">new_wit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027828"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-1628027824"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027826"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-762"></a><span>       </span><a name="local-1628027834"><a href="#local-1628027834"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027824"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027825"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-763"></a><span>       </span><a name="local-1628027835"><a href="#local-1628027835"><span class="hs-identifier">new_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier hs-var">zonkArithSeq</span></a><span> </span><a href="#local-1628027832"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027827"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-764"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeq"><span class="hs-identifier hs-var">ArithSeq</span></a><span> </span><a href="#local-1628027834"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027833"><span class="hs-identifier hs-var">new_wit</span></a><span> </span><a href="#local-1628027835"><span class="hs-identifier hs-var">new_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-765"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-1628027828"><a href="#local-1628027828"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-1628027829"><a href="#local-1628027829"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027829"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-766"></a><span>         </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-1628027830"><a href="#local-1628027830"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628027831"><a href="#local-1628027831"><span class="hs-identifier">fln</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628027830"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027831"><span class="hs-identifier hs-var">fln</span></a><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027836"><a href="#local-1628027836"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PArrSeq"><span class="hs-identifier hs-var">PArrSeq</span></a><span> </span><a name="local-1628027837"><a href="#local-1628027837"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027838"><a href="#local-1628027838"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027839"><a href="#local-1628027839"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027836"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027837"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-770"></a><span>       </span><a name="local-1628027840"><a href="#local-1628027840"><span class="hs-identifier">new_info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier hs-var">zonkArithSeq</span></a><span> </span><a href="#local-1628027836"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027838"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-771"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PArrSeq"><span class="hs-identifier hs-var">PArrSeq</span></a><span> </span><a href="#local-1628027839"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027840"><span class="hs-identifier hs-var">new_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027841"><a href="#local-1628027841"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSCC"><span class="hs-identifier hs-var">HsSCC</span></a><span> </span><a name="local-1628027842"><a href="#local-1628027842"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-1628027843"><a href="#local-1628027843"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-1628027844"><a href="#local-1628027844"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027845"><a href="#local-1628027845"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027841"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027844"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-775"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSCC"><span class="hs-identifier hs-var">HsSCC</span></a><span> </span><a href="#local-1628027842"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027843"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1628027845"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-776"></a><span>
</span><a name="line-777"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027846"><a href="#local-1628027846"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTickPragma"><span class="hs-identifier hs-var">HsTickPragma</span></a><span> </span><a name="local-1628027847"><a href="#local-1628027847"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-1628027848"><a href="#local-1628027848"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-1628027849"><a href="#local-1628027849"><span class="hs-identifier">srcInfo</span></a></a><span> </span><a name="local-1628027850"><a href="#local-1628027850"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027851"><a href="#local-1628027851"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027846"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027850"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-779"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTickPragma"><span class="hs-identifier hs-var">HsTickPragma</span></a><span> </span><a href="#local-1628027847"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027848"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-1628027849"><span class="hs-identifier hs-var">srcInfo</span></a><span> </span><a href="#local-1628027851"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-780"></a><span>
</span><a name="line-781"></a><span class="hs-comment">-- hdaume: core annotations</span><span>
</span><a name="line-782"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027852"><a href="#local-1628027852"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCoreAnn"><span class="hs-identifier hs-var">HsCoreAnn</span></a><span> </span><a name="local-1628027853"><a href="#local-1628027853"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-1628027854"><a href="#local-1628027854"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-1628027855"><a href="#local-1628027855"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-783"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027856"><a href="#local-1628027856"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027852"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027855"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-784"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCoreAnn"><span class="hs-identifier hs-var">HsCoreAnn</span></a><span> </span><a href="#local-1628027853"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-1628027854"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1628027856"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-785"></a><span>
</span><a name="line-786"></a><span class="hs-comment">-- arrow notation extensions</span><span>
</span><a name="line-787"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027857"><a href="#local-1628027857"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><a name="local-1628027858"><a href="#local-1628027858"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628027859"><a href="#local-1628027859"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-788"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027860"><a href="#local-1628027860"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027861"><a href="#local-1628027861"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628027857"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027858"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-789"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628027862"><a href="#local-1628027862"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier hs-var">zonkCmdTop</span></a><span> </span><a href="#local-1628027860"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027859"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-790"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><a href="#local-1628027861"><span class="hs-identifier hs-var">new_pat</span></a><span> </span><a href="#local-1628027862"><span class="hs-identifier hs-var">new_body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-791"></a><span>
</span><a name="line-792"></a><span class="hs-comment">-- StaticPointers extension</span><span>
</span><a name="line-793"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027863"><a href="#local-1628027863"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a><span> </span><a name="local-1628027864"><a href="#local-1628027864"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-794"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsStatic"><span class="hs-identifier hs-var">HsStatic</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027863"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027864"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-795"></a><span>
</span><a name="line-796"></a><span class="hs-identifier">zonkExpr</span><span> </span><a name="local-1628027865"><a href="#local-1628027865"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a name="local-1628027866"><a href="#local-1628027866"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-1628027867"><a href="#local-1628027867"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027868"><a href="#local-1628027868"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027869"><a href="#local-1628027869"><span class="hs-identifier">new_co_fn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027865"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027866"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-798"></a><span>       </span><a name="local-1628027870"><a href="#local-1628027870"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027868"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027867"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-799"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a href="#local-1628027869"><span class="hs-identifier hs-var">new_co_fn</span></a><span> </span><a href="#local-1628027870"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027871"><a href="#local-1628027871"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628027871"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">zonkExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628027872"><a href="#local-1628027872"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonkExpr&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628027872"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-806"></a><span class="hs-comment">{-
Note [Skolems in zonkSyntaxExpr]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider rebindable syntax with something like

  (&gt;&gt;=) :: (forall x. blah) -&gt; (forall y. blah') -&gt; blah''

The x and y become skolems that are in scope when type-checking the
arguments to the bind. This means that we must extend the ZonkEnv with
these skolems when zonking the arguments to the bind. But the skolems
are different between the two arguments, and so we should theoretically
carry around different environments to use for the different arguments.

However, this becomes a logistical nightmare, especially in dealing with
the more exotic Stmt forms. So, we simplify by making the critical
assumption that the uniques of the skolems are different. (This assumption
is justified by the use of newUnique in TcMType.instSkolTyCoVarX.)
Now, we can safely just extend one environment.
-}</span><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span class="hs-comment">-- See Note [Skolems in zonkSyntaxExpr]</span><span>
</span><a name="line-827"></a><span class="hs-identifier">zonkSyntaxExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>
</span><a name="line-828"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-829"></a><a name="zonkSyntaxExpr"><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier">zonkSyntaxExpr</span></a></a><span> </span><a name="local-1628027873"><a href="#local-1628027873"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027874"><a href="#local-1628027874"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-830"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027875"><a href="#local-1628027875"><span class="hs-identifier">arg_wraps</span></a></a><span>
</span><a name="line-831"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027876"><a href="#local-1628027876"><span class="hs-identifier">res_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027877"><a href="#local-1628027877"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027878"><a href="#local-1628027878"><span class="hs-identifier">res_wrap'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027873"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027876"><span class="hs-identifier hs-var">res_wrap</span></a><span>
</span><a name="line-833"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027879"><a href="#local-1628027879"><span class="hs-identifier">expr'</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027877"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628027874"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-834"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027880"><a href="#local-1628027880"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027881"><a href="#local-1628027881"><span class="hs-identifier">arg_wraps'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027877"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628027875"><span class="hs-identifier hs-var">arg_wraps</span></a><span>
</span><a name="line-835"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027880"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027879"><span class="hs-identifier hs-var">expr'</span></a><span>
</span><a name="line-836"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027881"><span class="hs-identifier hs-var">arg_wraps'</span></a><span>
</span><a name="line-837"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628027878"><span class="hs-identifier hs-var">res_wrap'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-840"></a><span>
</span><a name="line-841"></a><span class="hs-identifier">zonkLCmd</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-842"></a><span class="hs-identifier">zonkCmd</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-843"></a><span>
</span><a name="line-844"></a><a name="zonkLCmd"><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier">zonkLCmd</span></a></a><span>  </span><a name="local-1628027882"><a href="#local-1628027882"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027883"><a href="#local-1628027883"><span class="hs-identifier">cmd</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier hs-var">zonkCmd</span></a><span> </span><a href="#local-1628027882"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027883"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-845"></a><span>
</span><a name="line-846"></a><a name="zonkCmd"><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier">zonkCmd</span></a></a><span> </span><a name="local-1628027884"><a href="#local-1628027884"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a name="local-1628027885"><a href="#local-1628027885"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-1628027886"><a href="#local-1628027886"><span class="hs-identifier">cmd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-847"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027887"><a href="#local-1628027887"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027888"><a href="#local-1628027888"><span class="hs-identifier">w'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027884"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027885"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-848"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027889"><a href="#local-1628027889"><span class="hs-identifier">cmd'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCmd"><span class="hs-identifier hs-var">zonkCmd</span></a><span> </span><a href="#local-1628027887"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027886"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-849"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a href="#local-1628027888"><span class="hs-identifier hs-var">w'</span></a><span> </span><a href="#local-1628027889"><span class="hs-identifier hs-var">cmd'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-850"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027890"><a href="#local-1628027890"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a><span> </span><a name="local-1628027891"><a href="#local-1628027891"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628027892"><a href="#local-1628027892"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-1628027893"><a href="#local-1628027893"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628027894"><a href="#local-1628027894"><span class="hs-identifier">ho</span></a></a><span> </span><a name="local-1628027895"><a href="#local-1628027895"><span class="hs-identifier">rl</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-851"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027896"><a href="#local-1628027896"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027890"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027891"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-852"></a><span>       </span><a name="local-1628027897"><a href="#local-1628027897"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027890"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027892"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-853"></a><span>       </span><a name="local-1628027898"><a href="#local-1628027898"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027890"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027893"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-854"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a><span> </span><a href="#local-1628027896"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628027897"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-1628027898"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-1628027894"><span class="hs-identifier hs-var">ho</span></a><span> </span><a href="#local-1628027895"><span class="hs-identifier hs-var">rl</span></a><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027899"><a href="#local-1628027899"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a name="local-1628027900"><a href="#local-1628027900"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-1628027901"><a href="#local-1628027901"><span class="hs-identifier">fixity</span></a></a><span> </span><a name="local-1628027902"><a href="#local-1628027902"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027903"><a href="#local-1628027903"><span class="hs-identifier">new_op</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027899"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027900"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-858"></a><span>       </span><a name="local-1628027904"><a href="#local-1628027904"><span class="hs-identifier">new_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier hs-var">zonkCmdTop</span></a><span> </span><a href="#local-1628027899"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027902"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-859"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-1628027903"><span class="hs-identifier hs-var">new_op</span></a><span> </span><a href="#local-1628027901"><span class="hs-identifier hs-var">fixity</span></a><span> </span><a href="#local-1628027904"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-860"></a><span>
</span><a name="line-861"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027905"><a href="#local-1628027905"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a><span> </span><a name="local-1628027906"><a href="#local-1628027906"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1628027907"><a href="#local-1628027907"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027908"><a href="#local-1628027908"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027905"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027906"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-863"></a><span>       </span><a name="local-1628027909"><a href="#local-1628027909"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027905"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027907"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-864"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a><span> </span><a href="#local-1628027908"><span class="hs-identifier hs-var">new_c</span></a><span> </span><a href="#local-1628027909"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>
</span><a name="line-866"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027910"><a href="#local-1628027910"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a><span> </span><a name="local-1628027911"><a href="#local-1628027911"><span class="hs-identifier">matches</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027912"><a href="#local-1628027912"><span class="hs-identifier">new_matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027910"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027911"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-868"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a><span> </span><a href="#local-1628027912"><span class="hs-identifier hs-var">new_matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-869"></a><span>
</span><a name="line-870"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027913"><a href="#local-1628027913"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a><span> </span><a name="local-1628027914"><a href="#local-1628027914"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-871"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027915"><a href="#local-1628027915"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027913"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027914"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-872"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a><span> </span><a href="#local-1628027915"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">)</span><span>
</span><a name="line-873"></a><span>
</span><a name="line-874"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027916"><a href="#local-1628027916"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a><span> </span><a name="local-1628027917"><a href="#local-1628027917"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628027918"><a href="#local-1628027918"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-875"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027919"><a href="#local-1628027919"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027916"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027917"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-876"></a><span>       </span><a name="local-1628027920"><a href="#local-1628027920"><span class="hs-identifier">new_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkMatchGroup"><span class="hs-identifier hs-var">zonkMatchGroup</span></a><span> </span><a href="#local-1628027916"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027918"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-877"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a><span> </span><a href="#local-1628027919"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><a href="#local-1628027920"><span class="hs-identifier hs-var">new_ms</span></a><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027921"><a href="#local-1628027921"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a><span> </span><a name="local-1628027922"><a href="#local-1628027922"><span class="hs-identifier">eCond</span></a></a><span> </span><a name="local-1628027923"><a href="#local-1628027923"><span class="hs-identifier">ePred</span></a></a><span> </span><a name="local-1628027924"><a href="#local-1628027924"><span class="hs-identifier">cThen</span></a></a><span> </span><a name="local-1628027925"><a href="#local-1628027925"><span class="hs-identifier">cElse</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027930"><a href="#local-1628027930"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027931"><a href="#local-1628027931"><span class="hs-identifier">new_eCond</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628027926"><span class="hs-identifier hs-var">zonkWit</span></a><span> </span><a href="#local-1628027921"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027922"><span class="hs-identifier hs-var">eCond</span></a><span>
</span><a name="line-881"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027932"><a href="#local-1628027932"><span class="hs-identifier">new_ePred</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628027930"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027923"><span class="hs-identifier hs-var">ePred</span></a><span>
</span><a name="line-882"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027933"><a href="#local-1628027933"><span class="hs-identifier">new_cThen</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027930"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027924"><span class="hs-identifier hs-var">cThen</span></a><span>
</span><a name="line-883"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628027934"><a href="#local-1628027934"><span class="hs-identifier">new_cElse</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027930"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027925"><span class="hs-identifier hs-var">cElse</span></a><span>
</span><a name="line-884"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a><span> </span><a href="#local-1628027931"><span class="hs-identifier hs-var">new_eCond</span></a><span> </span><a href="#local-1628027932"><span class="hs-identifier hs-var">new_ePred</span></a><span> </span><a href="#local-1628027933"><span class="hs-identifier hs-var">new_cThen</span></a><span> </span><a href="#local-1628027934"><span class="hs-identifier hs-var">new_cElse</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-885"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-886"></a><span>    </span><a name="local-1628027926"><a href="#local-1628027926"><span class="hs-identifier">zonkWit</span></a></a><span> </span><a name="local-1628027927"><a href="#local-1628027927"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027927"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-887"></a><span>    </span><span class="hs-identifier">zonkWit</span><span> </span><a name="local-1628027928"><a href="#local-1628027928"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628027929"><a href="#local-1628027929"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628027928"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027929"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-888"></a><span>
</span><a name="line-889"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027935"><a href="#local-1628027935"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027936"><a href="#local-1628027936"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027937"><a href="#local-1628027937"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027938"><a href="#local-1628027938"><span class="hs-identifier">cmd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628027939"><a href="#local-1628027939"><span class="hs-identifier">new_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027940"><a href="#local-1628027940"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-1628027935"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027937"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-891"></a><span>       </span><a name="local-1628027941"><a href="#local-1628027941"><span class="hs-identifier">new_cmd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027939"><span class="hs-identifier hs-var">new_env</span></a><span> </span><a href="#local-1628027938"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-892"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027936"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027940"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027941"><span class="hs-identifier hs-var">new_cmd</span></a><span class="hs-special">)</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span class="hs-identifier">zonkCmd</span><span> </span><a name="local-1628027942"><a href="#local-1628027942"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628027943"><a href="#local-1628027943"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628027944"><a href="#local-1628027944"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628027945"><a href="#local-1628027945"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628027946"><a href="#local-1628027946"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628027942"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027944"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-896"></a><span>       </span><a name="local-1628027947"><a href="#local-1628027947"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027942"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027945"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-897"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628027943"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628027946"><span class="hs-identifier hs-var">new_stmts</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027947"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span>
</span><a name="line-901"></a><span>
</span><a name="line-902"></a><span>
</span><a name="line-903"></a><span class="hs-identifier">zonkCmdTop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-904"></a><a name="zonkCmdTop"><a href="TcHsSyn.html#zonkCmdTop"><span class="hs-identifier">zonkCmdTop</span></a></a><span> </span><a name="local-1628027948"><a href="#local-1628027948"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027949"><a href="#local-1628027949"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_cmd_top"><span class="hs-identifier hs-var">zonk_cmd_top</span></a><span> </span><a href="#local-1628027948"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027949"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-905"></a><span>
</span><a name="line-906"></a><span class="hs-identifier">zonk_cmd_top</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-type">HsCmdTop</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-type">HsCmdTop</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><a name="zonk_cmd_top"><a href="TcHsSyn.html#zonk_cmd_top"><span class="hs-identifier">zonk_cmd_top</span></a></a><span> </span><a name="local-1628027950"><a href="#local-1628027950"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a name="local-1628027951"><a href="#local-1628027951"><span class="hs-identifier">cmd</span></a></a><span> </span><a name="local-1628027952"><a href="#local-1628027952"><span class="hs-identifier">stack_tys</span></a></a><span> </span><a name="local-1628027953"><a href="#local-1628027953"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628027954"><a href="#local-1628027954"><span class="hs-identifier">ids</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628027955"><a href="#local-1628027955"><span class="hs-identifier">new_cmd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLCmd"><span class="hs-identifier hs-var">zonkLCmd</span></a><span> </span><a href="#local-1628027950"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027951"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-909"></a><span>       </span><a name="local-1628027956"><a href="#local-1628027956"><span class="hs-identifier">new_stack_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027950"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027952"><span class="hs-identifier hs-var">stack_tys</span></a><span>
</span><a name="line-910"></a><span>       </span><a name="local-1628027957"><a href="#local-1628027957"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027950"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027953"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-911"></a><span>       </span><a name="local-1628027958"><a href="#local-1628027958"><span class="hs-identifier">new_ids</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapSndM"><span class="hs-identifier hs-var">mapSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027950"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027954"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-912"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a href="#local-1628027955"><span class="hs-identifier hs-var">new_cmd</span></a><span> </span><a href="#local-1628027956"><span class="hs-identifier hs-var">new_stack_tys</span></a><span> </span><a href="#local-1628027957"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-1628027958"><span class="hs-identifier hs-var">new_ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-915"></a><span class="hs-identifier">zonkCoFn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span>
</span><a name="line-916"></a><a name="zonkCoFn"><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier">zonkCoFn</span></a></a><span> </span><a name="local-1628027959"><a href="#local-1628027959"><span class="hs-identifier">env</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027959"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027960"><a href="#local-1628027960"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a name="local-1628027961"><a href="#local-1628027961"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-1628027962"><a href="#local-1628027962"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027963"><a href="#local-1628027963"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027964"><a href="#local-1628027964"><span class="hs-identifier">c1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027960"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027961"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-918"></a><span>                                    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027965"><a href="#local-1628027965"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027966"><a href="#local-1628027966"><span class="hs-identifier">c2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027963"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027962"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-919"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027965"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a href="#local-1628027964"><span class="hs-identifier hs-var">c1'</span></a><span> </span><a href="#local-1628027966"><span class="hs-identifier hs-var">c2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-920"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027967"><a href="#local-1628027967"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a name="local-1628027968"><a href="#local-1628027968"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-1628027969"><a href="#local-1628027969"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-1628027970"><a href="#local-1628027970"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027971"><a href="#local-1628027971"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027972"><a href="#local-1628027972"><span class="hs-identifier">c1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027967"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027968"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-921"></a><span>                                   </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628027973"><a href="#local-1628027973"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027974"><a href="#local-1628027974"><span class="hs-identifier">c2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628027971"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628027969"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-922"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a name="local-1628027975"><a href="#local-1628027975"><span class="hs-identifier">t1'</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027973"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628027970"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-923"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027973"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a href="#local-1628027972"><span class="hs-identifier hs-var">c1'</span></a><span> </span><a href="#local-1628027974"><span class="hs-identifier hs-var">c2'</span></a><span> </span><a href="#local-1628027975"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-924"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027976"><a href="#local-1628027976"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-1628027977"><a href="#local-1628027977"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027978"><a href="#local-1628027978"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-1628027976"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027977"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-925"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027976"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a href="#local-1628027978"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-926"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027979"><a href="#local-1628027979"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a name="local-1628027980"><a href="#local-1628027980"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027981"><a href="#local-1628027981"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027982"><a href="#local-1628027982"><span class="hs-identifier">ev'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrX"><span class="hs-identifier hs-var">zonkEvBndrX</span></a><span> </span><a href="#local-1628027979"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027980"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-927"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027981"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a href="#local-1628027982"><span class="hs-identifier hs-var">ev'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-928"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027983"><a href="#local-1628027983"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a name="local-1628027984"><a href="#local-1628027984"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027985"><a href="#local-1628027985"><span class="hs-identifier">arg'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628027983"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027984"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-929"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027983"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a href="#local-1628027985"><span class="hs-identifier hs-var">arg'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-930"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027986"><a href="#local-1628027986"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a name="local-1628027987"><a href="#local-1628027987"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>                              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027988"><a href="#local-1628027988"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027989"><a href="#local-1628027989"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-1628027986"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027987"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-932"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027988"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a href="#local-1628027989"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-933"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027990"><a href="#local-1628027990"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a name="local-1628027991"><a href="#local-1628027991"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628027992"><a href="#local-1628027992"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027990"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027991"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-934"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027990"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a href="#local-1628027992"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-935"></a><span class="hs-identifier">zonkCoFn</span><span> </span><a name="local-1628027993"><a href="#local-1628027993"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a name="local-1628027994"><a href="#local-1628027994"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628027995"><a href="#local-1628027995"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628027996"><a href="#local-1628027996"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-1628027993"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027994"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-936"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027995"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a href="#local-1628027996"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-937"></a><span>
</span><a name="line-938"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-939"></a><span class="hs-identifier">zonkOverLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><a name="zonkOverLit"><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier">zonkOverLit</span></a></a><span> </span><a name="local-1628027997"><a href="#local-1628027997"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628027998"><a href="#local-1628027998"><span class="hs-identifier">lit</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ol_witness</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628027999"><a href="#local-1628027999"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ol_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028000"><a href="#local-1628028000"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028001"><a href="#local-1628028001"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628027997"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028000"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-942"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028002"><a href="#local-1628028002"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628027997"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628027999"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-943"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027998"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ol_witness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028002"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ol_type</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028001"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-944"></a><span>
</span><a name="line-945"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-946"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-947"></a><span>
</span><a name="line-948"></a><a name="zonkArithSeq"><a href="TcHsSyn.html#zonkArithSeq"><span class="hs-identifier">zonkArithSeq</span></a></a><span> </span><a name="local-1628028003"><a href="#local-1628028003"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a name="local-1628028004"><a href="#local-1628028004"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628028005"><a href="#local-1628028005"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028003"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028004"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-950"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="#local-1628028005"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>
</span><a name="line-952"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-1628028006"><a href="#local-1628028006"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThen"><span class="hs-identifier hs-var">FromThen</span></a><span> </span><a name="local-1628028007"><a href="#local-1628028007"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628028008"><a href="#local-1628028008"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628028009"><a href="#local-1628028009"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028006"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028007"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-954"></a><span>       </span><a name="local-1628028010"><a href="#local-1628028010"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028006"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028008"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-955"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThen"><span class="hs-identifier hs-var">FromThen</span></a><span> </span><a href="#local-1628028009"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628028010"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-1628028011"><a href="#local-1628028011"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromTo"><span class="hs-identifier hs-var">FromTo</span></a><span> </span><a name="local-1628028012"><a href="#local-1628028012"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628028013"><a href="#local-1628028013"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-958"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628028014"><a href="#local-1628028014"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028011"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028012"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-959"></a><span>       </span><a name="local-1628028015"><a href="#local-1628028015"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028011"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028013"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-960"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromTo"><span class="hs-identifier hs-var">FromTo</span></a><span> </span><a href="#local-1628028014"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628028015"><span class="hs-identifier hs-var">new_e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>
</span><a name="line-962"></a><span class="hs-identifier">zonkArithSeq</span><span> </span><a name="local-1628028016"><a href="#local-1628028016"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThenTo"><span class="hs-identifier hs-var">FromThenTo</span></a><span> </span><a name="local-1628028017"><a href="#local-1628028017"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628028018"><a href="#local-1628028018"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-1628028019"><a href="#local-1628028019"><span class="hs-identifier">e3</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-963"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628028020"><a href="#local-1628028020"><span class="hs-identifier">new_e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028016"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028017"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-964"></a><span>       </span><a name="local-1628028021"><a href="#local-1628028021"><span class="hs-identifier">new_e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028016"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028018"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-965"></a><span>       </span><a name="local-1628028022"><a href="#local-1628028022"><span class="hs-identifier">new_e3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028016"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028019"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-966"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FromThenTo"><span class="hs-identifier hs-var">FromThenTo</span></a><span> </span><a href="#local-1628028020"><span class="hs-identifier hs-var">new_e1</span></a><span> </span><a href="#local-1628028021"><span class="hs-identifier hs-var">new_e2</span></a><span> </span><a href="#local-1628028022"><span class="hs-identifier hs-var">new_e3</span></a><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span>
</span><a name="line-969"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-970"></a><span class="hs-identifier">zonkStmts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-971"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027364"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027364"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-972"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027364"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027364"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-973"></a><a name="zonkStmts"><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier">zonkStmts</span></a></a><span> </span><a name="local-1628028023"><a href="#local-1628028023"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028023"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-974"></a><span class="hs-identifier">zonkStmts</span><span> </span><a name="local-1628028024"><a href="#local-1628028024"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028025"><a href="#local-1628028025"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628028026"><a href="#local-1628028026"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-1628028027"><a href="#local-1628028027"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028028"><a href="#local-1628028028"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028029"><a href="#local-1628028029"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocSndM"><span class="hs-identifier hs-var">wrapLocSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkStmt"><span class="hs-identifier hs-var">zonkStmt</span></a><span> </span><a href="#local-1628028024"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028025"><span class="hs-identifier hs-var">zBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028026"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-975"></a><span>                                </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028030"><a href="#local-1628028030"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028031"><a href="#local-1628028031"><span class="hs-identifier">ss'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628028028"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028025"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628028027"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-976"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028030"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028029"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628028031"><span class="hs-identifier hs-var">ss'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-977"></a><span>
</span><a name="line-978"></a><span class="hs-identifier">zonkStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-979"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027363"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027363"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027363"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628027363"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-981"></a><a name="zonkStmt"><a href="TcHsSyn.html#zonkStmt"><span class="hs-identifier">zonkStmt</span></a></a><span> </span><a name="local-1628028032"><a href="#local-1628028032"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a name="local-1628028033"><a href="#local-1628028033"><span class="hs-identifier">stmts_w_bndrs</span></a></a><span> </span><a name="local-1628028034"><a href="#local-1628028034"><span class="hs-identifier">mzip_op</span></a></a><span> </span><a name="local-1628028035"><a href="#local-1628028035"><span class="hs-identifier">bind_op</span></a></a><span> </span><a name="local-1628028036"><a href="#local-1628028036"><span class="hs-identifier">bind_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-982"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028046"><a href="#local-1628028046"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028047"><a href="#local-1628028047"><span class="hs-identifier">new_bind_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028032"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028035"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-983"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028048"><a href="#local-1628028048"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028046"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028036"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-984"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028049"><a href="#local-1628028049"><span class="hs-identifier">new_stmts_w_bndrs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028037"><span class="hs-identifier hs-var">zonk_branch</span></a><span> </span><a href="#local-1628028046"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028033"><span class="hs-identifier hs-var">stmts_w_bndrs</span></a><span>
</span><a name="line-985"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028050"><a href="#local-1628028050"><span class="hs-identifier">new_binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628028053"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028052"><a href="#local-1628028052"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028049"><span class="hs-identifier hs-var">new_stmts_w_bndrs</span></a><span class="hs-special">,</span><span> </span><a name="local-1628028053"><a href="#local-1628028053"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028052"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">]</span><span>
</span><a name="line-986"></a><span>             </span><a name="local-1628028051"><a href="#local-1628028051"><span class="hs-identifier">env2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028046"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028050"><span class="hs-identifier hs-var">new_binders</span></a><span>
</span><a name="line-987"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028054"><a href="#local-1628028054"><span class="hs-identifier">new_mzip</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628028051"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028034"><span class="hs-identifier hs-var">mzip_op</span></a><span>
</span><a name="line-988"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028051"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><a href="#local-1628028049"><span class="hs-identifier hs-var">new_stmts_w_bndrs</span></a><span> </span><a href="#local-1628028054"><span class="hs-identifier hs-var">new_mzip</span></a><span> </span><a href="#local-1628028047"><span class="hs-identifier hs-var">new_bind_op</span></a><span> </span><a href="#local-1628028048"><span class="hs-identifier hs-var">new_bind_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-989"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-990"></a><span>    </span><a name="local-1628028037"><a href="#local-1628028037"><span class="hs-identifier">zonk_branch</span></a></a><span> </span><a name="local-1628028038"><a href="#local-1628028038"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a name="local-1628028039"><a href="#local-1628028039"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-1628028040"><a href="#local-1628028040"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-1628028041"><a href="#local-1628028041"><span class="hs-identifier">return_op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-991"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028042"><a href="#local-1628028042"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028043"><a href="#local-1628028043"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628028038"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028039"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-992"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028044"><a href="#local-1628028044"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028045"><a href="#local-1628028045"><span class="hs-identifier">new_return</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028042"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028041"><span class="hs-identifier hs-var">return_op</span></a><span>
</span><a name="line-993"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><a href="#local-1628028043"><span class="hs-identifier hs-var">new_stmts</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOccs"><span class="hs-identifier hs-var">zonkIdOccs</span></a><span> </span><a href="#local-1628028044"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028040"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028045"><span class="hs-identifier hs-var">new_return</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-994"></a><span>
</span><a name="line-995"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028055"><a href="#local-1628028055"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028056"><a href="#local-1628028056"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028057"><a href="#local-1628028057"><span class="hs-identifier">segStmts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028058"><a href="#local-1628028058"><span class="hs-identifier">lvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028059"><a href="#local-1628028059"><span class="hs-identifier">rvs</span></a></a><span>
</span><a name="line-996"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028060"><a href="#local-1628028060"><span class="hs-identifier">ret_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028061"><a href="#local-1628028061"><span class="hs-identifier">mfix_id</span></a></a><span>
</span><a name="line-997"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028062"><a href="#local-1628028062"><span class="hs-identifier">bind_id</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028063"><a href="#local-1628028063"><span class="hs-identifier">bind_ty</span></a></a><span>
</span><a name="line-998"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028064"><a href="#local-1628028064"><span class="hs-identifier">later_rets</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028065"><a href="#local-1628028065"><span class="hs-identifier">rec_rets</span></a></a><span>
</span><a name="line-999"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028066"><a href="#local-1628028066"><span class="hs-identifier">ret_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1000"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028067"><a href="#local-1628028067"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028068"><a href="#local-1628028068"><span class="hs-identifier">new_bind_id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028055"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028062"><span class="hs-identifier hs-var">bind_id</span></a><span>
</span><a name="line-1001"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028069"><a href="#local-1628028069"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028070"><a href="#local-1628028070"><span class="hs-identifier">new_mfix_id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028067"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028061"><span class="hs-identifier hs-var">mfix_id</span></a><span>
</span><a name="line-1002"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028071"><a href="#local-1628028071"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028072"><a href="#local-1628028072"><span class="hs-identifier">new_ret_id</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028069"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028060"><span class="hs-identifier hs-var">ret_id</span></a><span>
</span><a name="line-1003"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028073"><a href="#local-1628028073"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028063"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-1004"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028074"><a href="#local-1628028074"><span class="hs-identifier">new_rvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028059"><span class="hs-identifier hs-var">rvs</span></a><span>
</span><a name="line-1005"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028075"><a href="#local-1628028075"><span class="hs-identifier">new_lvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndrs"><span class="hs-identifier hs-var">zonkIdBndrs</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028058"><span class="hs-identifier hs-var">lvs</span></a><span>
</span><a name="line-1006"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028076"><a href="#local-1628028076"><span class="hs-identifier">new_ret_ty</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028066"><span class="hs-identifier hs-var">ret_ty</span></a><span>
</span><a name="line-1007"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028077"><a href="#local-1628028077"><span class="hs-identifier">env4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028074"><span class="hs-identifier hs-var">new_rvs</span></a><span>
</span><a name="line-1008"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028078"><a href="#local-1628028078"><span class="hs-identifier">env5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028079"><a href="#local-1628028079"><span class="hs-identifier">new_segStmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628028077"><span class="hs-identifier hs-var">env4</span></a><span> </span><a href="#local-1628028056"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628028057"><span class="hs-identifier hs-var">segStmts</span></a><span>
</span><a name="line-1009"></a><span>        </span><span class="hs-comment">-- Zonk the ret-expressions in an envt that</span><span>
</span><a name="line-1010"></a><span>        </span><span class="hs-comment">-- has the polymorphic bindings in the envt</span><span>
</span><a name="line-1011"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028080"><a href="#local-1628028080"><span class="hs-identifier">new_later_rets</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628028078"><span class="hs-identifier hs-var">env5</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028064"><span class="hs-identifier hs-var">later_rets</span></a><span>
</span><a name="line-1012"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028081"><a href="#local-1628028081"><span class="hs-identifier">new_rec_rets</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628028078"><span class="hs-identifier hs-var">env5</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028065"><span class="hs-identifier hs-var">rec_rets</span></a><span>
</span><a name="line-1013"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028071"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028075"><span class="hs-identifier hs-var">new_lvs</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Only the lvs are needed</span><span>
</span><a name="line-1014"></a><span>                 </span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028079"><span class="hs-identifier hs-var">new_segStmts</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028075"><span class="hs-identifier hs-var">new_lvs</span></a><span>
</span><a name="line-1015"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028074"><span class="hs-identifier hs-var">new_rvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028072"><span class="hs-identifier hs-var">new_ret_id</span></a><span>
</span><a name="line-1016"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028070"><span class="hs-identifier hs-var">new_mfix_id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028068"><span class="hs-identifier hs-var">new_bind_id</span></a><span>
</span><a name="line-1017"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028073"><span class="hs-identifier hs-var">new_bind_ty</span></a><span>
</span><a name="line-1018"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028080"><span class="hs-identifier hs-var">new_later_rets</span></a><span>
</span><a name="line-1019"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028081"><span class="hs-identifier hs-var">new_rec_rets</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028076"><span class="hs-identifier hs-var">new_ret_ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1020"></a><span>
</span><a name="line-1021"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028082"><a href="#local-1628028082"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028083"><a href="#local-1628028083"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a name="local-1628028084"><a href="#local-1628028084"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1628028085"><a href="#local-1628028085"><span class="hs-identifier">then_op</span></a></a><span> </span><a name="local-1628028086"><a href="#local-1628028086"><span class="hs-identifier">guard_op</span></a></a><span> </span><a name="local-1628028087"><a href="#local-1628028087"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1022"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628028088"><a href="#local-1628028088"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028089"><a href="#local-1628028089"><span class="hs-identifier">new_then_op</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028082"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028085"><span class="hs-identifier hs-var">then_op</span></a><span>
</span><a name="line-1023"></a><span>       </span><span class="hs-special">(</span><a name="local-1628028090"><a href="#local-1628028090"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028091"><a href="#local-1628028091"><span class="hs-identifier">new_guard_op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028088"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028086"><span class="hs-identifier hs-var">guard_op</span></a><span>
</span><a name="line-1024"></a><span>       </span><a name="local-1628028092"><a href="#local-1628028092"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028083"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628028090"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028084"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1025"></a><span>       </span><a name="local-1628028093"><a href="#local-1628028093"><span class="hs-identifier">new_ty</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028090"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028087"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1026"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028090"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a href="#local-1628028092"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-1628028089"><span class="hs-identifier hs-var">new_then_op</span></a><span> </span><a href="#local-1628028091"><span class="hs-identifier hs-var">new_guard_op</span></a><span> </span><a href="#local-1628028093"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1027"></a><span>
</span><a name="line-1028"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028094"><a href="#local-1628028094"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028095"><a href="#local-1628028095"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a name="local-1628028096"><a href="#local-1628028096"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1628028097"><a href="#local-1628028097"><span class="hs-identifier">noret</span></a></a><span> </span><a name="local-1628028098"><a href="#local-1628028098"><span class="hs-identifier">ret_op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1029"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628028099"><a href="#local-1628028099"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028100"><a href="#local-1628028100"><span class="hs-identifier">new_ret</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028094"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028098"><span class="hs-identifier hs-var">ret_op</span></a><span>
</span><a name="line-1030"></a><span>       </span><a name="local-1628028101"><a href="#local-1628028101"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028095"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628028099"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028096"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1031"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028094"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a href="#local-1628028101"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-1628028097"><span class="hs-identifier hs-var">noret</span></a><span> </span><a href="#local-1628028100"><span class="hs-identifier hs-var">new_ret</span></a><span class="hs-special">)</span><span>
</span><a name="line-1032"></a><span>
</span><a name="line-1033"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028102"><a href="#local-1628028102"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028103"><a href="#local-1628028103"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028104"><a href="#local-1628028104"><span class="hs-identifier">binderMap</span></a></a><span>
</span><a name="line-1034"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028105"><a href="#local-1628028105"><span class="hs-identifier">by</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028106"><a href="#local-1628028106"><span class="hs-identifier">form</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028107"><a href="#local-1628028107"><span class="hs-identifier">using</span></a></a><span>
</span><a name="line-1035"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028108"><a href="#local-1628028108"><span class="hs-identifier">return_op</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028109"><a href="#local-1628028109"><span class="hs-identifier">bind_op</span></a></a><span>
</span><a name="line-1036"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind_arg_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028110"><a href="#local-1628028110"><span class="hs-identifier">bind_arg_ty</span></a></a><span>
</span><a name="line-1037"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028111"><a href="#local-1628028111"><span class="hs-identifier">liftM_op</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1038"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1039"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028118"><a href="#local-1628028118"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028119"><a href="#local-1628028119"><span class="hs-identifier">bind_op'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028102"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028109"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-1040"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-1628028120"><a href="#local-1628028120"><span class="hs-identifier">bind_arg_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028118"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028110"><span class="hs-identifier hs-var">bind_arg_ty</span></a><span>
</span><a name="line-1041"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028121"><a href="#local-1628028121"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028122"><a href="#local-1628028122"><span class="hs-identifier">stmts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628028118"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028103"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1042"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-1628028123"><a href="#local-1628028123"><span class="hs-identifier">by'</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#fmapMaybeM"><span class="hs-identifier hs-var">fmapMaybeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028121"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028105"><span class="hs-identifier hs-var">by</span></a><span>
</span><a name="line-1043"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-1628028124"><a href="#local-1628028124"><span class="hs-identifier">using'</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028121"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028107"><span class="hs-identifier hs-var">using</span></a><span>
</span><a name="line-1044"></a><span>
</span><a name="line-1045"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028125"><a href="#local-1628028125"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028126"><a href="#local-1628028126"><span class="hs-identifier">return_op'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028121"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028108"><span class="hs-identifier hs-var">return_op</span></a><span>
</span><a name="line-1046"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-1628028127"><a href="#local-1628028127"><span class="hs-identifier">binderMap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028112"><span class="hs-identifier hs-var">zonkBinderMapEntry</span></a><span> </span><a href="#local-1628028125"><span class="hs-identifier hs-var">env3</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028104"><span class="hs-identifier hs-var">binderMap</span></a><span>
</span><a name="line-1047"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-1628028128"><a href="#local-1628028128"><span class="hs-identifier">liftM_op'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628028125"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028111"><span class="hs-identifier hs-var">liftM_op</span></a><span>
</span><a name="line-1048"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028129"><a href="#local-1628028129"><span class="hs-identifier">env3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028125"><span class="hs-identifier hs-var">env3</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="#local-1628028127"><span class="hs-identifier hs-var">binderMap'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1049"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028129"><span class="hs-identifier hs-var">env3'</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028122"><span class="hs-identifier hs-var">stmts'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028127"><span class="hs-identifier hs-var">binderMap'</span></a><span>
</span><a name="line-1050"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028123"><span class="hs-identifier hs-var">by'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028106"><span class="hs-identifier hs-var">form</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028124"><span class="hs-identifier hs-var">using'</span></a><span>
</span><a name="line-1051"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028126"><span class="hs-identifier hs-var">return_op'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028119"><span class="hs-identifier hs-var">bind_op'</span></a><span>
</span><a name="line-1052"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind_arg_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028120"><span class="hs-identifier hs-var">bind_arg_ty'</span></a><span>
</span><a name="line-1053"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028128"><span class="hs-identifier hs-var">liftM_op'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1054"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1055"></a><span>    </span><a name="local-1628028112"><a href="#local-1628028112"><span class="hs-identifier">zonkBinderMapEntry</span></a></a><span> </span><a name="local-1628028113"><a href="#local-1628028113"><span class="hs-identifier">env</span></a></a><span>  </span><span class="hs-special">(</span><a name="local-1628028114"><a href="#local-1628028114"><span class="hs-identifier">oldBinder</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028115"><a href="#local-1628028115"><span class="hs-identifier">newBinder</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1056"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028116"><a href="#local-1628028116"><span class="hs-identifier">oldBinder'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628028113"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028114"><span class="hs-identifier hs-var">oldBinder</span></a><span>
</span><a name="line-1057"></a><span>        </span><a name="local-1628028117"><a href="#local-1628028117"><span class="hs-identifier">newBinder'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028113"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028115"><span class="hs-identifier hs-var">newBinder</span></a><span>
</span><a name="line-1058"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028116"><span class="hs-identifier hs-var">oldBinder'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028117"><span class="hs-identifier hs-var">newBinder'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028130"><a href="#local-1628028130"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028131"><a href="#local-1628028131"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028132"><a href="#local-1628028132"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1628028133"><a href="#local-1628028133"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028134"><a href="#local-1628028134"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLocalBinds"><span class="hs-identifier hs-var">zonkLocalBinds</span></a><span> </span><a href="#local-1628028130"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028132"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1062"></a><span>       </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028133"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028131"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628028134"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028135"><a href="#local-1628028135"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028136"><a href="#local-1628028136"><span class="hs-identifier">zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-1628028137"><a href="#local-1628028137"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628028138"><a href="#local-1628028138"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1628028139"><a href="#local-1628028139"><span class="hs-identifier">bind_op</span></a></a><span> </span><a name="local-1628028140"><a href="#local-1628028140"><span class="hs-identifier">fail_op</span></a></a><span> </span><a name="local-1628028141"><a href="#local-1628028141"><span class="hs-identifier">bind_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028142"><a href="#local-1628028142"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028143"><a href="#local-1628028143"><span class="hs-identifier">new_bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028135"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028139"><span class="hs-identifier hs-var">bind_op</span></a><span>
</span><a name="line-1066"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028144"><a href="#local-1628028144"><span class="hs-identifier">new_bind_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028142"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028141"><span class="hs-identifier hs-var">bind_ty</span></a><span>
</span><a name="line-1067"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028145"><a href="#local-1628028145"><span class="hs-identifier">new_body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028136"><span class="hs-identifier hs-var">zBody</span></a><span> </span><a href="#local-1628028142"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028138"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1068"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028146"><a href="#local-1628028146"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028147"><a href="#local-1628028147"><span class="hs-identifier">new_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028142"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028137"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1069"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628028148"><a href="#local-1628028148"><span class="hs-identifier">new_fail</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028142"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028140"><span class="hs-identifier hs-var">fail_op</span></a><span>
</span><a name="line-1070"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028146"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="#local-1628028147"><span class="hs-identifier hs-var">new_pat</span></a><span> </span><a href="#local-1628028145"><span class="hs-identifier hs-var">new_body</span></a><span> </span><a href="#local-1628028143"><span class="hs-identifier hs-var">new_bind</span></a><span> </span><a href="#local-1628028148"><span class="hs-identifier hs-var">new_fail</span></a><span> </span><a href="#local-1628028144"><span class="hs-identifier hs-var">new_bind_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span class="hs-comment">-- Scopes: join &gt; ops (in reverse order) &gt; pats (in forward order)</span><span>
</span><a name="line-1073"></a><span class="hs-comment">--              &gt; rest of stmts</span><span>
</span><a name="line-1074"></a><span class="hs-identifier">zonkStmt</span><span> </span><a name="local-1628028149"><a href="#local-1628028149"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028150"><a href="#local-1628028150"><span class="hs-identifier">_zBody</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><a name="local-1628028151"><a href="#local-1628028151"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-1628028152"><a href="#local-1628028152"><span class="hs-identifier">mb_join</span></a></a><span> </span><a name="local-1628028153"><a href="#local-1628028153"><span class="hs-identifier">body_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1075"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028199"><a href="#local-1628028199"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028200"><a href="#local-1628028200"><span class="hs-identifier">new_mb_join</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028154"><span class="hs-identifier hs-var">zonk_join</span></a><span> </span><a href="#local-1628028149"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028152"><span class="hs-identifier hs-var">mb_join</span></a><span>
</span><a name="line-1076"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028201"><a href="#local-1628028201"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028202"><a href="#local-1628028202"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028157"><span class="hs-identifier hs-var">zonk_args</span></a><span> </span><a href="#local-1628028199"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028151"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1077"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028203"><a href="#local-1628028203"><span class="hs-identifier">new_body_ty</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028201"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028153"><span class="hs-identifier hs-var">body_ty</span></a><span>
</span><a name="line-1078"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028201"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><a href="#local-1628028202"><span class="hs-identifier hs-var">new_args</span></a><span> </span><a href="#local-1628028200"><span class="hs-identifier hs-var">new_mb_join</span></a><span> </span><a href="#local-1628028203"><span class="hs-identifier hs-var">new_body_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1079"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1080"></a><span>    </span><a name="local-1628028154"><a href="#local-1628028154"><span class="hs-identifier">zonk_join</span></a></a><span> </span><a name="local-1628028160"><a href="#local-1628028160"><span class="hs-identifier">env</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028160"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1081"></a><span>    </span><span class="hs-identifier">zonk_join</span><span> </span><a name="local-1628028161"><a href="#local-1628028161"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628028162"><a href="#local-1628028162"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028161"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028162"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-1082"></a><span>
</span><a name="line-1083"></a><span>    </span><a name="local-1628028155"><a href="#local-1628028155"><span class="hs-identifier">get_pat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a name="local-1628028163"><a href="#local-1628028163"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028163"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1084"></a><span>    </span><span class="hs-identifier">get_pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028164"><a href="#local-1628028164"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028164"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1085"></a><span>
</span><a name="line-1086"></a><span>    </span><a name="local-1628028156"><a href="#local-1628028156"><span class="hs-identifier">replace_pat</span></a></a><span> </span><a name="local-1628028165"><a href="#local-1628028165"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628028166"><a href="#local-1628028166"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028167"><a href="#local-1628028167"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628028166"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a href="#local-1628028165"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-1628028167"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><span>    </span><span class="hs-identifier">replace_pat</span><span> </span><a name="local-1628028168"><a href="#local-1628028168"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628028169"><a href="#local-1628028169"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a name="local-1628028170"><a href="#local-1628028170"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1628028171"><a href="#local-1628028171"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1089"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628028169"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a href="#local-1628028170"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1628028171"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1628028168"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1090"></a><span>
</span><a name="line-1091"></a><span>    </span><a name="local-1628028157"><a href="#local-1628028157"><span class="hs-identifier">zonk_args</span></a></a><span> </span><a name="local-1628028172"><a href="#local-1628028172"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028173"><a href="#local-1628028173"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1092"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028174"><a href="#local-1628028174"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028175"><a href="#local-1628028175"><span class="hs-identifier">new_args_rev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028158"><span class="hs-identifier hs-var">zonk_args_rev</span></a><span> </span><a href="#local-1628028172"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1628028173"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1093"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028176"><a href="#local-1628028176"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028177"><a href="#local-1628028177"><span class="hs-identifier">new_pats</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028174"><span class="hs-identifier hs-var">env1</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628028155"><span class="hs-identifier hs-var">get_pat</span></a><span> </span><a href="#local-1628028173"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1094"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028176"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="#local-1628028156"><span class="hs-identifier hs-var">replace_pat</span></a><span> </span><a href="#local-1628028177"><span class="hs-identifier hs-var">new_pats</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1628028175"><span class="hs-identifier hs-var">new_args_rev</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1095"></a><span>
</span><a name="line-1096"></a><span>     </span><span class="hs-comment">-- these need to go backward, because if any operators are higher-rank,</span><span>
</span><a name="line-1097"></a><span>     </span><span class="hs-comment">-- later operators may introduce skolems that are in scope for earlier</span><span>
</span><a name="line-1098"></a><span>     </span><span class="hs-comment">-- arguments</span><span>
</span><a name="line-1099"></a><span>    </span><a name="local-1628028158"><a href="#local-1628028158"><span class="hs-identifier">zonk_args_rev</span></a></a><span> </span><a name="local-1628028178"><a href="#local-1628028178"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1628028179"><a href="#local-1628028179"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028180"><a href="#local-1628028180"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1628028181"><a href="#local-1628028181"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028182"><a href="#local-1628028182"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028183"><a href="#local-1628028183"><span class="hs-identifier">new_op</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028178"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028179"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1101"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1628028184"><a href="#local-1628028184"><span class="hs-identifier">new_arg</span></a></a><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028159"><span class="hs-identifier hs-var">zonk_arg</span></a><span> </span><a href="#local-1628028182"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028180"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1102"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028185"><a href="#local-1628028185"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028186"><a href="#local-1628028186"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028158"><span class="hs-identifier hs-var">zonk_args_rev</span></a><span> </span><a href="#local-1628028182"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028181"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1103"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028185"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-1628028183"><span class="hs-identifier hs-var">new_op</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028184"><span class="hs-identifier hs-var">new_arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628028186"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1104"></a><span>    </span><span class="hs-identifier">zonk_args_rev</span><span> </span><a name="local-1628028187"><a href="#local-1628028187"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028187"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1105"></a><span>
</span><a name="line-1106"></a><span>    </span><a name="local-1628028159"><a href="#local-1628028159"><span class="hs-identifier">zonk_arg</span></a></a><span> </span><a name="local-1628028188"><a href="#local-1628028188"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a name="local-1628028189"><a href="#local-1628028189"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628028190"><a href="#local-1628028190"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1107"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028191"><a href="#local-1628028191"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028188"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028190"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1108"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><a href="#local-1628028189"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-1628028191"><span class="hs-identifier hs-var">new_expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1109"></a><span>    </span><span class="hs-identifier">zonk_arg</span><span> </span><a name="local-1628028192"><a href="#local-1628028192"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a name="local-1628028193"><a href="#local-1628028193"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-1628028194"><a href="#local-1628028194"><span class="hs-identifier">ret</span></a></a><span> </span><a name="local-1628028195"><a href="#local-1628028195"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1110"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028196"><a href="#local-1628028196"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028197"><a href="#local-1628028197"><span class="hs-identifier">new_stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkStmts"><span class="hs-identifier hs-var">zonkStmts</span></a><span> </span><a href="#local-1628028192"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028193"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1111"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1628028198"><a href="#local-1628028198"><span class="hs-identifier">new_ret</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkExpr"><span class="hs-identifier hs-var">zonkExpr</span></a><span> </span><a href="#local-1628028196"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028194"><span class="hs-identifier hs-var">ret</span></a><span>
</span><a name="line-1112"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><a href="#local-1628028197"><span class="hs-identifier hs-var">new_stmts</span></a><span> </span><a href="#local-1628028198"><span class="hs-identifier hs-var">new_ret</span></a><span> </span><a href="#local-1628028195"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1113"></a><span>
</span><a name="line-1114"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-1115"></a><span class="hs-identifier">zonkRecFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsRecordBinds"><span class="hs-identifier hs-type">HsRecordBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRecordBinds"><span class="hs-identifier hs-type">HsRecordBinds</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><a name="zonkRecFields"><a href="TcHsSyn.html#zonkRecFields"><span class="hs-identifier">zonkRecFields</span></a></a><span> </span><a name="local-1628028204"><a href="#local-1628028204"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-1628028205"><a href="#local-1628028205"><span class="hs-identifier">flds</span></a></a><span> </span><a name="local-1628028206"><a href="#local-1628028206"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028212"><a href="#local-1628028212"><span class="hs-identifier">flds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628028207"><span class="hs-identifier hs-var">zonk_rbind</span></a><span> </span><a href="#local-1628028205"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1118"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a href="#local-1628028212"><span class="hs-identifier hs-var">flds'</span></a><span> </span><a href="#local-1628028206"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1119"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1120"></a><span>    </span><a name="local-1628028207"><a href="#local-1628028207"><span class="hs-identifier">zonk_rbind</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028208"><a href="#local-1628028208"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028209"><a href="#local-1628028209"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028210"><a href="#local-1628028210"><span class="hs-identifier">new_id</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier hs-var">zonkFieldOcc</span></a><span> </span><a href="#local-1628028204"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><a href="#local-1628028209"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1122"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1628028211"><a href="#local-1628028211"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028204"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-1628028209"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028208"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028209"><span class="hs-identifier hs-var">fld</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028210"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-1124"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028211"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1125"></a><span>
</span><a name="line-1126"></a><span class="hs-identifier">zonkRecUpdFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecUpdField"><span class="hs-identifier hs-type">LHsRecUpdField</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecUpdField"><span class="hs-identifier hs-type">LHsRecUpdField</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span>
</span><a name="line-1127"></a><a name="zonkRecUpdFields"><a href="TcHsSyn.html#zonkRecUpdFields"><span class="hs-identifier">zonkRecUpdFields</span></a></a><span> </span><a name="local-1628028213"><a href="#local-1628028213"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628028214"><span class="hs-identifier hs-var">zonk_rbind</span></a><span>
</span><a name="line-1128"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1129"></a><span>    </span><a name="local-1628028214"><a href="#local-1628028214"><span class="hs-identifier">zonk_rbind</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028215"><a href="#local-1628028215"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028216"><a href="#local-1628028216"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1130"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028217"><a href="#local-1628028217"><span class="hs-identifier">new_id</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkFieldOcc"><span class="hs-identifier hs-var">zonkFieldOcc</span></a><span> </span><a href="#local-1628028213"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsRecUpdFieldOcc"><span class="hs-identifier hs-var">hsRecUpdFieldOcc</span></a><span> </span><a href="#local-1628028216"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1131"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1628028218"><a href="#local-1628028218"><span class="hs-identifier">new_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028213"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-1628028216"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028215"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028216"><span class="hs-identifier hs-var">fld</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="HsTypes.html#ambiguousFieldOcc"><span class="hs-identifier hs-var">ambiguousFieldOcc</span></a><span> </span><a href="#local-1628028217"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-1133"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028218"><span class="hs-identifier hs-var">new_expr</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1134"></a><span>
</span><a name="line-1135"></a><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><a name="line-1136"></a><span class="hs-identifier">mapIPNameTc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1628027361"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628027362"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027361"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1137"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="HsTypes.html#HsIPName"><span class="hs-identifier hs-type">HsIPName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628027362"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1138"></a><a name="mapIPNameTc"><a href="TcHsSyn.html#mapIPNameTc"><span class="hs-identifier">mapIPNameTc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628028219"><a href="#local-1628028219"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1628028219"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1139"></a><span class="hs-identifier">mapIPNameTc</span><span> </span><a name="local-1628028220"><a href="#local-1628028220"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628028221"><a href="#local-1628028221"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1628028222"><a href="#local-1628028222"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028220"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1628028221"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1140"></a><span>                             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-1628028222"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1141"></a><span>
</span><a name="line-1142"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Pats]{Patterns}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1149"></a><span>
</span><a name="line-1150"></a><span class="hs-identifier">zonkPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1151"></a><span class="hs-comment">-- Extend the environment as we go, because it's possible for one</span><span>
</span><a name="line-1152"></a><span class="hs-comment">-- pattern to bind something that is used in another (inside or</span><span>
</span><a name="line-1153"></a><span class="hs-comment">-- to the right)</span><span>
</span><a name="line-1154"></a><a name="zonkPat"><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier">zonkPat</span></a></a><span> </span><a name="local-1628028223"><a href="#local-1628028223"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028224"><a href="#local-1628028224"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#wrapLocSndM"><span class="hs-identifier hs-var">wrapLocSndM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonk_pat"><span class="hs-identifier hs-var">zonk_pat</span></a><span> </span><a href="#local-1628028223"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028224"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-identifier">zonk_pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1157"></a><a name="zonk_pat"><a href="TcHsSyn.html#zonk_pat"><span class="hs-identifier">zonk_pat</span></a></a><span> </span><a name="local-1628028225"><a href="#local-1628028225"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-1628028226"><a href="#local-1628028226"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1158"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028227"><a href="#local-1628028227"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028228"><a href="#local-1628028228"><span class="hs-identifier">p'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028225"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028226"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1159"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028227"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="#local-1628028228"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1160"></a><span>
</span><a name="line-1161"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028229"><a href="#local-1628028229"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a name="local-1628028230"><a href="#local-1628028230"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1162"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028231"><a href="#local-1628028231"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028229"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028230"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1163"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="TcHsSyn.html#ensureNotRepresentationPolymorphic"><span class="hs-identifier hs-var">ensureNotRepresentationPolymorphic</span></a><span> </span><a href="#local-1628028231"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1164"></a><span>            </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In a wildcard pattern&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1165"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028229"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="#local-1628028231"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1166"></a><span>
</span><a name="line-1167"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028232"><a href="#local-1628028232"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028233"><a href="#local-1628028233"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028234"><a href="#local-1628028234"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1168"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028235"><a href="#local-1628028235"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028232"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028234"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1169"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-1628028232"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028235"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028233"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628028235"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1170"></a><span>
</span><a name="line-1171"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028236"><a href="#local-1628028236"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-1628028237"><a href="#local-1628028237"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028238"><a href="#local-1628028238"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028239"><a href="#local-1628028239"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028236"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028237"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1173"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028238"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span>  </span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a href="#local-1628028239"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028240"><a href="#local-1628028240"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-1628028241"><a href="#local-1628028241"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1176"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028242"><a href="#local-1628028242"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028243"><a href="#local-1628028243"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028240"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028241"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1177"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028242"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span>  </span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a href="#local-1628028243"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028244"><a href="#local-1628028244"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028245"><a href="#local-1628028245"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628028246"><a href="#local-1628028246"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628028247"><a href="#local-1628028247"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1180"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028248"><a href="#local-1628028248"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028244"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028246"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1181"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028249"><a href="#local-1628028249"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028250"><a href="#local-1628028250"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-1628028244"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028248"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028247"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1182"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028249"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028245"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628028248"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028250"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1183"></a><span>
</span><a name="line-1184"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028251"><a href="#local-1628028251"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a name="local-1628028252"><a href="#local-1628028252"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-1628028253"><a href="#local-1628028253"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628028254"><a href="#local-1628028254"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1185"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028255"><a href="#local-1628028255"><span class="hs-identifier">expr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028251"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028252"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1186"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028256"><a href="#local-1628028256"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028257"><a href="#local-1628028257"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028251"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028253"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1187"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028258"><a href="#local-1628028258"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028251"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028254"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1188"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028256"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a href="#local-1628028255"><span class="hs-identifier hs-var">expr'</span></a><span> </span><a href="#local-1628028257"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-1628028258"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1189"></a><span>
</span><a name="line-1190"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028259"><a href="#local-1628028259"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-1628028260"><a href="#local-1628028260"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628028261"><a href="#local-1628028261"><span class="hs-identifier">ty</span></a></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1191"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028262"><a href="#local-1628028262"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028259"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028261"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1192"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028263"><a href="#local-1628028263"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028264"><a href="#local-1628028264"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028259"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028260"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1193"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028263"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="#local-1628028264"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-1628028262"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1194"></a><span>
</span><a name="line-1195"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028265"><a href="#local-1628028265"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-1628028266"><a href="#local-1628028266"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628028267"><a href="#local-1628028267"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628028268"><a href="#local-1628028268"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">,</span><a name="local-1628028269"><a href="#local-1628028269"><span class="hs-identifier">wit</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1196"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028270"><a href="#local-1628028270"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028271"><a href="#local-1628028271"><span class="hs-identifier">wit'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028265"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028269"><span class="hs-identifier hs-var">wit</span></a><span>
</span><a name="line-1197"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028272"><a href="#local-1628028272"><span class="hs-identifier">ty2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028270"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1628028268"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1198"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028273"><a href="#local-1628028273"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028270"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1628028267"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1199"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028274"><a href="#local-1628028274"><span class="hs-identifier">env''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028275"><a href="#local-1628028275"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028270"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1628028266"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1200"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028274"><span class="hs-identifier hs-var">env''</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="#local-1628028275"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-1628028273"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028272"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><a href="#local-1628028271"><span class="hs-identifier hs-var">wit'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028276"><a href="#local-1628028276"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-1628028277"><a href="#local-1628028277"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628028278"><a href="#local-1628028278"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028279"><a href="#local-1628028279"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028276"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028278"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1204"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028280"><a href="#local-1628028280"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028281"><a href="#local-1628028281"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028276"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028277"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1205"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028280"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a href="#local-1628028281"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-1628028279"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1206"></a><span>
</span><a name="line-1207"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028282"><a href="#local-1628028282"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-1628028283"><a href="#local-1628028283"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628028284"><a href="#local-1628028284"><span class="hs-identifier">boxed</span></a></a><span> </span><a name="local-1628028285"><a href="#local-1628028285"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028286"><a href="#local-1628028286"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028282"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028285"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1209"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028287"><a href="#local-1628028287"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028288"><a href="#local-1628028288"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028282"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028283"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1210"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028287"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="#local-1628028288"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-1628028284"><span class="hs-identifier hs-var">boxed</span></a><span> </span><a href="#local-1628028286"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1211"></a><span>
</span><a name="line-1212"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028289"><a href="#local-1628028289"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028290"><a href="#local-1628028290"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028291"><a href="#local-1628028291"><span class="hs-identifier">tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028292"><a href="#local-1628028292"><span class="hs-identifier">tyvars</span></a></a><span>
</span><a name="line-1213"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028293"><a href="#local-1628028293"><span class="hs-identifier">evs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028294"><a href="#local-1628028294"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1214"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028295"><a href="#local-1628028295"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028296"><a href="#local-1628028296"><span class="hs-identifier">wrapper</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1215"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1216"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028297"><a href="#local-1628028297"><span class="hs-identifier">new_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028289"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028291"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1217"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028298"><a href="#local-1628028298"><span class="hs-identifier">env0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028299"><a href="#local-1628028299"><span class="hs-identifier">new_tyvars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBndrsX"><span class="hs-identifier hs-var">zonkTyBndrsX</span></a><span> </span><a href="#local-1628028289"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028292"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-1218"></a><span>          </span><span class="hs-comment">-- Must zonk the existential variables, because their</span><span>
</span><a name="line-1219"></a><span>          </span><span class="hs-comment">-- /kind/ need potential zonking.</span><span>
</span><a name="line-1220"></a><span>          </span><span class="hs-comment">-- cf typecheck/should_compile/tc221.hs</span><span>
</span><a name="line-1221"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028300"><a href="#local-1628028300"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028301"><a href="#local-1628028301"><span class="hs-identifier">new_evs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvBndrsX"><span class="hs-identifier hs-var">zonkEvBndrsX</span></a><span> </span><a href="#local-1628028298"><span class="hs-identifier hs-var">env0</span></a><span> </span><a href="#local-1628028293"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-1222"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028302"><a href="#local-1628028302"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028303"><a href="#local-1628028303"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier hs-var">zonkTcEvBinds</span></a><span> </span><a href="#local-1628028300"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028294"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1223"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028304"><a href="#local-1628028304"><span class="hs-identifier">env3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028305"><a href="#local-1628028305"><span class="hs-identifier">new_wrapper</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628028302"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028296"><span class="hs-identifier hs-var">wrapper</span></a><span>
</span><a name="line-1224"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028306"><a href="#local-1628028306"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028307"><a href="#local-1628028307"><span class="hs-identifier">new_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkConStuff"><span class="hs-identifier hs-var">zonkConStuff</span></a><span> </span><a href="#local-1628028304"><span class="hs-identifier hs-var">env3</span></a><span> </span><a href="#local-1628028295"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1225"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028306"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028290"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028297"><span class="hs-identifier hs-var">new_tys</span></a><span class="hs-special">,</span><span>
</span><a name="line-1226"></a><span>                            </span><span class="hs-identifier">pat_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028299"><span class="hs-identifier hs-var">new_tyvars</span></a><span class="hs-special">,</span><span>
</span><a name="line-1227"></a><span>                            </span><span class="hs-identifier">pat_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028301"><span class="hs-identifier hs-var">new_evs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1228"></a><span>                            </span><span class="hs-identifier">pat_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028303"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">,</span><span>
</span><a name="line-1229"></a><span>                            </span><span class="hs-identifier">pat_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028307"><span class="hs-identifier hs-var">new_args</span></a><span class="hs-special">,</span><span>
</span><a name="line-1230"></a><span>                            </span><span class="hs-identifier">pat_wrap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028305"><span class="hs-identifier hs-var">new_wrapper</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1231"></a><span>
</span><a name="line-1232"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028308"><a href="#local-1628028308"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-1628028309"><a href="#local-1628028309"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028308"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="#local-1628028309"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1233"></a><span>
</span><a name="line-1234"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028310"><a href="#local-1628028310"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-1628028311"><a href="#local-1628028311"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628028312"><a href="#local-1628028312"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-1628028313"><a href="#local-1628028313"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028310"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028312"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1236"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028314"><a href="#local-1628028314"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028315"><a href="#local-1628028315"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028310"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028311"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1237"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028314"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a href="#local-1628028315"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-1628028313"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1238"></a><span>
</span><a name="line-1239"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028316"><a href="#local-1628028316"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028317"><a href="#local-1628028317"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028318"><a href="#local-1628028318"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628028319"><a href="#local-1628028319"><span class="hs-identifier">mb_neg</span></a></a><span> </span><a name="local-1628028320"><a href="#local-1628028320"><span class="hs-identifier">eq_expr</span></a></a><span> </span><a name="local-1628028321"><a href="#local-1628028321"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1240"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028322"><a href="#local-1628028322"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028323"><a href="#local-1628028323"><span class="hs-identifier">eq_expr'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028316"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028320"><span class="hs-identifier hs-var">eq_expr</span></a><span>
</span><a name="line-1241"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028325"><a href="#local-1628028325"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028326"><a href="#local-1628028326"><span class="hs-identifier">mb_neg'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628028319"><span class="hs-identifier hs-var">mb_neg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1242"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028322"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1243"></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628028324"><a href="#local-1628028324"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028322"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028324"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1244"></a><span>
</span><a name="line-1245"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028327"><a href="#local-1628028327"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-1628028325"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028318"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-1246"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028328"><a href="#local-1628028328"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028325"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028321"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1247"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028325"><span class="hs-identifier hs-var">env2</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028317"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628028327"><span class="hs-identifier hs-var">lit'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028326"><span class="hs-identifier hs-var">mb_neg'</span></a><span> </span><a href="#local-1628028323"><span class="hs-identifier hs-var">eq_expr'</span></a><span> </span><a href="#local-1628028328"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1248"></a><span>
</span><a name="line-1249"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028329"><a href="#local-1628028329"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028330"><a href="#local-1628028330"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628028331"><a href="#local-1628028331"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028332"><a href="#local-1628028332"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028333"><a href="#local-1628028333"><span class="hs-identifier">lit1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628028334"><a href="#local-1628028334"><span class="hs-identifier">lit2</span></a></a><span> </span><a name="local-1628028335"><a href="#local-1628028335"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-1628028336"><a href="#local-1628028336"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-1628028337"><a href="#local-1628028337"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028338"><a href="#local-1628028338"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028339"><a href="#local-1628028339"><span class="hs-identifier">e1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028329"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-1628028335"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1251"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028340"><a href="#local-1628028340"><span class="hs-identifier">env2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028341"><a href="#local-1628028341"><span class="hs-identifier">e2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkSyntaxExpr"><span class="hs-identifier hs-var">zonkSyntaxExpr</span></a><span> </span><a href="#local-1628028338"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028336"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1252"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028342"><a href="#local-1628028342"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028340"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028331"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1253"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028343"><a href="#local-1628028343"><span class="hs-identifier">lit1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-1628028340"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028333"><span class="hs-identifier hs-var">lit1</span></a><span>
</span><a name="line-1254"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028344"><a href="#local-1628028344"><span class="hs-identifier">lit2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkOverLit"><span class="hs-identifier hs-var">zonkOverLit</span></a><span> </span><a href="#local-1628028340"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028334"><span class="hs-identifier hs-var">lit2</span></a><span>
</span><a name="line-1255"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-1628028345"><a href="#local-1628028345"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028340"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028337"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1256"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnv1"><span class="hs-identifier hs-var">extendIdZonkEnv1</span></a><span> </span><a href="#local-1628028340"><span class="hs-identifier hs-var">env2</span></a><span> </span><a href="#local-1628028342"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span>
</span><a name="line-1257"></a><span>                  </span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028330"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628028342"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028332"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628028343"><span class="hs-identifier hs-var">lit1'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028344"><span class="hs-identifier hs-var">lit2'</span></a><span> </span><a href="#local-1628028339"><span class="hs-identifier hs-var">e1'</span></a><span> </span><a href="#local-1628028341"><span class="hs-identifier hs-var">e2'</span></a><span> </span><a href="#local-1628028345"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1258"></a><span>
</span><a name="line-1259"></a><span class="hs-identifier">zonk_pat</span><span> </span><a name="local-1628028346"><a href="#local-1628028346"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a name="local-1628028347"><a href="#local-1628028347"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-1628028348"><a href="#local-1628028348"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-1628028349"><a href="#local-1628028349"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028350"><a href="#local-1628028350"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028351"><a href="#local-1628028351"><span class="hs-identifier">co_fn'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoFn"><span class="hs-identifier hs-var">zonkCoFn</span></a><span> </span><a href="#local-1628028346"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028347"><span class="hs-identifier hs-var">co_fn</span></a><span>
</span><a name="line-1261"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028352"><a href="#local-1628028352"><span class="hs-identifier">env''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028353"><a href="#local-1628028353"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028350"><span class="hs-identifier hs-var">env'</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628028348"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028354"><a href="#local-1628028354"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028352"><span class="hs-identifier hs-var">env''</span></a><span> </span><a href="#local-1628028349"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1263"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028352"><span class="hs-identifier hs-var">env''</span></a><span class="hs-special">,</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a href="#local-1628028351"><span class="hs-identifier hs-var">co_fn'</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628028353"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028354"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1264"></a><span>
</span><a name="line-1265"></a><span class="hs-identifier">zonk_pat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028355"><a href="#local-1628028355"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;zonk_pat&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628028355"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1266"></a><span>
</span><a name="line-1267"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1268"></a><span class="hs-identifier">zonkConStuff</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span>
</span><a name="line-1269"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsConDetails"><span class="hs-identifier hs-type">HsConDetails</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="#local-1628027360"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-1271"></a><span>                     </span><a href="HsTypes.html#HsConDetails"><span class="hs-identifier hs-type">HsConDetails</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="#local-1628027360"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><a name="zonkConStuff"><a href="TcHsSyn.html#zonkConStuff"><span class="hs-identifier">zonkConStuff</span></a></a><span> </span><a name="local-1628028356"><a href="#local-1628028356"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-1628028357"><a href="#local-1628028357"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1273"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028358"><a href="#local-1628028358"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028359"><a href="#local-1628028359"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028356"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028357"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1274"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028358"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-1628028359"><span class="hs-identifier hs-var">pats'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1275"></a><span>
</span><a name="line-1276"></a><span class="hs-identifier">zonkConStuff</span><span> </span><a name="local-1628028360"><a href="#local-1628028360"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-1628028361"><a href="#local-1628028361"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-1628028362"><a href="#local-1628028362"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1277"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028363"><a href="#local-1628028363"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028364"><a href="#local-1628028364"><span class="hs-identifier">p1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028360"><span class="hs-identifier hs-var">env</span></a><span>  </span><a href="#local-1628028361"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1278"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028365"><a href="#local-1628028365"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028366"><a href="#local-1628028366"><span class="hs-identifier">p2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028363"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028362"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1279"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028365"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-1628028364"><span class="hs-identifier hs-var">p1'</span></a><span> </span><a href="#local-1628028366"><span class="hs-identifier hs-var">p2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1280"></a><span>
</span><a name="line-1281"></a><span class="hs-identifier">zonkConStuff</span><span> </span><a name="local-1628028367"><a href="#local-1628028367"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-1628028368"><a href="#local-1628028368"><span class="hs-identifier">rpats</span></a></a><span> </span><a name="local-1628028369"><a href="#local-1628028369"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028370"><a href="#local-1628028370"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028371"><a href="#local-1628028371"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028367"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028368"><span class="hs-identifier hs-var">rpats</span></a><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028372"><a href="#local-1628028372"><span class="hs-identifier">rpats'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028373"><a href="#local-1628028373"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028374"><a href="#local-1628028374"><span class="hs-identifier">rp</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628028375"><a href="#local-1628028375"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028373"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028374"><span class="hs-identifier hs-var">rp</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028375"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>                               </span><a href="#local-1628028368"><span class="hs-identifier hs-var">rpats</span></a><span> </span><a href="#local-1628028371"><span class="hs-identifier hs-var">pats'</span></a><span>
</span><a name="line-1285"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028370"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a href="#local-1628028372"><span class="hs-identifier hs-var">rpats'</span></a><span> </span><a href="#local-1628028369"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1286"></a><span>        </span><span class="hs-comment">-- Field selectors have declared types; hence no zonking</span><span>
</span><a name="line-1287"></a><span>
</span><a name="line-1288"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1289"></a><span class="hs-identifier">zonkPats</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#OutPat"><span class="hs-identifier hs-type">OutPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1290"></a><a name="zonkPats"><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier">zonkPats</span></a></a><span> </span><a name="local-1628028376"><a href="#local-1628028376"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028376"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1291"></a><span class="hs-identifier">zonkPats</span><span> </span><a name="local-1628028377"><a href="#local-1628028377"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628028378"><a href="#local-1628028378"><span class="hs-identifier">pat</span></a></a><span class="hs-glyph">:</span><a name="local-1628028379"><a href="#local-1628028379"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028380"><a href="#local-1628028380"><span class="hs-identifier">env1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028381"><a href="#local-1628028381"><span class="hs-identifier">pat'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPat"><span class="hs-identifier hs-var">zonkPat</span></a><span> </span><a href="#local-1628028377"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028378"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1292"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028382"><a href="#local-1628028382"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028383"><a href="#local-1628028383"><span class="hs-identifier">pats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkPats"><span class="hs-identifier hs-var">zonkPats</span></a><span> </span><a href="#local-1628028380"><span class="hs-identifier hs-var">env1</span></a><span> </span><a href="#local-1628028379"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1293"></a><span>                             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028382"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028381"><span class="hs-identifier hs-var">pat'</span></a><span class="hs-glyph">:</span><a href="#local-1628028383"><span class="hs-identifier hs-var">pats'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1294"></a><span>
</span><a name="line-1295"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[BackSubst-Foreign]{Foreign exports}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1302"></a><span>
</span><a name="line-1303"></a><span class="hs-identifier">zonkForeignExports</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1304"></a><a name="zonkForeignExports"><a href="TcHsSyn.html#zonkForeignExports"><span class="hs-identifier">zonkForeignExports</span></a></a><span> </span><a name="local-1628028384"><a href="#local-1628028384"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028385"><a href="#local-1628028385"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkForeignExport"><span class="hs-identifier hs-var">zonkForeignExport</span></a><span> </span><a href="#local-1628028384"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628028385"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1305"></a><span>
</span><a name="line-1306"></a><span class="hs-identifier">zonkForeignExport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1307"></a><a name="zonkForeignExport"><a href="TcHsSyn.html#zonkForeignExport"><span class="hs-identifier">zonkForeignExport</span></a></a><span> </span><a name="local-1628028386"><a href="#local-1628028386"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028387"><a href="#local-1628028387"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028388"><a href="#local-1628028388"><span class="hs-identifier">co</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028389"><a href="#local-1628028389"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1308"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628028386"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028387"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1309"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028388"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1310"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028389"><span class="hs-identifier hs-var">spec</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1311"></a><span class="hs-identifier">zonkForeignExport</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028390"><a href="#local-1628028390"><span class="hs-identifier">for_imp</span></a></a><span>
</span><a name="line-1312"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628028390"><span class="hs-identifier hs-var">for_imp</span></a><span>     </span><span class="hs-comment">-- Foreign imports don't need zonking</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">zonkRules</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleDecl"><span class="hs-identifier hs-type">LRuleDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1315"></a><a name="zonkRules"><a href="TcHsSyn.html#zonkRules"><span class="hs-identifier">zonkRules</span></a></a><span> </span><a name="local-1628028391"><a href="#local-1628028391"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028392"><a href="#local-1628028392"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkRule"><span class="hs-identifier hs-var">zonkRule</span></a><span> </span><a href="#local-1628028391"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628028392"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1316"></a><span>
</span><a name="line-1317"></a><span class="hs-identifier">zonkRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1318"></a><a name="zonkRule"><a href="TcHsSyn.html#zonkRule"><span class="hs-identifier">zonkRule</span></a></a><span> </span><a name="local-1628028393"><a href="#local-1628028393"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsRule"><span class="hs-identifier hs-var">HsRule</span></a><span> </span><a name="local-1628028394"><a href="#local-1628028394"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628028395"><a href="#local-1628028395"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628028396"><a href="#local-1628028396"><span class="hs-identifier">vars</span></a></a><span class="hs-comment">{-::[RuleBndr TcId]-}</span><span class="hs-special">)</span><span> </span><a name="local-1628028397"><a href="#local-1628028397"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-1628028398"><a href="#local-1628028398"><span class="hs-identifier">fv_lhs</span></a></a><span> </span><a name="local-1628028399"><a href="#local-1628028399"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-1628028400"><a href="#local-1628028400"><span class="hs-identifier">fv_rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028418"><a href="#local-1628028418"><span class="hs-identifier">unbound_tkv_set</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#newMutVar"><span class="hs-identifier hs-var">newMutVar</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-1320"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028419"><a href="#local-1628028419"><span class="hs-identifier">kind_var_set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028403"><span class="hs-identifier hs-var">identify_kind_vars</span></a><span> </span><a href="#local-1628028396"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1321"></a><span>             </span><a name="local-1628028420"><a href="#local-1628028420"><span class="hs-identifier">env_rule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#setZonkType"><span class="hs-identifier hs-var">setZonkType</span></a><span> </span><a href="#local-1628028393"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTvCollecting"><span class="hs-identifier hs-var">zonkTvCollecting</span></a><span> </span><a href="#local-1628028419"><span class="hs-identifier hs-var">kind_var_set</span></a><span> </span><a href="#local-1628028418"><span class="hs-identifier hs-var">unbound_tkv_set</span></a><span class="hs-special">)</span><span>
</span><a name="line-1322"></a><span>              </span><span class="hs-comment">-- See Note [Zonking the LHS of a RULE]</span><span>
</span><a name="line-1323"></a><span>
</span><a name="line-1324"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628028421"><a href="#local-1628028421"><span class="hs-identifier">env_inside</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028422"><a href="#local-1628028422"><span class="hs-identifier">new_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="#local-1628028401"><span class="hs-identifier hs-var">zonk_bndr</span></a><span> </span><a href="#local-1628028420"><span class="hs-identifier hs-var">env_rule</span></a><span> </span><a href="#local-1628028396"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028423"><a href="#local-1628028423"><span class="hs-identifier">new_lhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028421"><span class="hs-identifier hs-var">env_inside</span></a><span> </span><a href="#local-1628028397"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1327"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028424"><a href="#local-1628028424"><span class="hs-identifier">new_rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028421"><span class="hs-identifier hs-var">env_inside</span></a><span> </span><a href="#local-1628028399"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1328"></a><span>
</span><a name="line-1329"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028425"><a href="#local-1628028425"><span class="hs-identifier">unbound_tkvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-1628028418"><span class="hs-identifier hs-var">unbound_tkv_set</span></a><span>
</span><a name="line-1330"></a><span>
</span><a name="line-1331"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">final_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleBndr"><span class="hs-identifier hs-type">LRuleBndr</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-1332"></a><span>             </span><a name="local-1628028426"><a href="#local-1628028426"><span class="hs-identifier">final_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1333"></a><span>                               </span><span class="hs-special">(</span><a href="Type.html#varSetElemsWellScoped"><span class="hs-identifier hs-var">varSetElemsWellScoped</span></a><span> </span><a href="#local-1628028425"><span class="hs-identifier hs-var">unbound_tkvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628028422"><span class="hs-identifier hs-var">new_bndrs</span></a><span>
</span><a name="line-1335"></a><span>
</span><a name="line-1336"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1337"></a><span>         </span><a href="HsDecls.html#HsRule"><span class="hs-identifier hs-var">HsRule</span></a><span> </span><a href="#local-1628028394"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1628028395"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-1628028426"><span class="hs-identifier hs-var">final_bndrs</span></a><span> </span><a href="#local-1628028423"><span class="hs-identifier hs-var">new_lhs</span></a><span> </span><a href="#local-1628028398"><span class="hs-identifier hs-var">fv_lhs</span></a><span> </span><a href="#local-1628028424"><span class="hs-identifier hs-var">new_rhs</span></a><span> </span><a href="#local-1628028400"><span class="hs-identifier hs-var">fv_rhs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1338"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1339"></a><span>   </span><a name="local-1628028401"><a href="#local-1628028401"><span class="hs-identifier">zonk_bndr</span></a></a><span> </span><a name="local-1628028405"><a href="#local-1628028405"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028406"><a href="#local-1628028406"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628028407"><a href="#local-1628028407"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628028408"><a href="#local-1628028408"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1340"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028409"><a href="#local-1628028409"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028410"><a href="#local-1628028410"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628028402"><span class="hs-identifier hs-var">zonk_it</span></a><span> </span><a href="#local-1628028405"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028408"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1341"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028409"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028406"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628028407"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628028410"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1342"></a><span>   </span><span class="hs-identifier">zonk_bndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndrSig"><span class="hs-identifier hs-var">RuleBndrSig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;zonk_bndr RuleBndrSig&quot;</span><span>
</span><a name="line-1343"></a><span>
</span><a name="line-1344"></a><span>   </span><a name="local-1628028402"><a href="#local-1628028402"><span class="hs-identifier">zonk_it</span></a></a><span> </span><a name="local-1628028411"><a href="#local-1628028411"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028412"><a href="#local-1628028412"><span class="hs-identifier">v</span></a></a><span>
</span><a name="line-1345"></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span> </span><a href="#local-1628028412"><span class="hs-identifier hs-var">v</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028413"><a href="#local-1628028413"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028411"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028412"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1346"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028411"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628028413"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1628028413"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1347"></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isImmutableTyVar</span><span> </span><a href="TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-1348"></a><span>                    </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-1628028411"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028412"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1349"></a><span>                    </span><span class="hs-comment">-- DV: used to be return (env,v) but that is plain</span><span>
</span><a name="line-1350"></a><span>                    </span><span class="hs-comment">-- wrong because we may need to go inside the kind</span><span>
</span><a name="line-1351"></a><span>                    </span><span class="hs-comment">-- of v and zonk there!</span><span>
</span><a name="line-1352"></a><span>
</span><a name="line-1353"></a><span>     </span><span class="hs-comment">-- returns the set of type variables mentioned in the kind of another</span><span>
</span><a name="line-1354"></a><span>     </span><span class="hs-comment">-- type. This is used only when -XPolyKinds is not set.</span><span>
</span><a name="line-1355"></a><span>   </span><span class="hs-identifier">identify_kind_vars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleBndr"><span class="hs-identifier hs-type">LRuleBndr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span>
</span><a name="line-1356"></a><span>   </span><a name="local-1628028403"><a href="#local-1628028403"><span class="hs-identifier">identify_kind_vars</span></a></a><span> </span><a name="local-1628028414"><a href="#local-1628028414"><span class="hs-identifier">rule_bndrs</span></a></a><span>
</span><a name="line-1357"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028415"><a href="#local-1628028415"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628028404"><span class="hs-identifier hs-var">strip_rulebndr</span></a><span> </span><a href="#local-1628028414"><span class="hs-identifier hs-var">rule_bndrs</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1358"></a><span>       </span><a href="VarSet.html#unionVarSets"><span class="hs-identifier hs-var">unionVarSets</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628028416"><a href="#local-1628028416"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1628028416"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1359"></a><span>                                </span><span class="hs-keyword">then</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628028416"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-1360"></a><span>                                </span><span class="hs-keyword">else</span><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028415"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1361"></a><span>
</span><a name="line-1362"></a><span>   </span><a name="local-1628028404"><a href="#local-1628028404"><span class="hs-identifier">strip_rulebndr</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028417"><a href="#local-1628028417"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028417"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1363"></a><span>   </span><span class="hs-identifier">strip_rulebndr</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#RuleBndrSig"><span class="hs-identifier hs-var">RuleBndrSig</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;strip_rulebndr zonkRule&quot;</span><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span class="hs-identifier">zonkVects</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LVectDecl"><span class="hs-identifier hs-type">LVectDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1366"></a><a name="zonkVects"><a href="TcHsSyn.html#zonkVects"><span class="hs-identifier">zonkVects</span></a></a><span> </span><a name="local-1628028427"><a href="#local-1628028427"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkVect"><span class="hs-identifier hs-var">zonkVect</span></a><span> </span><a href="#local-1628028427"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span>
</span><a name="line-1368"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#VectDecl"><span class="hs-identifier hs-type">VectDecl</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#VectDecl"><span class="hs-identifier hs-type">VectDecl</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><a name="zonkVect"><a href="TcHsSyn.html#zonkVect"><span class="hs-identifier">zonkVect</span></a></a><span> </span><a name="local-1628028428"><a href="#local-1628028428"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVect"><span class="hs-identifier hs-var">HsVect</span></a><span> </span><a name="local-1628028429"><a href="#local-1628028429"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1628028430"><a href="#local-1628028430"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-1628028431"><a href="#local-1628028431"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1370"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028432"><a href="#local-1628028432"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028428"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028430"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1371"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028433"><a href="#local-1628028433"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkLExpr"><span class="hs-identifier hs-var">zonkLExpr</span></a><span> </span><a href="#local-1628028428"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028431"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1372"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVect"><span class="hs-identifier hs-var">HsVect</span></a><span> </span><a href="#local-1628028429"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1628028432"><span class="hs-identifier hs-var">v'</span></a><span> </span><a href="#local-1628028433"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-1373"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1374"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-1628028434"><a href="#local-1628028434"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsNoVect"><span class="hs-identifier hs-var">HsNoVect</span></a><span> </span><a name="local-1628028435"><a href="#local-1628028435"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1628028436"><a href="#local-1628028436"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1375"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028437"><a href="#local-1628028437"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#wrapLocM"><span class="hs-identifier hs-var">wrapLocM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdBndr"><span class="hs-identifier hs-var">zonkIdBndr</span></a><span> </span><a href="#local-1628028434"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028436"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1376"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsNoVect"><span class="hs-identifier hs-var">HsNoVect</span></a><span> </span><a href="#local-1628028435"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1628028437"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1377"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1378"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-1628028438"><a href="#local-1628028438"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectTypeOut"><span class="hs-identifier hs-var">HsVectTypeOut</span></a><span> </span><a name="local-1628028439"><a href="#local-1628028439"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1628028440"><a href="#local-1628028440"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1628028441"><a href="#local-1628028441"><span class="hs-identifier">rt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectTypeOut"><span class="hs-identifier hs-var">HsVectTypeOut</span></a><span> </span><a href="#local-1628028439"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1628028440"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1628028441"><span class="hs-identifier hs-var">rt</span></a><span>
</span><a name="line-1380"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectTypeIn"><span class="hs-identifier hs-var">HsVectTypeIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectTypeIn&quot;</span><span>
</span><a name="line-1381"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-1628028442"><a href="#local-1628028442"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectClassOut"><span class="hs-identifier hs-var">HsVectClassOut</span></a><span> </span><a name="local-1628028443"><a href="#local-1628028443"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectClassOut"><span class="hs-identifier hs-var">HsVectClassOut</span></a><span> </span><a href="#local-1628028443"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1383"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectClassIn"><span class="hs-identifier hs-var">HsVectClassIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectClassIn&quot;</span><span>
</span><a name="line-1384"></a><span class="hs-identifier">zonkVect</span><span> </span><a name="local-1628028444"><a href="#local-1628028444"><span class="hs-identifier">_env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectInstOut"><span class="hs-identifier hs-var">HsVectInstOut</span></a><span> </span><a name="local-1628028445"><a href="#local-1628028445"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1385"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsDecls.html#HsVectInstOut"><span class="hs-identifier hs-var">HsVectInstOut</span></a><span> </span><a href="#local-1628028445"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1386"></a><span class="hs-identifier">zonkVect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsVectInstIn"><span class="hs-identifier hs-var">HsVectInstIn</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;TcHsSyn.zonkVect: HsVectInstIn&quot;</span><span>
</span><a name="line-1387"></a><span>
</span><a name="line-1388"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
              Constraints and evidence
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1395"></a><span>
</span><a name="line-1396"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-1397"></a><a name="zonkEvTerm"><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier">zonkEvTerm</span></a></a><span> </span><a name="local-1628028446"><a href="#local-1628028446"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><a name="local-1628028447"><a href="#local-1628028447"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isId</span><span> </span><span class="hs-identifier hs-var">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1398"></a><span>                                    </span><a href="TcHsSyn.html#zonkEvVarOcc"><span class="hs-identifier hs-var">zonkEvVarOcc</span></a><span> </span><a href="#local-1628028446"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028447"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1399"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028448"><a href="#local-1628028448"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a name="local-1628028449"><a href="#local-1628028449"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028450"><a href="#local-1628028450"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-1628028448"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028449"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1400"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><a href="#local-1628028450"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1401"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028451"><a href="#local-1628028451"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCast"><span class="hs-identifier hs-var">EvCast</span></a><span> </span><a name="local-1628028452"><a href="#local-1628028452"><span class="hs-identifier">tm</span></a></a><span> </span><a name="local-1628028453"><a href="#local-1628028453"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028454"><a href="#local-1628028454"><span class="hs-identifier">tm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028451"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028452"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-1402"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a name="local-1628028455"><a href="#local-1628028455"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-1628028451"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028453"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1403"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkEvCast"><span class="hs-identifier hs-var">mkEvCast</span></a><span> </span><a href="#local-1628028454"><span class="hs-identifier hs-var">tm'</span></a><span> </span><a href="#local-1628028455"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1404"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TcEvidence.html#EvLit"><span class="hs-identifier hs-var">EvLit</span></a><span> </span><a name="local-1628028456"><a href="#local-1628028456"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvLit"><span class="hs-identifier hs-var">EvLit</span></a><span> </span><a href="#local-1628028456"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1405"></a><span>
</span><a name="line-1406"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028457"><a href="#local-1628028457"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><a name="local-1628028458"><a href="#local-1628028458"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628028459"><a href="#local-1628028459"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1407"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028460"><a href="#local-1628028460"><span class="hs-identifier">ev'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTypeable"><span class="hs-identifier hs-var">zonkEvTypeable</span></a><span> </span><a href="#local-1628028457"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028459"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-1408"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-1628028461"><a href="#local-1628028461"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028457"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028458"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1409"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><a href="#local-1628028461"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1628028460"><span class="hs-identifier hs-var">ev'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1410"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028462"><a href="#local-1628028462"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><a name="local-1628028463"><a href="#local-1628028463"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1411"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628028463"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1412"></a><span>      </span><a href="TcEvidence.html#EvCsEmpty"><span class="hs-identifier hs-var">EvCsEmpty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><a href="#local-1628028463"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><span>      </span><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier hs-var">EvCsPushCall</span></a><span> </span><a name="local-1628028464"><a href="#local-1628028464"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628028465"><a href="#local-1628028465"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628028466"><a href="#local-1628028466"><span class="hs-identifier">tm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028467"><a href="#local-1628028467"><span class="hs-identifier">tm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028462"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028466"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-1414"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-var">EvCallStack</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier hs-var">EvCsPushCall</span></a><span> </span><a href="#local-1628028464"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1628028465"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628028467"><span class="hs-identifier hs-var">tm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1415"></a><span>
</span><a name="line-1416"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028468"><a href="#local-1628028468"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSuperClass"><span class="hs-identifier hs-var">EvSuperClass</span></a><span> </span><a name="local-1628028469"><a href="#local-1628028469"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-1628028470"><a href="#local-1628028470"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028471"><a href="#local-1628028471"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028468"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028469"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1417"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvSuperClass"><span class="hs-identifier hs-var">EvSuperClass</span></a><span> </span><a href="#local-1628028471"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-1628028470"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1418"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028472"><a href="#local-1628028472"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDFunApp"><span class="hs-identifier hs-var">EvDFunApp</span></a><span> </span><a name="local-1628028473"><a href="#local-1628028473"><span class="hs-identifier">df</span></a></a><span> </span><a name="local-1628028474"><a href="#local-1628028474"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-1628028475"><a href="#local-1628028475"><span class="hs-identifier">tms</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028476"><a href="#local-1628028476"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier hs-var">zonkTcTypeToTypes</span></a><span> </span><a href="#local-1628028472"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028474"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1420"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028477"><a href="#local-1628028477"><span class="hs-identifier">tms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028472"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028475"><span class="hs-identifier hs-var">tms</span></a><span>
</span><a name="line-1421"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDFunApp"><span class="hs-identifier hs-var">EvDFunApp</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkIdOcc"><span class="hs-identifier hs-var">zonkIdOcc</span></a><span> </span><a href="#local-1628028472"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028473"><span class="hs-identifier hs-var">df</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028476"><span class="hs-identifier hs-var">tys'</span></a><span> </span><a href="#local-1628028477"><span class="hs-identifier hs-var">tms'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1422"></a><span class="hs-identifier">zonkEvTerm</span><span> </span><a name="local-1628028478"><a href="#local-1628028478"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDelayedError"><span class="hs-identifier hs-var">EvDelayedError</span></a><span> </span><a name="local-1628028479"><a href="#local-1628028479"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628028480"><a href="#local-1628028480"><span class="hs-identifier">msg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1423"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028481"><a href="#local-1628028481"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028478"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028479"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1424"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvDelayedError"><span class="hs-identifier hs-var">EvDelayedError</span></a><span> </span><a href="#local-1628028481"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1628028480"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1425"></a><span>
</span><a name="line-1426"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span>
</span><a name="line-1427"></a><a name="zonkEvTypeable"><a href="TcHsSyn.html#zonkEvTypeable"><span class="hs-identifier">zonkEvTypeable</span></a></a><span> </span><a name="local-1628028482"><a href="#local-1628028482"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><a name="local-1628028483"><a href="#local-1628028483"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1428"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028484"><a href="#local-1628028484"><span class="hs-identifier">ts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028482"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028483"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-1429"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><a href="#local-1628028484"><span class="hs-identifier hs-var">ts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1430"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><a name="local-1628028485"><a href="#local-1628028485"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a name="local-1628028486"><a href="#local-1628028486"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628028487"><a href="#local-1628028487"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1431"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028488"><a href="#local-1628028488"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028485"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028486"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1432"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028489"><a href="#local-1628028489"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028485"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028487"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1433"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a href="#local-1628028488"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-1628028489"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1434"></a><span class="hs-identifier">zonkEvTypeable</span><span> </span><a name="local-1628028490"><a href="#local-1628028490"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a name="local-1628028491"><a href="#local-1628028491"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1435"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028492"><a href="#local-1628028492"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028490"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028491"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1436"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a href="#local-1628028492"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1437"></a><span>
</span><a name="line-1438"></a><span class="hs-identifier">zonkTcEvBinds_s</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><a name="zonkTcEvBinds_s"><a href="TcHsSyn.html#zonkTcEvBinds_s"><span class="hs-identifier">zonkTcEvBinds_s</span></a></a><span> </span><a name="local-1628028493"><a href="#local-1628028493"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028494"><a href="#local-1628028494"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028495"><a href="#local-1628028495"><span class="hs-identifier">env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028496"><a href="#local-1628028496"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a><span> </span><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier hs-var">zonk_tc_ev_binds</span></a><span> </span><a href="#local-1628028493"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028494"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1440"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028495"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><a href="#local-1628028496"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span class="hs-identifier">zonkTcEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1443"></a><a name="zonkTcEvBinds"><a href="TcHsSyn.html#zonkTcEvBinds"><span class="hs-identifier">zonkTcEvBinds</span></a></a><span> </span><a name="local-1628028497"><a href="#local-1628028497"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028498"><a href="#local-1628028498"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028499"><a href="#local-1628028499"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028500"><a href="#local-1628028500"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier hs-var">zonk_tc_ev_binds</span></a><span> </span><a href="#local-1628028497"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028498"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1444"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028499"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a href="#local-1628028500"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1445"></a><span>
</span><a name="line-1446"></a><span class="hs-identifier">zonk_tc_ev_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><a name="zonk_tc_ev_binds"><a href="TcHsSyn.html#zonk_tc_ev_binds"><span class="hs-identifier">zonk_tc_ev_binds</span></a></a><span> </span><a name="local-1628028501"><a href="#local-1628028501"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-var">TcEvBinds</span></a><span> </span><a name="local-1628028502"><a href="#local-1628028502"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkEvBindsVar"><span class="hs-identifier hs-var">zonkEvBindsVar</span></a><span> </span><a href="#local-1628028501"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028502"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1448"></a><span class="hs-identifier">zonk_tc_ev_binds</span><span> </span><a name="local-1628028503"><a href="#local-1628028503"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a name="local-1628028504"><a href="#local-1628028504"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="#local-1628028503"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028504"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1449"></a><span>
</span><a name="line-1450"></a><span class="hs-identifier">zonkEvBindsVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><a name="zonkEvBindsVar"><a href="TcHsSyn.html#zonkEvBindsVar"><span class="hs-identifier">zonkEvBindsVar</span></a></a><span> </span><a name="local-1628028505"><a href="#local-1628028505"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-var">EvBindsVar</span></a><span> </span><a name="local-1628028506"><a href="#local-1628028506"><span class="hs-identifier">ref</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028507"><a href="#local-1628028507"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-1628028506"><span class="hs-identifier hs-var">ref</span></a><span>
</span><a name="line-1452"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier hs-var">zonkEvBinds</span></a><span> </span><a href="#local-1628028505"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#evBindMapBinds"><span class="hs-identifier hs-var">evBindMapBinds</span></a><span> </span><a href="#local-1628028507"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1453"></a><span>
</span><a name="line-1454"></a><span class="hs-identifier">zonkEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1455"></a><a name="zonkEvBinds"><a href="TcHsSyn.html#zonkEvBinds"><span class="hs-identifier">zonkEvBinds</span></a></a><span> </span><a name="local-1628028508"><a href="#local-1628028508"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028509"><a href="#local-1628028509"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1456"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkEvBinds&quot; #-}</span><span>
</span><a name="line-1457"></a><span>    </span><a href="IOEnv.html#fixM"><span class="hs-identifier hs-var">fixM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1628028514"><a href="#local-1628028514"><span class="hs-identifier">new_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1458"></a><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028515"><a href="#local-1628028515"><span class="hs-identifier">env1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#extendIdZonkEnvRec"><span class="hs-identifier hs-var">extendIdZonkEnvRec</span></a><span> </span><a href="#local-1628028508"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028510"><span class="hs-identifier hs-var">collect_ev_bndrs</span></a><span> </span><a href="#local-1628028514"><span class="hs-identifier hs-var">new_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>         </span><span class="hs-special">;</span><span> </span><a name="local-1628028516"><a href="#local-1628028516"><span class="hs-identifier">binds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Bag.html#mapBagM"><span class="hs-identifier hs-var">mapBagM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkEvBind"><span class="hs-identifier hs-var">zonkEvBind</span></a><span> </span><a href="#local-1628028515"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028509"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1460"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028515"><span class="hs-identifier hs-var">env1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028516"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1461"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1462"></a><span>    </span><span class="hs-identifier">collect_ev_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1463"></a><span>    </span><a name="local-1628028510"><a href="#local-1628028510"><span class="hs-identifier">collect_ev_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="#local-1628028511"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1464"></a><span>    </span><a name="local-1628028511"><a href="#local-1628028511"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028512"><a href="#local-1628028512"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1628028513"><a href="#local-1628028513"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028512"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628028513"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1465"></a><span>
</span><a name="line-1466"></a><span class="hs-identifier">zonkEvBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-1467"></a><a name="zonkEvBind"><a href="TcHsSyn.html#zonkEvBind"><span class="hs-identifier">zonkEvBind</span></a></a><span> </span><a name="local-1628028517"><a href="#local-1628028517"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028518"><a href="#local-1628028518"><span class="hs-identifier">bind</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028519"><a href="#local-1628028519"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028520"><a href="#local-1628028520"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1468"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028521"><a href="#local-1628028521"><span class="hs-identifier">var'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkEvBndr&quot; #-}</span><span> </span><a href="TcHsSyn.html#zonkEvBndr"><span class="hs-identifier hs-var">zonkEvBndr</span></a><span> </span><a href="#local-1628028517"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028519"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1469"></a><span>
</span><a name="line-1470"></a><span>         </span><span class="hs-comment">-- Optimise the common case of Refl coercions</span><span>
</span><a name="line-1471"></a><span>         </span><span class="hs-comment">-- See Note [Optimise coercion zonking]</span><span>
</span><a name="line-1472"></a><span>         </span><span class="hs-comment">-- This has a very big effect on some programs (eg Trac #5030)</span><span>
</span><a name="line-1473"></a><span>
</span><a name="line-1474"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028526"><a href="#local-1628028526"><span class="hs-identifier">term'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628028521"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1475"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628028522"><a href="#local-1628028522"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028523"><a href="#local-1628028523"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028524"><a href="#local-1628028524"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628028523"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628028524"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1476"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCoercion"><span class="hs-identifier hs-var">EvCoercion</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcReflCo"><span class="hs-identifier hs-var">mkTcReflCo</span></a><span> </span><a href="#local-1628028522"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628028523"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><span>           </span><a name="local-1628028525"><a href="#local-1628028525"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkEvTerm"><span class="hs-identifier hs-var">zonkEvTerm</span></a><span> </span><a href="#local-1628028517"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028520"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-1478"></a><span>
</span><a name="line-1479"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028518"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028521"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028526"><span class="hs-identifier hs-var">term'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                         Zonking types
*                                                                      *
************************************************************************

Note [Zonking the LHS of a RULE]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We need to gather the type variables mentioned on the LHS so we can
quantify over them.  Example:
  data T a = C

  foo :: T a -&gt; Int
  foo C = 1

  {-# RULES &quot;myrule&quot;  foo C = 1 #-}

After type checking the LHS becomes (foo a (C a))
and we do not want to zap the unbound tyvar 'a' to (), because
that limits the applicability of the rule.  Instead, we
want to quantify over it!

It's easiest to get zonkTvCollecting to gather the free tyvars
here. Attempts to do so earlier are tiresome, because (a) the data
type is big and (b) finding the free type vars of an expression is
necessarily monadic operation. (consider /\a -&gt; f @ b, where b is
side-effected to a)

And that in turn is why ZonkEnv carries the function to use for
type variables!

Note [Zonking mutable unbound type or kind variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In zonkTypeZapping, we zonk mutable but unbound type or kind variables to an
arbitrary type. We know if they are unbound even though we don't carry an
environment, because at the binding site for a variable we bind the mutable
var to a fresh immutable one.  So the mutable store plays the role of an
environment.  If we come across a mutable variable that isn't so bound, it
must be completely free. We zonk the expected kind to make sure we don't get
some unbound meta variable as the kind.

Note that since we have kind polymorphism, zonk_unbound_tyvar will handle both
type and kind variables. Consider the following datatype:

  data Phantom a = Phantom Int

The type of Phantom is (forall (k : *). forall (a : k). Int). Both `a` and
`k` are unbound variables. We want to zonk this to
(forall (k : Any *). forall (a : Any (Any *)). Int).

Note [Optimise coercion zonking]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When optimising evidence binds we may come across situations where
a coercion looks like
      cv = ReflCo ty
or    cv1 = cv2
where the type 'ty' is big.  In such cases it is a waste of time to zonk both
  * The variable on the LHS
  * The coercion on the RHS
Rather, we can zonk the variable, and if its type is (ty ~ ty), we can just
use Refl on the right, ignoring the actual coercion on the RHS.

This can have a very big effect, because the constraint solver sometimes does go
to a lot of effort to prove Refl!  (Eg when solving  10+3 = 10+3; cf Trac #5030)

-}</span><span>
</span><a name="line-1548"></a><span>
</span><a name="line-1549"></a><span class="hs-identifier">zonkTyVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-1550"></a><a name="zonkTyVarOcc"><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier">zonkTyVarOcc</span></a></a><span> </span><a name="local-1628028527"><a href="#local-1628028527"><span class="hs-identifier">env</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><a name="local-1628028528"><a href="#local-1628028528"><span class="hs-identifier">zonk_unbound_tyvar</span></a></a><span> </span><a name="local-1628028529"><a href="#local-1628028529"><span class="hs-identifier">tv_env</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1628028530"><a href="#local-1628028530"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1551"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1552"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1553"></a><span>         </span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628028531"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1554"></a><span>         </span><a href="TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628028531"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1555"></a><span>         </span><a href="TcType.html#FlatSkol"><span class="hs-identifier hs-var">FlatSkol</span></a><span> </span><a name="local-1628028533"><a href="#local-1628028533"><span class="hs-identifier">ty</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028527"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028533"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1556"></a><span>         </span><a href="TcType.html#MetaTv"><span class="hs-identifier hs-var">MetaTv</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mtv_ref</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628028534"><a href="#local-1628028534"><span class="hs-identifier">ref</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1557"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028535"><a href="#local-1628028535"><span class="hs-identifier">cts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-1628028534"><span class="hs-identifier hs-var">ref</span></a><span>
</span><a name="line-1558"></a><span>                 </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628028535"><span class="hs-identifier hs-var">cts</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1559"></a><span>                      </span><a href="TcType.html#Flexi"><span class="hs-identifier hs-var">Flexi</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028536"><a href="#local-1628028536"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC &quot;zonkKind1&quot; #-}</span><span>
</span><a name="line-1560"></a><span>                                            </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028527"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1561"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a href="#local-1628028528"><span class="hs-identifier hs-var">zonk_unbound_tyvar</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1628028536"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1562"></a><span>                      </span><a href="TcType.html#Indirect"><span class="hs-identifier hs-var">Indirect</span></a><span> </span><a name="local-1628028537"><a href="#local-1628028537"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028538"><a href="#local-1628028538"><span class="hs-identifier">zty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028527"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028537"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1563"></a><span>                                        </span><span class="hs-comment">-- Small optimisation: shortern-out indirect steps</span><span>
</span><a name="line-1564"></a><span>                                        </span><span class="hs-comment">-- so that the old type may be more easily collected.</span><span>
</span><a name="line-1565"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="IOEnv.html#writeMutVar"><span class="hs-identifier hs-var">writeMutVar</span></a><span> </span><a href="#local-1628028534"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#Indirect"><span class="hs-identifier hs-var">Indirect</span></a><span> </span><a href="#local-1628028538"><span class="hs-identifier hs-var">zty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1566"></a><span>                                        </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628028538"><span class="hs-identifier hs-var">zty</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1567"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1568"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628028531"><span class="hs-identifier hs-var">lookup_in_env</span></a><span>
</span><a name="line-1569"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1570"></a><span>    </span><a name="local-1628028531"><a href="#local-1628028531"><span class="hs-identifier">lookup_in_env</span></a></a><span>    </span><span class="hs-comment">-- Look up in the env just as we do for Ids</span><span>
</span><a name="line-1571"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-1628028529"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1572"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Var.html#updateTyVarKindM"><span class="hs-identifier hs-var">updateTyVarKindM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028527"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028530"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1573"></a><span>          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628028532"><a href="#local-1628028532"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628028532"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1574"></a><span>
</span><a name="line-1575"></a><span class="hs-identifier">zonkCoVarOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1576"></a><a name="zonkCoVarOcc"><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier">zonkCoVarOcc</span></a></a><span> </span><a name="local-1628028539"><a href="#local-1628028539"><span class="hs-identifier">env</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-var">ZonkEnv</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628028540"><a href="#local-1628028540"><span class="hs-identifier">tyco_env</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1628028541"><a href="#local-1628028541"><span class="hs-identifier">cv</span></a></a><span>
</span><a name="line-1577"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628028542"><a href="#local-1628028542"><span class="hs-identifier">cv'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-1628028540"><span class="hs-identifier hs-var">tyco_env</span></a><span> </span><a href="#local-1628028541"><span class="hs-identifier hs-var">cv</span></a><span>  </span><span class="hs-comment">-- don't look in the knot-tied env</span><span>
</span><a name="line-1578"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span> </span><a href="#local-1628028542"><span class="hs-identifier hs-var">cv'</span></a><span>
</span><a name="line-1579"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1580"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028539"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028541"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span class="hs-identifier">zonkCoHole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span>
</span><a name="line-1583"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>  </span><span class="hs-comment">-- these are all redundant with</span><span>
</span><a name="line-1584"></a><span>                                    </span><span class="hs-comment">-- the details in the hole,</span><span>
</span><a name="line-1585"></a><span>                                    </span><span class="hs-comment">-- unzonked</span><span>
</span><a name="line-1586"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1587"></a><a name="zonkCoHole"><a href="TcHsSyn.html#zonkCoHole"><span class="hs-identifier">zonkCoHole</span></a></a><span> </span><a name="local-1628028543"><a href="#local-1628028543"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028544"><a href="#local-1628028544"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1628028545"><a href="#local-1628028545"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1628028546"><a href="#local-1628028546"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1628028547"><a href="#local-1628028547"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1588"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028548"><a href="#local-1628028548"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#unpackCoercionHole_maybe"><span class="hs-identifier hs-var">unpackCoercionHole_maybe</span></a><span> </span><a href="#local-1628028544"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-1589"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628028548"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1590"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628028549"><a href="#local-1628028549"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028550"><a href="#local-1628028550"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier hs-var">zonkCoToCo</span></a><span> </span><a href="#local-1628028543"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028549"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1591"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#checkCoercionHole"><span class="hs-identifier hs-var">checkCoercionHole</span></a><span> </span><a href="#local-1628028550"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-1628028544"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-1628028545"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628028546"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628028547"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1592"></a><span>
</span><a name="line-1593"></a><span>              </span><span class="hs-comment">-- This next case should happen only in the presence of</span><span>
</span><a name="line-1594"></a><span>              </span><span class="hs-comment">-- (undeferred) type errors. Originally, I put in a panic</span><span>
</span><a name="line-1595"></a><span>              </span><span class="hs-comment">-- here, but that caused too many uses of `failIfErrsM`.</span><span>
</span><a name="line-1596"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;Zonking unfilled coercion hole&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628028544"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-1597"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1598"></a><span>                           </span><a href="TcRnMonad.html#whenNoErrs"><span class="hs-identifier hs-var">whenNoErrs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1599"></a><span>                           </span><span class="hs-identifier">MASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-1600"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;Type-correct unfilled coercion hole&quot;</span><span>
</span><a name="line-1601"></a><span>                                     </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1602"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-1628028551"><a href="#local-1628028551"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028543"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028546"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1603"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-1628028552"><a href="#local-1628028552"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028543"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028547"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1604"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#mkHoleCo"><span class="hs-identifier hs-var">mkHoleCo</span></a><span> </span><a href="#local-1628028544"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-1628028545"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1628028551"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1628028552"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span class="hs-identifier">zonk_tycomapper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span>
</span><a name="line-1607"></a><a name="zonk_tycomapper"><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier">zonk_tycomapper</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span>
</span><a name="line-1608"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Establish type invariants</span><span>
</span><a name="line-1609"></a><span>                       </span><span class="hs-comment">-- See Note [Type-checking inside the knot] in TcHsType</span><span>
</span><a name="line-1610"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tyvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkTyVarOcc"><span class="hs-identifier hs-var">zonkTyVarOcc</span></a><span>
</span><a name="line-1611"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_covar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkCoVarOcc"><span class="hs-identifier hs-var">zonkCoVarOcc</span></a><span>
</span><a name="line-1612"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_hole</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcHsSyn.html#zonkCoHole"><span class="hs-identifier hs-var">zonkCoHole</span></a><span>
</span><a name="line-1613"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1628028553"><a href="#local-1628028553"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028554"><a href="#local-1628028554"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1628028555"><a href="#local-1628028555"><span class="hs-identifier">_vis</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#zonkTyBndrX"><span class="hs-identifier hs-var">zonkTyBndrX</span></a><span> </span><a href="#local-1628028553"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028554"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1614"></a><span>
</span><a name="line-1615"></a><span class="hs-comment">-- Confused by zonking? See Note [What is zonking?] in TcMType.</span><span>
</span><a name="line-1616"></a><span class="hs-identifier">zonkTcTypeToType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1617"></a><a name="zonkTcTypeToType"><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier">zonkTcTypeToType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier hs-var">zonk_tycomapper</span></a><span>
</span><a name="line-1618"></a><span>
</span><a name="line-1619"></a><span class="hs-identifier">zonkTcTypeToTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1620"></a><a name="zonkTcTypeToTypes"><a href="TcHsSyn.html#zonkTcTypeToTypes"><span class="hs-identifier">zonkTcTypeToTypes</span></a></a><span> </span><a name="local-1628028556"><a href="#local-1628028556"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1628028557"><a href="#local-1628028557"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028556"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628028557"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1621"></a><span>
</span><a name="line-1622"></a><span class="hs-comment">-- | Used during kind-checking in TcTyClsDecls, where it's more convenient</span><span>
</span><a name="line-1623"></a><span class="hs-comment">-- to keep the binders and result kind separate.</span><span>
</span><a name="line-1624"></a><span class="hs-identifier">zonkTcKindToKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcTyBinder"><span class="hs-identifier hs-type">TcTyBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcKind"><span class="hs-identifier hs-type">TcKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1625"></a><a name="zonkTcKindToKind"><a href="TcHsSyn.html#zonkTcKindToKind"><span class="hs-identifier">zonkTcKindToKind</span></a></a><span> </span><a name="local-1628028558"><a href="#local-1628028558"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-1628028559"><a href="#local-1628028559"><span class="hs-identifier">res_kind</span></a></a><span>
</span><a name="line-1626"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628028560"><a href="#local-1628028560"><span class="hs-identifier">env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028561"><a href="#local-1628028561"><span class="hs-identifier">binders'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTyBinders"><span class="hs-identifier hs-var">zonkTyBinders</span></a><span> </span><a href="TcHsSyn.html#emptyZonkEnv"><span class="hs-identifier hs-var">emptyZonkEnv</span></a><span> </span><a href="#local-1628028558"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1627"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628028562"><a href="#local-1628028562"><span class="hs-identifier">res_kind'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsSyn.html#zonkTcTypeToType"><span class="hs-identifier hs-var">zonkTcTypeToType</span></a><span> </span><a href="#local-1628028560"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1628028559"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1628"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628028561"><span class="hs-identifier hs-var">binders'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628028562"><span class="hs-identifier hs-var">res_kind'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">zonkCoToCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#ZonkEnv"><span class="hs-identifier hs-type">ZonkEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1631"></a><a name="zonkCoToCo"><a href="TcHsSyn.html#zonkCoToCo"><span class="hs-identifier">zonkCoToCo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="TcHsSyn.html#zonk_tycomapper"><span class="hs-identifier hs-var">zonk_tycomapper</span></a><span>
</span><a name="line-1632"></a><span>
</span><a name="line-1633"></a><span class="hs-identifier">zonkTvCollecting</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a><span> </span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-1634"></a><span class="hs-comment">-- This variant collects unbound type variables in a mutable variable</span><span>
</span><a name="line-1635"></a><span class="hs-comment">-- Works on both types and kinds</span><span>
</span><a name="line-1636"></a><a name="zonkTvCollecting"><a href="TcHsSyn.html#zonkTvCollecting"><span class="hs-identifier">zonkTvCollecting</span></a></a><span> </span><a name="local-1628028563"><a href="#local-1628028563"><span class="hs-identifier">kind_vars</span></a></a><span> </span><a name="local-1628028564"><a href="#local-1628028564"><span class="hs-identifier">unbound_tv_set</span></a></a><span> </span><a name="local-1628028565"><a href="#local-1628028565"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628028566"><a href="#local-1628028566"><span class="hs-identifier">poly_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-8.1/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html#PolyKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">PolyKinds</span></a><span>
</span><a name="line-1638"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628028565"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628028563"><span class="hs-identifier hs-var">kind_vars</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-1628028566"><span class="hs-identifier hs-var">poly_kinds</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="TcMType.html#defaultKindVar"><span class="hs-identifier hs-var">defaultKindVar</span></a><span> </span><a href="#local-1628028565"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1639"></a><span>       </span><span class="hs-special">{</span><span> </span><a name="local-1628028567"><a href="#local-1628028567"><span class="hs-identifier">ty_or_tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkQuantifiedTyVarOrType"><span class="hs-identifier hs-var">zonkQuantifiedTyVarOrType</span></a><span> </span><a href="#local-1628028565"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1640"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628028567"><span class="hs-identifier hs-var">ty_or_tv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1641"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1628028568"><a href="#local-1628028568"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628028568"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1642"></a><span>           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-1628028569"><a href="#local-1628028569"><span class="hs-identifier">tv'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1643"></a><span>             </span><span class="hs-special">{</span><span> </span><a name="local-1628028570"><a href="#local-1628028570"><span class="hs-identifier">tv_set</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a><span> </span><a href="#local-1628028564"><span class="hs-identifier hs-var">unbound_tv_set</span></a><span>
</span><a name="line-1644"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="IOEnv.html#writeMutVar"><span class="hs-identifier hs-var">writeMutVar</span></a><span> </span><a href="#local-1628028564"><span class="hs-identifier hs-var">unbound_tv_set</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a><span> </span><a href="#local-1628028570"><span class="hs-identifier hs-var">tv_set</span></a><span> </span><a href="#local-1628028569"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1645"></a><span>             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628028569"><span class="hs-identifier hs-var">tv'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1646"></a><span>
</span><a name="line-1647"></a><span class="hs-identifier">zonkTypeZapping</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcHsSyn.html#UnboundTyVarZonker"><span class="hs-identifier hs-type">UnboundTyVarZonker</span></a><span>
</span><a name="line-1648"></a><span class="hs-comment">-- This variant is used for everything except the LHS of rules</span><span>
</span><a name="line-1649"></a><span class="hs-comment">-- It zaps unbound type variables to (), or some other arbitrary type</span><span>
</span><a name="line-1650"></a><span class="hs-comment">-- Works on both types and kinds</span><span>
</span><a name="line-1651"></a><a name="zonkTypeZapping"><a href="TcHsSyn.html#zonkTypeZapping"><span class="hs-identifier">zonkTypeZapping</span></a></a><span> </span><a name="local-1628028571"><a href="#local-1628028571"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-1652"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628028572"><a href="#local-1628028572"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isRuntimeRepVar"><span class="hs-identifier hs-var">isRuntimeRepVar</span></a><span> </span><a href="#local-1628028571"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#ptrRepLiftedTy"><span class="hs-identifier hs-var">ptrRepLiftedTy</span></a><span>
</span><a name="line-1653"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#anyTypeOfKind"><span class="hs-identifier hs-var">anyTypeOfKind</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628028571"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1654"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcMType.html#writeMetaTyVar"><span class="hs-identifier hs-var">writeMetaTyVar</span></a><span> </span><a href="#local-1628028571"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1628028572"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1655"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628028572"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1656"></a><span>
</span><a name="line-1657"></a><span class="hs-comment">---------------------------------------</span><span>
</span><a name="line-1658"></a><span class="hs-comment">{-
Note [Unboxed tuples in representation polymorphism check]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Recall that all types that have values (that is, lifted and unlifted
types) have kinds that look like (TYPE rep), where (rep :: RuntimeRep)
tells how the values are represented at runtime. Lifted types have
kind (TYPE PtrRepLifted) (for which * is just a synonym) and, say,
Int# has kind (TYPE IntRep).

It would be terrible if the code generator came upon a binder of a type
whose kind is something like TYPE r, where r is a skolem type variable.
The code generator wouldn't know what to do. So we eliminate that case
here.

Although representation polymorphism and the RuntimeRep type catch
most ways of abusing unlifted types, it still isn't quite satisfactory
around unboxed tuples. That's because all unboxed tuple types have kind
TYPE UnboxedTupleRep, which is clearly a lie: it doesn't actually tell
you what the representation is.

Naively, when checking for representation polymorphism, you might think we can
just look for free variables in a type's RuntimeRep. But this misses the
UnboxedTupleRep case.

So, instead, we handle unboxed tuples specially. Only after unboxed tuples
are handled do we look for free tyvars in a RuntimeRep.

We must still be careful in the UnboxedTupleRep case. A binder whose type
has kind UnboxedTupleRep is OK -- only as long as the type is really an
unboxed tuple, which the code generator treats specially. So we do this:
 1. Check if the type is an unboxed tuple. If so, recur.
 2. Check if the kind is TYPE UnboxedTupleRep. If so, error.
 3. Check if the kind has any free variables. If so, error.

In case 1, we have a type that looks like

  (# , #) PtrRepLifted IntRep Bool Int#

recalling that

  (# , #) :: forall (r1 :: RuntimeRep) (r2 :: RuntimeRep).
             TYPE r1 -&gt; TYPE r2 -&gt; TYPE UnboxedTupleRep

It's tempting just to look at the RuntimeRep arguments to make sure
that they are devoid of free variables and not UnboxedTupleRep. This
naive check, though, fails on nested unboxed tuples, like
(# Int#, (# Bool, Void# #) #). Thus, instead of looking at the RuntimeRep
args to the unboxed tuple constructor, we look at the types themselves.

Here are a few examples:

   type family F r :: TYPE r

   x :: (F r :: TYPE r)   -- REJECTED: simple representation polymorphism
     where r is an in-scope type variable of kind RuntimeRep

   x :: (F PtrRepLifted :: TYPE PtrRepLifted)   -- OK
   x :: (F IntRep       :: TYPE IntRep)         -- OK

   x :: (F UnboxedTupleRep :: TYPE UnboxedTupleRep)  -- REJECTED

   x :: ((# Int, Bool #) :: TYPE UnboxedTupleRep)    -- OK
-}</span><span>
</span><a name="line-1721"></a><span>
</span><a name="line-1722"></a><span class="hs-comment">-- | According to the rules around representation polymorphism</span><span>
</span><a name="line-1723"></a><span class="hs-comment">-- (see https://ghc.haskell.org/trac/ghc/wiki/NoSubKinds), no binder</span><span>
</span><a name="line-1724"></a><span class="hs-comment">-- can have a representation-polymorphic type. This check ensures</span><span>
</span><a name="line-1725"></a><span class="hs-comment">-- that we respect this rule. It is a bit regrettable that this error</span><span>
</span><a name="line-1726"></a><span class="hs-comment">-- occurs in zonking, after which we should have reported all errors.</span><span>
</span><a name="line-1727"></a><span class="hs-comment">-- But it's hard to see where else to do it, because this can be discovered</span><span>
</span><a name="line-1728"></a><span class="hs-comment">-- only after all solving is done. And, perhaps most importantly, this</span><span>
</span><a name="line-1729"></a><span class="hs-comment">-- isn't really a compositional property of a type system, so it's</span><span>
</span><a name="line-1730"></a><span class="hs-comment">-- not a terrible surprise that the check has to go in an awkward spot.</span><span>
</span><a name="line-1731"></a><span class="hs-identifier">ensureNotRepresentationPolymorphic</span><span>
</span><a name="line-1732"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>  </span><span class="hs-comment">-- its zonked type</span><span>
</span><a name="line-1733"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>  </span><span class="hs-comment">-- where this happened</span><span>
</span><a name="line-1734"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1735"></a><a name="ensureNotRepresentationPolymorphic"><a href="TcHsSyn.html#ensureNotRepresentationPolymorphic"><span class="hs-identifier">ensureNotRepresentationPolymorphic</span></a></a><span> </span><a name="local-1628028573"><a href="#local-1628028573"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628028574"><a href="#local-1628028574"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-1736"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenNoErrs"><span class="hs-identifier hs-var">whenNoErrs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>   </span><span class="hs-comment">-- sometimes we end up zonking bogus definitions of type</span><span>
</span><a name="line-1737"></a><span>                   </span><span class="hs-comment">-- forall a. a. See, for example, test ghci/scripts/T9140</span><span>
</span><a name="line-1738"></a><span>    </span><a href="TcHsSyn.html#checkForRepresentationPolymorphism"><span class="hs-identifier hs-var">checkForRepresentationPolymorphism</span></a><span> </span><a href="#local-1628028574"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-1628028573"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1739"></a><span>
</span><a name="line-1740"></a><span>   </span><span class="hs-comment">-- See Note [Unboxed tuples in representation polymorphism check]</span><span>
</span><a name="line-1741"></a><span class="hs-identifier">checkForRepresentationPolymorphism</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1742"></a><a name="checkForRepresentationPolymorphism"><a href="TcHsSyn.html#checkForRepresentationPolymorphism"><span class="hs-identifier">checkForRepresentationPolymorphism</span></a></a><span> </span><a name="local-1628028575"><a href="#local-1628028575"><span class="hs-identifier">extra</span></a></a><span> </span><a name="local-1628028576"><a href="#local-1628028576"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1743"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628028582"><a href="#local-1628028582"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028583"><a href="#local-1628028583"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1628028576"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1744"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><a href="#local-1628028582"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1745"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#checkForRepresentationPolymorphism"><span class="hs-identifier hs-var">checkForRepresentationPolymorphism</span></a><span> </span><a href="#local-1628028575"><span class="hs-identifier hs-var">extra</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var">dropRuntimeRepArgs</span></a><span> </span><a href="#local-1628028583"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1746"></a><span>
</span><a name="line-1747"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628028578"><span class="hs-identifier hs-var">runtime_rep</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="TysWiredIn.html#unboxedTupleRepDataConTy"><span class="hs-identifier hs-var">unboxedTupleRepDataConTy</span></a><span>
</span><a name="line-1748"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628028580"><span class="hs-identifier hs-var">tidy_ty</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1749"></a><span>                     </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not an unboxed tuple,&quot;</span><span>
</span><a name="line-1750"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;and yet its kind suggests that it has the representation&quot;</span><span>
</span><a name="line-1751"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;of an unboxed tuple. This is not allowed.&quot;</span><span> </span><span class="hs-special">]</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1752"></a><span>            </span><a href="#local-1628028575"><span class="hs-identifier hs-var">extra</span></a><span class="hs-special">)</span><span>
</span><a name="line-1753"></a><span>
</span><a name="line-1754"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#isEmptyVarSet"><span class="hs-identifier hs-var">isEmptyVarSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628028578"><span class="hs-identifier hs-var">runtime_rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1755"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1756"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;A representation-polymorphic type is not allowed here:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1757"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628028580"><span class="hs-identifier hs-var">tidy_ty</span></a><span>
</span><a name="line-1758"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628028581"><span class="hs-identifier hs-var">tidy_ki</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1759"></a><span>    </span><a href="#local-1628028575"><span class="hs-identifier hs-var">extra</span></a><span>
</span><a name="line-1760"></a><span>
</span><a name="line-1761"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1762"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1763"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1764"></a><span>    </span><a name="local-1628028577"><a href="#local-1628028577"><span class="hs-identifier">ki</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628028576"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1765"></a><span>    </span><a name="local-1628028578"><a href="#local-1628028578"><span class="hs-identifier">runtime_rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier hs-var">getRuntimeRepFromKind</span></a><span> </span><span class="hs-string">&quot;check_type&quot;</span><span> </span><a href="#local-1628028577"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1766"></a><span>
</span><a name="line-1767"></a><span>    </span><span class="hs-special">(</span><a name="local-1628028579"><a href="#local-1628028579"><span class="hs-identifier">tidy_env</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628028580"><a href="#local-1628028580"><span class="hs-identifier">tidy_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a><span> </span><a href="VarEnv.html#emptyTidyEnv"><span class="hs-identifier hs-var">emptyTidyEnv</span></a><span> </span><a href="#local-1628028576"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1768"></a><span>    </span><a name="local-1628028581"><a href="#local-1628028581"><span class="hs-identifier">tidy_ki</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a><span> </span><a href="#local-1628028579"><span class="hs-identifier hs-var">tidy_env</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1628028576"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1769"></a></pre></body></html>